2025-03-29 18:46:27,069 [INFO] - Using device: cuda
2025-03-29 18:46:27,074 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-03-29 18:46:27,074 [INFO] - GPU Memory: 6.00 GB
2025-03-29 18:46:27,074 [INFO] - CUDA Version: 12.4
2025-03-29 18:46:27,074 [INFO] - cuDNN benchmark mode enabled
2025-03-29 18:46:27,100 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-03-29 18:46:27,103 [INFO] - Random seed set to 42
2025-03-29 18:46:27,103 [INFO] - Preparing data loaders...
2025-03-29 18:46:28,683 [INFO] - Training samples: 45000
2025-03-29 18:46:28,683 [INFO] - Validation samples: 5000
2025-03-29 18:46:28,683 [INFO] - Test samples: 10000
2025-03-29 18:46:28,683 [INFO] - Creating models for mutual learning...
2025-03-29 18:46:28,683 [INFO] - Loading ViT-B16 model...
2025-03-29 18:46:29,610 [INFO] - Loading EfficientNetB0 model...
2025-03-29 18:46:29,731 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-03-29 18:46:30,111 [INFO] - Loading MobileNetV3 model...
2025-03-29 18:46:30,231 [INFO] - Loading ResNet50 model...
2025-03-29 18:46:30,620 [INFO] - Loading DenseNet121 model...
2025-03-29 18:46:30,773 [INFO] - Creating student model (EfficientNetB0-based)...
2025-03-29 18:46:30,999 [INFO] - Model vit moved to cuda
2025-03-29 18:46:31,036 [INFO] - Model efficientnet moved to cuda
2025-03-29 18:46:31,090 [INFO] - Model inception moved to cuda
2025-03-29 18:46:31,122 [INFO] - Model mobilenet moved to cuda
2025-03-29 18:46:31,155 [INFO] - Model resnet moved to cuda
2025-03-29 18:46:31,216 [INFO] - Model densenet moved to cuda
2025-03-29 18:46:31,235 [INFO] - Model student moved to cuda
2025-03-29 18:46:31,238 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-03-29 18:46:31,240 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-03-29 18:46:31,243 [INFO] - Model inception: 25.13M parameters (25.13M trainable)
2025-03-29 18:46:31,245 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-03-29 18:46:31,246 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-03-29 18:46:31,249 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-03-29 18:46:31,249 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-03-29 18:46:31,249 [INFO] - Starting initialization phase...
2025-03-29 18:46:31,257 [INFO] - Initialization Epoch 1/5
2025-03-29 18:46:31,400 [INFO] - GPU cache cleared: 595.11MB → 595.11MB (freed 0.00MB)
2025-03-29 18:47:01,454 [INFO] - GPU cache cleared: 1224.43MB → 1224.43MB (freed 0.00MB)
2025-03-29 18:49:13,343 [INFO] - GPU cache cleared: 2396.62MB → 2396.62MB (freed 0.00MB)
2025-03-29 18:54:29,568 [INFO] - GPU cache cleared: 2396.63MB → 2396.63MB (freed 0.00MB)
2025-03-29 18:59:39,171 [INFO] - GPU cache cleared: 2398.50MB → 2398.50MB (freed 0.00MB)
2025-03-29 19:04:51,162 [INFO] - GPU cache cleared: 2402.39MB → 2402.39MB (freed 0.00MB)
2025-03-29 19:09:43,290 [INFO] - GPU cache cleared: 2396.66MB → 2396.66MB (freed 0.00MB)
2025-03-29 19:15:02,590 [INFO] - GPU cache cleared: 2399.76MB → 2399.76MB (freed 0.00MB)
2025-03-29 19:19:28,643 [INFO] - GPU cache cleared: 2396.73MB → 2396.73MB (freed 0.00MB)
2025-03-29 19:23:34,544 [INFO] - GPU cache cleared: 2395.85MB → 2395.85MB (freed 0.00MB)
2025-03-29 19:28:40,677 [INFO] - GPU cache cleared: 2394.05MB → 2394.05MB (freed 0.00MB)
2025-03-29 19:32:54,225 [INFO] - GPU cache cleared: 2395.09MB → 2395.09MB (freed 0.00MB)
2025-03-29 19:37:35,128 [INFO] - GPU cache cleared: 2395.93MB → 2395.93MB (freed 0.00MB)
2025-03-29 19:41:42,456 [INFO] - GPU cache cleared: 2400.19MB → 2400.19MB (freed 0.00MB)
2025-03-29 19:46:08,741 [INFO] - GPU cache cleared: 2398.03MB → 2398.03MB (freed 0.00MB)
2025-03-29 19:50:09,452 [INFO] - GPU cache cleared: 2401.53MB → 2401.53MB (freed 0.00MB)
2025-03-29 19:55:01,348 [INFO] - GPU cache cleared: 2393.63MB → 2393.63MB (freed 0.00MB)
2025-03-29 19:58:58,588 [INFO] - GPU cache cleared: 2395.66MB → 2395.66MB (freed 0.00MB)
2025-03-29 20:03:13,675 [INFO] - GPU cache cleared: 2399.10MB → 2399.10MB (freed 0.00MB)
2025-03-29 20:07:02,923 [INFO] - GPU cache cleared: 2393.87MB → 2393.87MB (freed 0.00MB)
2025-03-29 20:11:14,425 [INFO] -   vit: Train Loss=2.0530, Train Acc=23.85%, Val Loss=1.9032, Val Acc=29.38%
2025-03-29 20:11:14,483 [INFO] -   New best model for vit (Val Acc: 29.38%)
2025-03-29 20:11:14,483 [INFO] -   efficientnet: Train Loss=0.5684, Train Acc=80.81%, Val Loss=0.1897, Val Acc=93.40%
2025-03-29 20:11:14,537 [INFO] -   New best model for efficientnet (Val Acc: 93.40%)
2025-03-29 20:11:14,538 [INFO] -   inception: Train Loss=0.7133, Train Acc=75.92%, Val Loss=0.3381, Val Acc=88.62%
2025-03-29 20:11:14,592 [INFO] -   New best model for inception (Val Acc: 88.62%)
2025-03-29 20:11:14,592 [INFO] -   mobilenet: Train Loss=0.5482, Train Acc=81.04%, Val Loss=0.2931, Val Acc=90.02%
2025-03-29 20:11:14,647 [INFO] -   New best model for mobilenet (Val Acc: 90.02%)
2025-03-29 20:11:14,647 [INFO] -   resnet: Train Loss=0.7906, Train Acc=72.80%, Val Loss=0.5464, Val Acc=81.86%
2025-03-29 20:11:14,696 [INFO] -   New best model for resnet (Val Acc: 81.86%)
2025-03-29 20:11:14,697 [INFO] -   densenet: Train Loss=0.6042, Train Acc=79.30%, Val Loss=0.3336, Val Acc=88.42%
2025-03-29 20:11:14,745 [INFO] -   New best model for densenet (Val Acc: 88.42%)
2025-03-29 20:11:14,746 [INFO] -   student: Train Loss=0.5639, Train Acc=81.08%, Val Loss=0.1892, Val Acc=93.42%
2025-03-29 20:11:14,793 [INFO] -   New best model for student (Val Acc: 93.42%)
2025-03-29 20:11:14,793 [INFO] - Initialization epoch 1 completed in 5083.54s
2025-03-29 20:11:14,793 [INFO] - Initialization Epoch 2/5
2025-03-29 20:11:14,964 [INFO] - GPU cache cleared: 2376.12MB → 2376.12MB (freed 0.00MB)
2025-03-29 20:11:19,336 [INFO] - GPU cache cleared: 2396.04MB → 2396.04MB (freed 0.00MB)
2025-03-29 20:15:42,114 [INFO] - GPU cache cleared: 2393.56MB → 2393.56MB (freed 0.00MB)
2025-03-29 20:20:21,905 [INFO] - GPU cache cleared: 2398.62MB → 2398.62MB (freed 0.00MB)
2025-03-29 20:24:35,926 [INFO] - GPU cache cleared: 2399.10MB → 2399.10MB (freed 0.00MB)
2025-03-29 20:28:48,593 [INFO] - GPU cache cleared: 2398.43MB → 2398.43MB (freed 0.00MB)
2025-03-29 20:32:47,777 [INFO] - GPU cache cleared: 2397.86MB → 2397.86MB (freed 0.00MB)
2025-03-29 20:37:18,309 [INFO] - GPU cache cleared: 2393.81MB → 2393.81MB (freed 0.00MB)
2025-03-29 20:41:09,805 [INFO] - GPU cache cleared: 2396.56MB → 2396.56MB (freed 0.00MB)
2025-03-29 20:45:24,735 [INFO] - GPU cache cleared: 2392.80MB → 2392.80MB (freed 0.00MB)
2025-03-29 20:49:28,654 [INFO] - GPU cache cleared: 2396.92MB → 2396.92MB (freed 0.00MB)
2025-03-29 20:53:37,815 [INFO] - GPU cache cleared: 2396.14MB → 2396.14MB (freed 0.00MB)
2025-03-29 20:57:17,607 [INFO] - GPU cache cleared: 2394.28MB → 2394.28MB (freed 0.00MB)
2025-03-29 21:01:54,619 [INFO] - GPU cache cleared: 2398.80MB → 2398.80MB (freed 0.00MB)
2025-03-29 21:05:59,854 [INFO] - GPU cache cleared: 2394.91MB → 2394.91MB (freed 0.00MB)
2025-03-29 21:10:25,598 [INFO] - GPU cache cleared: 2399.59MB → 2399.59MB (freed 0.00MB)
2025-03-29 21:14:26,924 [INFO] - GPU cache cleared: 2395.39MB → 2395.39MB (freed 0.00MB)
2025-03-29 21:19:34,633 [INFO] - GPU cache cleared: 2398.37MB → 2398.37MB (freed 0.00MB)
2025-03-29 21:23:38,585 [INFO] - GPU cache cleared: 2395.00MB → 2395.00MB (freed 0.00MB)
2025-03-29 21:28:22,240 [INFO] - GPU cache cleared: 2395.83MB → 2395.83MB (freed 0.00MB)
2025-03-29 21:32:38,822 [INFO] -   vit: Train Loss=1.7516, Train Acc=34.34%, Val Loss=1.6562, Val Acc=38.92%
2025-03-29 21:32:38,885 [INFO] -   New best model for vit (Val Acc: 38.92%)
2025-03-29 21:32:38,885 [INFO] -   efficientnet: Train Loss=0.2857, Train Acc=90.21%, Val Loss=0.1558, Val Acc=94.70%
2025-03-29 21:32:38,939 [INFO] -   New best model for efficientnet (Val Acc: 94.70%)
2025-03-29 21:32:38,939 [INFO] -   inception: Train Loss=0.4474, Train Acc=85.04%, Val Loss=0.2728, Val Acc=91.02%
2025-03-29 21:32:38,993 [INFO] -   New best model for inception (Val Acc: 91.02%)
2025-03-29 21:32:38,994 [INFO] -   mobilenet: Train Loss=0.2838, Train Acc=90.26%, Val Loss=0.2002, Val Acc=92.94%
2025-03-29 21:32:39,043 [INFO] -   New best model for mobilenet (Val Acc: 92.94%)
2025-03-29 21:32:39,043 [INFO] -   resnet: Train Loss=0.5179, Train Acc=82.50%, Val Loss=0.3510, Val Acc=87.88%
2025-03-29 21:32:39,106 [INFO] -   New best model for resnet (Val Acc: 87.88%)
2025-03-29 21:32:39,106 [INFO] -   densenet: Train Loss=0.3672, Train Acc=87.58%, Val Loss=0.2583, Val Acc=91.12%
2025-03-29 21:32:39,171 [INFO] -   New best model for densenet (Val Acc: 91.12%)
2025-03-29 21:32:39,171 [INFO] -   student: Train Loss=0.2838, Train Acc=90.31%, Val Loss=0.1702, Val Acc=94.20%
2025-03-29 21:32:39,223 [INFO] -   New best model for student (Val Acc: 94.20%)
2025-03-29 21:32:39,224 [INFO] - Initialization epoch 2 completed in 4884.43s
2025-03-29 21:32:39,224 [INFO] - Initialization Epoch 3/5
2025-03-29 21:32:39,519 [INFO] - GPU cache cleared: 2373.16MB → 2373.16MB (freed 0.00MB)
2025-03-29 21:32:43,139 [INFO] - GPU cache cleared: 2395.93MB → 2395.93MB (freed 0.00MB)
2025-03-29 21:37:10,823 [INFO] - GPU cache cleared: 2394.10MB → 2394.10MB (freed 0.00MB)
2025-03-29 21:41:41,786 [INFO] - GPU cache cleared: 2395.74MB → 2395.74MB (freed 0.00MB)
2025-03-29 21:45:35,924 [INFO] - GPU cache cleared: 2397.33MB → 2397.33MB (freed 0.00MB)
2025-03-29 21:50:18,690 [INFO] - GPU cache cleared: 2394.59MB → 2394.59MB (freed 0.00MB)
2025-03-29 21:54:35,501 [INFO] - GPU cache cleared: 2394.63MB → 2394.63MB (freed 0.00MB)
2025-03-29 21:59:05,196 [INFO] - GPU cache cleared: 2394.68MB → 2394.68MB (freed 0.00MB)
2025-03-29 22:03:16,099 [INFO] - GPU cache cleared: 2399.91MB → 2399.91MB (freed 0.00MB)
2025-03-29 22:07:51,112 [INFO] - GPU cache cleared: 2398.45MB → 2398.45MB (freed 0.00MB)
2025-03-29 22:12:06,793 [INFO] - GPU cache cleared: 2392.96MB → 2392.96MB (freed 0.00MB)
2025-03-29 22:16:31,608 [INFO] - GPU cache cleared: 2395.68MB → 2395.68MB (freed 0.00MB)
2025-03-29 22:20:34,792 [INFO] - GPU cache cleared: 2402.46MB → 2402.46MB (freed 0.00MB)
2025-03-29 22:25:44,167 [INFO] - GPU cache cleared: 2397.59MB → 2397.59MB (freed 0.00MB)
2025-03-29 22:30:28,803 [INFO] - GPU cache cleared: 2397.08MB → 2397.08MB (freed 0.00MB)
2025-03-29 22:34:55,497 [INFO] - GPU cache cleared: 2394.88MB → 2394.88MB (freed 0.00MB)
2025-03-29 22:39:07,160 [INFO] - GPU cache cleared: 2395.82MB → 2395.82MB (freed 0.00MB)
2025-03-29 22:43:13,023 [INFO] - GPU cache cleared: 2396.75MB → 2396.75MB (freed 0.00MB)
2025-03-29 22:46:47,018 [INFO] - GPU cache cleared: 2394.18MB → 2394.18MB (freed 0.00MB)
2025-03-29 22:50:56,850 [INFO] - GPU cache cleared: 2397.17MB → 2397.17MB (freed 0.00MB)
2025-03-29 22:55:40,406 [INFO] -   vit: Train Loss=1.5322, Train Acc=43.81%, Val Loss=1.5141, Val Acc=45.00%
2025-03-29 22:55:40,470 [INFO] -   New best model for vit (Val Acc: 45.00%)
2025-03-29 22:55:40,470 [INFO] -   efficientnet: Train Loss=0.1933, Train Acc=93.41%, Val Loss=0.1229, Val Acc=95.80%
2025-03-29 22:55:40,510 [INFO] -   New best model for efficientnet (Val Acc: 95.80%)
2025-03-29 22:55:40,520 [INFO] -   inception: Train Loss=0.3247, Train Acc=89.23%, Val Loss=0.2158, Val Acc=92.52%
2025-03-29 22:55:40,569 [INFO] -   New best model for inception (Val Acc: 92.52%)
2025-03-29 22:55:40,569 [INFO] -   mobilenet: Train Loss=0.1995, Train Acc=92.99%, Val Loss=0.1629, Val Acc=94.36%
2025-03-29 22:55:40,623 [INFO] -   New best model for mobilenet (Val Acc: 94.36%)
2025-03-29 22:55:40,623 [INFO] -   resnet: Train Loss=0.3880, Train Acc=86.69%, Val Loss=0.2759, Val Acc=90.14%
2025-03-29 22:55:40,664 [INFO] -   New best model for resnet (Val Acc: 90.14%)
2025-03-29 22:55:40,664 [INFO] -   densenet: Train Loss=0.2629, Train Acc=90.91%, Val Loss=0.1843, Val Acc=93.84%
2025-03-29 22:55:40,724 [INFO] -   New best model for densenet (Val Acc: 93.84%)
2025-03-29 22:55:40,726 [INFO] -   student: Train Loss=0.1933, Train Acc=93.30%, Val Loss=0.1198, Val Acc=95.64%
2025-03-29 22:55:40,778 [INFO] -   New best model for student (Val Acc: 95.64%)
2025-03-29 22:55:40,780 [INFO] - Initialization epoch 3 completed in 4981.56s
2025-03-29 22:55:40,780 [INFO] - Initialization Epoch 4/5
2025-03-29 22:55:41,119 [INFO] - GPU cache cleared: 2373.07MB → 2373.07MB (freed 0.00MB)
2025-03-29 22:55:46,301 [INFO] - GPU cache cleared: 2393.66MB → 2393.66MB (freed 0.00MB)
2025-03-29 22:59:39,002 [INFO] - GPU cache cleared: 2397.01MB → 2397.01MB (freed 0.00MB)
2025-03-29 23:04:11,091 [INFO] - GPU cache cleared: 2394.43MB → 2394.43MB (freed 0.00MB)
2025-03-29 23:08:29,794 [INFO] - GPU cache cleared: 2397.72MB → 2397.72MB (freed 0.00MB)
2025-03-29 23:13:21,235 [INFO] - GPU cache cleared: 2394.56MB → 2394.56MB (freed 0.00MB)
2025-03-29 23:17:26,104 [INFO] - GPU cache cleared: 2399.55MB → 2399.55MB (freed 0.00MB)
2025-03-29 23:21:46,248 [INFO] - GPU cache cleared: 2398.60MB → 2398.60MB (freed 0.00MB)
2025-03-29 23:25:48,277 [INFO] - GPU cache cleared: 2393.59MB → 2393.59MB (freed 0.00MB)
2025-03-29 23:30:15,770 [INFO] - GPU cache cleared: 2396.97MB → 2396.97MB (freed 0.00MB)
2025-03-29 23:34:17,626 [INFO] - GPU cache cleared: 2396.65MB → 2396.65MB (freed 0.00MB)
2025-03-29 23:38:49,077 [INFO] - GPU cache cleared: 2395.17MB → 2395.17MB (freed 0.00MB)
2025-03-29 23:42:58,912 [INFO] - GPU cache cleared: 2397.95MB → 2397.95MB (freed 0.00MB)
2025-03-29 23:48:00,940 [INFO] - GPU cache cleared: 2400.66MB → 2400.66MB (freed 0.00MB)
2025-03-29 23:52:26,400 [INFO] - GPU cache cleared: 2399.67MB → 2399.67MB (freed 0.00MB)
2025-03-29 23:57:25,459 [INFO] - GPU cache cleared: 2392.46MB → 2392.46MB (freed 0.00MB)
2025-03-30 00:01:32,973 [INFO] - GPU cache cleared: 2393.60MB → 2393.60MB (freed 0.00MB)
2025-03-30 00:06:37,170 [INFO] - GPU cache cleared: 2393.71MB → 2393.71MB (freed 0.00MB)
2025-03-30 00:11:21,657 [INFO] - GPU cache cleared: 2399.47MB → 2399.47MB (freed 0.00MB)
2025-03-30 00:16:09,400 [INFO] - GPU cache cleared: 2395.01MB → 2395.01MB (freed 0.00MB)
2025-03-30 00:20:29,082 [INFO] -   vit: Train Loss=1.3987, Train Acc=48.78%, Val Loss=1.4157, Val Acc=48.70%
2025-03-30 00:20:29,133 [INFO] -   New best model for vit (Val Acc: 48.70%)
2025-03-30 00:20:29,133 [INFO] -   efficientnet: Train Loss=0.1311, Train Acc=95.49%, Val Loss=0.0939, Val Acc=96.86%
2025-03-30 00:20:29,175 [INFO] -   New best model for efficientnet (Val Acc: 96.86%)
2025-03-30 00:20:29,182 [INFO] -   inception: Train Loss=0.2189, Train Acc=92.60%, Val Loss=0.1471, Val Acc=95.10%
2025-03-30 00:20:29,237 [INFO] -   New best model for inception (Val Acc: 95.10%)
2025-03-30 00:20:29,237 [INFO] -   mobilenet: Train Loss=0.1355, Train Acc=95.16%, Val Loss=0.1256, Val Acc=95.54%
2025-03-30 00:20:29,293 [INFO] -   New best model for mobilenet (Val Acc: 95.54%)
2025-03-30 00:20:29,293 [INFO] -   resnet: Train Loss=0.2743, Train Acc=90.71%, Val Loss=0.2135, Val Acc=92.88%
2025-03-30 00:20:29,345 [INFO] -   New best model for resnet (Val Acc: 92.88%)
2025-03-30 00:20:29,346 [INFO] -   densenet: Train Loss=0.1795, Train Acc=93.97%, Val Loss=0.1399, Val Acc=95.44%
2025-03-30 00:20:29,397 [INFO] -   New best model for densenet (Val Acc: 95.44%)
2025-03-30 00:20:29,407 [INFO] -   student: Train Loss=0.1330, Train Acc=95.52%, Val Loss=0.0921, Val Acc=96.68%
2025-03-30 00:20:29,459 [INFO] -   New best model for student (Val Acc: 96.68%)
2025-03-30 00:20:29,460 [INFO] - Initialization epoch 4 completed in 5088.68s
2025-03-30 00:20:29,461 [INFO] - Initialization Epoch 5/5
2025-03-30 00:20:29,766 [INFO] - GPU cache cleared: 2375.51MB → 2375.51MB (freed 0.00MB)
2025-03-30 00:20:35,148 [INFO] - GPU cache cleared: 2398.41MB → 2398.41MB (freed 0.00MB)
2025-03-30 00:25:20,863 [INFO] - GPU cache cleared: 2392.69MB → 2392.69MB (freed 0.00MB)
2025-03-30 00:30:12,069 [INFO] - GPU cache cleared: 2395.38MB → 2395.38MB (freed 0.00MB)
2025-03-30 00:34:35,492 [INFO] - GPU cache cleared: 2398.12MB → 2398.12MB (freed 0.00MB)
2025-03-30 00:39:06,355 [INFO] - GPU cache cleared: 2396.32MB → 2396.32MB (freed 0.00MB)
2025-03-30 00:43:02,209 [INFO] - GPU cache cleared: 2396.73MB → 2396.73MB (freed 0.00MB)
2025-03-30 00:47:35,698 [INFO] - GPU cache cleared: 2400.46MB → 2400.46MB (freed 0.00MB)
2025-03-30 00:51:42,434 [INFO] - GPU cache cleared: 2397.17MB → 2397.17MB (freed 0.00MB)
2025-03-30 00:55:55,852 [INFO] - GPU cache cleared: 2394.68MB → 2394.68MB (freed 0.00MB)
2025-03-30 01:00:03,406 [INFO] - GPU cache cleared: 2397.46MB → 2397.46MB (freed 0.00MB)
2025-03-30 01:04:42,033 [INFO] - GPU cache cleared: 2397.37MB → 2397.37MB (freed 0.00MB)
2025-03-30 01:08:28,987 [INFO] - GPU cache cleared: 2397.76MB → 2397.76MB (freed 0.00MB)
2025-03-30 01:12:11,733 [INFO] - GPU cache cleared: 2393.40MB → 2393.40MB (freed 0.00MB)
2025-03-30 01:15:50,002 [INFO] - GPU cache cleared: 2395.47MB → 2395.47MB (freed 0.00MB)
2025-03-30 01:20:03,197 [INFO] - GPU cache cleared: 2395.58MB → 2395.58MB (freed 0.00MB)
2025-03-30 01:23:52,099 [INFO] - GPU cache cleared: 2396.97MB → 2396.97MB (freed 0.00MB)
2025-03-30 01:28:09,763 [INFO] - GPU cache cleared: 2395.48MB → 2395.48MB (freed 0.00MB)
2025-03-30 01:32:07,294 [INFO] - GPU cache cleared: 2395.59MB → 2395.59MB (freed 0.00MB)
2025-03-30 01:36:43,158 [INFO] - GPU cache cleared: 2396.42MB → 2396.42MB (freed 0.00MB)
2025-03-30 01:42:13,914 [INFO] -   vit: Train Loss=1.2956, Train Acc=53.02%, Val Loss=1.3226, Val Acc=52.06%
2025-03-30 01:42:13,965 [INFO] -   New best model for vit (Val Acc: 52.06%)
2025-03-30 01:42:13,965 [INFO] -   efficientnet: Train Loss=0.0957, Train Acc=96.72%, Val Loss=0.0844, Val Acc=97.16%
2025-03-30 01:42:14,016 [INFO] -   New best model for efficientnet (Val Acc: 97.16%)
2025-03-30 01:42:14,017 [INFO] -   inception: Train Loss=0.1465, Train Acc=94.92%, Val Loss=0.1253, Val Acc=95.78%
2025-03-30 01:42:14,066 [INFO] -   New best model for inception (Val Acc: 95.78%)
2025-03-30 01:42:14,067 [INFO] -   mobilenet: Train Loss=0.0925, Train Acc=96.83%, Val Loss=0.1084, Val Acc=96.28%
2025-03-30 01:42:14,116 [INFO] -   New best model for mobilenet (Val Acc: 96.28%)
2025-03-30 01:42:14,116 [INFO] -   resnet: Train Loss=0.1884, Train Acc=93.44%, Val Loss=0.1622, Val Acc=94.40%
2025-03-30 01:42:14,169 [INFO] -   New best model for resnet (Val Acc: 94.40%)
2025-03-30 01:42:14,169 [INFO] -   densenet: Train Loss=0.1169, Train Acc=96.02%, Val Loss=0.1148, Val Acc=96.12%
2025-03-30 01:42:14,222 [INFO] -   New best model for densenet (Val Acc: 96.12%)
2025-03-30 01:42:14,223 [INFO] -   student: Train Loss=0.0951, Train Acc=96.80%, Val Loss=0.0900, Val Acc=96.68%
2025-03-30 01:42:14,223 [INFO] - Initialization epoch 5 completed in 4904.76s
2025-03-30 01:42:14,227 [ERROR] - Error loading best state for vit: invalid group reference 1 at position 10
2025-03-30 01:42:14,228 [ERROR] - Continuing with current model state for vit
2025-03-30 01:42:14,506 [INFO] - Saved current state for vit to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\vit_init_error_recovery.pth
2025-03-30 01:42:14,525 [INFO] - Restored best state for efficientnet with validation accuracy 97.16% (coverage: 100.0%)
2025-03-30 01:42:14,528 [ERROR] - Error loading best state for inception: invalid group reference 1 at position 10
2025-03-30 01:42:14,528 [ERROR] - Continuing with current model state for inception
2025-03-30 01:42:14,661 [INFO] - Saved current state for inception to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\inception_init_error_recovery.pth
2025-03-30 01:42:14,671 [ERROR] - Error loading best state for mobilenet: invalid group reference 1 at position 10
2025-03-30 01:42:14,671 [ERROR] - Continuing with current model state for mobilenet
2025-03-30 01:42:14,715 [INFO] - Saved current state for mobilenet to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mobilenet_init_error_recovery.pth
2025-03-30 01:42:14,715 [ERROR] - Error loading best state for resnet: invalid group reference 1 at position 10
2025-03-30 01:42:14,715 [ERROR] - Continuing with current model state for resnet
2025-03-30 01:42:14,835 [INFO] - Saved current state for resnet to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\resnet_init_error_recovery.pth
2025-03-30 01:42:14,841 [ERROR] - Error loading best state for densenet: invalid group reference 1 at position 10
2025-03-30 01:42:14,841 [ERROR] - Continuing with current model state for densenet
2025-03-30 01:42:14,944 [INFO] - Saved current state for densenet to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\densenet_init_error_recovery.pth
2025-03-30 01:42:14,945 [INFO] - Restored best state for student with validation accuracy 96.68% (coverage: 100.0%)
2025-03-30 01:42:14,945 [INFO] - Initialization phase completed
2025-03-30 01:42:14,954 [INFO] - Starting mutual learning phase...
2025-03-30 01:42:14,954 [INFO] - Hook registered for encoder.ln
2025-03-30 01:42:14,954 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-03-30 01:42:15,245 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-03-30 01:42:15,247 [INFO] - Hook registered for features.8
2025-03-30 01:42:15,248 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-03-30 01:42:15,546 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-03-30 01:42:15,548 [INFO] - Hook registered for inception.Mixed_7c
2025-03-30 01:42:15,548 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-03-30 01:42:15,820 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-03-30 01:42:15,822 [INFO] - Hook registered for features
2025-03-30 01:42:15,822 [INFO] - Feature extractor registered for mobilenet at layer features
2025-03-30 01:42:15,945 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-03-30 01:42:15,945 [INFO] - Hook registered for layer4
2025-03-30 01:42:15,952 [INFO] - Feature extractor registered for resnet at layer layer4
2025-03-30 01:42:16,117 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-03-30 01:42:16,117 [INFO] - Hook registered for features
2025-03-30 01:42:16,117 [INFO] - Feature extractor registered for densenet at layer features
2025-03-30 01:42:16,479 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-03-30 01:42:16,480 [INFO] - Hook registered for features.8
2025-03-30 01:42:16,480 [INFO] - Feature extractor registered for student at layer features.8
2025-03-30 01:42:16,501 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-03-30 01:42:16,503 [INFO] - Using learning rate 5e-05 for vit
2025-03-30 01:42:16,503 [INFO] - Using 16 gradient accumulation steps for ViT
2025-03-30 01:42:16,503 [INFO] - Using learning rate 0.001 for efficientnet
2025-03-30 01:42:16,503 [INFO] - Using learning rate 0.001 for inception
2025-03-30 01:42:16,507 [INFO] - Using learning rate 0.001 for mobilenet
2025-03-30 01:42:16,509 [INFO] - Using learning rate 0.001 for resnet
2025-03-30 01:42:16,510 [INFO] - Using learning rate 0.001 for densenet
2025-03-30 01:42:16,512 [INFO] - Using learning rate 0.001 for student
2025-03-30 01:42:16,514 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250330_014216_config.json
2025-03-30 01:42:16,515 [INFO] - Mutual Learning Epoch 1/50
2025-03-30 01:42:16,515 [INFO] - Mutual weight: 0.0400, Calibration weight: 0.0133
2025-03-30 01:42:16,522 [INFO] - Current temperatures: {'vit': 5.0, 'efficientnet': 5.0, 'inception': 6.0, 'mobilenet': 5.0, 'resnet': 5.0, 'densenet': 5.0, 'student': 4.0}
2025-03-30 01:42:16,681 [INFO] - GPU cache cleared: 1197.97MB → 1197.97MB (freed 0.00MB)
2025-03-30 01:42:19,506 [INFO] - GPU cache cleared: 1344.76MB → 1344.76MB (freed 0.00MB)
2025-03-30 01:44:40,436 [INFO] - GPU cache cleared: 2518.78MB → 2518.78MB (freed 0.00MB)
2025-03-30 01:50:36,939 [INFO] - GPU cache cleared: 2521.27MB → 2521.27MB (freed 0.00MB)
2025-03-30 01:57:01,839 [INFO] - GPU cache cleared: 2520.56MB → 2520.56MB (freed 0.00MB)
2025-03-30 02:02:47,868 [INFO] - GPU cache cleared: 2519.26MB → 2519.26MB (freed 0.00MB)
2025-03-30 02:09:01,623 [INFO] - GPU cache cleared: 2522.44MB → 2522.44MB (freed 0.00MB)
2025-03-30 02:14:26,208 [INFO] - GPU cache cleared: 2519.40MB → 2519.40MB (freed 0.00MB)
2025-03-30 02:20:07,017 [INFO] - GPU cache cleared: 2518.45MB → 2518.45MB (freed 0.00MB)
2025-03-30 02:25:22,638 [INFO] - GPU cache cleared: 2518.18MB → 2518.18MB (freed 0.00MB)
2025-03-30 02:30:52,901 [INFO] - GPU cache cleared: 2520.23MB → 2520.23MB (freed 0.00MB)
2025-03-30 02:36:32,668 [INFO] - GPU cache cleared: 2519.81MB → 2519.81MB (freed 0.00MB)
2025-03-30 02:41:12,593 [INFO] - GPU cache cleared: 2518.47MB → 2518.47MB (freed 0.00MB)
2025-03-30 02:46:54,896 [INFO] - GPU cache cleared: 2521.60MB → 2521.60MB (freed 0.00MB)
2025-03-30 02:53:08,893 [INFO] - GPU cache cleared: 2519.50MB → 2519.50MB (freed 0.00MB)
2025-03-30 02:58:35,687 [INFO] - GPU cache cleared: 2520.87MB → 2520.87MB (freed 0.00MB)
2025-03-30 03:03:17,914 [INFO] - GPU cache cleared: 2516.38MB → 2516.38MB (freed 0.00MB)
2025-03-30 03:08:29,112 [INFO] - GPU cache cleared: 2518.35MB → 2518.35MB (freed 0.00MB)
2025-03-30 03:13:43,518 [INFO] - GPU cache cleared: 2518.40MB → 2518.40MB (freed 0.00MB)
2025-03-30 03:19:35,107 [INFO] - GPU cache cleared: 2523.83MB → 2523.83MB (freed 0.00MB)
2025-03-30 03:24:54,176 [INFO] -   vit: Train Loss=1.4651, Train Acc=54.62%, Val Loss=1.3035, Val Acc=53.16%, ECE=0.0272
2025-03-30 03:24:54,180 [INFO] -   New best model for vit (Val Acc: 53.16%)
2025-03-30 03:24:54,791 [INFO] -   efficientnet: Train Loss=0.2562, Train Acc=94.08%, Val Loss=0.1279, Val Acc=95.70%, ECE=0.0072
2025-03-30 03:24:54,795 [INFO] -   New best model for efficientnet (Val Acc: 95.70%)
2025-03-30 03:24:54,915 [INFO] -   inception: Train Loss=0.5169, Train Acc=88.62%, Val Loss=0.2108, Val Acc=92.88%, ECE=0.0152
2025-03-30 03:24:54,919 [INFO] -   New best model for inception (Val Acc: 92.88%)
2025-03-30 03:24:55,144 [INFO] -   mobilenet: Train Loss=0.3822, Train Acc=93.78%, Val Loss=0.1617, Val Acc=94.50%, ECE=0.0039
2025-03-30 03:24:55,148 [INFO] -   New best model for mobilenet (Val Acc: 94.50%)
2025-03-30 03:24:55,256 [INFO] -   resnet: Train Loss=0.5521, Train Acc=87.11%, Val Loss=0.2531, Val Acc=91.14%, ECE=0.0132
2025-03-30 03:24:55,256 [INFO] -   New best model for resnet (Val Acc: 91.14%)
2025-03-30 03:24:55,493 [INFO] -   densenet: Train Loss=0.4669, Train Acc=90.83%, Val Loss=0.1781, Val Acc=94.02%, ECE=0.0101
2025-03-30 03:24:55,497 [INFO] -   New best model for densenet (Val Acc: 94.02%)
2025-03-30 03:24:55,674 [INFO] -   student: Train Loss=0.2287, Train Acc=94.02%, Val Loss=0.1295, Val Acc=95.70%, ECE=0.0134
2025-03-30 03:24:55,684 [INFO] -   New best model for student (Val Acc: 95.70%)
2025-03-30 03:24:55,812 [INFO] - Mutual learning epoch 1 completed in 6159.30s
2025-03-30 03:24:55,812 [INFO] - Mutual Learning Epoch 2/50
2025-03-30 03:24:55,812 [INFO] - Mutual weight: 0.0800, Calibration weight: 0.0267
2025-03-30 03:24:55,812 [INFO] - Current temperatures: {'vit': 4.997582912445068, 'efficientnet': 5.088164329528809, 'inception': 5.914714336395264, 'mobilenet': 5.055821895599365, 'resnet': 5.067295074462891, 'densenet': 5.076976776123047, 'student': 4.1001410484313965}
2025-03-30 03:24:56,027 [INFO] - GPU cache cleared: 2442.59MB → 2442.59MB (freed 0.00MB)
2025-03-30 03:25:01,157 [INFO] - GPU cache cleared: 2518.01MB → 2518.01MB (freed 0.00MB)
2025-03-30 03:31:10,291 [INFO] - GPU cache cleared: 2518.96MB → 2518.96MB (freed 0.00MB)
2025-03-30 03:38:31,495 [INFO] - GPU cache cleared: 2521.41MB → 2521.41MB (freed 0.00MB)
2025-03-30 03:44:44,670 [INFO] - GPU cache cleared: 2518.93MB → 2518.93MB (freed 0.00MB)
2025-03-30 03:51:07,205 [INFO] - GPU cache cleared: 2520.90MB → 2520.90MB (freed 0.00MB)
2025-03-30 03:56:18,257 [INFO] - GPU cache cleared: 2520.91MB → 2520.91MB (freed 0.00MB)
2025-03-30 04:02:45,046 [INFO] - GPU cache cleared: 2521.67MB → 2521.67MB (freed 0.00MB)
2025-03-30 04:08:09,791 [INFO] - GPU cache cleared: 2515.98MB → 2515.98MB (freed 0.00MB)
2025-03-30 04:14:22,410 [INFO] - GPU cache cleared: 2519.92MB → 2519.92MB (freed 0.00MB)
2025-03-30 04:20:37,045 [INFO] - GPU cache cleared: 2522.23MB → 2522.23MB (freed 0.00MB)
2025-03-30 04:26:22,993 [INFO] - GPU cache cleared: 2519.89MB → 2519.89MB (freed 0.00MB)
2025-03-30 04:31:46,076 [INFO] - GPU cache cleared: 2518.28MB → 2518.28MB (freed 0.00MB)
2025-03-30 04:38:19,723 [INFO] - GPU cache cleared: 2516.53MB → 2516.53MB (freed 0.00MB)
2025-03-30 04:44:18,370 [INFO] - GPU cache cleared: 2519.65MB → 2519.65MB (freed 0.00MB)
2025-03-30 04:50:21,531 [INFO] - GPU cache cleared: 2518.19MB → 2518.19MB (freed 0.00MB)
2025-03-30 04:56:34,491 [INFO] - GPU cache cleared: 2517.81MB → 2517.81MB (freed 0.00MB)
2025-03-30 05:02:36,870 [INFO] - GPU cache cleared: 2522.07MB → 2522.07MB (freed 0.00MB)
2025-03-30 05:08:44,337 [INFO] - GPU cache cleared: 2518.76MB → 2518.76MB (freed 0.00MB)
2025-03-30 05:15:55,230 [INFO] - GPU cache cleared: 2518.11MB → 2518.11MB (freed 0.00MB)
2025-03-30 05:23:18,445 [INFO] -   vit: Train Loss=1.4371, Train Acc=55.38%, Val Loss=1.2949, Val Acc=53.98%, ECE=0.0328
2025-03-30 05:23:18,451 [INFO] -   New best model for vit (Val Acc: 53.98%)
2025-03-30 05:23:19,156 [INFO] -   efficientnet: Train Loss=0.2395, Train Acc=95.04%, Val Loss=0.1318, Val Acc=95.24%, ECE=0.0102
2025-03-30 05:23:19,156 [INFO] -   inception: Train Loss=0.4505, Train Acc=90.73%, Val Loss=0.1964, Val Acc=93.20%, ECE=0.0111
2025-03-30 05:23:19,166 [INFO] -   New best model for inception (Val Acc: 93.20%)
2025-03-30 05:23:19,420 [INFO] -   mobilenet: Train Loss=0.3310, Train Acc=95.01%, Val Loss=0.1405, Val Acc=95.12%, ECE=0.0082
2025-03-30 05:23:19,424 [INFO] -   New best model for mobilenet (Val Acc: 95.12%)
2025-03-30 05:23:20,139 [INFO] -   resnet: Train Loss=0.4707, Train Acc=89.35%, Val Loss=0.2617, Val Acc=91.12%, ECE=0.0064
2025-03-30 05:23:20,148 [INFO] -   densenet: Train Loss=0.4041, Train Acc=92.56%, Val Loss=0.1889, Val Acc=93.48%, ECE=0.0076
2025-03-30 05:23:20,148 [INFO] -   student: Train Loss=0.2124, Train Acc=95.14%, Val Loss=0.1308, Val Acc=96.06%, ECE=0.0172
2025-03-30 05:23:20,155 [INFO] -   New best model for student (Val Acc: 96.06%)
2025-03-30 05:23:20,281 [INFO] - Mutual learning epoch 2 completed in 7104.47s
2025-03-30 05:23:20,281 [INFO] - Mutual Learning Epoch 3/50
2025-03-30 05:23:20,281 [INFO] - Mutual weight: 0.1200, Calibration weight: 0.0400
2025-03-30 05:23:20,281 [INFO] - Current temperatures: {'vit': 4.994599342346191, 'efficientnet': 5.195853233337402, 'inception': 5.817821502685547, 'mobilenet': 5.150443077087402, 'resnet': 5.181661128997803, 'densenet': 5.174471855163574, 'student': 4.224142074584961}
2025-03-30 05:23:20,560 [INFO] - GPU cache cleared: 2444.28MB → 2444.28MB (freed 0.00MB)
2025-03-30 05:23:27,186 [INFO] - GPU cache cleared: 2518.22MB → 2518.22MB (freed 0.00MB)
2025-03-30 05:30:15,538 [INFO] - GPU cache cleared: 2522.21MB → 2522.21MB (freed 0.00MB)
2025-03-30 05:37:28,469 [INFO] - GPU cache cleared: 2520.53MB → 2520.53MB (freed 0.00MB)
2025-03-30 05:43:22,664 [INFO] - GPU cache cleared: 2522.72MB → 2522.72MB (freed 0.00MB)
2025-03-30 05:50:34,486 [INFO] - GPU cache cleared: 2520.71MB → 2520.71MB (freed 0.00MB)
2025-03-30 05:56:07,151 [INFO] - GPU cache cleared: 2521.98MB → 2521.98MB (freed 0.00MB)
2025-03-30 06:02:52,342 [INFO] - GPU cache cleared: 2521.22MB → 2521.22MB (freed 0.00MB)
2025-03-30 06:08:28,366 [INFO] - GPU cache cleared: 2519.69MB → 2519.69MB (freed 0.00MB)
2025-03-30 06:15:23,836 [INFO] - GPU cache cleared: 2516.79MB → 2516.79MB (freed 0.00MB)
2025-03-30 06:21:27,696 [INFO] - GPU cache cleared: 2523.78MB → 2523.78MB (freed 0.00MB)
2025-03-30 06:27:50,455 [INFO] - GPU cache cleared: 2517.95MB → 2517.95MB (freed 0.00MB)
2025-03-30 06:34:17,896 [INFO] - GPU cache cleared: 2518.29MB → 2518.29MB (freed 0.00MB)
2025-03-30 06:39:54,406 [INFO] - GPU cache cleared: 2521.29MB → 2521.29MB (freed 0.00MB)
2025-03-30 06:45:12,970 [INFO] - GPU cache cleared: 2519.03MB → 2519.03MB (freed 0.00MB)
2025-03-30 06:50:42,568 [INFO] - GPU cache cleared: 2518.52MB → 2518.52MB (freed 0.00MB)
2025-03-30 06:56:31,985 [INFO] - GPU cache cleared: 2517.86MB → 2517.86MB (freed 0.00MB)
2025-03-30 07:01:46,527 [INFO] - GPU cache cleared: 2519.39MB → 2519.39MB (freed 0.00MB)
2025-03-30 07:07:20,077 [INFO] - GPU cache cleared: 2520.04MB → 2520.04MB (freed 0.00MB)
2025-03-30 07:13:18,452 [INFO] - GPU cache cleared: 2519.66MB → 2519.66MB (freed 0.00MB)
2025-03-30 07:18:48,249 [INFO] -   vit: Train Loss=1.4134, Train Acc=55.80%, Val Loss=1.2851, Val Acc=53.40%, ECE=0.0254
2025-03-30 07:18:48,250 [INFO] -   efficientnet: Train Loss=0.2255, Train Acc=95.96%, Val Loss=0.1096, Val Acc=96.42%, ECE=0.0161
2025-03-30 07:18:48,256 [INFO] -   New best model for efficientnet (Val Acc: 96.42%)
2025-03-30 07:18:48,413 [INFO] -   inception: Train Loss=0.4087, Train Acc=92.01%, Val Loss=0.1758, Val Acc=94.40%, ECE=0.0111
2025-03-30 07:18:48,417 [INFO] -   New best model for inception (Val Acc: 94.40%)
2025-03-30 07:18:48,685 [INFO] -   mobilenet: Train Loss=0.3020, Train Acc=96.24%, Val Loss=0.1383, Val Acc=95.58%, ECE=0.0140
2025-03-30 07:18:48,685 [INFO] -   New best model for mobilenet (Val Acc: 95.58%)
2025-03-30 07:18:48,803 [INFO] -   resnet: Train Loss=0.4317, Train Acc=90.54%, Val Loss=0.2407, Val Acc=91.58%, ECE=0.0112
2025-03-30 07:18:48,803 [INFO] -   New best model for resnet (Val Acc: 91.58%)
2025-03-30 07:18:49,043 [INFO] -   densenet: Train Loss=0.3736, Train Acc=93.54%, Val Loss=0.1605, Val Acc=94.94%, ECE=0.0147
2025-03-30 07:18:49,053 [INFO] -   New best model for densenet (Val Acc: 94.94%)
2025-03-30 07:18:49,217 [INFO] -   student: Train Loss=0.2024, Train Acc=95.92%, Val Loss=0.1260, Val Acc=96.38%, ECE=0.0284
2025-03-30 07:18:49,226 [INFO] -   New best model for student (Val Acc: 96.38%)
2025-03-30 07:18:49,343 [INFO] - Mutual learning epoch 3 completed in 6929.06s
2025-03-30 07:18:49,343 [INFO] - Mutual Learning Epoch 4/50
2025-03-30 07:18:49,343 [INFO] - Mutual weight: 0.1600, Calibration weight: 0.0533
2025-03-30 07:18:49,343 [INFO] - Current temperatures: {'vit': 4.991476535797119, 'efficientnet': 5.302482604980469, 'inception': 5.739878177642822, 'mobilenet': 5.254741668701172, 'resnet': 5.283935546875, 'densenet': 5.271505832672119, 'student': 4.349889755249023}
2025-03-30 07:18:49,597 [INFO] - GPU cache cleared: 2440.38MB → 2440.38MB (freed 0.00MB)
2025-03-30 07:18:55,161 [INFO] - GPU cache cleared: 2517.83MB → 2517.83MB (freed 0.00MB)
2025-03-30 07:24:16,455 [INFO] - GPU cache cleared: 2519.00MB → 2519.00MB (freed 0.00MB)
2025-03-30 07:30:14,789 [INFO] - GPU cache cleared: 2519.74MB → 2519.74MB (freed 0.00MB)
2025-03-30 07:35:38,475 [INFO] - GPU cache cleared: 2521.50MB → 2521.50MB (freed 0.00MB)
2025-03-30 07:41:49,734 [INFO] - GPU cache cleared: 2519.83MB → 2519.83MB (freed 0.00MB)
2025-03-30 07:47:16,068 [INFO] - GPU cache cleared: 2521.51MB → 2521.51MB (freed 0.00MB)
2025-03-30 07:53:51,586 [INFO] - GPU cache cleared: 2520.96MB → 2520.96MB (freed 0.00MB)
2025-03-30 08:00:01,567 [INFO] - GPU cache cleared: 2521.63MB → 2521.63MB (freed 0.00MB)
2025-03-30 08:05:29,382 [INFO] - GPU cache cleared: 2519.60MB → 2519.60MB (freed 0.00MB)
2025-03-30 08:10:07,308 [INFO] - GPU cache cleared: 2517.50MB → 2517.50MB (freed 0.00MB)
2025-03-30 08:16:21,729 [INFO] - GPU cache cleared: 2518.55MB → 2518.55MB (freed 0.00MB)
2025-03-30 08:22:07,380 [INFO] - GPU cache cleared: 2520.73MB → 2520.73MB (freed 0.00MB)
2025-03-30 08:28:10,298 [INFO] - GPU cache cleared: 2517.16MB → 2517.16MB (freed 0.00MB)
2025-03-30 08:34:12,546 [INFO] - GPU cache cleared: 2516.33MB → 2516.33MB (freed 0.00MB)
2025-03-30 08:40:44,136 [INFO] - GPU cache cleared: 2520.67MB → 2520.67MB (freed 0.00MB)
2025-03-30 08:47:01,341 [INFO] - GPU cache cleared: 2520.73MB → 2520.73MB (freed 0.00MB)
2025-03-30 08:53:00,692 [INFO] - GPU cache cleared: 2522.60MB → 2522.60MB (freed 0.00MB)
2025-03-30 08:58:32,903 [INFO] - GPU cache cleared: 2521.52MB → 2521.52MB (freed 0.00MB)
2025-03-30 09:03:56,664 [INFO] - GPU cache cleared: 2519.59MB → 2519.59MB (freed 0.00MB)
2025-03-30 09:12:36,416 [INFO] -   vit: Train Loss=1.3777, Train Acc=56.03%, Val Loss=1.2689, Val Acc=54.28%, ECE=0.0268
2025-03-30 09:12:36,421 [INFO] -   New best model for vit (Val Acc: 54.28%)
2025-03-30 09:12:37,210 [INFO] -   efficientnet: Train Loss=0.2178, Train Acc=96.45%, Val Loss=0.1131, Val Acc=96.64%, ECE=0.0191
2025-03-30 09:12:37,212 [INFO] -   New best model for efficientnet (Val Acc: 96.64%)
2025-03-30 09:12:37,334 [INFO] -   inception: Train Loss=0.3738, Train Acc=93.09%, Val Loss=0.1806, Val Acc=93.92%, ECE=0.0171
2025-03-30 09:12:37,335 [INFO] -   mobilenet: Train Loss=0.2880, Train Acc=96.46%, Val Loss=0.1453, Val Acc=95.78%, ECE=0.0241
2025-03-30 09:12:37,338 [INFO] -   New best model for mobilenet (Val Acc: 95.78%)
2025-03-30 09:12:37,450 [INFO] -   resnet: Train Loss=0.4030, Train Acc=91.45%, Val Loss=0.2036, Val Acc=93.58%, ECE=0.0199
2025-03-30 09:12:37,453 [INFO] -   New best model for resnet (Val Acc: 93.58%)
2025-03-30 09:12:37,669 [INFO] -   densenet: Train Loss=0.3482, Train Acc=94.14%, Val Loss=0.1558, Val Acc=94.98%, ECE=0.0216
2025-03-30 09:12:37,680 [INFO] -   New best model for densenet (Val Acc: 94.98%)
2025-03-30 09:12:37,842 [INFO] -   student: Train Loss=0.1961, Train Acc=96.43%, Val Loss=0.1324, Val Acc=96.36%, ECE=0.0307
2025-03-30 09:12:37,842 [INFO] - Mutual learning epoch 4 completed in 6828.50s
2025-03-30 09:12:37,842 [INFO] - Mutual Learning Epoch 5/50
2025-03-30 09:12:37,842 [INFO] - Mutual weight: 0.2000, Calibration weight: 0.0667
2025-03-30 09:12:37,842 [INFO] - Current temperatures: {'vit': 4.98836088180542, 'efficientnet': 5.403698921203613, 'inception': 5.682631492614746, 'mobilenet': 5.355216026306152, 'resnet': 5.3742594718933105, 'densenet': 5.369604110717773, 'student': 4.4726080894470215}
2025-03-30 09:12:38,132 [INFO] - GPU cache cleared: 2443.90MB → 2443.90MB (freed 0.00MB)
2025-03-30 09:12:44,886 [INFO] - GPU cache cleared: 2518.11MB → 2518.11MB (freed 0.00MB)
2025-03-30 09:19:18,367 [INFO] - GPU cache cleared: 2520.62MB → 2520.62MB (freed 0.00MB)
2025-03-30 09:25:44,819 [INFO] - GPU cache cleared: 2520.28MB → 2520.28MB (freed 0.00MB)
2025-03-30 09:31:37,228 [INFO] - GPU cache cleared: 2517.52MB → 2517.52MB (freed 0.00MB)
2025-03-30 09:37:56,068 [INFO] - GPU cache cleared: 2519.93MB → 2519.93MB (freed 0.00MB)
2025-03-30 09:43:46,537 [INFO] - GPU cache cleared: 2519.30MB → 2519.30MB (freed 0.00MB)
2025-03-30 09:49:59,646 [INFO] - GPU cache cleared: 2515.98MB → 2515.98MB (freed 0.00MB)
2025-03-30 09:55:31,336 [INFO] - GPU cache cleared: 2515.88MB → 2515.88MB (freed 0.00MB)
2025-03-30 10:01:33,515 [INFO] - GPU cache cleared: 2517.05MB → 2517.05MB (freed 0.00MB)
2025-03-30 10:06:38,198 [INFO] - GPU cache cleared: 2518.85MB → 2518.85MB (freed 0.00MB)
2025-03-30 10:13:34,794 [INFO] - GPU cache cleared: 2517.51MB → 2517.51MB (freed 0.00MB)
2025-03-30 10:19:47,428 [INFO] - GPU cache cleared: 2521.50MB → 2521.50MB (freed 0.00MB)
2025-03-30 10:26:08,327 [INFO] - GPU cache cleared: 2521.12MB → 2521.12MB (freed 0.00MB)
2025-03-30 10:32:17,936 [INFO] - GPU cache cleared: 2519.85MB → 2519.85MB (freed 0.00MB)
2025-03-30 10:38:34,982 [INFO] - GPU cache cleared: 2517.26MB → 2517.26MB (freed 0.00MB)
2025-03-30 10:44:54,949 [INFO] - GPU cache cleared: 2518.71MB → 2518.71MB (freed 0.00MB)
2025-03-30 10:53:25,552 [INFO] - GPU cache cleared: 2522.08MB → 2522.08MB (freed 0.00MB)
2025-03-30 11:01:49,800 [INFO] - GPU cache cleared: 2519.39MB → 2519.39MB (freed 0.00MB)
2025-03-30 11:10:09,005 [INFO] - GPU cache cleared: 2521.62MB → 2521.62MB (freed 0.00MB)
2025-03-30 11:18:27,974 [INFO] -   vit: Train Loss=1.3338, Train Acc=56.52%, Val Loss=1.2573, Val Acc=54.82%, ECE=0.0187
2025-03-30 11:18:27,988 [INFO] -   New best model for vit (Val Acc: 54.82%)
2025-03-30 11:18:28,757 [INFO] -   efficientnet: Train Loss=0.2121, Train Acc=96.94%, Val Loss=0.1126, Val Acc=96.36%, ECE=0.0178
2025-03-30 11:18:28,759 [INFO] -   inception: Train Loss=0.3483, Train Acc=93.76%, Val Loss=0.1677, Val Acc=94.96%, ECE=0.0192
2025-03-30 11:18:28,765 [INFO] -   New best model for inception (Val Acc: 94.96%)
2025-03-30 11:18:29,053 [INFO] -   mobilenet: Train Loss=0.2750, Train Acc=96.85%, Val Loss=0.1482, Val Acc=95.48%, ECE=0.0224
2025-03-30 11:18:29,054 [INFO] -   resnet: Train Loss=0.3771, Train Acc=92.18%, Val Loss=0.2165, Val Acc=93.00%, ECE=0.0200
2025-03-30 11:18:29,057 [INFO] -   densenet: Train Loss=0.3313, Train Acc=94.70%, Val Loss=0.1606, Val Acc=95.18%, ECE=0.0235
2025-03-30 11:18:29,063 [INFO] -   New best model for densenet (Val Acc: 95.18%)
2025-03-30 11:18:29,226 [INFO] -   student: Train Loss=0.1911, Train Acc=96.85%, Val Loss=0.1254, Val Acc=96.66%, ECE=0.0308
2025-03-30 11:18:29,230 [INFO] -   New best model for student (Val Acc: 96.66%)
2025-03-30 11:18:29,342 [INFO] - Mutual learning epoch 5 completed in 7551.50s
2025-03-30 11:18:29,343 [INFO] - Mutual Learning Epoch 6/50
2025-03-30 11:18:29,343 [INFO] - Mutual weight: 0.2400, Calibration weight: 0.0800
2025-03-30 11:18:29,345 [INFO] - Current temperatures: {'vit': 4.985304832458496, 'efficientnet': 5.497673988342285, 'inception': 5.650471210479736, 'mobilenet': 5.451262950897217, 'resnet': 5.456006050109863, 'densenet': 5.46004581451416, 'student': 4.590257167816162}
2025-03-30 11:18:29,642 [INFO] - GPU cache cleared: 2443.41MB → 2443.41MB (freed 0.00MB)
2025-03-30 11:18:37,412 [INFO] - GPU cache cleared: 2518.78MB → 2518.78MB (freed 0.00MB)
2025-03-30 11:24:54,623 [INFO] - GPU cache cleared: 2520.93MB → 2520.93MB (freed 0.00MB)
2025-03-30 11:32:30,674 [INFO] - GPU cache cleared: 2524.64MB → 2524.64MB (freed 0.00MB)
2025-03-30 11:39:12,937 [INFO] - GPU cache cleared: 2524.59MB → 2524.59MB (freed 0.00MB)
2025-03-30 11:45:17,641 [INFO] - GPU cache cleared: 2517.62MB → 2517.62MB (freed 0.00MB)
2025-03-30 11:50:58,861 [INFO] - GPU cache cleared: 2520.44MB → 2520.44MB (freed 0.00MB)
2025-03-30 11:56:49,342 [INFO] - GPU cache cleared: 2522.32MB → 2522.32MB (freed 0.00MB)
2025-03-30 12:01:57,800 [INFO] - GPU cache cleared: 2522.26MB → 2522.26MB (freed 0.00MB)
2025-03-30 12:08:05,093 [INFO] - GPU cache cleared: 2519.41MB → 2519.41MB (freed 0.00MB)
2025-03-30 12:14:00,585 [INFO] - GPU cache cleared: 2520.36MB → 2520.36MB (freed 0.00MB)
2025-03-30 12:20:24,145 [INFO] - GPU cache cleared: 2520.94MB → 2520.94MB (freed 0.00MB)
2025-03-30 12:27:25,231 [INFO] - GPU cache cleared: 2517.48MB → 2517.48MB (freed 0.00MB)
2025-03-30 12:34:26,113 [INFO] - GPU cache cleared: 2520.12MB → 2520.12MB (freed 0.00MB)
2025-03-30 12:41:25,409 [INFO] - GPU cache cleared: 2517.55MB → 2517.55MB (freed 0.00MB)
2025-03-30 12:48:05,429 [INFO] - GPU cache cleared: 2520.09MB → 2520.09MB (freed 0.00MB)
2025-03-30 12:54:22,406 [INFO] - GPU cache cleared: 2519.61MB → 2519.61MB (freed 0.00MB)
2025-03-30 13:01:19,333 [INFO] - GPU cache cleared: 2519.30MB → 2519.30MB (freed 0.00MB)
2025-03-30 13:07:30,417 [INFO] - GPU cache cleared: 2522.30MB → 2522.30MB (freed 0.00MB)
2025-03-30 13:14:11,410 [INFO] - GPU cache cleared: 2517.96MB → 2517.96MB (freed 0.00MB)
2025-03-30 13:21:50,211 [INFO] -   vit: Train Loss=1.2889, Train Acc=56.70%, Val Loss=1.2583, Val Acc=54.56%, ECE=0.0203
2025-03-30 13:21:50,213 [INFO] -   efficientnet: Train Loss=0.2096, Train Acc=97.08%, Val Loss=0.1093, Val Acc=96.74%, ECE=0.0182
2025-03-30 13:21:50,219 [INFO] -   New best model for efficientnet (Val Acc: 96.74%)
2025-03-30 13:21:50,356 [INFO] -   inception: Train Loss=0.3272, Train Acc=94.46%, Val Loss=0.1775, Val Acc=94.76%, ECE=0.0215
2025-03-30 13:21:50,359 [INFO] -   mobilenet: Train Loss=0.2604, Train Acc=97.39%, Val Loss=0.1463, Val Acc=95.32%, ECE=0.0220
2025-03-30 13:21:50,363 [INFO] -   resnet: Train Loss=0.3539, Train Acc=92.86%, Val Loss=0.2004, Val Acc=93.64%, ECE=0.0171
2025-03-30 13:21:50,375 [INFO] -   New best model for resnet (Val Acc: 93.64%)
2025-03-30 13:21:50,637 [INFO] -   densenet: Train Loss=0.3133, Train Acc=95.20%, Val Loss=0.1633, Val Acc=95.12%, ECE=0.0217
2025-03-30 13:21:50,637 [INFO] -   student: Train Loss=0.1900, Train Acc=97.11%, Val Loss=0.1482, Val Acc=95.98%, ECE=0.0269
2025-03-30 13:21:50,645 [INFO] - Mutual learning epoch 6 completed in 7401.29s
2025-03-30 13:21:50,645 [INFO] - Mutual Learning Epoch 7/50
2025-03-30 13:21:50,646 [INFO] - Mutual weight: 0.2800, Calibration weight: 0.0933
2025-03-30 13:21:50,647 [INFO] - Current temperatures: {'vit': 4.982351779937744, 'efficientnet': 5.585743427276611, 'inception': 5.645108699798584, 'mobilenet': 5.541408538818359, 'resnet': 5.525513648986816, 'densenet': 5.543480396270752, 'student': 4.703547954559326}
2025-03-30 13:21:50,915 [INFO] - GPU cache cleared: 2445.79MB → 2445.79MB (freed 0.00MB)
2025-03-30 13:21:57,287 [INFO] - GPU cache cleared: 2518.68MB → 2518.68MB (freed 0.00MB)
2025-03-30 13:28:31,287 [INFO] - GPU cache cleared: 2520.01MB → 2520.01MB (freed 0.00MB)
2025-03-30 13:35:13,563 [INFO] - GPU cache cleared: 2518.70MB → 2518.70MB (freed 0.00MB)
2025-03-30 13:41:41,688 [INFO] - GPU cache cleared: 2520.49MB → 2520.49MB (freed 0.00MB)
2025-03-30 13:48:13,853 [INFO] - GPU cache cleared: 2517.48MB → 2517.48MB (freed 0.00MB)
2025-03-30 13:54:30,015 [INFO] - GPU cache cleared: 2519.19MB → 2519.19MB (freed 0.00MB)
2025-03-30 14:02:50,383 [INFO] - GPU cache cleared: 2517.41MB → 2517.41MB (freed 0.00MB)
2025-03-30 14:11:38,191 [INFO] - GPU cache cleared: 2520.46MB → 2520.46MB (freed 0.00MB)
2025-03-30 14:19:57,230 [INFO] - GPU cache cleared: 2519.36MB → 2519.36MB (freed 0.00MB)
2025-03-30 14:27:22,960 [INFO] - GPU cache cleared: 2518.11MB → 2518.11MB (freed 0.00MB)
2025-03-30 14:34:22,930 [INFO] - GPU cache cleared: 2520.13MB → 2520.13MB (freed 0.00MB)
2025-03-30 14:40:32,572 [INFO] - GPU cache cleared: 2520.20MB → 2520.20MB (freed 0.00MB)
2025-03-30 14:45:42,538 [INFO] - GPU cache cleared: 2521.01MB → 2521.01MB (freed 0.00MB)
2025-03-30 14:51:38,330 [INFO] - GPU cache cleared: 2519.66MB → 2519.66MB (freed 0.00MB)
2025-03-30 14:58:44,144 [INFO] - GPU cache cleared: 2522.26MB → 2522.26MB (freed 0.00MB)
2025-03-30 15:05:22,985 [INFO] - GPU cache cleared: 2520.20MB → 2520.20MB (freed 0.00MB)
2025-03-30 15:11:16,882 [INFO] - GPU cache cleared: 2521.31MB → 2521.31MB (freed 0.00MB)
2025-03-30 15:17:29,521 [INFO] - GPU cache cleared: 2519.20MB → 2519.20MB (freed 0.00MB)
2025-03-30 15:23:05,686 [INFO] - GPU cache cleared: 2517.32MB → 2517.32MB (freed 0.00MB)
2025-03-30 15:29:13,510 [INFO] -   vit: Train Loss=1.2396, Train Acc=57.37%, Val Loss=1.2475, Val Acc=54.78%, ECE=0.0232
2025-03-30 15:29:13,511 [INFO] -   efficientnet: Train Loss=0.2019, Train Acc=97.45%, Val Loss=0.1169, Val Acc=96.80%, ECE=0.0199
2025-03-30 15:29:13,518 [INFO] -   New best model for efficientnet (Val Acc: 96.80%)
2025-03-30 15:29:13,656 [INFO] -   inception: Train Loss=0.3068, Train Acc=94.90%, Val Loss=0.1855, Val Acc=94.76%, ECE=0.0218
2025-03-30 15:29:13,656 [INFO] -   mobilenet: Train Loss=0.2532, Train Acc=97.52%, Val Loss=0.1373, Val Acc=96.14%, ECE=0.0252
2025-03-30 15:29:13,664 [INFO] -   New best model for mobilenet (Val Acc: 96.14%)
2025-03-30 15:29:13,779 [INFO] -   resnet: Train Loss=0.3358, Train Acc=93.34%, Val Loss=0.2136, Val Acc=93.26%, ECE=0.0199
2025-03-30 15:29:13,779 [INFO] -   densenet: Train Loss=0.3002, Train Acc=95.55%, Val Loss=0.1720, Val Acc=94.68%, ECE=0.0263
2025-03-30 15:29:13,779 [INFO] -   student: Train Loss=0.1844, Train Acc=97.44%, Val Loss=0.1378, Val Acc=96.56%, ECE=0.0393
2025-03-30 15:29:13,779 [INFO] - Mutual learning epoch 7 completed in 7643.13s
2025-03-30 15:29:13,788 [INFO] - Mutual Learning Epoch 8/50
2025-03-30 15:29:13,788 [INFO] - Mutual weight: 0.3200, Calibration weight: 0.1067
2025-03-30 15:29:13,790 [INFO] - Current temperatures: {'vit': 4.979499816894531, 'efficientnet': 5.670443534851074, 'inception': 5.666605472564697, 'mobilenet': 5.6233015060424805, 'resnet': 5.595459461212158, 'densenet': 5.619895935058594, 'student': 4.810659885406494}
2025-03-30 15:29:14,064 [INFO] - GPU cache cleared: 2445.06MB → 2445.06MB (freed 0.00MB)
2025-03-30 15:29:19,998 [INFO] - GPU cache cleared: 2515.76MB → 2515.76MB (freed 0.00MB)
2025-03-30 15:35:05,909 [INFO] - GPU cache cleared: 2520.50MB → 2520.50MB (freed 0.00MB)
2025-03-30 15:40:51,793 [INFO] - GPU cache cleared: 2519.65MB → 2519.65MB (freed 0.00MB)
2025-03-30 15:47:00,789 [INFO] - GPU cache cleared: 2519.03MB → 2519.03MB (freed 0.00MB)
2025-03-30 15:53:54,717 [INFO] - GPU cache cleared: 2520.67MB → 2520.67MB (freed 0.00MB)
2025-03-30 16:00:39,292 [INFO] - GPU cache cleared: 2521.53MB → 2521.53MB (freed 0.00MB)
2025-03-30 16:07:50,238 [INFO] - GPU cache cleared: 2521.05MB → 2521.05MB (freed 0.00MB)
2025-03-30 16:13:48,691 [INFO] - GPU cache cleared: 2516.32MB → 2516.32MB (freed 0.00MB)
2025-03-30 16:20:13,978 [INFO] - GPU cache cleared: 2518.15MB → 2518.15MB (freed 0.00MB)
2025-03-30 16:27:02,379 [INFO] - GPU cache cleared: 2519.85MB → 2519.85MB (freed 0.00MB)
2025-03-30 16:32:34,219 [INFO] - GPU cache cleared: 2519.86MB → 2519.86MB (freed 0.00MB)
2025-03-30 16:38:26,516 [INFO] - GPU cache cleared: 2519.66MB → 2519.66MB (freed 0.00MB)
2025-03-30 16:45:02,187 [INFO] - GPU cache cleared: 2518.77MB → 2518.77MB (freed 0.00MB)
2025-03-30 16:50:18,186 [INFO] - GPU cache cleared: 2521.29MB → 2521.29MB (freed 0.00MB)
2025-03-30 16:56:56,103 [INFO] - GPU cache cleared: 2517.70MB → 2517.70MB (freed 0.00MB)
2025-03-30 17:02:43,309 [INFO] - GPU cache cleared: 2515.65MB → 2515.65MB (freed 0.00MB)
2025-03-30 17:09:35,383 [INFO] - GPU cache cleared: 2524.84MB → 2524.84MB (freed 0.00MB)
2025-03-30 17:15:49,917 [INFO] - GPU cache cleared: 2518.20MB → 2518.20MB (freed 0.00MB)
2025-03-30 17:21:58,965 [INFO] - GPU cache cleared: 2519.04MB → 2519.04MB (freed 0.00MB)
2025-03-30 17:29:01,288 [INFO] -   vit: Train Loss=1.1939, Train Acc=57.72%, Val Loss=1.2372, Val Acc=55.02%, ECE=0.0224
2025-03-30 17:29:01,294 [INFO] -   New best model for vit (Val Acc: 55.02%)
2025-03-30 17:29:01,927 [INFO] -   efficientnet: Train Loss=0.1931, Train Acc=97.90%, Val Loss=0.1222, Val Acc=96.62%, ECE=0.0214
2025-03-30 17:29:01,928 [INFO] -   inception: Train Loss=0.2927, Train Acc=95.50%, Val Loss=0.1842, Val Acc=94.58%, ECE=0.0227
2025-03-30 17:29:01,931 [INFO] -   mobilenet: Train Loss=0.2455, Train Acc=97.69%, Val Loss=0.1487, Val Acc=95.80%, ECE=0.0276
2025-03-30 17:29:01,934 [INFO] -   resnet: Train Loss=0.3217, Train Acc=93.73%, Val Loss=0.2035, Val Acc=93.72%, ECE=0.0275
2025-03-30 17:29:01,934 [INFO] -   New best model for resnet (Val Acc: 93.72%)
2025-03-30 17:29:02,205 [INFO] -   densenet: Train Loss=0.2853, Train Acc=96.02%, Val Loss=0.1567, Val Acc=95.80%, ECE=0.0292
2025-03-30 17:29:02,205 [INFO] -   New best model for densenet (Val Acc: 95.80%)
2025-03-30 17:29:02,379 [INFO] -   student: Train Loss=0.1828, Train Acc=97.58%, Val Loss=0.1430, Val Acc=96.56%, ECE=0.0414
2025-03-30 17:29:02,379 [INFO] - Mutual learning epoch 8 completed in 7188.59s
2025-03-30 17:29:02,379 [INFO] - Mutual Learning Epoch 9/50
2025-03-30 17:29:02,390 [INFO] - Mutual weight: 0.3600, Calibration weight: 0.1200
2025-03-30 17:29:02,392 [INFO] - Current temperatures: {'vit': 4.976749420166016, 'efficientnet': 5.7552103996276855, 'inception': 5.702966213226318, 'mobilenet': 5.702963352203369, 'resnet': 5.65960168838501, 'densenet': 5.6949143409729, 'student': 4.912437438964844}
2025-03-30 17:29:02,674 [INFO] - GPU cache cleared: 2445.46MB → 2445.46MB (freed 0.00MB)
2025-03-30 17:29:08,379 [INFO] - GPU cache cleared: 2519.45MB → 2519.45MB (freed 0.00MB)
2025-03-30 17:34:19,917 [INFO] - GPU cache cleared: 2521.24MB → 2521.24MB (freed 0.00MB)
2025-03-30 17:41:22,683 [INFO] - GPU cache cleared: 2517.55MB → 2517.55MB (freed 0.00MB)
2025-03-30 17:46:49,948 [INFO] - GPU cache cleared: 2519.94MB → 2519.94MB (freed 0.00MB)
2025-03-30 17:54:47,177 [INFO] - GPU cache cleared: 2518.40MB → 2518.40MB (freed 0.00MB)
2025-03-30 18:00:38,037 [INFO] - GPU cache cleared: 2521.27MB → 2521.27MB (freed 0.00MB)
2025-03-30 18:07:19,132 [INFO] - GPU cache cleared: 2520.42MB → 2520.42MB (freed 0.00MB)
2025-03-30 18:13:44,750 [INFO] - GPU cache cleared: 2517.02MB → 2517.02MB (freed 0.00MB)
2025-03-30 18:20:40,111 [INFO] - GPU cache cleared: 2517.96MB → 2517.96MB (freed 0.00MB)
2025-03-30 18:26:24,857 [INFO] - GPU cache cleared: 2521.48MB → 2521.48MB (freed 0.00MB)
2025-03-30 18:32:36,987 [INFO] - GPU cache cleared: 2520.86MB → 2520.86MB (freed 0.00MB)
2025-03-30 18:38:45,971 [INFO] - GPU cache cleared: 2524.07MB → 2524.07MB (freed 0.00MB)
2025-03-30 18:45:56,885 [INFO] - GPU cache cleared: 2517.91MB → 2517.91MB (freed 0.00MB)
2025-03-30 18:51:50,165 [INFO] - GPU cache cleared: 2518.90MB → 2518.90MB (freed 0.00MB)
2025-03-30 19:01:22,861 [INFO] - GPU cache cleared: 2518.33MB → 2518.33MB (freed 0.00MB)
2025-03-30 19:10:25,245 [INFO] - GPU cache cleared: 2523.26MB → 2523.26MB (freed 0.00MB)
2025-03-30 19:16:39,286 [INFO] - GPU cache cleared: 2518.52MB → 2518.52MB (freed 0.00MB)
2025-03-30 19:23:09,850 [INFO] - GPU cache cleared: 2524.80MB → 2524.80MB (freed 0.00MB)
2025-03-30 19:30:46,146 [INFO] - GPU cache cleared: 2518.79MB → 2518.79MB (freed 0.00MB)
2025-03-30 19:39:26,197 [INFO] -   vit: Train Loss=1.1443, Train Acc=57.97%, Val Loss=1.2271, Val Acc=55.52%, ECE=0.0141
2025-03-30 19:39:26,206 [INFO] -   New best model for vit (Val Acc: 55.52%)
2025-03-30 19:39:27,083 [INFO] -   efficientnet: Train Loss=0.1913, Train Acc=97.98%, Val Loss=0.1304, Val Acc=96.62%, ECE=0.0313
2025-03-30 19:39:27,084 [INFO] -   inception: Train Loss=0.2824, Train Acc=95.69%, Val Loss=0.1808, Val Acc=95.04%, ECE=0.0298
2025-03-30 19:39:27,090 [INFO] -   New best model for inception (Val Acc: 95.04%)
2025-03-30 19:39:27,408 [INFO] -   mobilenet: Train Loss=0.2365, Train Acc=97.98%, Val Loss=0.1447, Val Acc=96.08%, ECE=0.0315
2025-03-30 19:39:27,410 [INFO] -   resnet: Train Loss=0.3034, Train Acc=94.28%, Val Loss=0.2057, Val Acc=93.96%, ECE=0.0346
2025-03-30 19:39:27,415 [INFO] -   New best model for resnet (Val Acc: 93.96%)
2025-03-30 19:39:27,702 [INFO] -   densenet: Train Loss=0.2771, Train Acc=96.11%, Val Loss=0.1686, Val Acc=95.52%, ECE=0.0334
2025-03-30 19:39:27,703 [INFO] -   student: Train Loss=0.1778, Train Acc=97.86%, Val Loss=0.1504, Val Acc=96.52%, ECE=0.0475
2025-03-30 19:39:27,705 [INFO] - Mutual learning epoch 9 completed in 7825.32s
2025-03-30 19:39:27,706 [INFO] - Mutual Learning Epoch 10/50
2025-03-30 19:39:27,707 [INFO] - Mutual weight: 0.4000, Calibration weight: 0.1333
2025-03-30 19:39:27,709 [INFO] - Current temperatures: {'vit': 4.974104881286621, 'efficientnet': 5.830447673797607, 'inception': 5.748961925506592, 'mobilenet': 5.779464244842529, 'resnet': 5.72531795501709, 'densenet': 5.7653937339782715, 'student': 5.0102057456970215}
2025-03-30 19:39:27,983 [INFO] - GPU cache cleared: 2445.53MB → 2445.53MB (freed 0.00MB)
2025-03-30 19:39:35,965 [INFO] - GPU cache cleared: 2519.35MB → 2519.35MB (freed 0.00MB)
2025-03-30 19:48:38,638 [INFO] - GPU cache cleared: 2519.41MB → 2519.41MB (freed 0.00MB)
2025-03-30 19:59:02,630 [INFO] - GPU cache cleared: 2520.64MB → 2520.64MB (freed 0.00MB)
2025-03-30 20:06:18,665 [INFO] - GPU cache cleared: 2520.50MB → 2520.50MB (freed 0.00MB)
2025-03-30 20:12:35,390 [INFO] - GPU cache cleared: 2522.95MB → 2522.95MB (freed 0.00MB)
2025-03-30 20:18:20,824 [INFO] - GPU cache cleared: 2516.83MB → 2516.83MB (freed 0.00MB)
2025-03-30 20:23:35,186 [INFO] - GPU cache cleared: 2517.92MB → 2517.92MB (freed 0.00MB)
2025-03-30 20:28:54,788 [INFO] - GPU cache cleared: 2524.99MB → 2524.99MB (freed 0.00MB)
2025-03-30 20:36:00,187 [INFO] - GPU cache cleared: 2519.79MB → 2519.79MB (freed 0.00MB)
2025-03-30 20:42:25,944 [INFO] - GPU cache cleared: 2522.26MB → 2522.26MB (freed 0.00MB)
2025-03-30 20:49:38,700 [INFO] - GPU cache cleared: 2521.47MB → 2521.47MB (freed 0.00MB)
2025-03-30 20:55:59,324 [INFO] - GPU cache cleared: 2516.18MB → 2516.18MB (freed 0.00MB)
2025-03-30 21:02:23,727 [INFO] - GPU cache cleared: 2523.85MB → 2523.85MB (freed 0.00MB)
2025-03-30 21:07:48,139 [INFO] - GPU cache cleared: 2520.97MB → 2520.97MB (freed 0.00MB)
2025-03-30 21:14:23,939 [INFO] - GPU cache cleared: 2518.42MB → 2518.42MB (freed 0.00MB)
2025-03-30 21:21:18,183 [INFO] - GPU cache cleared: 2518.04MB → 2518.04MB (freed 0.00MB)
2025-03-30 21:28:54,710 [INFO] - GPU cache cleared: 2521.83MB → 2521.83MB (freed 0.00MB)
2025-03-30 21:35:50,559 [INFO] - GPU cache cleared: 2524.14MB → 2524.14MB (freed 0.00MB)
2025-03-30 21:42:30,956 [INFO] - GPU cache cleared: 2522.11MB → 2522.11MB (freed 0.00MB)
2025-03-30 21:49:23,799 [INFO] -   vit: Train Loss=1.0950, Train Acc=58.41%, Val Loss=1.2250, Val Acc=55.60%, ECE=0.0216
2025-03-30 21:49:23,805 [INFO] -   New best model for vit (Val Acc: 55.60%)
2025-03-30 21:49:24,480 [INFO] -   efficientnet: Train Loss=0.1887, Train Acc=98.05%, Val Loss=0.1294, Val Acc=96.64%, ECE=0.0304
2025-03-30 21:49:24,480 [INFO] -   inception: Train Loss=0.2708, Train Acc=96.06%, Val Loss=0.1778, Val Acc=95.14%, ECE=0.0369
2025-03-30 21:49:24,480 [INFO] -   New best model for inception (Val Acc: 95.14%)
2025-03-30 21:49:24,730 [INFO] -   mobilenet: Train Loss=0.2293, Train Acc=98.24%, Val Loss=0.1464, Val Acc=96.18%, ECE=0.0332
2025-03-30 21:49:24,735 [INFO] -   New best model for mobilenet (Val Acc: 96.18%)
2025-03-30 21:49:24,852 [INFO] -   resnet: Train Loss=0.2899, Train Acc=94.60%, Val Loss=0.2057, Val Acc=93.78%, ECE=0.0279
2025-03-30 21:49:24,852 [INFO] -   densenet: Train Loss=0.2658, Train Acc=96.54%, Val Loss=0.1647, Val Acc=95.38%, ECE=0.0306
2025-03-30 21:49:24,852 [INFO] -   student: Train Loss=0.1750, Train Acc=98.08%, Val Loss=0.1465, Val Acc=96.72%, ECE=0.0475
2025-03-30 21:49:24,862 [INFO] -   New best model for student (Val Acc: 96.72%)
2025-03-30 21:49:33,508 [INFO] - Mutual learning epoch 10 completed in 7805.80s
2025-03-30 21:49:33,515 [INFO] - Mutual Learning Epoch 11/50
2025-03-30 21:49:33,515 [INFO] - Mutual weight: 0.4400, Calibration weight: 0.1467
2025-03-30 21:49:33,515 [INFO] - Current temperatures: {'vit': 4.971604824066162, 'efficientnet': 5.902292728424072, 'inception': 5.7965497970581055, 'mobilenet': 5.851897239685059, 'resnet': 5.785370826721191, 'densenet': 5.830244541168213, 'student': 5.10185432434082}
2025-03-30 21:49:33,761 [INFO] - GPU cache cleared: 2445.04MB → 2445.04MB (freed 0.00MB)
2025-03-30 21:49:40,321 [INFO] - GPU cache cleared: 2521.42MB → 2521.42MB (freed 0.00MB)
2025-03-30 21:55:04,324 [INFO] - GPU cache cleared: 2521.17MB → 2521.17MB (freed 0.00MB)
2025-03-30 22:00:58,553 [INFO] - GPU cache cleared: 2519.67MB → 2519.67MB (freed 0.00MB)
2025-03-30 22:06:25,102 [INFO] - GPU cache cleared: 2523.82MB → 2523.82MB (freed 0.00MB)
2025-03-30 22:12:57,229 [INFO] - GPU cache cleared: 2519.29MB → 2519.29MB (freed 0.00MB)
2025-03-30 22:18:56,780 [INFO] - GPU cache cleared: 2521.68MB → 2521.68MB (freed 0.00MB)
2025-03-30 22:25:55,622 [INFO] - GPU cache cleared: 2517.88MB → 2517.88MB (freed 0.00MB)
2025-03-30 22:32:12,670 [INFO] - GPU cache cleared: 2517.32MB → 2517.32MB (freed 0.00MB)
2025-03-30 22:38:17,880 [INFO] - GPU cache cleared: 2521.34MB → 2521.34MB (freed 0.00MB)
2025-03-30 22:44:27,969 [INFO] - GPU cache cleared: 2521.02MB → 2521.02MB (freed 0.00MB)
2025-03-30 22:50:03,185 [INFO] - GPU cache cleared: 2519.04MB → 2519.04MB (freed 0.00MB)
2025-03-30 22:55:45,978 [INFO] - GPU cache cleared: 2522.31MB → 2522.31MB (freed 0.00MB)
2025-03-30 23:00:34,935 [INFO] - GPU cache cleared: 2520.43MB → 2520.43MB (freed 0.00MB)
2025-03-30 23:06:07,795 [INFO] - GPU cache cleared: 2518.38MB → 2518.38MB (freed 0.00MB)
2025-03-30 23:12:00,702 [INFO] - GPU cache cleared: 2521.22MB → 2521.22MB (freed 0.00MB)
2025-03-30 23:17:25,626 [INFO] - GPU cache cleared: 2521.63MB → 2521.63MB (freed 0.00MB)
2025-03-30 23:23:25,328 [INFO] - GPU cache cleared: 2520.31MB → 2520.31MB (freed 0.00MB)
2025-03-30 23:29:06,556 [INFO] - GPU cache cleared: 2520.41MB → 2520.41MB (freed 0.00MB)
2025-03-30 23:35:39,130 [INFO] - GPU cache cleared: 2517.81MB → 2517.81MB (freed 0.00MB)
2025-03-30 23:44:21,833 [INFO] -   vit: Train Loss=1.0430, Train Acc=58.63%, Val Loss=1.2262, Val Acc=55.48%, ECE=0.0205
2025-03-30 23:44:21,838 [INFO] -   efficientnet: Train Loss=0.1847, Train Acc=98.16%, Val Loss=0.1314, Val Acc=96.70%, ECE=0.0327
2025-03-30 23:44:21,842 [INFO] -   inception: Train Loss=0.2612, Train Acc=96.21%, Val Loss=0.1719, Val Acc=95.52%, ECE=0.0370
2025-03-30 23:44:21,848 [INFO] -   New best model for inception (Val Acc: 95.52%)
2025-03-30 23:44:22,113 [INFO] -   mobilenet: Train Loss=0.2229, Train Acc=98.33%, Val Loss=0.1498, Val Acc=96.30%, ECE=0.0410
2025-03-30 23:44:22,113 [INFO] -   New best model for mobilenet (Val Acc: 96.30%)
2025-03-30 23:44:22,228 [INFO] -   resnet: Train Loss=0.2718, Train Acc=95.13%, Val Loss=0.2095, Val Acc=94.08%, ECE=0.0357
2025-03-30 23:44:22,232 [INFO] -   New best model for resnet (Val Acc: 94.08%)
2025-03-30 23:44:22,469 [INFO] -   densenet: Train Loss=0.2558, Train Acc=96.67%, Val Loss=0.1807, Val Acc=95.08%, ECE=0.0413
2025-03-30 23:44:22,470 [INFO] -   student: Train Loss=0.1731, Train Acc=98.05%, Val Loss=0.1524, Val Acc=96.32%, ECE=0.0513
2025-03-30 23:44:22,470 [INFO] - Mutual learning epoch 11 completed in 6888.96s
2025-03-30 23:44:22,470 [INFO] - Mutual Learning Epoch 12/50
2025-03-30 23:44:22,470 [INFO] - Mutual weight: 0.4800, Calibration weight: 0.1600
2025-03-30 23:44:22,470 [INFO] - Current temperatures: {'vit': 4.969239234924316, 'efficientnet': 5.968461513519287, 'inception': 5.847569465637207, 'mobilenet': 5.91933012008667, 'resnet': 5.845605850219727, 'densenet': 5.89236307144165, 'student': 5.188321590423584}
2025-03-30 23:44:22,844 [INFO] - GPU cache cleared: 2446.71MB → 2446.71MB (freed 0.00MB)
2025-03-30 23:44:29,487 [INFO] - GPU cache cleared: 2517.88MB → 2517.88MB (freed 0.00MB)
2025-03-30 23:50:47,943 [INFO] - GPU cache cleared: 2518.86MB → 2518.86MB (freed 0.00MB)
2025-03-30 23:57:41,936 [INFO] - GPU cache cleared: 2522.65MB → 2522.65MB (freed 0.00MB)
2025-03-31 00:04:01,761 [INFO] - GPU cache cleared: 2521.18MB → 2521.18MB (freed 0.00MB)
2025-03-31 00:11:20,817 [INFO] - GPU cache cleared: 2524.08MB → 2524.08MB (freed 0.00MB)
2025-03-31 00:18:09,175 [INFO] - GPU cache cleared: 2519.04MB → 2519.04MB (freed 0.00MB)
2025-03-31 00:24:25,521 [INFO] - GPU cache cleared: 2524.08MB → 2524.08MB (freed 0.00MB)
2025-03-31 00:31:13,371 [INFO] - GPU cache cleared: 2520.80MB → 2520.80MB (freed 0.00MB)
2025-03-31 00:38:37,620 [INFO] - GPU cache cleared: 2519.39MB → 2519.39MB (freed 0.00MB)
2025-03-31 00:44:49,930 [INFO] - GPU cache cleared: 2522.27MB → 2522.27MB (freed 0.00MB)
2025-03-31 00:52:17,730 [INFO] - GPU cache cleared: 2522.87MB → 2522.87MB (freed 0.00MB)
2025-03-31 00:58:55,947 [INFO] - GPU cache cleared: 2521.65MB → 2521.65MB (freed 0.00MB)
2025-03-31 01:06:28,657 [INFO] - GPU cache cleared: 2521.27MB → 2521.27MB (freed 0.00MB)
2025-03-31 01:13:48,362 [INFO] - GPU cache cleared: 2522.47MB → 2522.47MB (freed 0.00MB)
2025-03-31 01:20:18,615 [INFO] - GPU cache cleared: 2519.68MB → 2519.68MB (freed 0.00MB)
2025-03-31 01:26:28,820 [INFO] - GPU cache cleared: 2519.32MB → 2519.32MB (freed 0.00MB)
2025-03-31 01:33:13,317 [INFO] - GPU cache cleared: 2519.77MB → 2519.77MB (freed 0.00MB)
2025-03-31 01:40:16,589 [INFO] - GPU cache cleared: 2520.68MB → 2520.68MB (freed 0.00MB)
2025-03-31 01:46:50,447 [INFO] - GPU cache cleared: 2521.66MB → 2521.66MB (freed 0.00MB)
2025-03-31 01:55:38,589 [INFO] -   vit: Train Loss=0.9913, Train Acc=58.96%, Val Loss=1.2102, Val Acc=56.56%, ECE=0.0195
2025-03-31 01:55:38,598 [INFO] -   New best model for vit (Val Acc: 56.56%)
2025-03-31 01:55:39,317 [INFO] -   efficientnet: Train Loss=0.1778, Train Acc=98.34%, Val Loss=0.1410, Val Acc=96.44%, ECE=0.0405
2025-03-31 01:55:39,317 [INFO] -   inception: Train Loss=0.2471, Train Acc=96.78%, Val Loss=0.1804, Val Acc=95.26%, ECE=0.0408
2025-03-31 01:55:39,317 [INFO] -   mobilenet: Train Loss=0.2168, Train Acc=98.47%, Val Loss=0.1604, Val Acc=96.14%, ECE=0.0438
2025-03-31 01:55:39,317 [INFO] -   resnet: Train Loss=0.2582, Train Acc=95.46%, Val Loss=0.2160, Val Acc=93.84%, ECE=0.0375
2025-03-31 01:55:39,327 [INFO] -   densenet: Train Loss=0.2516, Train Acc=96.71%, Val Loss=0.1827, Val Acc=95.22%, ECE=0.0405
2025-03-31 01:55:39,327 [INFO] -   student: Train Loss=0.1664, Train Acc=98.38%, Val Loss=0.1623, Val Acc=96.44%, ECE=0.0617
2025-03-31 01:55:39,327 [INFO] - Mutual learning epoch 12 completed in 7876.86s
2025-03-31 01:55:39,327 [INFO] - Mutual Learning Epoch 13/50
2025-03-31 01:55:39,327 [INFO] - Mutual weight: 0.5200, Calibration weight: 0.1733
2025-03-31 01:55:39,332 [INFO] - Current temperatures: {'vit': 4.966963768005371, 'efficientnet': 6.032919883728027, 'inception': 5.903419494628906, 'mobilenet': 5.98568058013916, 'resnet': 5.902023792266846, 'densenet': 5.947507381439209, 'student': 5.271348476409912}
2025-03-31 01:55:39,587 [INFO] - GPU cache cleared: 2451.34MB → 2451.34MB (freed 0.00MB)
2025-03-31 01:55:46,377 [INFO] - GPU cache cleared: 2519.25MB → 2519.25MB (freed 0.00MB)
2025-03-31 02:02:10,371 [INFO] - GPU cache cleared: 2517.96MB → 2517.96MB (freed 0.00MB)
2025-03-31 02:08:55,523 [INFO] - GPU cache cleared: 2522.65MB → 2522.65MB (freed 0.00MB)
2025-03-31 02:15:16,877 [INFO] - GPU cache cleared: 2521.25MB → 2521.25MB (freed 0.00MB)
2025-03-31 02:21:29,130 [INFO] - GPU cache cleared: 2518.30MB → 2518.30MB (freed 0.00MB)
2025-03-31 02:26:49,854 [INFO] - GPU cache cleared: 2523.54MB → 2523.54MB (freed 0.00MB)
2025-03-31 02:32:52,506 [INFO] - GPU cache cleared: 2520.95MB → 2520.95MB (freed 0.00MB)
2025-03-31 02:37:51,685 [INFO] - GPU cache cleared: 2521.04MB → 2521.04MB (freed 0.00MB)
2025-03-31 02:43:34,304 [INFO] - GPU cache cleared: 2523.81MB → 2523.81MB (freed 0.00MB)
2025-03-31 02:49:23,764 [INFO] - GPU cache cleared: 2518.13MB → 2518.13MB (freed 0.00MB)
2025-03-31 02:55:53,185 [INFO] - GPU cache cleared: 2520.43MB → 2520.43MB (freed 0.00MB)
2025-03-31 03:01:02,212 [INFO] - GPU cache cleared: 2518.80MB → 2518.80MB (freed 0.00MB)
2025-03-31 03:06:34,781 [INFO] - GPU cache cleared: 2520.16MB → 2520.16MB (freed 0.00MB)
2025-03-31 03:13:03,660 [INFO] - GPU cache cleared: 2515.55MB → 2515.55MB (freed 0.00MB)
2025-03-31 03:19:06,196 [INFO] - GPU cache cleared: 2518.33MB → 2518.33MB (freed 0.00MB)
2025-03-31 03:24:31,233 [INFO] - GPU cache cleared: 2521.55MB → 2521.55MB (freed 0.00MB)
2025-03-31 03:30:39,122 [INFO] - GPU cache cleared: 2522.41MB → 2522.41MB (freed 0.00MB)
2025-03-31 03:36:09,701 [INFO] - GPU cache cleared: 2523.30MB → 2523.30MB (freed 0.00MB)
2025-03-31 03:44:10,986 [INFO] - GPU cache cleared: 2520.07MB → 2520.07MB (freed 0.00MB)
2025-03-31 03:52:22,498 [INFO] -   vit: Train Loss=0.9381, Train Acc=59.26%, Val Loss=1.2062, Val Acc=56.74%, ECE=0.0182
2025-03-31 03:52:22,511 [INFO] -   New best model for vit (Val Acc: 56.74%)
2025-03-31 03:52:23,236 [INFO] -   efficientnet: Train Loss=0.1754, Train Acc=98.44%, Val Loss=0.1395, Val Acc=96.64%, ECE=0.0393
2025-03-31 03:52:23,236 [INFO] -   inception: Train Loss=0.2394, Train Acc=96.96%, Val Loss=0.1891, Val Acc=95.06%, ECE=0.0394
2025-03-31 03:52:23,236 [INFO] -   mobilenet: Train Loss=0.2126, Train Acc=98.54%, Val Loss=0.1611, Val Acc=95.74%, ECE=0.0463
2025-03-31 03:52:23,243 [INFO] -   resnet: Train Loss=0.2518, Train Acc=95.63%, Val Loss=0.2068, Val Acc=94.62%, ECE=0.0445
2025-03-31 03:52:23,245 [INFO] -   New best model for resnet (Val Acc: 94.62%)
2025-03-31 03:52:23,524 [INFO] -   densenet: Train Loss=0.2384, Train Acc=97.12%, Val Loss=0.1704, Val Acc=95.96%, ECE=0.0424
2025-03-31 03:52:23,526 [INFO] -   New best model for densenet (Val Acc: 95.96%)
2025-03-31 03:52:23,695 [INFO] -   student: Train Loss=0.1645, Train Acc=98.43%, Val Loss=0.1565, Val Acc=96.80%, ECE=0.0617
2025-03-31 03:52:23,700 [INFO] -   New best model for student (Val Acc: 96.80%)
2025-03-31 03:52:23,825 [INFO] - Mutual learning epoch 13 completed in 7004.50s
2025-03-31 03:52:23,825 [INFO] - Mutual Learning Epoch 14/50
2025-03-31 03:52:23,825 [INFO] - Mutual weight: 0.5600, Calibration weight: 0.1867
2025-03-31 03:52:23,825 [INFO] - Current temperatures: {'vit': 4.9648613929748535, 'efficientnet': 6.090721130371094, 'inception': 5.954287052154541, 'mobilenet': 6.046170234680176, 'resnet': 5.952172756195068, 'densenet': 6.0040974617004395, 'student': 5.348907470703125}
2025-03-31 03:52:24,100 [INFO] - GPU cache cleared: 2444.42MB → 2444.42MB (freed 0.00MB)
2025-03-31 03:52:30,805 [INFO] - GPU cache cleared: 2518.16MB → 2518.16MB (freed 0.00MB)
2025-03-31 03:59:19,040 [INFO] - GPU cache cleared: 2519.41MB → 2519.41MB (freed 0.00MB)
2025-03-31 04:04:09,317 [INFO] - GPU cache cleared: 2518.08MB → 2518.08MB (freed 0.00MB)
2025-03-31 04:09:41,493 [INFO] - GPU cache cleared: 2518.57MB → 2518.57MB (freed 0.00MB)
2025-03-31 04:16:20,739 [INFO] - GPU cache cleared: 2521.21MB → 2521.21MB (freed 0.00MB)
2025-03-31 04:22:08,337 [INFO] - GPU cache cleared: 2516.02MB → 2516.02MB (freed 0.00MB)
2025-03-31 04:28:29,305 [INFO] - GPU cache cleared: 2520.72MB → 2520.72MB (freed 0.00MB)
2025-03-31 04:33:52,987 [INFO] - GPU cache cleared: 2519.07MB → 2519.07MB (freed 0.00MB)
2025-03-31 04:40:24,018 [INFO] - GPU cache cleared: 2519.76MB → 2519.76MB (freed 0.00MB)
2025-03-31 04:46:22,203 [INFO] - GPU cache cleared: 2518.38MB → 2518.38MB (freed 0.00MB)
2025-03-31 04:52:19,720 [INFO] - GPU cache cleared: 2522.68MB → 2522.68MB (freed 0.00MB)
2025-03-31 04:57:38,116 [INFO] - GPU cache cleared: 2515.86MB → 2515.86MB (freed 0.00MB)
2025-03-31 05:03:41,674 [INFO] - GPU cache cleared: 2521.43MB → 2521.43MB (freed 0.00MB)
2025-03-31 05:09:14,445 [INFO] - GPU cache cleared: 2517.75MB → 2517.75MB (freed 0.00MB)
2025-03-31 05:15:52,983 [INFO] - GPU cache cleared: 2518.70MB → 2518.70MB (freed 0.00MB)
2025-03-31 05:21:57,424 [INFO] - GPU cache cleared: 2517.11MB → 2517.11MB (freed 0.00MB)
2025-03-31 05:27:59,222 [INFO] - GPU cache cleared: 2518.86MB → 2518.86MB (freed 0.00MB)
2025-03-31 05:33:26,063 [INFO] - GPU cache cleared: 2519.39MB → 2519.39MB (freed 0.00MB)
2025-03-31 05:39:24,092 [INFO] - GPU cache cleared: 2519.45MB → 2519.45MB (freed 0.00MB)
2025-03-31 05:46:55,913 [INFO] -   vit: Train Loss=0.8875, Train Acc=59.41%, Val Loss=1.2084, Val Acc=56.78%, ECE=0.0179
2025-03-31 05:46:55,919 [INFO] -   New best model for vit (Val Acc: 56.78%)
2025-03-31 05:46:56,642 [INFO] -   efficientnet: Train Loss=0.1670, Train Acc=98.71%, Val Loss=0.1435, Val Acc=96.88%, ECE=0.0482
2025-03-31 05:46:56,649 [INFO] -   New best model for efficientnet (Val Acc: 96.88%)
2025-03-31 05:46:56,764 [INFO] -   inception: Train Loss=0.2281, Train Acc=97.27%, Val Loss=0.1862, Val Acc=95.58%, ECE=0.0514
2025-03-31 05:46:56,767 [INFO] -   New best model for inception (Val Acc: 95.58%)
2025-03-31 05:46:57,067 [INFO] -   mobilenet: Train Loss=0.2036, Train Acc=98.75%, Val Loss=0.1727, Val Acc=95.92%, ECE=0.0555
2025-03-31 05:46:57,069 [INFO] -   resnet: Train Loss=0.2366, Train Acc=96.02%, Val Loss=0.2063, Val Acc=94.66%, ECE=0.0497
2025-03-31 05:46:57,069 [INFO] -   New best model for resnet (Val Acc: 94.66%)
2025-03-31 05:46:57,322 [INFO] -   densenet: Train Loss=0.2297, Train Acc=97.30%, Val Loss=0.1798, Val Acc=95.60%, ECE=0.0504
2025-03-31 05:46:57,322 [INFO] -   student: Train Loss=0.1582, Train Acc=98.63%, Val Loss=0.1588, Val Acc=96.94%, ECE=0.0676
2025-03-31 05:46:57,332 [INFO] -   New best model for student (Val Acc: 96.94%)
2025-03-31 05:46:57,449 [INFO] - Mutual learning epoch 14 completed in 6873.62s
2025-03-31 05:46:57,449 [INFO] - Mutual Learning Epoch 15/50
2025-03-31 05:46:57,449 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-03-31 05:46:57,449 [INFO] - Current temperatures: {'vit': 4.962864875793457, 'efficientnet': 6.14618444442749, 'inception': 6.006397724151611, 'mobilenet': 6.103635311126709, 'resnet': 6.004146575927734, 'densenet': 6.056589126586914, 'student': 5.421834468841553}
2025-03-31 05:46:57,745 [INFO] - GPU cache cleared: 2447.27MB → 2447.27MB (freed 0.00MB)
2025-03-31 05:47:04,599 [INFO] - GPU cache cleared: 2516.65MB → 2516.65MB (freed 0.00MB)
2025-03-31 05:53:01,081 [INFO] - GPU cache cleared: 2518.60MB → 2518.60MB (freed 0.00MB)
2025-03-31 05:59:24,578 [INFO] - GPU cache cleared: 2521.99MB → 2521.99MB (freed 0.00MB)
2025-03-31 06:05:54,095 [INFO] - GPU cache cleared: 2521.05MB → 2521.05MB (freed 0.00MB)
2025-03-31 06:12:37,867 [INFO] - GPU cache cleared: 2521.82MB → 2521.82MB (freed 0.00MB)
2025-03-31 06:18:33,582 [INFO] - GPU cache cleared: 2522.01MB → 2522.01MB (freed 0.00MB)
2025-03-31 06:24:36,301 [INFO] - GPU cache cleared: 2520.60MB → 2520.60MB (freed 0.00MB)
2025-03-31 06:30:14,871 [INFO] - GPU cache cleared: 2521.68MB → 2521.68MB (freed 0.00MB)
2025-03-31 06:36:09,370 [INFO] - GPU cache cleared: 2518.67MB → 2518.67MB (freed 0.00MB)
2025-03-31 06:41:40,629 [INFO] - GPU cache cleared: 2519.42MB → 2519.42MB (freed 0.00MB)
2025-03-31 06:46:48,565 [INFO] - GPU cache cleared: 2522.19MB → 2522.19MB (freed 0.00MB)
2025-03-31 06:51:46,622 [INFO] - GPU cache cleared: 2517.22MB → 2517.22MB (freed 0.00MB)
2025-03-31 06:57:17,100 [INFO] - GPU cache cleared: 2518.25MB → 2518.25MB (freed 0.00MB)
2025-03-31 07:02:34,484 [INFO] - GPU cache cleared: 2517.93MB → 2517.93MB (freed 0.00MB)
2025-03-31 07:09:44,169 [INFO] - GPU cache cleared: 2522.06MB → 2522.06MB (freed 0.00MB)
2025-03-31 07:17:06,369 [INFO] - GPU cache cleared: 2518.50MB → 2518.50MB (freed 0.00MB)
2025-03-31 07:23:43,433 [INFO] - GPU cache cleared: 2516.97MB → 2516.97MB (freed 0.00MB)
2025-03-31 07:30:02,382 [INFO] - GPU cache cleared: 2521.26MB → 2521.26MB (freed 0.00MB)
2025-03-31 07:36:45,045 [INFO] - GPU cache cleared: 2520.08MB → 2520.08MB (freed 0.00MB)
2025-03-31 07:44:37,239 [INFO] -   vit: Train Loss=0.8389, Train Acc=59.51%, Val Loss=1.1994, Val Acc=57.40%, ECE=0.0188
2025-03-31 07:44:37,247 [INFO] -   New best model for vit (Val Acc: 57.40%)
2025-03-31 07:44:37,945 [INFO] -   efficientnet: Train Loss=0.1639, Train Acc=98.72%, Val Loss=0.1464, Val Acc=96.98%, ECE=0.0555
2025-03-31 07:44:37,953 [INFO] -   New best model for efficientnet (Val Acc: 96.98%)
2025-03-31 07:44:38,067 [INFO] -   inception: Train Loss=0.2209, Train Acc=97.38%, Val Loss=0.2002, Val Acc=95.40%, ECE=0.0601
2025-03-31 07:44:38,067 [INFO] -   mobilenet: Train Loss=0.1999, Train Acc=98.83%, Val Loss=0.1666, Val Acc=96.34%, ECE=0.0609
2025-03-31 07:44:38,075 [INFO] -   New best model for mobilenet (Val Acc: 96.34%)
2025-03-31 07:44:38,179 [INFO] -   resnet: Train Loss=0.2247, Train Acc=96.32%, Val Loss=0.2005, Val Acc=95.22%, ECE=0.0519
2025-03-31 07:44:38,183 [INFO] -   New best model for resnet (Val Acc: 95.22%)
2025-03-31 07:44:38,498 [INFO] -   densenet: Train Loss=0.2201, Train Acc=97.60%, Val Loss=0.1810, Val Acc=95.98%, ECE=0.0571
2025-03-31 07:44:38,503 [INFO] -   New best model for densenet (Val Acc: 95.98%)
2025-03-31 07:44:38,690 [INFO] -   student: Train Loss=0.1552, Train Acc=98.61%, Val Loss=0.1730, Val Acc=97.00%, ECE=0.0793
2025-03-31 07:44:38,695 [INFO] -   New best model for student (Val Acc: 97.00%)
2025-03-31 07:44:38,814 [INFO] - Mutual learning epoch 15 completed in 7061.36s
2025-03-31 07:44:38,814 [INFO] - Mutual Learning Epoch 16/50
2025-03-31 07:44:38,814 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-03-31 07:44:38,814 [INFO] - Current temperatures: {'vit': 4.960986614227295, 'efficientnet': 6.198797225952148, 'inception': 6.055327415466309, 'mobilenet': 6.156865119934082, 'resnet': 6.056190013885498, 'densenet': 6.107991695404053, 'student': 5.490189552307129}
2025-03-31 07:44:39,108 [INFO] - GPU cache cleared: 2445.56MB → 2445.56MB (freed 0.00MB)
2025-03-31 07:44:45,738 [INFO] - GPU cache cleared: 2518.25MB → 2518.25MB (freed 0.00MB)
2025-03-31 07:51:45,872 [INFO] - GPU cache cleared: 2522.02MB → 2522.02MB (freed 0.00MB)
2025-03-31 07:59:04,657 [INFO] - GPU cache cleared: 2518.79MB → 2518.79MB (freed 0.00MB)
2025-03-31 08:05:20,961 [INFO] - GPU cache cleared: 2521.61MB → 2521.61MB (freed 0.00MB)
2025-03-31 08:12:01,711 [INFO] - GPU cache cleared: 2523.66MB → 2523.66MB (freed 0.00MB)
2025-03-31 08:18:10,319 [INFO] - GPU cache cleared: 2522.03MB → 2522.03MB (freed 0.00MB)
2025-03-31 08:24:14,974 [INFO] - GPU cache cleared: 2519.30MB → 2519.30MB (freed 0.00MB)
2025-03-31 08:30:33,517 [INFO] - GPU cache cleared: 2520.44MB → 2520.44MB (freed 0.00MB)
2025-03-31 08:35:50,069 [INFO] - GPU cache cleared: 2517.35MB → 2517.35MB (freed 0.00MB)
2025-03-31 08:41:28,152 [INFO] - GPU cache cleared: 2520.72MB → 2520.72MB (freed 0.00MB)
2025-03-31 08:47:30,005 [INFO] - GPU cache cleared: 2522.63MB → 2522.63MB (freed 0.00MB)
2025-03-31 08:53:16,168 [INFO] - GPU cache cleared: 2520.02MB → 2520.02MB (freed 0.00MB)
2025-03-31 08:59:24,075 [INFO] - GPU cache cleared: 2520.39MB → 2520.39MB (freed 0.00MB)
2025-03-31 09:05:25,539 [INFO] - GPU cache cleared: 2524.14MB → 2524.14MB (freed 0.00MB)
2025-03-31 09:12:18,694 [INFO] - GPU cache cleared: 2518.77MB → 2518.77MB (freed 0.00MB)
2025-03-31 09:18:19,338 [INFO] - GPU cache cleared: 2521.33MB → 2521.33MB (freed 0.00MB)
2025-03-31 09:24:26,873 [INFO] - GPU cache cleared: 2519.78MB → 2519.78MB (freed 0.00MB)
2025-03-31 09:30:26,443 [INFO] - GPU cache cleared: 2519.02MB → 2519.02MB (freed 0.00MB)
2025-03-31 09:37:14,283 [INFO] - GPU cache cleared: 2519.50MB → 2519.50MB (freed 0.00MB)
2025-03-31 09:44:43,754 [INFO] -   vit: Train Loss=0.8224, Train Acc=60.06%, Val Loss=1.2042, Val Acc=57.00%, ECE=0.0203
2025-03-31 09:44:43,756 [INFO] -   efficientnet: Train Loss=0.1604, Train Acc=98.70%, Val Loss=0.1497, Val Acc=96.84%, ECE=0.0533
2025-03-31 09:44:43,759 [INFO] -   inception: Train Loss=0.2171, Train Acc=97.41%, Val Loss=0.1988, Val Acc=95.44%, ECE=0.0599
2025-03-31 09:44:43,761 [INFO] -   mobilenet: Train Loss=0.1962, Train Acc=98.78%, Val Loss=0.1666, Val Acc=96.26%, ECE=0.0606
2025-03-31 09:44:43,763 [INFO] -   resnet: Train Loss=0.2203, Train Acc=96.46%, Val Loss=0.2143, Val Acc=94.94%, ECE=0.0558
2025-03-31 09:44:43,764 [INFO] -   densenet: Train Loss=0.2181, Train Acc=97.52%, Val Loss=0.1940, Val Acc=95.24%, ECE=0.0562
2025-03-31 09:44:43,768 [INFO] -   student: Train Loss=0.1518, Train Acc=98.68%, Val Loss=0.1700, Val Acc=97.08%, ECE=0.0809
2025-03-31 09:44:43,775 [INFO] -   New best model for student (Val Acc: 97.08%)
2025-03-31 09:44:43,918 [INFO] - Mutual learning epoch 16 completed in 7205.10s
2025-03-31 09:44:43,918 [INFO] - Mutual Learning Epoch 17/50
2025-03-31 09:44:43,924 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-03-31 09:44:43,925 [INFO] - Current temperatures: {'vit': 4.959236145019531, 'efficientnet': 6.248796463012695, 'inception': 6.1041460037231445, 'mobilenet': 6.208027362823486, 'resnet': 6.1033806800842285, 'densenet': 6.155068397521973, 'student': 5.554386138916016}
2025-03-31 09:44:44,187 [INFO] - GPU cache cleared: 2445.65MB → 2445.65MB (freed 0.00MB)
2025-03-31 09:44:51,544 [INFO] - GPU cache cleared: 2522.46MB → 2522.46MB (freed 0.00MB)
2025-03-31 09:50:50,471 [INFO] - GPU cache cleared: 2520.21MB → 2520.21MB (freed 0.00MB)
2025-03-31 09:57:28,888 [INFO] - GPU cache cleared: 2519.02MB → 2519.02MB (freed 0.00MB)
2025-03-31 10:04:04,549 [INFO] - GPU cache cleared: 2515.77MB → 2515.77MB (freed 0.00MB)
2025-03-31 10:10:03,364 [INFO] - GPU cache cleared: 2521.02MB → 2521.02MB (freed 0.00MB)
2025-03-31 10:16:23,943 [INFO] - GPU cache cleared: 2522.72MB → 2522.72MB (freed 0.00MB)
2025-03-31 10:21:35,612 [INFO] - GPU cache cleared: 2522.82MB → 2522.82MB (freed 0.00MB)
2025-03-31 10:27:12,557 [INFO] - GPU cache cleared: 2523.30MB → 2523.30MB (freed 0.00MB)
2025-03-31 10:33:14,444 [INFO] - GPU cache cleared: 2524.07MB → 2524.07MB (freed 0.00MB)
2025-03-31 10:39:30,529 [INFO] - GPU cache cleared: 2523.32MB → 2523.32MB (freed 0.00MB)
2025-03-31 10:45:57,049 [INFO] - GPU cache cleared: 2523.30MB → 2523.30MB (freed 0.00MB)
2025-03-31 10:52:24,568 [INFO] - GPU cache cleared: 2521.67MB → 2521.67MB (freed 0.00MB)
2025-03-31 10:59:56,036 [INFO] - GPU cache cleared: 2521.01MB → 2521.01MB (freed 0.00MB)
2025-03-31 11:06:34,626 [INFO] - GPU cache cleared: 2522.43MB → 2522.43MB (freed 0.00MB)
2025-03-31 11:12:55,265 [INFO] - GPU cache cleared: 2521.30MB → 2521.30MB (freed 0.00MB)
2025-03-31 11:19:36,002 [INFO] - GPU cache cleared: 2522.52MB → 2522.52MB (freed 0.00MB)
2025-03-31 11:25:29,793 [INFO] - GPU cache cleared: 2522.76MB → 2522.76MB (freed 0.00MB)
2025-03-31 11:31:11,855 [INFO] - GPU cache cleared: 2523.10MB → 2523.10MB (freed 0.00MB)
2025-03-31 11:37:48,842 [INFO] - GPU cache cleared: 2521.25MB → 2521.25MB (freed 0.00MB)
2025-03-31 11:43:40,881 [INFO] -   vit: Train Loss=0.8116, Train Acc=60.46%, Val Loss=1.2001, Val Acc=57.50%, ECE=0.0175
2025-03-31 11:43:40,891 [INFO] -   New best model for vit (Val Acc: 57.50%)
2025-03-31 11:43:41,771 [INFO] -   efficientnet: Train Loss=0.1573, Train Acc=98.85%, Val Loss=0.1506, Val Acc=96.70%, ECE=0.0517
2025-03-31 11:43:41,771 [INFO] -   inception: Train Loss=0.2128, Train Acc=97.68%, Val Loss=0.1903, Val Acc=95.24%, ECE=0.0498
2025-03-31 11:43:41,771 [INFO] -   mobilenet: Train Loss=0.1928, Train Acc=98.93%, Val Loss=0.1664, Val Acc=96.36%, ECE=0.0566
2025-03-31 11:43:41,776 [INFO] -   New best model for mobilenet (Val Acc: 96.36%)
2025-03-31 11:43:42,293 [INFO] -   resnet: Train Loss=0.2152, Train Acc=96.76%, Val Loss=0.2109, Val Acc=94.76%, ECE=0.0478
2025-03-31 11:43:42,301 [INFO] -   densenet: Train Loss=0.2181, Train Acc=97.37%, Val Loss=0.1941, Val Acc=95.42%, ECE=0.0511
2025-03-31 11:43:42,301 [INFO] -   student: Train Loss=0.1492, Train Acc=98.72%, Val Loss=0.1764, Val Acc=96.84%, ECE=0.0780
2025-03-31 11:43:42,303 [INFO] - Mutual learning epoch 17 completed in 7138.39s
2025-03-31 11:43:42,303 [INFO] - Mutual Learning Epoch 18/50
2025-03-31 11:43:42,303 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-03-31 11:43:42,303 [INFO] - Current temperatures: {'vit': 4.957590579986572, 'efficientnet': 6.2967529296875, 'inception': 6.148577690124512, 'mobilenet': 6.256913185119629, 'resnet': 6.1483683586120605, 'densenet': 6.194669723510742, 'student': 5.616356372833252}
2025-03-31 11:43:42,587 [INFO] - GPU cache cleared: 2446.79MB → 2446.79MB (freed 0.00MB)
2025-03-31 11:43:48,891 [INFO] - GPU cache cleared: 2518.68MB → 2518.68MB (freed 0.00MB)
2025-03-31 11:49:38,800 [INFO] - GPU cache cleared: 2519.61MB → 2519.61MB (freed 0.00MB)
2025-03-31 11:56:05,473 [INFO] - GPU cache cleared: 2524.06MB → 2524.06MB (freed 0.00MB)
2025-03-31 12:02:27,480 [INFO] - GPU cache cleared: 2521.01MB → 2521.01MB (freed 0.00MB)
2025-03-31 12:09:33,623 [INFO] - GPU cache cleared: 2520.68MB → 2520.68MB (freed 0.00MB)
2025-03-31 12:15:53,465 [INFO] - GPU cache cleared: 2518.81MB → 2518.81MB (freed 0.00MB)
2025-03-31 12:23:07,906 [INFO] - GPU cache cleared: 2520.25MB → 2520.25MB (freed 0.00MB)
2025-03-31 12:30:18,500 [INFO] - GPU cache cleared: 2517.68MB → 2517.68MB (freed 0.00MB)
2025-03-31 12:37:06,121 [INFO] - GPU cache cleared: 2519.96MB → 2519.96MB (freed 0.00MB)
2025-03-31 12:43:12,282 [INFO] - GPU cache cleared: 2519.88MB → 2519.88MB (freed 0.00MB)
2025-03-31 12:50:23,396 [INFO] - GPU cache cleared: 2524.44MB → 2524.44MB (freed 0.00MB)
2025-03-31 12:56:40,075 [INFO] - GPU cache cleared: 2517.28MB → 2517.28MB (freed 0.00MB)
2025-03-31 13:04:11,509 [INFO] - GPU cache cleared: 2519.85MB → 2519.85MB (freed 0.00MB)
2025-03-31 13:10:02,081 [INFO] - GPU cache cleared: 2518.90MB → 2518.90MB (freed 0.00MB)
2025-03-31 13:16:05,739 [INFO] - GPU cache cleared: 2520.17MB → 2520.17MB (freed 0.00MB)
2025-03-31 13:21:13,717 [INFO] - GPU cache cleared: 2519.30MB → 2519.30MB (freed 0.00MB)
2025-03-31 13:27:44,410 [INFO] - GPU cache cleared: 2518.82MB → 2518.82MB (freed 0.00MB)
2025-03-31 13:33:38,284 [INFO] - GPU cache cleared: 2520.29MB → 2520.29MB (freed 0.00MB)
2025-03-31 13:40:09,553 [INFO] - GPU cache cleared: 2524.15MB → 2524.15MB (freed 0.00MB)
2025-03-31 13:47:00,823 [INFO] -   vit: Train Loss=0.8034, Train Acc=60.66%, Val Loss=1.1901, Val Acc=57.60%, ECE=0.0162
2025-03-31 13:47:00,829 [INFO] -   New best model for vit (Val Acc: 57.60%)
2025-03-31 13:47:01,512 [INFO] -   efficientnet: Train Loss=0.1566, Train Acc=98.75%, Val Loss=0.1453, Val Acc=96.92%, ECE=0.0505
2025-03-31 13:47:01,512 [INFO] -   inception: Train Loss=0.2117, Train Acc=97.57%, Val Loss=0.1864, Val Acc=95.50%, ECE=0.0568
2025-03-31 13:47:01,512 [INFO] -   mobilenet: Train Loss=0.1910, Train Acc=98.86%, Val Loss=0.1652, Val Acc=96.42%, ECE=0.0546
2025-03-31 13:47:01,519 [INFO] -   New best model for mobilenet (Val Acc: 96.42%)
2025-03-31 13:47:01,629 [INFO] -   resnet: Train Loss=0.2126, Train Acc=96.74%, Val Loss=0.2001, Val Acc=95.20%, ECE=0.0524
2025-03-31 13:47:01,632 [INFO] -   densenet: Train Loss=0.2096, Train Acc=97.78%, Val Loss=0.1879, Val Acc=95.30%, ECE=0.0531
2025-03-31 13:47:01,632 [INFO] -   student: Train Loss=0.1484, Train Acc=98.70%, Val Loss=0.1637, Val Acc=96.90%, ECE=0.0732
2025-03-31 13:47:01,632 [INFO] - Mutual learning epoch 18 completed in 7399.33s
2025-03-31 13:47:01,632 [INFO] - Mutual Learning Epoch 19/50
2025-03-31 13:47:01,632 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-03-31 13:47:01,639 [INFO] - Current temperatures: {'vit': 4.956936836242676, 'efficientnet': 6.304076194763184, 'inception': 6.151226997375488, 'mobilenet': 6.268160820007324, 'resnet': 6.1476664543151855, 'densenet': 6.19636344909668, 'student': 5.662326335906982}
2025-03-31 13:47:01,916 [INFO] - GPU cache cleared: 2445.18MB → 2445.18MB (freed 0.00MB)
2025-03-31 13:47:07,152 [INFO] - GPU cache cleared: 2518.89MB → 2518.89MB (freed 0.00MB)
2025-03-31 13:52:45,531 [INFO] - GPU cache cleared: 2524.10MB → 2524.10MB (freed 0.00MB)
2025-03-31 13:58:23,011 [INFO] - GPU cache cleared: 2519.61MB → 2519.61MB (freed 0.00MB)
2025-03-31 14:03:49,185 [INFO] - GPU cache cleared: 2519.96MB → 2519.96MB (freed 0.00MB)
2025-03-31 14:09:52,131 [INFO] - GPU cache cleared: 2521.97MB → 2521.97MB (freed 0.00MB)
2025-03-31 14:15:21,237 [INFO] - GPU cache cleared: 2517.88MB → 2517.88MB (freed 0.00MB)
2025-03-31 14:20:12,095 [INFO] - GPU cache cleared: 2523.00MB → 2523.00MB (freed 0.00MB)
2025-03-31 14:25:24,647 [INFO] - GPU cache cleared: 2522.54MB → 2522.54MB (freed 0.00MB)
2025-03-31 14:32:03,025 [INFO] - GPU cache cleared: 2521.35MB → 2521.35MB (freed 0.00MB)
2025-03-31 14:37:45,555 [INFO] - GPU cache cleared: 2518.69MB → 2518.69MB (freed 0.00MB)
2025-03-31 14:43:47,474 [INFO] - GPU cache cleared: 2521.12MB → 2521.12MB (freed 0.00MB)
2025-03-31 14:49:29,217 [INFO] - GPU cache cleared: 2518.95MB → 2518.95MB (freed 0.00MB)
2025-03-31 14:56:13,114 [INFO] - GPU cache cleared: 2519.67MB → 2519.67MB (freed 0.00MB)
2025-03-31 15:02:28,668 [INFO] - GPU cache cleared: 2519.54MB → 2519.54MB (freed 0.00MB)
2025-03-31 15:08:29,496 [INFO] - GPU cache cleared: 2517.45MB → 2517.45MB (freed 0.00MB)
2025-03-31 15:14:27,900 [INFO] - GPU cache cleared: 2518.26MB → 2518.26MB (freed 0.00MB)
2025-03-31 15:21:50,994 [INFO] - GPU cache cleared: 2521.16MB → 2521.16MB (freed 0.00MB)
2025-03-31 15:28:17,298 [INFO] - GPU cache cleared: 2519.31MB → 2519.31MB (freed 0.00MB)
2025-03-31 15:35:05,903 [INFO] - GPU cache cleared: 2520.68MB → 2520.68MB (freed 0.00MB)
2025-03-31 15:42:33,906 [INFO] -   vit: Train Loss=0.7972, Train Acc=60.77%, Val Loss=1.1876, Val Acc=58.00%, ECE=0.0189
2025-03-31 15:42:33,912 [INFO] -   New best model for vit (Val Acc: 58.00%)
2025-03-31 15:42:34,632 [INFO] -   efficientnet: Train Loss=0.1555, Train Acc=98.70%, Val Loss=0.1460, Val Acc=97.08%, ECE=0.0538
2025-03-31 15:42:34,636 [INFO] -   New best model for efficientnet (Val Acc: 97.08%)
2025-03-31 15:42:34,751 [INFO] -   inception: Train Loss=0.2087, Train Acc=97.73%, Val Loss=0.1899, Val Acc=95.40%, ECE=0.0541
2025-03-31 15:42:34,751 [INFO] -   mobilenet: Train Loss=0.1898, Train Acc=98.85%, Val Loss=0.1664, Val Acc=96.32%, ECE=0.0545
2025-03-31 15:42:34,754 [INFO] -   resnet: Train Loss=0.2108, Train Acc=96.69%, Val Loss=0.2113, Val Acc=94.78%, ECE=0.0487
2025-03-31 15:42:34,756 [INFO] -   densenet: Train Loss=0.2070, Train Acc=97.78%, Val Loss=0.1959, Val Acc=95.38%, ECE=0.0569
2025-03-31 15:42:34,756 [INFO] -   student: Train Loss=0.1460, Train Acc=98.68%, Val Loss=0.1694, Val Acc=96.86%, ECE=0.0715
2025-03-31 15:42:34,756 [INFO] - Mutual learning epoch 19 completed in 6933.12s
2025-03-31 15:42:34,756 [INFO] - Mutual Learning Epoch 20/50
2025-03-31 15:42:34,756 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-03-31 15:42:34,764 [INFO] - Current temperatures: {'vit': 4.956627368927002, 'efficientnet': 6.30299186706543, 'inception': 6.14939546585083, 'mobilenet': 6.271629810333252, 'resnet': 6.140398025512695, 'densenet': 6.19165563583374, 'student': 5.703344821929932}
2025-03-31 15:42:35,031 [INFO] - GPU cache cleared: 2444.71MB → 2444.71MB (freed 0.00MB)
2025-03-31 15:42:40,980 [INFO] - GPU cache cleared: 2518.85MB → 2518.85MB (freed 0.00MB)
2025-03-31 15:48:07,385 [INFO] - GPU cache cleared: 2522.33MB → 2522.33MB (freed 0.00MB)
2025-03-31 15:53:45,627 [INFO] - GPU cache cleared: 2518.43MB → 2518.43MB (freed 0.00MB)
2025-03-31 15:58:22,144 [INFO] - GPU cache cleared: 2520.38MB → 2520.38MB (freed 0.00MB)
2025-03-31 16:05:00,516 [INFO] - GPU cache cleared: 2519.11MB → 2519.11MB (freed 0.00MB)
2025-03-31 16:11:19,309 [INFO] - GPU cache cleared: 2516.88MB → 2516.88MB (freed 0.00MB)
2025-03-31 16:18:32,084 [INFO] - GPU cache cleared: 2519.98MB → 2519.98MB (freed 0.00MB)
2025-03-31 16:24:29,930 [INFO] - GPU cache cleared: 2521.51MB → 2521.51MB (freed 0.00MB)
2025-03-31 16:31:15,659 [INFO] - GPU cache cleared: 2522.07MB → 2522.07MB (freed 0.00MB)
2025-03-31 16:36:15,549 [INFO] - GPU cache cleared: 2519.17MB → 2519.17MB (freed 0.00MB)
2025-03-31 16:41:22,165 [INFO] - GPU cache cleared: 2518.96MB → 2518.96MB (freed 0.00MB)
2025-03-31 16:46:15,637 [INFO] - GPU cache cleared: 2521.40MB → 2521.40MB (freed 0.00MB)
2025-03-31 16:51:57,752 [INFO] - GPU cache cleared: 2524.63MB → 2524.63MB (freed 0.00MB)
2025-03-31 16:57:08,906 [INFO] - GPU cache cleared: 2522.83MB → 2522.83MB (freed 0.00MB)
2025-03-31 17:02:05,590 [INFO] - GPU cache cleared: 2520.43MB → 2520.43MB (freed 0.00MB)
2025-03-31 17:07:45,839 [INFO] - GPU cache cleared: 2521.53MB → 2521.53MB (freed 0.00MB)
2025-03-31 17:14:02,276 [INFO] - GPU cache cleared: 2521.04MB → 2521.04MB (freed 0.00MB)
2025-03-31 17:20:19,486 [INFO] - GPU cache cleared: 2521.32MB → 2521.32MB (freed 0.00MB)
2025-03-31 17:26:25,770 [INFO] - GPU cache cleared: 2520.77MB → 2520.77MB (freed 0.00MB)
2025-03-31 17:34:58,232 [INFO] -   vit: Train Loss=0.7920, Train Acc=61.21%, Val Loss=1.1853, Val Acc=57.76%, ECE=0.0197
2025-03-31 17:34:58,233 [INFO] -   efficientnet: Train Loss=0.1546, Train Acc=98.68%, Val Loss=0.1471, Val Acc=96.98%, ECE=0.0519
2025-03-31 17:34:58,235 [INFO] -   inception: Train Loss=0.2073, Train Acc=97.80%, Val Loss=0.1936, Val Acc=95.50%, ECE=0.0584
2025-03-31 17:34:58,237 [INFO] -   mobilenet: Train Loss=0.1878, Train Acc=98.89%, Val Loss=0.1662, Val Acc=96.16%, ECE=0.0523
2025-03-31 17:34:58,240 [INFO] -   resnet: Train Loss=0.2073, Train Acc=96.93%, Val Loss=0.2119, Val Acc=95.02%, ECE=0.0508
2025-03-31 17:34:58,243 [INFO] -   densenet: Train Loss=0.2048, Train Acc=97.93%, Val Loss=0.1885, Val Acc=95.56%, ECE=0.0535
2025-03-31 17:34:58,245 [INFO] -   student: Train Loss=0.1456, Train Acc=98.71%, Val Loss=0.1698, Val Acc=96.64%, ECE=0.0709
2025-03-31 17:35:00,452 [INFO] - Mutual learning epoch 20 completed in 6745.70s
2025-03-31 17:35:00,452 [INFO] - Mutual Learning Epoch 21/50
2025-03-31 17:35:00,452 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-03-31 17:35:00,452 [INFO] - Current temperatures: {'vit': 4.956321716308594, 'efficientnet': 6.305368900299072, 'inception': 6.14829683303833, 'mobilenet': 6.275966167449951, 'resnet': 6.13931131362915, 'densenet': 6.189357757568359, 'student': 5.741439342498779}
2025-03-31 17:35:00,737 [INFO] - GPU cache cleared: 2444.16MB → 2444.16MB (freed 0.00MB)
2025-03-31 17:35:07,304 [INFO] - GPU cache cleared: 2517.08MB → 2517.08MB (freed 0.00MB)
2025-03-31 17:40:56,665 [INFO] - GPU cache cleared: 2521.53MB → 2521.53MB (freed 0.00MB)
2025-03-31 17:47:47,674 [INFO] - GPU cache cleared: 2520.95MB → 2520.95MB (freed 0.00MB)
2025-03-31 17:53:48,492 [INFO] - GPU cache cleared: 2520.14MB → 2520.14MB (freed 0.00MB)
2025-03-31 18:00:06,349 [INFO] - GPU cache cleared: 2522.26MB → 2522.26MB (freed 0.00MB)
2025-03-31 18:06:13,912 [INFO] - GPU cache cleared: 2521.50MB → 2521.50MB (freed 0.00MB)
2025-03-31 18:12:11,936 [INFO] - GPU cache cleared: 2519.24MB → 2519.24MB (freed 0.00MB)
2025-03-31 18:17:11,525 [INFO] - GPU cache cleared: 2522.77MB → 2522.77MB (freed 0.00MB)
2025-03-31 18:23:12,895 [INFO] - GPU cache cleared: 2519.07MB → 2519.07MB (freed 0.00MB)
2025-03-31 18:29:20,724 [INFO] - GPU cache cleared: 2520.32MB → 2520.32MB (freed 0.00MB)
2025-03-31 18:35:25,573 [INFO] - GPU cache cleared: 2521.78MB → 2521.78MB (freed 0.00MB)
2025-03-31 18:40:54,532 [INFO] - GPU cache cleared: 2523.80MB → 2523.80MB (freed 0.00MB)
2025-03-31 18:48:07,749 [INFO] - GPU cache cleared: 2521.68MB → 2521.68MB (freed 0.00MB)
2025-03-31 18:54:51,523 [INFO] - GPU cache cleared: 2517.00MB → 2517.00MB (freed 0.00MB)
2025-03-31 19:01:27,130 [INFO] - GPU cache cleared: 2521.83MB → 2521.83MB (freed 0.00MB)
2025-03-31 19:07:33,650 [INFO] - GPU cache cleared: 2520.44MB → 2520.44MB (freed 0.00MB)
2025-03-31 19:13:32,840 [INFO] - GPU cache cleared: 2520.14MB → 2520.14MB (freed 0.00MB)
2025-03-31 19:19:11,462 [INFO] - GPU cache cleared: 2520.87MB → 2520.87MB (freed 0.00MB)
2025-03-31 19:26:10,278 [INFO] - GPU cache cleared: 2519.80MB → 2519.80MB (freed 0.00MB)
2025-03-31 19:35:17,177 [INFO] -   vit: Train Loss=0.7900, Train Acc=61.02%, Val Loss=1.1781, Val Acc=58.04%, ECE=0.0191
2025-03-31 19:35:17,184 [INFO] -   New best model for vit (Val Acc: 58.04%)
2025-03-31 19:35:18,055 [INFO] -   efficientnet: Train Loss=0.1516, Train Acc=98.77%, Val Loss=0.1493, Val Acc=96.72%, ECE=0.0530
2025-03-31 19:35:18,055 [INFO] -   inception: Train Loss=0.2034, Train Acc=97.93%, Val Loss=0.1840, Val Acc=95.88%, ECE=0.0547
2025-03-31 19:35:18,062 [INFO] -   New best model for inception (Val Acc: 95.88%)
2025-03-31 19:35:18,395 [INFO] -   mobilenet: Train Loss=0.1851, Train Acc=98.91%, Val Loss=0.1669, Val Acc=96.18%, ECE=0.0541
2025-03-31 19:35:18,395 [INFO] -   resnet: Train Loss=0.2033, Train Acc=97.06%, Val Loss=0.2146, Val Acc=94.52%, ECE=0.0472
2025-03-31 19:35:18,402 [INFO] -   densenet: Train Loss=0.2008, Train Acc=98.00%, Val Loss=0.1831, Val Acc=95.66%, ECE=0.0505
2025-03-31 19:35:18,405 [INFO] -   student: Train Loss=0.1431, Train Acc=98.81%, Val Loss=0.1672, Val Acc=96.88%, ECE=0.0699
2025-03-31 19:35:18,405 [INFO] - Mutual learning epoch 21 completed in 7217.95s
2025-03-31 19:35:18,405 [INFO] - Mutual Learning Epoch 22/50
2025-03-31 19:35:18,405 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-03-31 19:35:18,405 [INFO] - Current temperatures: {'vit': 4.956027507781982, 'efficientnet': 6.306436538696289, 'inception': 6.151725769042969, 'mobilenet': 6.280742168426514, 'resnet': 6.140357494354248, 'densenet': 6.1904072761535645, 'student': 5.7770562171936035}
2025-03-31 19:35:18,675 [INFO] - GPU cache cleared: 2444.58MB → 2444.58MB (freed 0.00MB)
2025-03-31 19:35:24,966 [INFO] - GPU cache cleared: 2520.28MB → 2520.28MB (freed 0.00MB)
2025-03-31 19:41:57,924 [INFO] - GPU cache cleared: 2523.10MB → 2523.10MB (freed 0.00MB)
2025-03-31 19:48:58,533 [INFO] - GPU cache cleared: 2517.17MB → 2517.17MB (freed 0.00MB)
2025-03-31 19:55:12,238 [INFO] - GPU cache cleared: 2523.68MB → 2523.68MB (freed 0.00MB)
2025-03-31 20:02:16,631 [INFO] - GPU cache cleared: 2522.64MB → 2522.64MB (freed 0.00MB)
2025-03-31 20:08:08,640 [INFO] - GPU cache cleared: 2524.26MB → 2524.26MB (freed 0.00MB)
2025-03-31 20:16:07,319 [INFO] - GPU cache cleared: 2518.97MB → 2518.97MB (freed 0.00MB)
2025-03-31 20:21:49,505 [INFO] - GPU cache cleared: 2524.68MB → 2524.68MB (freed 0.00MB)
2025-03-31 20:27:44,807 [INFO] - GPU cache cleared: 2519.81MB → 2519.81MB (freed 0.00MB)
2025-03-31 20:34:04,407 [INFO] - GPU cache cleared: 2518.60MB → 2518.60MB (freed 0.00MB)
2025-03-31 20:42:23,333 [INFO] - GPU cache cleared: 2520.69MB → 2520.69MB (freed 0.00MB)
2025-03-31 20:50:31,833 [INFO] - GPU cache cleared: 2522.29MB → 2522.29MB (freed 0.00MB)
2025-03-31 21:00:17,597 [INFO] - GPU cache cleared: 2520.65MB → 2520.65MB (freed 0.00MB)
2025-03-31 21:08:31,320 [INFO] - GPU cache cleared: 2517.03MB → 2517.03MB (freed 0.00MB)
2025-03-31 21:15:04,815 [INFO] - GPU cache cleared: 2523.96MB → 2523.96MB (freed 0.00MB)
2025-03-31 21:21:28,405 [INFO] - GPU cache cleared: 2521.47MB → 2521.47MB (freed 0.00MB)
2025-03-31 21:29:15,698 [INFO] - GPU cache cleared: 2521.08MB → 2521.08MB (freed 0.00MB)
2025-03-31 21:36:32,954 [INFO] - GPU cache cleared: 2520.17MB → 2520.17MB (freed 0.00MB)
2025-03-31 21:44:14,116 [INFO] - GPU cache cleared: 2520.77MB → 2520.77MB (freed 0.00MB)
2025-03-31 21:52:56,436 [INFO] -   vit: Train Loss=0.7844, Train Acc=61.84%, Val Loss=1.1725, Val Acc=58.46%, ECE=0.0163
2025-03-31 21:52:56,452 [INFO] -   New best model for vit (Val Acc: 58.46%)
2025-03-31 21:52:57,250 [INFO] -   efficientnet: Train Loss=0.1483, Train Acc=98.85%, Val Loss=0.1444, Val Acc=97.28%, ECE=0.0573
2025-03-31 21:52:57,255 [INFO] -   New best model for efficientnet (Val Acc: 97.28%)
2025-03-31 21:52:57,380 [INFO] -   inception: Train Loss=0.1974, Train Acc=98.15%, Val Loss=0.2014, Val Acc=95.38%, ECE=0.0536
2025-03-31 21:52:57,380 [INFO] -   mobilenet: Train Loss=0.1819, Train Acc=99.01%, Val Loss=0.1798, Val Acc=95.80%, ECE=0.0473
2025-03-31 21:52:57,390 [INFO] -   resnet: Train Loss=0.1971, Train Acc=97.28%, Val Loss=0.2170, Val Acc=94.96%, ECE=0.0544
2025-03-31 21:52:57,390 [INFO] -   densenet: Train Loss=0.1972, Train Acc=98.05%, Val Loss=0.1887, Val Acc=95.84%, ECE=0.0512
2025-03-31 21:52:57,390 [INFO] -   student: Train Loss=0.1404, Train Acc=98.86%, Val Loss=0.1630, Val Acc=96.82%, ECE=0.0668
2025-03-31 21:52:57,390 [INFO] - Mutual learning epoch 22 completed in 8258.98s
2025-03-31 21:52:57,390 [INFO] - Mutual Learning Epoch 23/50
2025-03-31 21:52:57,390 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-03-31 21:52:57,420 [INFO] - Current temperatures: {'vit': 4.955681800842285, 'efficientnet': 6.310364723205566, 'inception': 6.157419681549072, 'mobilenet': 6.286093711853027, 'resnet': 6.1469855308532715, 'densenet': 6.193866729736328, 'student': 5.810509204864502}
2025-03-31 21:52:57,769 [INFO] - GPU cache cleared: 2443.42MB → 2443.42MB (freed 0.00MB)
2025-03-31 21:53:04,280 [INFO] - GPU cache cleared: 2519.38MB → 2519.38MB (freed 0.00MB)
2025-03-31 21:59:17,534 [INFO] - GPU cache cleared: 2519.32MB → 2519.32MB (freed 0.00MB)
2025-03-31 22:05:51,358 [INFO] - GPU cache cleared: 2520.39MB → 2520.39MB (freed 0.00MB)
2025-03-31 22:11:20,902 [INFO] - GPU cache cleared: 2520.04MB → 2520.04MB (freed 0.00MB)
2025-03-31 22:17:46,111 [INFO] - GPU cache cleared: 2519.90MB → 2519.90MB (freed 0.00MB)
2025-03-31 22:23:53,326 [INFO] - GPU cache cleared: 2519.66MB → 2519.66MB (freed 0.00MB)
2025-03-31 22:30:29,426 [INFO] - GPU cache cleared: 2523.01MB → 2523.01MB (freed 0.00MB)
2025-03-31 22:36:03,933 [INFO] - GPU cache cleared: 2520.01MB → 2520.01MB (freed 0.00MB)
2025-03-31 22:41:59,444 [INFO] - GPU cache cleared: 2522.00MB → 2522.00MB (freed 0.00MB)
2025-03-31 22:48:18,722 [INFO] - GPU cache cleared: 2521.97MB → 2521.97MB (freed 0.00MB)
2025-03-31 22:58:27,597 [INFO] - GPU cache cleared: 2523.08MB → 2523.08MB (freed 0.00MB)
2025-03-31 23:08:10,802 [INFO] - GPU cache cleared: 2518.39MB → 2518.39MB (freed 0.00MB)
2025-03-31 23:14:53,868 [INFO] - GPU cache cleared: 2518.42MB → 2518.42MB (freed 0.00MB)
2025-03-31 23:21:41,623 [INFO] - GPU cache cleared: 2522.66MB → 2522.66MB (freed 0.00MB)
2025-03-31 23:28:26,891 [INFO] - GPU cache cleared: 2524.08MB → 2524.08MB (freed 0.00MB)
2025-03-31 23:35:15,750 [INFO] - GPU cache cleared: 2518.29MB → 2518.29MB (freed 0.00MB)
2025-03-31 23:41:46,659 [INFO] - GPU cache cleared: 2521.95MB → 2521.95MB (freed 0.00MB)
2025-03-31 23:48:11,747 [INFO] - GPU cache cleared: 2519.77MB → 2519.77MB (freed 0.00MB)
2025-03-31 23:54:31,827 [INFO] - GPU cache cleared: 2521.58MB → 2521.58MB (freed 0.00MB)
2025-04-01 00:01:40,628 [INFO] -   vit: Train Loss=0.7780, Train Acc=61.95%, Val Loss=1.1648, Val Acc=58.60%, ECE=0.0189
2025-04-01 00:01:40,645 [INFO] -   New best model for vit (Val Acc: 58.60%)
2025-04-01 00:01:41,273 [INFO] -   efficientnet: Train Loss=0.1471, Train Acc=98.91%, Val Loss=0.1453, Val Acc=96.90%, ECE=0.0499
2025-04-01 00:01:41,273 [INFO] -   inception: Train Loss=0.1955, Train Acc=98.20%, Val Loss=0.1877, Val Acc=95.94%, ECE=0.0555
2025-04-01 00:01:41,282 [INFO] -   New best model for inception (Val Acc: 95.94%)
2025-04-01 00:01:41,512 [INFO] -   mobilenet: Train Loss=0.1805, Train Acc=99.03%, Val Loss=0.1634, Val Acc=96.36%, ECE=0.0522
2025-04-01 00:01:41,513 [INFO] -   resnet: Train Loss=0.1956, Train Acc=97.35%, Val Loss=0.2113, Val Acc=94.72%, ECE=0.0505
2025-04-01 00:01:41,513 [INFO] -   densenet: Train Loss=0.1955, Train Acc=98.03%, Val Loss=0.1835, Val Acc=96.02%, ECE=0.0514
2025-04-01 00:01:41,522 [INFO] -   New best model for densenet (Val Acc: 96.02%)
2025-04-01 00:01:41,705 [INFO] -   student: Train Loss=0.1398, Train Acc=98.86%, Val Loss=0.1628, Val Acc=96.78%, ECE=0.0627
2025-04-01 00:01:41,705 [INFO] - Mutual learning epoch 23 completed in 7724.32s
2025-04-01 00:01:41,705 [INFO] - Mutual Learning Epoch 24/50
2025-04-01 00:01:41,712 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-01 00:01:41,715 [INFO] - Current temperatures: {'vit': 4.955401420593262, 'efficientnet': 6.314581871032715, 'inception': 6.1632490158081055, 'mobilenet': 6.2920756340026855, 'resnet': 6.152327537536621, 'densenet': 6.19687032699585, 'student': 5.841635227203369}
2025-04-01 00:01:41,966 [INFO] - GPU cache cleared: 2447.53MB → 2447.53MB (freed 0.00MB)
2025-04-01 00:01:46,972 [INFO] - GPU cache cleared: 2518.86MB → 2518.86MB (freed 0.00MB)
2025-04-01 00:07:29,372 [INFO] - GPU cache cleared: 2522.13MB → 2522.13MB (freed 0.00MB)
2025-04-01 00:13:06,186 [INFO] - GPU cache cleared: 2518.28MB → 2518.28MB (freed 0.00MB)
2025-04-01 00:18:58,548 [INFO] - GPU cache cleared: 2520.69MB → 2520.69MB (freed 0.00MB)
2025-04-01 00:24:37,045 [INFO] - GPU cache cleared: 2521.42MB → 2521.42MB (freed 0.00MB)
2025-04-01 00:30:15,908 [INFO] - GPU cache cleared: 2521.08MB → 2521.08MB (freed 0.00MB)
2025-04-01 00:36:05,018 [INFO] - GPU cache cleared: 2521.79MB → 2521.79MB (freed 0.00MB)
2025-04-01 00:41:35,008 [INFO] - GPU cache cleared: 2521.61MB → 2521.61MB (freed 0.00MB)
2025-04-01 00:47:45,452 [INFO] - GPU cache cleared: 2520.29MB → 2520.29MB (freed 0.00MB)
2025-04-01 00:53:17,499 [INFO] - GPU cache cleared: 2516.78MB → 2516.78MB (freed 0.00MB)
2025-04-01 00:59:38,852 [INFO] - GPU cache cleared: 2522.67MB → 2522.67MB (freed 0.00MB)
2025-04-01 01:05:19,909 [INFO] - GPU cache cleared: 2518.55MB → 2518.55MB (freed 0.00MB)
2025-04-01 01:11:29,279 [INFO] - GPU cache cleared: 2520.53MB → 2520.53MB (freed 0.00MB)
2025-04-01 01:17:23,580 [INFO] - GPU cache cleared: 2517.22MB → 2517.22MB (freed 0.00MB)
2025-04-01 01:24:20,007 [INFO] - GPU cache cleared: 2517.54MB → 2517.54MB (freed 0.00MB)
2025-04-01 01:29:35,880 [INFO] - GPU cache cleared: 2521.38MB → 2521.38MB (freed 0.00MB)
2025-04-01 01:35:20,912 [INFO] - GPU cache cleared: 2521.13MB → 2521.13MB (freed 0.00MB)
2025-04-01 01:40:55,269 [INFO] - GPU cache cleared: 2518.66MB → 2518.66MB (freed 0.00MB)
2025-04-01 01:46:51,252 [INFO] - GPU cache cleared: 2520.20MB → 2520.20MB (freed 0.00MB)
2025-04-01 01:53:57,832 [INFO] -   vit: Train Loss=0.7748, Train Acc=62.06%, Val Loss=1.1640, Val Acc=59.02%, ECE=0.0190
2025-04-01 01:53:57,838 [INFO] -   New best model for vit (Val Acc: 59.02%)
2025-04-01 01:53:58,577 [INFO] -   efficientnet: Train Loss=0.1448, Train Acc=98.89%, Val Loss=0.1457, Val Acc=96.94%, ECE=0.0486
2025-04-01 01:53:58,577 [INFO] -   inception: Train Loss=0.1934, Train Acc=98.19%, Val Loss=0.1896, Val Acc=95.66%, ECE=0.0490
2025-04-01 01:53:58,577 [INFO] -   mobilenet: Train Loss=0.1765, Train Acc=99.12%, Val Loss=0.1616, Val Acc=96.46%, ECE=0.0503
2025-04-01 01:53:58,588 [INFO] -   New best model for mobilenet (Val Acc: 96.46%)
2025-04-01 01:53:58,714 [INFO] -   resnet: Train Loss=0.1874, Train Acc=97.68%, Val Loss=0.1972, Val Acc=95.18%, ECE=0.0484
2025-04-01 01:53:58,717 [INFO] -   densenet: Train Loss=0.1885, Train Acc=98.41%, Val Loss=0.1783, Val Acc=96.18%, ECE=0.0550
2025-04-01 01:53:58,717 [INFO] -   New best model for densenet (Val Acc: 96.18%)
2025-04-01 01:53:58,999 [INFO] -   student: Train Loss=0.1377, Train Acc=98.91%, Val Loss=0.1620, Val Acc=97.06%, ECE=0.0675
2025-04-01 01:53:58,999 [INFO] - Mutual learning epoch 24 completed in 6737.29s
2025-04-01 01:53:58,999 [INFO] - Mutual Learning Epoch 25/50
2025-04-01 01:53:58,999 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-01 01:53:58,999 [INFO] - Current temperatures: {'vit': 4.955089569091797, 'efficientnet': 6.31821870803833, 'inception': 6.169696807861328, 'mobilenet': 6.299089431762695, 'resnet': 6.162939548492432, 'densenet': 6.206345558166504, 'student': 5.870809555053711}
2025-04-01 01:53:59,298 [INFO] - GPU cache cleared: 2442.56MB → 2442.56MB (freed 0.00MB)
2025-04-01 01:54:04,541 [INFO] - GPU cache cleared: 2519.43MB → 2519.43MB (freed 0.00MB)
2025-04-01 01:59:59,456 [INFO] - GPU cache cleared: 2519.39MB → 2519.39MB (freed 0.00MB)
2025-04-01 02:06:18,759 [INFO] - GPU cache cleared: 2520.48MB → 2520.48MB (freed 0.00MB)
2025-04-01 02:12:46,555 [INFO] - GPU cache cleared: 2521.06MB → 2521.06MB (freed 0.00MB)
2025-04-01 02:18:50,024 [INFO] - GPU cache cleared: 2519.23MB → 2519.23MB (freed 0.00MB)
2025-04-01 02:24:33,165 [INFO] - GPU cache cleared: 2517.86MB → 2517.86MB (freed 0.00MB)
2025-04-01 02:30:37,330 [INFO] - GPU cache cleared: 2518.78MB → 2518.78MB (freed 0.00MB)
2025-04-01 02:36:53,776 [INFO] - GPU cache cleared: 2518.45MB → 2518.45MB (freed 0.00MB)
2025-04-01 02:43:06,252 [INFO] - GPU cache cleared: 2516.56MB → 2516.56MB (freed 0.00MB)
2025-04-01 02:49:42,529 [INFO] - GPU cache cleared: 2516.93MB → 2516.93MB (freed 0.00MB)
2025-04-01 02:55:58,772 [INFO] - GPU cache cleared: 2519.22MB → 2519.22MB (freed 0.00MB)
2025-04-01 03:02:02,228 [INFO] - GPU cache cleared: 2518.14MB → 2518.14MB (freed 0.00MB)
2025-04-01 03:07:45,787 [INFO] - GPU cache cleared: 2522.91MB → 2522.91MB (freed 0.00MB)
2025-04-01 03:13:27,691 [INFO] - GPU cache cleared: 2517.72MB → 2517.72MB (freed 0.00MB)
2025-04-01 03:20:06,900 [INFO] - GPU cache cleared: 2520.32MB → 2520.32MB (freed 0.00MB)
2025-04-01 03:25:50,424 [INFO] - GPU cache cleared: 2522.92MB → 2522.92MB (freed 0.00MB)
2025-04-01 03:31:34,299 [INFO] - GPU cache cleared: 2520.79MB → 2520.79MB (freed 0.00MB)
2025-04-01 03:36:52,293 [INFO] - GPU cache cleared: 2519.39MB → 2519.39MB (freed 0.00MB)
2025-04-01 03:42:41,732 [INFO] - GPU cache cleared: 2515.69MB → 2515.69MB (freed 0.00MB)
2025-04-01 03:48:07,844 [INFO] -   vit: Train Loss=0.7717, Train Acc=62.02%, Val Loss=1.1636, Val Acc=58.36%, ECE=0.0262
2025-04-01 03:48:07,845 [INFO] -   efficientnet: Train Loss=0.1419, Train Acc=99.04%, Val Loss=0.1474, Val Acc=96.94%, ECE=0.0520
2025-04-01 03:48:07,848 [INFO] -   inception: Train Loss=0.1926, Train Acc=98.25%, Val Loss=0.1842, Val Acc=96.04%, ECE=0.0547
2025-04-01 03:48:07,854 [INFO] -   New best model for inception (Val Acc: 96.04%)
2025-04-01 03:48:08,156 [INFO] -   mobilenet: Train Loss=0.1747, Train Acc=99.14%, Val Loss=0.1621, Val Acc=96.32%, ECE=0.0508
2025-04-01 03:48:08,156 [INFO] -   resnet: Train Loss=0.1855, Train Acc=97.72%, Val Loss=0.2064, Val Acc=94.70%, ECE=0.0506
2025-04-01 03:48:08,161 [INFO] -   densenet: Train Loss=0.1876, Train Acc=98.38%, Val Loss=0.1805, Val Acc=95.80%, ECE=0.0488
2025-04-01 03:48:08,161 [INFO] -   student: Train Loss=0.1361, Train Acc=98.95%, Val Loss=0.1568, Val Acc=96.90%, ECE=0.0616
2025-04-01 03:48:08,166 [INFO] - Mutual learning epoch 25 completed in 6849.17s
2025-04-01 03:48:08,166 [INFO] - Mutual Learning Epoch 26/50
2025-04-01 03:48:08,166 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-01 03:48:08,166 [INFO] - Current temperatures: {'vit': 4.954763412475586, 'efficientnet': 6.3251752853393555, 'inception': 6.175938129425049, 'mobilenet': 6.3066630363464355, 'resnet': 6.1728057861328125, 'densenet': 6.212997913360596, 'student': 5.898502826690674}
2025-04-01 03:48:08,452 [INFO] - GPU cache cleared: 2443.35MB → 2443.35MB (freed 0.00MB)
2025-04-01 03:48:13,931 [INFO] - GPU cache cleared: 2516.10MB → 2516.10MB (freed 0.00MB)
2025-04-01 03:53:44,163 [INFO] - GPU cache cleared: 2518.50MB → 2518.50MB (freed 0.00MB)
2025-04-01 04:00:32,217 [INFO] - GPU cache cleared: 2525.06MB → 2525.06MB (freed 0.00MB)
2025-04-01 04:05:56,219 [INFO] - GPU cache cleared: 2518.98MB → 2518.98MB (freed 0.00MB)
2025-04-01 04:12:40,130 [INFO] - GPU cache cleared: 2519.13MB → 2519.13MB (freed 0.00MB)
2025-04-01 04:18:38,365 [INFO] - GPU cache cleared: 2520.60MB → 2520.60MB (freed 0.00MB)
2025-04-01 04:25:24,547 [INFO] - GPU cache cleared: 2519.26MB → 2519.26MB (freed 0.00MB)
2025-04-01 04:31:56,060 [INFO] - GPU cache cleared: 2517.69MB → 2517.69MB (freed 0.00MB)
2025-04-01 04:37:50,877 [INFO] - GPU cache cleared: 2519.42MB → 2519.42MB (freed 0.00MB)
2025-04-01 04:44:02,076 [INFO] - GPU cache cleared: 2520.84MB → 2520.84MB (freed 0.00MB)
2025-04-01 04:50:31,812 [INFO] - GPU cache cleared: 2521.97MB → 2521.97MB (freed 0.00MB)
2025-04-01 04:56:14,804 [INFO] - GPU cache cleared: 2517.72MB → 2517.72MB (freed 0.00MB)
2025-04-01 05:03:33,881 [INFO] - GPU cache cleared: 2517.29MB → 2517.29MB (freed 0.00MB)
2025-04-01 05:10:27,588 [INFO] - GPU cache cleared: 2523.78MB → 2523.78MB (freed 0.00MB)
2025-04-01 05:16:29,447 [INFO] - GPU cache cleared: 2518.87MB → 2518.87MB (freed 0.00MB)
2025-04-01 05:22:07,051 [INFO] - GPU cache cleared: 2521.48MB → 2521.48MB (freed 0.00MB)
2025-04-01 05:27:55,480 [INFO] - GPU cache cleared: 2518.20MB → 2518.20MB (freed 0.00MB)
2025-04-01 05:33:21,010 [INFO] - GPU cache cleared: 2519.21MB → 2519.21MB (freed 0.00MB)
2025-04-01 05:39:43,218 [INFO] - GPU cache cleared: 2516.33MB → 2516.33MB (freed 0.00MB)
2025-04-01 05:46:38,500 [INFO] -   vit: Train Loss=0.7663, Train Acc=62.61%, Val Loss=1.1564, Val Acc=59.26%, ECE=0.0336
2025-04-01 05:46:38,510 [INFO] -   New best model for vit (Val Acc: 59.26%)
2025-04-01 05:46:39,187 [INFO] -   efficientnet: Train Loss=0.1393, Train Acc=99.08%, Val Loss=0.1541, Val Acc=96.86%, ECE=0.0499
2025-04-01 05:46:39,187 [INFO] -   inception: Train Loss=0.1893, Train Acc=98.36%, Val Loss=0.1845, Val Acc=95.90%, ECE=0.0517
2025-04-01 05:46:39,194 [INFO] -   mobilenet: Train Loss=0.1708, Train Acc=99.32%, Val Loss=0.1658, Val Acc=96.24%, ECE=0.0484
2025-04-01 05:46:39,198 [INFO] -   resnet: Train Loss=0.1822, Train Acc=97.95%, Val Loss=0.1945, Val Acc=95.36%, ECE=0.0509
2025-04-01 05:46:39,198 [INFO] -   New best model for resnet (Val Acc: 95.36%)
2025-04-01 05:46:39,509 [INFO] -   densenet: Train Loss=0.1840, Train Acc=98.54%, Val Loss=0.1876, Val Acc=95.78%, ECE=0.0459
2025-04-01 05:46:39,509 [INFO] -   student: Train Loss=0.1339, Train Acc=98.98%, Val Loss=0.1551, Val Acc=97.12%, ECE=0.0652
2025-04-01 05:46:39,509 [INFO] -   New best model for student (Val Acc: 97.12%)
2025-04-01 05:46:39,632 [INFO] - Mutual learning epoch 26 completed in 7111.47s
2025-04-01 05:46:39,632 [INFO] - Mutual Learning Epoch 27/50
2025-04-01 05:46:39,634 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-01 05:46:39,634 [INFO] - Current temperatures: {'vit': 4.954558372497559, 'efficientnet': 6.332557201385498, 'inception': 6.181384563446045, 'mobilenet': 6.3140482902526855, 'resnet': 6.182322025299072, 'densenet': 6.220242023468018, 'student': 5.923575401306152}
2025-04-01 05:46:39,958 [INFO] - GPU cache cleared: 2443.23MB → 2443.23MB (freed 0.00MB)
2025-04-01 05:46:46,609 [INFO] - GPU cache cleared: 2518.46MB → 2518.46MB (freed 0.00MB)
2025-04-01 05:53:00,553 [INFO] - GPU cache cleared: 2521.03MB → 2521.03MB (freed 0.00MB)
2025-04-01 05:59:46,056 [INFO] - GPU cache cleared: 2521.77MB → 2521.77MB (freed 0.00MB)
2025-04-01 06:06:07,078 [INFO] - GPU cache cleared: 2520.92MB → 2520.92MB (freed 0.00MB)
2025-04-01 06:12:10,914 [INFO] - GPU cache cleared: 2521.19MB → 2521.19MB (freed 0.00MB)
2025-04-01 06:18:13,979 [INFO] - GPU cache cleared: 2519.51MB → 2519.51MB (freed 0.00MB)
2025-04-01 06:25:54,714 [INFO] - GPU cache cleared: 2518.60MB → 2518.60MB (freed 0.00MB)
2025-04-01 06:32:26,331 [INFO] - GPU cache cleared: 2519.34MB → 2519.34MB (freed 0.00MB)
2025-04-01 06:38:57,057 [INFO] - GPU cache cleared: 2520.50MB → 2520.50MB (freed 0.00MB)
2025-04-01 06:45:16,262 [INFO] - GPU cache cleared: 2519.58MB → 2519.58MB (freed 0.00MB)
2025-04-01 06:52:45,103 [INFO] - GPU cache cleared: 2517.55MB → 2517.55MB (freed 0.00MB)
2025-04-01 06:58:06,632 [INFO] - GPU cache cleared: 2521.65MB → 2521.65MB (freed 0.00MB)
2025-04-01 07:04:33,691 [INFO] - GPU cache cleared: 2518.83MB → 2518.83MB (freed 0.00MB)
2025-04-01 07:10:27,019 [INFO] - GPU cache cleared: 2517.44MB → 2517.44MB (freed 0.00MB)
2025-04-01 07:16:55,925 [INFO] - GPU cache cleared: 2520.19MB → 2520.19MB (freed 0.00MB)
2025-04-01 07:22:44,462 [INFO] - GPU cache cleared: 2516.96MB → 2516.96MB (freed 0.00MB)
2025-04-01 07:28:14,867 [INFO] - GPU cache cleared: 2517.21MB → 2517.21MB (freed 0.00MB)
2025-04-01 07:34:28,759 [INFO] - GPU cache cleared: 2520.30MB → 2520.30MB (freed 0.00MB)
2025-04-01 07:41:21,897 [INFO] - GPU cache cleared: 2519.06MB → 2519.06MB (freed 0.00MB)
2025-04-01 07:47:21,384 [INFO] -   vit: Train Loss=0.7614, Train Acc=62.92%, Val Loss=1.1487, Val Acc=59.06%, ECE=0.0254
2025-04-01 07:47:21,391 [INFO] -   efficientnet: Train Loss=0.1371, Train Acc=99.11%, Val Loss=0.1359, Val Acc=97.18%, ECE=0.0494
2025-04-01 07:47:21,394 [INFO] -   inception: Train Loss=0.1827, Train Acc=98.63%, Val Loss=0.1729, Val Acc=96.08%, ECE=0.0528
2025-04-01 07:47:21,401 [INFO] -   New best model for inception (Val Acc: 96.08%)
2025-04-01 07:47:21,735 [INFO] -   mobilenet: Train Loss=0.1690, Train Acc=99.28%, Val Loss=0.1675, Val Acc=96.06%, ECE=0.0471
2025-04-01 07:47:21,736 [INFO] -   resnet: Train Loss=0.1752, Train Acc=98.16%, Val Loss=0.2016, Val Acc=95.30%, ECE=0.0489
2025-04-01 07:47:21,736 [INFO] -   densenet: Train Loss=0.1794, Train Acc=98.68%, Val Loss=0.1774, Val Acc=95.90%, ECE=0.0435
2025-04-01 07:47:21,736 [INFO] -   student: Train Loss=0.1309, Train Acc=99.04%, Val Loss=0.1532, Val Acc=97.10%, ECE=0.0587
2025-04-01 07:47:21,741 [INFO] - Mutual learning epoch 27 completed in 7242.11s
2025-04-01 07:47:21,743 [INFO] - Mutual Learning Epoch 28/50
2025-04-01 07:47:21,743 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-01 07:47:21,746 [INFO] - Current temperatures: {'vit': 4.954317569732666, 'efficientnet': 6.337780952453613, 'inception': 6.190462589263916, 'mobilenet': 6.321191310882568, 'resnet': 6.194355487823486, 'densenet': 6.228843688964844, 'student': 5.947007179260254}
2025-04-01 07:47:22,036 [INFO] - GPU cache cleared: 2449.90MB → 2449.90MB (freed 0.00MB)
2025-04-01 07:47:26,253 [INFO] - GPU cache cleared: 2520.86MB → 2520.86MB (freed 0.00MB)
2025-04-01 07:52:28,765 [INFO] - GPU cache cleared: 2520.50MB → 2520.50MB (freed 0.00MB)
2025-04-01 07:58:17,325 [INFO] - GPU cache cleared: 2520.05MB → 2520.05MB (freed 0.00MB)
2025-04-01 08:03:30,199 [INFO] - GPU cache cleared: 2520.21MB → 2520.21MB (freed 0.00MB)
2025-04-01 08:09:30,258 [INFO] - GPU cache cleared: 2522.50MB → 2522.50MB (freed 0.00MB)
2025-04-01 08:16:09,919 [INFO] - GPU cache cleared: 2519.60MB → 2519.60MB (freed 0.00MB)
2025-04-01 08:22:07,107 [INFO] - GPU cache cleared: 2521.96MB → 2521.96MB (freed 0.00MB)
2025-04-01 08:27:53,476 [INFO] - GPU cache cleared: 2516.42MB → 2516.42MB (freed 0.00MB)
2025-04-01 08:34:55,723 [INFO] - GPU cache cleared: 2518.78MB → 2518.78MB (freed 0.00MB)
2025-04-01 08:40:47,194 [INFO] - GPU cache cleared: 2519.74MB → 2519.74MB (freed 0.00MB)
2025-04-01 08:47:08,601 [INFO] - GPU cache cleared: 2519.15MB → 2519.15MB (freed 0.00MB)
2025-04-01 08:52:51,836 [INFO] - GPU cache cleared: 2518.64MB → 2518.64MB (freed 0.00MB)
2025-04-01 08:59:05,825 [INFO] - GPU cache cleared: 2520.69MB → 2520.69MB (freed 0.00MB)
2025-04-01 09:04:46,876 [INFO] - GPU cache cleared: 2519.89MB → 2519.89MB (freed 0.00MB)
2025-04-01 09:10:44,314 [INFO] - GPU cache cleared: 2520.46MB → 2520.46MB (freed 0.00MB)
2025-04-01 09:15:24,750 [INFO] - GPU cache cleared: 2521.11MB → 2521.11MB (freed 0.00MB)
2025-04-01 09:21:20,268 [INFO] - GPU cache cleared: 2518.72MB → 2518.72MB (freed 0.00MB)
2025-04-01 09:26:52,090 [INFO] - GPU cache cleared: 2519.03MB → 2519.03MB (freed 0.00MB)
2025-04-01 09:33:38,817 [INFO] - GPU cache cleared: 2518.70MB → 2518.70MB (freed 0.00MB)
2025-04-01 09:40:54,687 [INFO] -   vit: Train Loss=0.7609, Train Acc=62.82%, Val Loss=1.1538, Val Acc=58.72%, ECE=0.0291
2025-04-01 09:40:54,689 [INFO] -   efficientnet: Train Loss=0.1337, Train Acc=99.22%, Val Loss=0.1501, Val Acc=96.88%, ECE=0.0479
2025-04-01 09:40:54,692 [INFO] -   inception: Train Loss=0.1787, Train Acc=98.72%, Val Loss=0.1882, Val Acc=95.66%, ECE=0.0510
2025-04-01 09:40:54,695 [INFO] -   mobilenet: Train Loss=0.1652, Train Acc=99.43%, Val Loss=0.1653, Val Acc=96.34%, ECE=0.0489
2025-04-01 09:40:54,699 [INFO] -   resnet: Train Loss=0.1711, Train Acc=98.33%, Val Loss=0.2153, Val Acc=94.88%, ECE=0.0465
2025-04-01 09:40:54,700 [INFO] -   densenet: Train Loss=0.1755, Train Acc=98.85%, Val Loss=0.1982, Val Acc=95.60%, ECE=0.0487
2025-04-01 09:40:54,703 [INFO] -   student: Train Loss=0.1279, Train Acc=99.20%, Val Loss=0.1598, Val Acc=96.80%, ECE=0.0585
2025-04-01 09:40:54,706 [INFO] - Mutual learning epoch 28 completed in 6812.96s
2025-04-01 09:40:54,706 [INFO] - Mutual Learning Epoch 29/50
2025-04-01 09:40:54,707 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-01 09:40:54,709 [INFO] - Current temperatures: {'vit': 4.954099655151367, 'efficientnet': 6.344043254852295, 'inception': 6.198941230773926, 'mobilenet': 6.328348159790039, 'resnet': 6.20505428314209, 'densenet': 6.237482070922852, 'student': 5.968916416168213}
2025-04-01 09:40:55,075 [INFO] - GPU cache cleared: 2448.58MB → 2448.58MB (freed 0.00MB)
2025-04-01 09:41:00,938 [INFO] - GPU cache cleared: 2523.41MB → 2523.41MB (freed 0.00MB)
2025-04-01 09:46:50,435 [INFO] - GPU cache cleared: 2519.58MB → 2519.58MB (freed 0.00MB)
2025-04-01 09:53:00,824 [INFO] - GPU cache cleared: 2524.45MB → 2524.45MB (freed 0.00MB)
2025-04-01 09:59:08,943 [INFO] - GPU cache cleared: 2522.53MB → 2522.53MB (freed 0.00MB)
2025-04-01 10:05:15,706 [INFO] - GPU cache cleared: 2523.76MB → 2523.76MB (freed 0.00MB)
2025-04-01 10:11:10,717 [INFO] - GPU cache cleared: 2520.52MB → 2520.52MB (freed 0.00MB)
2025-04-01 10:18:10,807 [INFO] - GPU cache cleared: 2515.72MB → 2515.72MB (freed 0.00MB)
2025-04-01 10:23:45,765 [INFO] - GPU cache cleared: 2517.41MB → 2517.41MB (freed 0.00MB)
2025-04-01 10:30:09,135 [INFO] - GPU cache cleared: 2520.97MB → 2520.97MB (freed 0.00MB)
2025-04-01 10:35:53,009 [INFO] - GPU cache cleared: 2520.09MB → 2520.09MB (freed 0.00MB)
2025-04-01 10:42:28,876 [INFO] - GPU cache cleared: 2522.14MB → 2522.14MB (freed 0.00MB)
2025-04-01 10:48:24,866 [INFO] - GPU cache cleared: 2519.70MB → 2519.70MB (freed 0.00MB)
2025-04-01 10:54:29,373 [INFO] - GPU cache cleared: 2518.63MB → 2518.63MB (freed 0.00MB)
2025-04-01 11:00:09,564 [INFO] - GPU cache cleared: 2519.14MB → 2519.14MB (freed 0.00MB)
2025-04-01 11:07:13,714 [INFO] - GPU cache cleared: 2519.24MB → 2519.24MB (freed 0.00MB)
2025-04-01 11:13:45,737 [INFO] - GPU cache cleared: 2521.44MB → 2521.44MB (freed 0.00MB)
2025-04-01 11:19:54,572 [INFO] - GPU cache cleared: 2520.36MB → 2520.36MB (freed 0.00MB)
2025-04-01 11:25:38,590 [INFO] - GPU cache cleared: 2521.46MB → 2521.46MB (freed 0.00MB)
2025-04-01 11:31:57,582 [INFO] - GPU cache cleared: 2520.77MB → 2520.77MB (freed 0.00MB)
2025-04-01 11:39:09,318 [INFO] -   vit: Train Loss=0.7545, Train Acc=63.14%, Val Loss=1.1471, Val Acc=59.30%, ECE=0.0315
2025-04-01 11:39:09,328 [INFO] -   New best model for vit (Val Acc: 59.30%)
2025-04-01 11:39:10,030 [INFO] -   efficientnet: Train Loss=0.1317, Train Acc=99.25%, Val Loss=0.1410, Val Acc=97.04%, ECE=0.0461
2025-04-01 11:39:10,030 [INFO] -   inception: Train Loss=0.1758, Train Acc=98.82%, Val Loss=0.1972, Val Acc=95.42%, ECE=0.0479
2025-04-01 11:39:10,038 [INFO] -   mobilenet: Train Loss=0.1634, Train Acc=99.43%, Val Loss=0.1691, Val Acc=96.12%, ECE=0.0430
2025-04-01 11:39:10,040 [INFO] -   resnet: Train Loss=0.1690, Train Acc=98.38%, Val Loss=0.2005, Val Acc=95.08%, ECE=0.0436
2025-04-01 11:39:10,040 [INFO] -   densenet: Train Loss=0.1722, Train Acc=98.91%, Val Loss=0.1749, Val Acc=96.02%, ECE=0.0461
2025-04-01 11:39:10,040 [INFO] -   student: Train Loss=0.1264, Train Acc=99.18%, Val Loss=0.1538, Val Acc=96.84%, ECE=0.0562
2025-04-01 11:39:10,040 [INFO] - Mutual learning epoch 29 completed in 7095.33s
2025-04-01 11:39:10,040 [INFO] - Mutual Learning Epoch 30/50
2025-04-01 11:39:10,040 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-01 11:39:10,048 [INFO] - Current temperatures: {'vit': 4.953871726989746, 'efficientnet': 6.350948810577393, 'inception': 6.2087812423706055, 'mobilenet': 6.3354105949401855, 'resnet': 6.215399265289307, 'densenet': 6.246943473815918, 'student': 5.989585876464844}
2025-04-01 11:39:10,359 [INFO] - GPU cache cleared: 2445.87MB → 2445.87MB (freed 0.00MB)
2025-04-01 11:39:16,293 [INFO] - GPU cache cleared: 2521.65MB → 2521.65MB (freed 0.00MB)
2025-04-01 11:44:44,838 [INFO] - GPU cache cleared: 2518.70MB → 2518.70MB (freed 0.00MB)
2025-04-01 11:50:43,957 [INFO] - GPU cache cleared: 2523.41MB → 2523.41MB (freed 0.00MB)
2025-04-01 11:56:49,479 [INFO] - GPU cache cleared: 2521.32MB → 2521.32MB (freed 0.00MB)
2025-04-01 12:03:32,491 [INFO] - GPU cache cleared: 2525.09MB → 2525.09MB (freed 0.00MB)
2025-04-01 12:09:18,920 [INFO] - GPU cache cleared: 2519.00MB → 2519.00MB (freed 0.00MB)
2025-04-01 12:15:45,019 [INFO] - GPU cache cleared: 2520.12MB → 2520.12MB (freed 0.00MB)
2025-04-01 12:21:55,103 [INFO] - GPU cache cleared: 2518.84MB → 2518.84MB (freed 0.00MB)
2025-04-01 12:28:18,405 [INFO] - GPU cache cleared: 2520.17MB → 2520.17MB (freed 0.00MB)
2025-04-01 12:33:43,697 [INFO] - GPU cache cleared: 2522.54MB → 2522.54MB (freed 0.00MB)
2025-04-01 12:40:05,900 [INFO] - GPU cache cleared: 2521.04MB → 2521.04MB (freed 0.00MB)
2025-04-01 12:45:58,709 [INFO] - GPU cache cleared: 2519.45MB → 2519.45MB (freed 0.00MB)
2025-04-01 12:51:41,640 [INFO] - GPU cache cleared: 2520.18MB → 2520.18MB (freed 0.00MB)
2025-04-01 12:56:55,581 [INFO] - GPU cache cleared: 2519.71MB → 2519.71MB (freed 0.00MB)
2025-04-01 13:02:40,057 [INFO] - GPU cache cleared: 2524.07MB → 2524.07MB (freed 0.00MB)
2025-04-01 13:08:50,064 [INFO] - GPU cache cleared: 2524.50MB → 2524.50MB (freed 0.00MB)
2025-04-01 13:14:35,785 [INFO] - GPU cache cleared: 2520.00MB → 2520.00MB (freed 0.00MB)
2025-04-01 13:20:05,185 [INFO] - GPU cache cleared: 2521.57MB → 2521.57MB (freed 0.00MB)
2025-04-01 13:25:46,460 [INFO] - GPU cache cleared: 2518.18MB → 2518.18MB (freed 0.00MB)
2025-04-01 13:32:15,324 [INFO] -   vit: Train Loss=0.7523, Train Acc=63.52%, Val Loss=1.1471, Val Acc=59.40%, ECE=0.0308
2025-04-01 13:32:15,331 [INFO] -   New best model for vit (Val Acc: 59.40%)
2025-04-01 13:32:16,017 [INFO] -   efficientnet: Train Loss=0.1295, Train Acc=99.33%, Val Loss=0.1408, Val Acc=97.12%, ECE=0.0473
2025-04-01 13:32:16,017 [INFO] -   inception: Train Loss=0.1708, Train Acc=99.03%, Val Loss=0.1810, Val Acc=95.80%, ECE=0.0422
2025-04-01 13:32:16,023 [INFO] -   mobilenet: Train Loss=0.1604, Train Acc=99.53%, Val Loss=0.1563, Val Acc=96.66%, ECE=0.0480
2025-04-01 13:32:16,023 [INFO] -   New best model for mobilenet (Val Acc: 96.66%)
2025-04-01 13:32:16,143 [INFO] -   resnet: Train Loss=0.1627, Train Acc=98.71%, Val Loss=0.1864, Val Acc=95.78%, ECE=0.0491
2025-04-01 13:32:16,143 [INFO] -   New best model for resnet (Val Acc: 95.78%)
2025-04-01 13:32:16,389 [INFO] -   densenet: Train Loss=0.1689, Train Acc=99.03%, Val Loss=0.1718, Val Acc=96.06%, ECE=0.0460
2025-04-01 13:32:16,389 [INFO] -   student: Train Loss=0.1244, Train Acc=99.25%, Val Loss=0.1543, Val Acc=97.14%, ECE=0.0608
2025-04-01 13:32:16,395 [INFO] -   New best model for student (Val Acc: 97.14%)
2025-04-01 13:32:18,986 [INFO] - Mutual learning epoch 30 completed in 6788.95s
2025-04-01 13:32:18,986 [INFO] - Mutual Learning Epoch 31/50
2025-04-01 13:32:18,986 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-01 13:32:18,994 [INFO] - Current temperatures: {'vit': 4.953704357147217, 'efficientnet': 6.356061935424805, 'inception': 6.217841625213623, 'mobilenet': 6.341849327087402, 'resnet': 6.226756572723389, 'densenet': 6.255134582519531, 'student': 6.00852108001709}
2025-04-01 13:32:19,243 [INFO] - GPU cache cleared: 2446.52MB → 2446.52MB (freed 0.00MB)
2025-04-01 13:32:24,226 [INFO] - GPU cache cleared: 2524.50MB → 2524.50MB (freed 0.00MB)
2025-04-01 13:37:32,320 [INFO] - GPU cache cleared: 2522.76MB → 2522.76MB (freed 0.00MB)
2025-04-01 13:44:27,641 [INFO] - GPU cache cleared: 2520.08MB → 2520.08MB (freed 0.00MB)
2025-04-01 13:50:36,372 [INFO] - GPU cache cleared: 2519.31MB → 2519.31MB (freed 0.00MB)
2025-04-01 13:56:43,973 [INFO] - GPU cache cleared: 2521.37MB → 2521.37MB (freed 0.00MB)
2025-04-01 14:03:22,059 [INFO] - GPU cache cleared: 2519.48MB → 2519.48MB (freed 0.00MB)
2025-04-01 14:10:52,532 [INFO] - GPU cache cleared: 2519.75MB → 2519.75MB (freed 0.00MB)
2025-04-01 14:18:36,427 [INFO] - GPU cache cleared: 2519.51MB → 2519.51MB (freed 0.00MB)
2025-04-01 14:24:45,286 [INFO] - GPU cache cleared: 2519.29MB → 2519.29MB (freed 0.00MB)
2025-04-01 14:31:51,700 [INFO] - GPU cache cleared: 2520.28MB → 2520.28MB (freed 0.00MB)
2025-04-01 14:38:21,732 [INFO] - GPU cache cleared: 2524.87MB → 2524.87MB (freed 0.00MB)
2025-04-01 14:43:58,382 [INFO] - GPU cache cleared: 2521.24MB → 2521.24MB (freed 0.00MB)
2025-04-01 14:50:02,304 [INFO] - GPU cache cleared: 2522.47MB → 2522.47MB (freed 0.00MB)
2025-04-01 14:55:46,412 [INFO] - GPU cache cleared: 2518.51MB → 2518.51MB (freed 0.00MB)
2025-04-01 15:01:48,051 [INFO] - GPU cache cleared: 2518.12MB → 2518.12MB (freed 0.00MB)
2025-04-01 15:07:01,986 [INFO] - GPU cache cleared: 2520.27MB → 2520.27MB (freed 0.00MB)
2025-04-01 15:12:33,842 [INFO] - GPU cache cleared: 2522.61MB → 2522.61MB (freed 0.00MB)
2025-04-01 15:17:41,866 [INFO] - GPU cache cleared: 2520.94MB → 2520.94MB (freed 0.00MB)
2025-04-01 15:23:54,338 [INFO] - GPU cache cleared: 2518.65MB → 2518.65MB (freed 0.00MB)
2025-04-01 15:30:21,166 [INFO] -   vit: Train Loss=0.7476, Train Acc=63.52%, Val Loss=1.1462, Val Acc=59.46%, ECE=0.0293
2025-04-01 15:30:21,182 [INFO] -   New best model for vit (Val Acc: 59.46%)
2025-04-01 15:30:21,908 [INFO] -   efficientnet: Train Loss=0.1265, Train Acc=99.41%, Val Loss=0.1387, Val Acc=97.18%, ECE=0.0450
2025-04-01 15:30:21,908 [INFO] -   inception: Train Loss=0.1689, Train Acc=98.99%, Val Loss=0.1809, Val Acc=96.08%, ECE=0.0473
2025-04-01 15:30:21,908 [INFO] -   mobilenet: Train Loss=0.1568, Train Acc=99.61%, Val Loss=0.1620, Val Acc=96.42%, ECE=0.0462
2025-04-01 15:30:21,908 [INFO] -   resnet: Train Loss=0.1588, Train Acc=98.82%, Val Loss=0.1920, Val Acc=95.52%, ECE=0.0439
2025-04-01 15:30:21,908 [INFO] -   densenet: Train Loss=0.1666, Train Acc=99.07%, Val Loss=0.1679, Val Acc=96.46%, ECE=0.0483
2025-04-01 15:30:21,917 [INFO] -   New best model for densenet (Val Acc: 96.46%)
2025-04-01 15:30:22,180 [INFO] -   student: Train Loss=0.1226, Train Acc=99.29%, Val Loss=0.1552, Val Acc=97.04%, ECE=0.0538
2025-04-01 15:30:22,180 [INFO] - Mutual learning epoch 31 completed in 7083.19s
2025-04-01 15:30:22,187 [INFO] - Mutual Learning Epoch 32/50
2025-04-01 15:30:22,187 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-01 15:30:22,190 [INFO] - Current temperatures: {'vit': 4.953517913818359, 'efficientnet': 6.362148284912109, 'inception': 6.226563930511475, 'mobilenet': 6.349019527435303, 'resnet': 6.238218784332275, 'densenet': 6.263054370880127, 'student': 6.026052951812744}
2025-04-01 15:30:22,460 [INFO] - GPU cache cleared: 2447.12MB → 2447.12MB (freed 0.00MB)
2025-04-01 15:30:28,724 [INFO] - GPU cache cleared: 2520.02MB → 2520.02MB (freed 0.00MB)
2025-04-01 15:36:58,536 [INFO] - GPU cache cleared: 2519.00MB → 2519.00MB (freed 0.00MB)
2025-04-01 15:44:42,915 [INFO] - GPU cache cleared: 2521.31MB → 2521.31MB (freed 0.00MB)
2025-04-01 15:51:47,359 [INFO] - GPU cache cleared: 2520.12MB → 2520.12MB (freed 0.00MB)
2025-04-01 15:59:04,878 [INFO] - GPU cache cleared: 2522.87MB → 2522.87MB (freed 0.00MB)
2025-04-01 16:05:28,926 [INFO] - GPU cache cleared: 2519.54MB → 2519.54MB (freed 0.00MB)
2025-04-01 16:12:52,781 [INFO] - GPU cache cleared: 2519.70MB → 2519.70MB (freed 0.00MB)
2025-04-01 16:20:00,875 [INFO] - GPU cache cleared: 2519.79MB → 2519.79MB (freed 0.00MB)
2025-04-01 16:27:54,185 [INFO] - GPU cache cleared: 2521.81MB → 2521.81MB (freed 0.00MB)
2025-04-01 16:34:52,748 [INFO] - GPU cache cleared: 2522.32MB → 2522.32MB (freed 0.00MB)
2025-04-01 16:41:55,998 [INFO] - GPU cache cleared: 2523.22MB → 2523.22MB (freed 0.00MB)
2025-04-01 16:48:33,742 [INFO] - GPU cache cleared: 2519.02MB → 2519.02MB (freed 0.00MB)
2025-04-01 16:56:13,705 [INFO] - GPU cache cleared: 2518.46MB → 2518.46MB (freed 0.00MB)
2025-04-01 17:02:56,334 [INFO] - GPU cache cleared: 2520.98MB → 2520.98MB (freed 0.00MB)
2025-04-01 17:10:14,681 [INFO] - GPU cache cleared: 2520.03MB → 2520.03MB (freed 0.00MB)
2025-04-01 17:16:38,758 [INFO] - GPU cache cleared: 2518.80MB → 2518.80MB (freed 0.00MB)
2025-04-01 17:22:45,840 [INFO] - GPU cache cleared: 2519.46MB → 2519.46MB (freed 0.00MB)
2025-04-01 17:28:57,191 [INFO] - GPU cache cleared: 2520.33MB → 2520.33MB (freed 0.00MB)
2025-04-01 17:35:00,357 [INFO] - GPU cache cleared: 2519.80MB → 2519.80MB (freed 0.00MB)
2025-04-01 17:42:20,039 [INFO] -   vit: Train Loss=0.7460, Train Acc=63.67%, Val Loss=1.1490, Val Acc=59.28%, ECE=0.0325
2025-04-01 17:42:20,040 [INFO] -   efficientnet: Train Loss=0.1247, Train Acc=99.46%, Val Loss=0.1502, Val Acc=96.88%, ECE=0.0474
2025-04-01 17:42:20,043 [INFO] -   inception: Train Loss=0.1668, Train Acc=99.11%, Val Loss=0.1732, Val Acc=96.24%, ECE=0.0479
2025-04-01 17:42:20,050 [INFO] -   New best model for inception (Val Acc: 96.24%)
2025-04-01 17:42:20,349 [INFO] -   mobilenet: Train Loss=0.1557, Train Acc=99.56%, Val Loss=0.1549, Val Acc=96.54%, ECE=0.0474
2025-04-01 17:42:20,349 [INFO] -   resnet: Train Loss=0.1562, Train Acc=98.88%, Val Loss=0.1896, Val Acc=95.54%, ECE=0.0453
2025-04-01 17:42:20,356 [INFO] -   densenet: Train Loss=0.1650, Train Acc=99.09%, Val Loss=0.1695, Val Acc=96.28%, ECE=0.0465
2025-04-01 17:42:20,356 [INFO] -   student: Train Loss=0.1208, Train Acc=99.31%, Val Loss=0.1518, Val Acc=97.04%, ECE=0.0569
2025-04-01 17:42:20,359 [INFO] - Mutual learning epoch 32 completed in 7918.17s
2025-04-01 17:42:20,359 [INFO] - Mutual Learning Epoch 33/50
2025-04-01 17:42:20,359 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-01 17:42:20,359 [INFO] - Current temperatures: {'vit': 4.953360080718994, 'efficientnet': 6.368722915649414, 'inception': 6.2344512939453125, 'mobilenet': 6.355737686157227, 'resnet': 6.248290061950684, 'densenet': 6.270148754119873, 'student': 6.0425214767456055}
2025-04-01 17:42:20,646 [INFO] - GPU cache cleared: 2444.07MB → 2444.07MB (freed 0.00MB)
2025-04-01 17:42:27,193 [INFO] - GPU cache cleared: 2518.09MB → 2518.09MB (freed 0.00MB)
2025-04-01 17:48:06,513 [INFO] - GPU cache cleared: 2518.12MB → 2518.12MB (freed 0.00MB)
2025-04-01 17:54:55,727 [INFO] - GPU cache cleared: 2521.85MB → 2521.85MB (freed 0.00MB)
2025-04-01 18:01:02,096 [INFO] - GPU cache cleared: 2518.00MB → 2518.00MB (freed 0.00MB)
2025-04-01 18:07:06,006 [INFO] - GPU cache cleared: 2523.49MB → 2523.49MB (freed 0.00MB)
2025-04-01 18:13:42,055 [INFO] - GPU cache cleared: 2518.31MB → 2518.31MB (freed 0.00MB)
2025-04-01 18:20:06,674 [INFO] - GPU cache cleared: 2524.33MB → 2524.33MB (freed 0.00MB)
2025-04-01 18:27:06,590 [INFO] - GPU cache cleared: 2524.11MB → 2524.11MB (freed 0.00MB)
2025-04-01 18:34:54,322 [INFO] - GPU cache cleared: 2521.60MB → 2521.60MB (freed 0.00MB)
2025-04-01 18:42:19,736 [INFO] - GPU cache cleared: 2521.73MB → 2521.73MB (freed 0.00MB)
2025-04-01 18:49:56,436 [INFO] - GPU cache cleared: 2523.32MB → 2523.32MB (freed 0.00MB)
2025-04-01 18:57:07,844 [INFO] - GPU cache cleared: 2520.61MB → 2520.61MB (freed 0.00MB)
2025-04-01 19:04:24,848 [INFO] - GPU cache cleared: 2519.45MB → 2519.45MB (freed 0.00MB)
2025-04-01 19:11:26,985 [INFO] - GPU cache cleared: 2518.59MB → 2518.59MB (freed 0.00MB)
2025-04-01 19:17:51,133 [INFO] - GPU cache cleared: 2518.00MB → 2518.00MB (freed 0.00MB)
2025-04-01 19:24:15,142 [INFO] - GPU cache cleared: 2519.07MB → 2519.07MB (freed 0.00MB)
2025-04-01 19:29:41,951 [INFO] - GPU cache cleared: 2521.58MB → 2521.58MB (freed 0.00MB)
2025-04-01 19:35:34,443 [INFO] - GPU cache cleared: 2522.88MB → 2522.88MB (freed 0.00MB)
2025-04-01 19:41:59,988 [INFO] - GPU cache cleared: 2518.73MB → 2518.73MB (freed 0.00MB)
2025-04-01 19:48:08,727 [INFO] -   vit: Train Loss=0.7428, Train Acc=63.90%, Val Loss=1.1346, Val Acc=59.90%, ECE=0.0273
2025-04-01 19:48:08,737 [INFO] -   New best model for vit (Val Acc: 59.90%)
2025-04-01 19:48:09,694 [INFO] -   efficientnet: Train Loss=0.1233, Train Acc=99.40%, Val Loss=0.1392, Val Acc=97.22%, ECE=0.0475
2025-04-01 19:48:09,694 [INFO] -   inception: Train Loss=0.1628, Train Acc=99.30%, Val Loss=0.1738, Val Acc=96.22%, ECE=0.0450
2025-04-01 19:48:09,701 [INFO] -   mobilenet: Train Loss=0.1543, Train Acc=99.58%, Val Loss=0.1599, Val Acc=96.44%, ECE=0.0447
2025-04-01 19:48:09,702 [INFO] -   resnet: Train Loss=0.1535, Train Acc=98.92%, Val Loss=0.1897, Val Acc=95.64%, ECE=0.0468
2025-04-01 19:48:09,702 [INFO] -   densenet: Train Loss=0.1593, Train Acc=99.35%, Val Loss=0.1698, Val Acc=96.48%, ECE=0.0480
2025-04-01 19:48:09,707 [INFO] -   New best model for densenet (Val Acc: 96.48%)
2025-04-01 19:48:09,976 [INFO] -   student: Train Loss=0.1183, Train Acc=99.43%, Val Loss=0.1470, Val Acc=97.24%, ECE=0.0560
2025-04-01 19:48:09,992 [INFO] -   New best model for student (Val Acc: 97.24%)
2025-04-01 19:48:10,142 [INFO] - Mutual learning epoch 33 completed in 7549.78s
2025-04-01 19:48:10,142 [INFO] - Mutual Learning Epoch 34/50
2025-04-01 19:48:10,142 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-01 19:48:10,145 [INFO] - Current temperatures: {'vit': 4.953210830688477, 'efficientnet': 6.37382698059082, 'inception': 6.242964744567871, 'mobilenet': 6.361525535583496, 'resnet': 6.258098125457764, 'densenet': 6.279526233673096, 'student': 6.057566165924072}
2025-04-01 19:48:10,427 [INFO] - GPU cache cleared: 2444.70MB → 2444.70MB (freed 0.00MB)
2025-04-01 19:48:16,352 [INFO] - GPU cache cleared: 2520.91MB → 2520.91MB (freed 0.00MB)
2025-04-01 19:53:43,746 [INFO] - GPU cache cleared: 2516.45MB → 2516.45MB (freed 0.00MB)
2025-04-01 20:00:52,018 [INFO] - GPU cache cleared: 2523.10MB → 2523.10MB (freed 0.00MB)
2025-04-01 20:07:00,256 [INFO] - GPU cache cleared: 2522.18MB → 2522.18MB (freed 0.00MB)
2025-04-01 20:14:36,208 [INFO] - GPU cache cleared: 2520.14MB → 2520.14MB (freed 0.00MB)
2025-04-01 20:21:38,877 [INFO] - GPU cache cleared: 2517.92MB → 2517.92MB (freed 0.00MB)
2025-04-01 20:28:18,926 [INFO] - GPU cache cleared: 2519.07MB → 2519.07MB (freed 0.00MB)
2025-04-01 20:34:59,425 [INFO] - GPU cache cleared: 2521.65MB → 2521.65MB (freed 0.00MB)
2025-04-01 20:41:21,366 [INFO] - GPU cache cleared: 2518.84MB → 2518.84MB (freed 0.00MB)
2025-04-01 20:48:09,664 [INFO] - GPU cache cleared: 2520.75MB → 2520.75MB (freed 0.00MB)
2025-04-01 20:54:24,459 [INFO] - GPU cache cleared: 2519.83MB → 2519.83MB (freed 0.00MB)
2025-04-01 20:59:47,112 [INFO] - GPU cache cleared: 2524.35MB → 2524.35MB (freed 0.00MB)
2025-04-01 21:06:03,076 [INFO] - GPU cache cleared: 2517.83MB → 2517.83MB (freed 0.00MB)
2025-04-01 21:12:31,440 [INFO] - GPU cache cleared: 2520.11MB → 2520.11MB (freed 0.00MB)
2025-04-01 21:19:14,594 [INFO] - GPU cache cleared: 2518.90MB → 2518.90MB (freed 0.00MB)
2025-04-01 21:25:21,468 [INFO] - GPU cache cleared: 2522.92MB → 2522.92MB (freed 0.00MB)
2025-04-01 21:31:39,697 [INFO] - GPU cache cleared: 2521.75MB → 2521.75MB (freed 0.00MB)
2025-04-01 21:37:12,827 [INFO] - GPU cache cleared: 2517.58MB → 2517.58MB (freed 0.00MB)
2025-04-01 21:44:12,279 [INFO] - GPU cache cleared: 2520.49MB → 2520.49MB (freed 0.00MB)
2025-04-01 21:52:15,893 [INFO] -   vit: Train Loss=0.7430, Train Acc=63.82%, Val Loss=1.1354, Val Acc=59.80%, ECE=0.0314
2025-04-01 21:52:15,894 [INFO] -   efficientnet: Train Loss=0.1205, Train Acc=99.54%, Val Loss=0.1409, Val Acc=97.02%, ECE=0.0495
2025-04-01 21:52:15,897 [INFO] -   inception: Train Loss=0.1597, Train Acc=99.36%, Val Loss=0.1772, Val Acc=96.26%, ECE=0.0474
2025-04-01 21:52:15,902 [INFO] -   New best model for inception (Val Acc: 96.26%)
2025-04-01 21:52:16,165 [INFO] -   mobilenet: Train Loss=0.1518, Train Acc=99.65%, Val Loss=0.1547, Val Acc=96.70%, ECE=0.0499
2025-04-01 21:52:16,169 [INFO] -   New best model for mobilenet (Val Acc: 96.70%)
2025-04-01 21:52:16,277 [INFO] -   resnet: Train Loss=0.1490, Train Acc=99.14%, Val Loss=0.1851, Val Acc=95.60%, ECE=0.0453
2025-04-01 21:52:16,277 [INFO] -   densenet: Train Loss=0.1577, Train Acc=99.40%, Val Loss=0.1679, Val Acc=96.28%, ECE=0.0488
2025-04-01 21:52:16,277 [INFO] -   student: Train Loss=0.1158, Train Acc=99.54%, Val Loss=0.1472, Val Acc=97.16%, ECE=0.0561
2025-04-01 21:52:16,283 [INFO] - Mutual learning epoch 34 completed in 7446.14s
2025-04-01 21:52:16,285 [INFO] - Mutual Learning Epoch 35/50
2025-04-01 21:52:16,285 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-01 21:52:16,285 [INFO] - Current temperatures: {'vit': 4.953060150146484, 'efficientnet': 6.379814147949219, 'inception': 6.251458644866943, 'mobilenet': 6.366944789886475, 'resnet': 6.26747989654541, 'densenet': 6.2873854637146, 'student': 6.071348667144775}
2025-04-01 21:52:16,567 [INFO] - GPU cache cleared: 2445.19MB → 2445.19MB (freed 0.00MB)
2025-04-01 21:52:22,585 [INFO] - GPU cache cleared: 2516.60MB → 2516.60MB (freed 0.00MB)
2025-04-01 21:57:31,565 [INFO] - GPU cache cleared: 2518.08MB → 2518.08MB (freed 0.00MB)
2025-04-01 22:04:29,942 [INFO] - GPU cache cleared: 2519.33MB → 2519.33MB (freed 0.00MB)
2025-04-01 22:10:30,557 [INFO] - GPU cache cleared: 2519.64MB → 2519.64MB (freed 0.00MB)
2025-04-01 22:16:40,759 [INFO] - GPU cache cleared: 2520.38MB → 2520.38MB (freed 0.00MB)
2025-04-01 22:22:29,261 [INFO] - GPU cache cleared: 2521.05MB → 2521.05MB (freed 0.00MB)
2025-04-01 22:28:36,596 [INFO] - GPU cache cleared: 2519.60MB → 2519.60MB (freed 0.00MB)
2025-04-01 22:34:44,935 [INFO] - GPU cache cleared: 2520.40MB → 2520.40MB (freed 0.00MB)
2025-04-01 22:41:03,058 [INFO] - GPU cache cleared: 2522.24MB → 2522.24MB (freed 0.00MB)
2025-04-01 22:47:18,350 [INFO] - GPU cache cleared: 2517.97MB → 2517.97MB (freed 0.00MB)
2025-04-01 22:52:59,100 [INFO] - GPU cache cleared: 2517.97MB → 2517.97MB (freed 0.00MB)
2025-04-01 22:58:17,386 [INFO] - GPU cache cleared: 2518.43MB → 2518.43MB (freed 0.00MB)
2025-04-01 23:03:57,395 [INFO] - GPU cache cleared: 2519.74MB → 2519.74MB (freed 0.00MB)
2025-04-01 23:09:04,854 [INFO] - GPU cache cleared: 2520.78MB → 2520.78MB (freed 0.00MB)
2025-04-01 23:15:54,575 [INFO] - GPU cache cleared: 2519.29MB → 2519.29MB (freed 0.00MB)
2025-04-01 23:21:59,062 [INFO] - GPU cache cleared: 2520.56MB → 2520.56MB (freed 0.00MB)
2025-04-01 23:28:01,804 [INFO] - GPU cache cleared: 2517.66MB → 2517.66MB (freed 0.00MB)
2025-04-01 23:33:40,468 [INFO] - GPU cache cleared: 2519.50MB → 2519.50MB (freed 0.00MB)
2025-04-01 23:40:26,160 [INFO] - GPU cache cleared: 2520.13MB → 2520.13MB (freed 0.00MB)
2025-04-01 23:47:46,275 [INFO] -   vit: Train Loss=0.7392, Train Acc=64.00%, Val Loss=1.1300, Val Acc=60.22%, ECE=0.0288
2025-04-01 23:47:46,282 [INFO] -   New best model for vit (Val Acc: 60.22%)
2025-04-01 23:47:47,076 [INFO] -   efficientnet: Train Loss=0.1184, Train Acc=99.59%, Val Loss=0.1368, Val Acc=97.34%, ECE=0.0452
2025-04-01 23:47:47,082 [INFO] -   New best model for efficientnet (Val Acc: 97.34%)
2025-04-01 23:47:47,197 [INFO] -   inception: Train Loss=0.1584, Train Acc=99.38%, Val Loss=0.1732, Val Acc=96.46%, ECE=0.0451
2025-04-01 23:47:47,201 [INFO] -   New best model for inception (Val Acc: 96.46%)
2025-04-01 23:47:47,473 [INFO] -   mobilenet: Train Loss=0.1498, Train Acc=99.66%, Val Loss=0.1590, Val Acc=96.38%, ECE=0.0435
2025-04-01 23:47:47,474 [INFO] -   resnet: Train Loss=0.1452, Train Acc=99.25%, Val Loss=0.1869, Val Acc=95.64%, ECE=0.0480
2025-04-01 23:47:47,477 [INFO] -   densenet: Train Loss=0.1541, Train Acc=99.51%, Val Loss=0.1656, Val Acc=96.46%, ECE=0.0490
2025-04-01 23:47:47,479 [INFO] -   student: Train Loss=0.1142, Train Acc=99.53%, Val Loss=0.1439, Val Acc=97.48%, ECE=0.0563
2025-04-01 23:47:47,484 [INFO] -   New best model for student (Val Acc: 97.48%)
2025-04-01 23:47:47,660 [INFO] - Mutual learning epoch 35 completed in 6931.38s
2025-04-01 23:47:47,662 [INFO] - Mutual Learning Epoch 36/50
2025-04-01 23:47:47,663 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-01 23:47:47,665 [INFO] - Current temperatures: {'vit': 4.953311920166016, 'efficientnet': 6.382049560546875, 'inception': 6.255550384521484, 'mobilenet': 6.368319988250732, 'resnet': 6.273380279541016, 'densenet': 6.291702747344971, 'student': 6.082716941833496}
2025-04-01 23:47:47,981 [INFO] - GPU cache cleared: 2442.95MB → 2442.95MB (freed 0.00MB)
2025-04-01 23:47:54,386 [INFO] - GPU cache cleared: 2518.67MB → 2518.67MB (freed 0.00MB)
2025-04-01 23:54:02,995 [INFO] - GPU cache cleared: 2520.46MB → 2520.46MB (freed 0.00MB)
2025-04-02 00:02:17,817 [INFO] - GPU cache cleared: 2521.59MB → 2521.59MB (freed 0.00MB)
2025-04-02 00:10:13,469 [INFO] - GPU cache cleared: 2518.82MB → 2518.82MB (freed 0.00MB)
2025-04-02 00:17:50,049 [INFO] - GPU cache cleared: 2521.63MB → 2521.63MB (freed 0.00MB)
2025-04-02 00:24:42,535 [INFO] - GPU cache cleared: 2519.87MB → 2519.87MB (freed 0.00MB)
2025-04-02 00:31:19,303 [INFO] - GPU cache cleared: 2517.08MB → 2517.08MB (freed 0.00MB)
2025-04-02 00:37:14,023 [INFO] - GPU cache cleared: 2522.10MB → 2522.10MB (freed 0.00MB)
2025-04-02 00:44:08,536 [INFO] - GPU cache cleared: 2524.10MB → 2524.10MB (freed 0.00MB)
2025-04-02 00:50:18,651 [INFO] - GPU cache cleared: 2519.95MB → 2519.95MB (freed 0.00MB)
2025-04-02 00:57:40,651 [INFO] - GPU cache cleared: 2518.18MB → 2518.18MB (freed 0.00MB)
2025-04-02 01:03:35,909 [INFO] - GPU cache cleared: 2519.99MB → 2519.99MB (freed 0.00MB)
2025-04-02 01:09:46,991 [INFO] - GPU cache cleared: 2520.85MB → 2520.85MB (freed 0.00MB)
2025-04-02 01:16:06,768 [INFO] - GPU cache cleared: 2520.83MB → 2520.83MB (freed 0.00MB)
2025-04-02 01:22:22,182 [INFO] - GPU cache cleared: 2520.02MB → 2520.02MB (freed 0.00MB)
2025-04-02 01:28:05,913 [INFO] - GPU cache cleared: 2522.23MB → 2522.23MB (freed 0.00MB)
2025-04-02 01:35:09,085 [INFO] - GPU cache cleared: 2522.22MB → 2522.22MB (freed 0.00MB)
2025-04-02 01:41:30,722 [INFO] - GPU cache cleared: 2521.04MB → 2521.04MB (freed 0.00MB)
2025-04-02 01:47:46,325 [INFO] - GPU cache cleared: 2522.52MB → 2522.52MB (freed 0.00MB)
2025-04-02 01:55:24,654 [INFO] -   vit: Train Loss=0.7383, Train Acc=64.15%, Val Loss=1.1338, Val Acc=59.80%, ECE=0.0339
2025-04-02 01:55:24,655 [INFO] -   efficientnet: Train Loss=0.1167, Train Acc=99.61%, Val Loss=0.1400, Val Acc=97.12%, ECE=0.0461
2025-04-02 01:55:24,658 [INFO] -   inception: Train Loss=0.1554, Train Acc=99.49%, Val Loss=0.1763, Val Acc=96.00%, ECE=0.0477
2025-04-02 01:55:24,660 [INFO] -   mobilenet: Train Loss=0.1481, Train Acc=99.72%, Val Loss=0.1560, Val Acc=96.64%, ECE=0.0439
2025-04-02 01:55:24,663 [INFO] -   resnet: Train Loss=0.1428, Train Acc=99.32%, Val Loss=0.1849, Val Acc=95.82%, ECE=0.0460
2025-04-02 01:55:24,669 [INFO] -   New best model for resnet (Val Acc: 95.82%)
2025-04-02 01:55:24,946 [INFO] -   densenet: Train Loss=0.1530, Train Acc=99.49%, Val Loss=0.1741, Val Acc=96.40%, ECE=0.0480
2025-04-02 01:55:24,952 [INFO] -   student: Train Loss=0.1125, Train Acc=99.60%, Val Loss=0.1468, Val Acc=97.20%, ECE=0.0554
2025-04-02 01:55:24,952 [INFO] - Mutual learning epoch 36 completed in 7657.29s
2025-04-02 01:55:24,952 [INFO] - Mutual Learning Epoch 37/50
2025-04-02 01:55:24,952 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-02 01:55:24,952 [INFO] - Current temperatures: {'vit': 4.953197002410889, 'efficientnet': 6.386885643005371, 'inception': 6.2632365226745605, 'mobilenet': 6.373525619506836, 'resnet': 6.281833171844482, 'densenet': 6.298888683319092, 'student': 6.093965530395508}
2025-04-02 01:55:25,260 [INFO] - GPU cache cleared: 2446.40MB → 2446.40MB (freed 0.00MB)
2025-04-02 01:55:31,874 [INFO] - GPU cache cleared: 2519.16MB → 2519.16MB (freed 0.00MB)
2025-04-02 02:01:17,917 [INFO] - GPU cache cleared: 2520.30MB → 2520.30MB (freed 0.00MB)
2025-04-02 02:06:01,694 [INFO] - GPU cache cleared: 2519.82MB → 2519.82MB (freed 0.00MB)
2025-04-02 02:10:45,284 [INFO] - GPU cache cleared: 2523.66MB → 2523.66MB (freed 0.00MB)
2025-04-02 02:16:37,440 [INFO] - GPU cache cleared: 2519.07MB → 2519.07MB (freed 0.00MB)
2025-04-02 02:21:46,257 [INFO] - GPU cache cleared: 2520.23MB → 2520.23MB (freed 0.00MB)
2025-04-02 02:28:10,041 [INFO] - GPU cache cleared: 2522.08MB → 2522.08MB (freed 0.00MB)
2025-04-02 02:33:48,487 [INFO] - GPU cache cleared: 2520.86MB → 2520.86MB (freed 0.00MB)
2025-04-02 02:38:42,829 [INFO] - GPU cache cleared: 2523.86MB → 2523.86MB (freed 0.00MB)
2025-04-02 02:44:51,755 [INFO] - GPU cache cleared: 2521.28MB → 2521.28MB (freed 0.00MB)
2025-04-02 02:51:36,635 [INFO] - GPU cache cleared: 2519.20MB → 2519.20MB (freed 0.00MB)
2025-04-02 02:57:25,161 [INFO] - GPU cache cleared: 2520.56MB → 2520.56MB (freed 0.00MB)
2025-04-02 03:03:28,168 [INFO] - GPU cache cleared: 2519.72MB → 2519.72MB (freed 0.00MB)
2025-04-02 03:08:49,850 [INFO] - GPU cache cleared: 2521.20MB → 2521.20MB (freed 0.00MB)
2025-04-02 03:14:38,864 [INFO] - GPU cache cleared: 2520.44MB → 2520.44MB (freed 0.00MB)
2025-04-02 03:20:24,765 [INFO] - GPU cache cleared: 2521.61MB → 2521.61MB (freed 0.00MB)
2025-04-02 03:26:55,248 [INFO] - GPU cache cleared: 2523.08MB → 2523.08MB (freed 0.00MB)
2025-04-02 03:32:41,180 [INFO] - GPU cache cleared: 2522.30MB → 2522.30MB (freed 0.00MB)
2025-04-02 03:39:36,273 [INFO] - GPU cache cleared: 2518.78MB → 2518.78MB (freed 0.00MB)
2025-04-02 03:46:39,681 [INFO] -   vit: Train Loss=0.7362, Train Acc=64.07%, Val Loss=1.1276, Val Acc=60.24%, ECE=0.0278
2025-04-02 03:46:39,687 [INFO] -   New best model for vit (Val Acc: 60.24%)
2025-04-02 03:46:40,532 [INFO] -   efficientnet: Train Loss=0.1151, Train Acc=99.69%, Val Loss=0.1340, Val Acc=97.46%, ECE=0.0478
2025-04-02 03:46:40,536 [INFO] -   New best model for efficientnet (Val Acc: 97.46%)
2025-04-02 03:46:40,647 [INFO] -   inception: Train Loss=0.1533, Train Acc=99.60%, Val Loss=0.1696, Val Acc=96.38%, ECE=0.0491
2025-04-02 03:46:40,647 [INFO] -   mobilenet: Train Loss=0.1470, Train Acc=99.72%, Val Loss=0.1584, Val Acc=96.38%, ECE=0.0466
2025-04-02 03:46:40,653 [INFO] -   resnet: Train Loss=0.1412, Train Acc=99.36%, Val Loss=0.1792, Val Acc=95.92%, ECE=0.0461
2025-04-02 03:46:40,657 [INFO] -   New best model for resnet (Val Acc: 95.92%)
2025-04-02 03:46:40,970 [INFO] -   densenet: Train Loss=0.1507, Train Acc=99.59%, Val Loss=0.1591, Val Acc=96.80%, ECE=0.0474
2025-04-02 03:46:40,980 [INFO] -   New best model for densenet (Val Acc: 96.80%)
2025-04-02 03:46:41,157 [INFO] -   student: Train Loss=0.1112, Train Acc=99.63%, Val Loss=0.1486, Val Acc=97.18%, ECE=0.0539
2025-04-02 03:46:41,158 [INFO] - Mutual learning epoch 37 completed in 6676.21s
2025-04-02 03:46:41,159 [INFO] - Mutual Learning Epoch 38/50
2025-04-02 03:46:41,160 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-02 03:46:41,161 [INFO] - Current temperatures: {'vit': 4.953094482421875, 'efficientnet': 6.391202449798584, 'inception': 6.26973295211792, 'mobilenet': 6.37816047668457, 'resnet': 6.289279460906982, 'densenet': 6.306227684020996, 'student': 6.104089736938477}
2025-04-02 03:46:41,432 [INFO] - GPU cache cleared: 2445.51MB → 2445.51MB (freed 0.00MB)
2025-04-02 03:46:47,617 [INFO] - GPU cache cleared: 2519.28MB → 2519.28MB (freed 0.00MB)
2025-04-02 03:53:09,587 [INFO] - GPU cache cleared: 2518.33MB → 2518.33MB (freed 0.00MB)
2025-04-02 03:59:26,043 [INFO] - GPU cache cleared: 2520.68MB → 2520.68MB (freed 0.00MB)
2025-04-02 04:05:36,134 [INFO] - GPU cache cleared: 2519.84MB → 2519.84MB (freed 0.00MB)
2025-04-02 04:11:32,844 [INFO] - GPU cache cleared: 2521.47MB → 2521.47MB (freed 0.00MB)
2025-04-02 04:17:41,023 [INFO] - GPU cache cleared: 2522.94MB → 2522.94MB (freed 0.00MB)
2025-04-02 04:25:42,022 [INFO] - GPU cache cleared: 2520.37MB → 2520.37MB (freed 0.00MB)
2025-04-02 04:31:36,876 [INFO] - GPU cache cleared: 2523.43MB → 2523.43MB (freed 0.00MB)
2025-04-02 04:38:58,929 [INFO] - GPU cache cleared: 2518.41MB → 2518.41MB (freed 0.00MB)
2025-04-02 04:45:03,541 [INFO] - GPU cache cleared: 2518.47MB → 2518.47MB (freed 0.00MB)
2025-04-02 04:51:50,102 [INFO] - GPU cache cleared: 2516.45MB → 2516.45MB (freed 0.00MB)
2025-04-02 04:58:23,508 [INFO] - GPU cache cleared: 2524.97MB → 2524.97MB (freed 0.00MB)
2025-04-02 05:04:31,626 [INFO] - GPU cache cleared: 2519.17MB → 2519.17MB (freed 0.00MB)
2025-04-02 05:11:08,505 [INFO] - GPU cache cleared: 2517.92MB → 2517.92MB (freed 0.00MB)
2025-04-02 05:17:35,419 [INFO] - GPU cache cleared: 2522.06MB → 2522.06MB (freed 0.00MB)
2025-04-02 05:24:04,345 [INFO] - GPU cache cleared: 2519.02MB → 2519.02MB (freed 0.00MB)
2025-04-02 05:30:29,819 [INFO] - GPU cache cleared: 2518.72MB → 2518.72MB (freed 0.00MB)
2025-04-02 05:35:55,871 [INFO] - GPU cache cleared: 2517.54MB → 2517.54MB (freed 0.00MB)
2025-04-02 05:41:51,265 [INFO] - GPU cache cleared: 2520.38MB → 2520.38MB (freed 0.00MB)
2025-04-02 05:47:57,713 [INFO] -   vit: Train Loss=0.7332, Train Acc=64.28%, Val Loss=1.1292, Val Acc=60.18%, ECE=0.0319
2025-04-02 05:47:57,715 [INFO] -   efficientnet: Train Loss=0.1143, Train Acc=99.66%, Val Loss=0.1314, Val Acc=97.26%, ECE=0.0458
2025-04-02 05:47:57,718 [INFO] -   inception: Train Loss=0.1528, Train Acc=99.52%, Val Loss=0.1656, Val Acc=96.40%, ECE=0.0476
2025-04-02 05:47:57,720 [INFO] -   mobilenet: Train Loss=0.1451, Train Acc=99.78%, Val Loss=0.1500, Val Acc=96.60%, ECE=0.0452
2025-04-02 05:47:57,723 [INFO] -   resnet: Train Loss=0.1377, Train Acc=99.50%, Val Loss=0.1811, Val Acc=95.80%, ECE=0.0427
2025-04-02 05:47:57,725 [INFO] -   densenet: Train Loss=0.1488, Train Acc=99.64%, Val Loss=0.1664, Val Acc=96.46%, ECE=0.0475
2025-04-02 05:47:57,729 [INFO] -   student: Train Loss=0.1104, Train Acc=99.64%, Val Loss=0.1430, Val Acc=97.34%, ECE=0.0495
2025-04-02 05:47:57,732 [INFO] - Mutual learning epoch 38 completed in 7276.57s
2025-04-02 05:47:57,733 [INFO] - Mutual Learning Epoch 39/50
2025-04-02 05:47:57,734 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-02 05:47:57,736 [INFO] - Current temperatures: {'vit': 4.952993392944336, 'efficientnet': 6.395910263061523, 'inception': 6.274946212768555, 'mobilenet': 6.382662773132324, 'resnet': 6.296635627746582, 'densenet': 6.312638282775879, 'student': 6.113206386566162}
2025-04-02 05:47:58,047 [INFO] - GPU cache cleared: 2445.06MB → 2445.06MB (freed 0.00MB)
2025-04-02 05:48:03,055 [INFO] - GPU cache cleared: 2519.85MB → 2519.85MB (freed 0.00MB)
2025-04-02 05:53:25,651 [INFO] - GPU cache cleared: 2519.89MB → 2519.89MB (freed 0.00MB)
2025-04-02 06:00:04,174 [INFO] - GPU cache cleared: 2517.64MB → 2517.64MB (freed 0.00MB)
2025-04-02 06:05:56,538 [INFO] - GPU cache cleared: 2519.89MB → 2519.89MB (freed 0.00MB)
2025-04-02 06:12:51,971 [INFO] - GPU cache cleared: 2517.70MB → 2517.70MB (freed 0.00MB)
2025-04-02 06:19:44,906 [INFO] - GPU cache cleared: 2521.68MB → 2521.68MB (freed 0.00MB)
2025-04-02 06:27:01,115 [INFO] - GPU cache cleared: 2520.74MB → 2520.74MB (freed 0.00MB)
2025-04-02 06:32:37,196 [INFO] - GPU cache cleared: 2520.78MB → 2520.78MB (freed 0.00MB)
2025-04-02 06:37:44,043 [INFO] - GPU cache cleared: 2521.68MB → 2521.68MB (freed 0.00MB)
2025-04-02 06:43:25,777 [INFO] - GPU cache cleared: 2519.28MB → 2519.28MB (freed 0.00MB)
2025-04-02 06:49:20,662 [INFO] - GPU cache cleared: 2521.72MB → 2521.72MB (freed 0.00MB)
2025-04-02 06:55:14,976 [INFO] - GPU cache cleared: 2521.16MB → 2521.16MB (freed 0.00MB)
2025-04-02 07:01:50,515 [INFO] - GPU cache cleared: 2519.61MB → 2519.61MB (freed 0.00MB)
2025-04-02 07:07:41,244 [INFO] - GPU cache cleared: 2518.39MB → 2518.39MB (freed 0.00MB)
2025-04-02 07:13:45,343 [INFO] - GPU cache cleared: 2519.82MB → 2519.82MB (freed 0.00MB)
2025-04-02 07:18:54,122 [INFO] - GPU cache cleared: 2519.25MB → 2519.25MB (freed 0.00MB)
2025-04-02 07:24:32,822 [INFO] - GPU cache cleared: 2521.82MB → 2521.82MB (freed 0.00MB)
2025-04-02 07:30:14,170 [INFO] - GPU cache cleared: 2518.60MB → 2518.60MB (freed 0.00MB)
2025-04-02 07:37:27,894 [INFO] - GPU cache cleared: 2518.09MB → 2518.09MB (freed 0.00MB)
2025-04-02 07:45:32,118 [INFO] -   vit: Train Loss=0.7313, Train Acc=64.51%, Val Loss=1.1220, Val Acc=60.24%, ECE=0.0284
2025-04-02 07:45:32,119 [INFO] -   efficientnet: Train Loss=0.1131, Train Acc=99.66%, Val Loss=0.1307, Val Acc=97.50%, ECE=0.0477
2025-04-02 07:45:32,127 [INFO] -   New best model for efficientnet (Val Acc: 97.50%)
2025-04-02 07:45:32,271 [INFO] -   inception: Train Loss=0.1499, Train Acc=99.64%, Val Loss=0.1637, Val Acc=96.72%, ECE=0.0474
2025-04-02 07:45:32,277 [INFO] -   New best model for inception (Val Acc: 96.72%)
2025-04-02 07:45:32,580 [INFO] -   mobilenet: Train Loss=0.1433, Train Acc=99.80%, Val Loss=0.1539, Val Acc=96.70%, ECE=0.0456
2025-04-02 07:45:32,580 [INFO] -   resnet: Train Loss=0.1356, Train Acc=99.56%, Val Loss=0.1727, Val Acc=96.32%, ECE=0.0469
2025-04-02 07:45:32,584 [INFO] -   New best model for resnet (Val Acc: 96.32%)
2025-04-02 07:45:32,831 [INFO] -   densenet: Train Loss=0.1471, Train Acc=99.67%, Val Loss=0.1673, Val Acc=96.66%, ECE=0.0453
2025-04-02 07:45:32,831 [INFO] -   student: Train Loss=0.1089, Train Acc=99.65%, Val Loss=0.1421, Val Acc=97.58%, ECE=0.0530
2025-04-02 07:45:32,838 [INFO] -   New best model for student (Val Acc: 97.58%)
2025-04-02 07:45:32,954 [INFO] - Mutual learning epoch 39 completed in 7055.22s
2025-04-02 07:45:32,954 [INFO] - Mutual Learning Epoch 40/50
2025-04-02 07:45:32,954 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-02 07:45:32,954 [INFO] - Current temperatures: {'vit': 4.952910423278809, 'efficientnet': 6.399448394775391, 'inception': 6.279942035675049, 'mobilenet': 6.386131286621094, 'resnet': 6.303217887878418, 'densenet': 6.317807197570801, 'student': 6.12131929397583}
2025-04-02 07:45:33,213 [INFO] - GPU cache cleared: 2444.05MB → 2444.05MB (freed 0.00MB)
2025-04-02 07:45:38,444 [INFO] - GPU cache cleared: 2519.11MB → 2519.11MB (freed 0.00MB)
2025-04-02 07:51:37,450 [INFO] - GPU cache cleared: 2523.94MB → 2523.94MB (freed 0.00MB)
2025-04-02 07:58:42,933 [INFO] - GPU cache cleared: 2519.31MB → 2519.31MB (freed 0.00MB)
2025-04-02 08:04:53,134 [INFO] - GPU cache cleared: 2519.08MB → 2519.08MB (freed 0.00MB)
2025-04-02 08:10:59,823 [INFO] - GPU cache cleared: 2518.99MB → 2518.99MB (freed 0.00MB)
2025-04-02 08:16:50,554 [INFO] - GPU cache cleared: 2519.84MB → 2519.84MB (freed 0.00MB)
2025-04-02 08:22:39,989 [INFO] - GPU cache cleared: 2517.23MB → 2517.23MB (freed 0.00MB)
2025-04-02 08:28:20,599 [INFO] - GPU cache cleared: 2520.64MB → 2520.64MB (freed 0.00MB)
2025-04-02 08:35:30,435 [INFO] - GPU cache cleared: 2521.78MB → 2521.78MB (freed 0.00MB)
2025-04-02 08:42:35,372 [INFO] - GPU cache cleared: 2517.10MB → 2517.10MB (freed 0.00MB)
2025-04-02 08:49:13,681 [INFO] - GPU cache cleared: 2522.71MB → 2522.71MB (freed 0.00MB)
2025-04-02 08:55:58,013 [INFO] - GPU cache cleared: 2520.63MB → 2520.63MB (freed 0.00MB)
2025-04-02 09:01:48,674 [INFO] - GPU cache cleared: 2520.58MB → 2520.58MB (freed 0.00MB)
2025-04-02 09:07:44,173 [INFO] - GPU cache cleared: 2519.99MB → 2519.99MB (freed 0.00MB)
2025-04-02 09:14:04,162 [INFO] - GPU cache cleared: 2521.56MB → 2521.56MB (freed 0.00MB)
2025-04-02 09:20:10,628 [INFO] - GPU cache cleared: 2524.61MB → 2524.61MB (freed 0.00MB)
2025-04-02 09:25:32,595 [INFO] - GPU cache cleared: 2522.17MB → 2522.17MB (freed 0.00MB)
2025-04-02 09:31:14,623 [INFO] - GPU cache cleared: 2520.91MB → 2520.91MB (freed 0.00MB)
2025-04-02 09:37:42,244 [INFO] - GPU cache cleared: 2520.60MB → 2520.60MB (freed 0.00MB)
2025-04-02 09:44:01,338 [INFO] -   vit: Train Loss=0.7300, Train Acc=64.39%, Val Loss=1.1280, Val Acc=60.44%, ECE=0.0359
2025-04-02 09:44:01,349 [INFO] -   New best model for vit (Val Acc: 60.44%)
2025-04-02 09:44:02,218 [INFO] -   efficientnet: Train Loss=0.1117, Train Acc=99.75%, Val Loss=0.1330, Val Acc=97.44%, ECE=0.0467
2025-04-02 09:44:02,218 [INFO] -   inception: Train Loss=0.1485, Train Acc=99.67%, Val Loss=0.1617, Val Acc=96.70%, ECE=0.0451
2025-04-02 09:44:02,225 [INFO] -   mobilenet: Train Loss=0.1424, Train Acc=99.82%, Val Loss=0.1492, Val Acc=96.74%, ECE=0.0456
2025-04-02 09:44:02,232 [INFO] -   New best model for mobilenet (Val Acc: 96.74%)
2025-04-02 09:44:02,344 [INFO] -   resnet: Train Loss=0.1341, Train Acc=99.61%, Val Loss=0.1816, Val Acc=95.96%, ECE=0.0457
2025-04-02 09:44:02,346 [INFO] -   densenet: Train Loss=0.1457, Train Acc=99.71%, Val Loss=0.1703, Val Acc=96.20%, ECE=0.0456
2025-04-02 09:44:02,348 [INFO] -   student: Train Loss=0.1082, Train Acc=99.68%, Val Loss=0.1429, Val Acc=97.30%, ECE=0.0505
2025-04-02 09:44:04,648 [INFO] - Mutual learning epoch 40 completed in 7111.69s
2025-04-02 09:44:04,648 [INFO] - Mutual Learning Epoch 41/50
2025-04-02 09:44:04,649 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-02 09:44:04,651 [INFO] - Current temperatures: {'vit': 4.952830791473389, 'efficientnet': 6.402807235717773, 'inception': 6.284551620483398, 'mobilenet': 6.389673709869385, 'resnet': 6.30886173248291, 'densenet': 6.322519779205322, 'student': 6.128185749053955}
2025-04-02 09:44:04,931 [INFO] - GPU cache cleared: 2441.36MB → 2441.36MB (freed 0.00MB)
2025-04-02 09:44:10,205 [INFO] - GPU cache cleared: 2517.62MB → 2517.62MB (freed 0.00MB)
2025-04-02 09:49:53,824 [INFO] - GPU cache cleared: 2517.46MB → 2517.46MB (freed 0.00MB)
2025-04-02 09:56:09,303 [INFO] - GPU cache cleared: 2518.93MB → 2518.93MB (freed 0.00MB)
2025-04-02 10:01:52,044 [INFO] - GPU cache cleared: 2521.61MB → 2521.61MB (freed 0.00MB)
2025-04-02 10:08:59,275 [INFO] - GPU cache cleared: 2521.13MB → 2521.13MB (freed 0.00MB)
2025-04-02 10:15:32,234 [INFO] - GPU cache cleared: 2518.69MB → 2518.69MB (freed 0.00MB)
2025-04-02 10:22:11,845 [INFO] - GPU cache cleared: 2518.77MB → 2518.77MB (freed 0.00MB)
2025-04-02 10:28:01,827 [INFO] - GPU cache cleared: 2521.35MB → 2521.35MB (freed 0.00MB)
2025-04-02 10:34:11,266 [INFO] - GPU cache cleared: 2521.60MB → 2521.60MB (freed 0.00MB)
2025-04-02 10:40:47,914 [INFO] - GPU cache cleared: 2519.52MB → 2519.52MB (freed 0.00MB)
2025-04-02 10:47:06,491 [INFO] - GPU cache cleared: 2520.47MB → 2520.47MB (freed 0.00MB)
2025-04-02 10:53:12,409 [INFO] - GPU cache cleared: 2519.14MB → 2519.14MB (freed 0.00MB)
2025-04-02 11:00:20,623 [INFO] - GPU cache cleared: 2521.59MB → 2521.59MB (freed 0.00MB)
2025-04-02 11:07:05,412 [INFO] - GPU cache cleared: 2520.35MB → 2520.35MB (freed 0.00MB)
2025-04-02 11:13:24,637 [INFO] - GPU cache cleared: 2520.20MB → 2520.20MB (freed 0.00MB)
2025-04-02 11:19:37,795 [INFO] - GPU cache cleared: 2520.79MB → 2520.79MB (freed 0.00MB)
2025-04-02 11:26:39,681 [INFO] - GPU cache cleared: 2519.80MB → 2519.80MB (freed 0.00MB)
2025-04-02 11:32:40,641 [INFO] - GPU cache cleared: 2519.32MB → 2519.32MB (freed 0.00MB)
2025-04-02 11:39:07,562 [INFO] - GPU cache cleared: 2518.58MB → 2518.58MB (freed 0.00MB)
2025-04-02 11:46:04,733 [INFO] -   vit: Train Loss=0.7295, Train Acc=64.32%, Val Loss=1.1224, Val Acc=60.36%, ECE=0.0342
2025-04-02 11:46:04,735 [INFO] -   efficientnet: Train Loss=0.1112, Train Acc=99.72%, Val Loss=0.1381, Val Acc=97.26%, ECE=0.0484
2025-04-02 11:46:04,739 [INFO] -   inception: Train Loss=0.1475, Train Acc=99.69%, Val Loss=0.1625, Val Acc=96.58%, ECE=0.0458
2025-04-02 11:46:04,741 [INFO] -   mobilenet: Train Loss=0.1421, Train Acc=99.80%, Val Loss=0.1534, Val Acc=96.74%, ECE=0.0463
2025-04-02 11:46:04,743 [INFO] -   resnet: Train Loss=0.1328, Train Acc=99.60%, Val Loss=0.1794, Val Acc=95.98%, ECE=0.0438
2025-04-02 11:46:04,745 [INFO] -   densenet: Train Loss=0.1453, Train Acc=99.69%, Val Loss=0.1647, Val Acc=96.48%, ECE=0.0461
2025-04-02 11:46:04,748 [INFO] -   student: Train Loss=0.1071, Train Acc=99.72%, Val Loss=0.1444, Val Acc=97.46%, ECE=0.0532
2025-04-02 11:46:04,750 [INFO] - Mutual learning epoch 41 completed in 7320.10s
2025-04-02 11:46:04,751 [INFO] - Mutual Learning Epoch 42/50
2025-04-02 11:46:04,751 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-02 11:46:04,754 [INFO] - Current temperatures: {'vit': 4.9527692794799805, 'efficientnet': 6.405496120452881, 'inception': 6.288265705108643, 'mobilenet': 6.392717361450195, 'resnet': 6.313790798187256, 'densenet': 6.326775550842285, 'student': 6.1341962814331055}
2025-04-02 11:46:05,033 [INFO] - GPU cache cleared: 2443.78MB → 2443.78MB (freed 0.00MB)
2025-04-02 11:46:12,229 [INFO] - GPU cache cleared: 2521.18MB → 2521.18MB (freed 0.00MB)
2025-04-02 11:52:14,596 [INFO] - GPU cache cleared: 2523.41MB → 2523.41MB (freed 0.00MB)
2025-04-02 11:58:54,528 [INFO] - GPU cache cleared: 2520.38MB → 2520.38MB (freed 0.00MB)
2025-04-02 12:05:09,434 [INFO] - GPU cache cleared: 2519.74MB → 2519.74MB (freed 0.00MB)
2025-04-02 12:11:29,763 [INFO] - GPU cache cleared: 2519.58MB → 2519.58MB (freed 0.00MB)
2025-04-02 12:17:36,379 [INFO] - GPU cache cleared: 2519.53MB → 2519.53MB (freed 0.00MB)
2025-04-02 12:24:02,396 [INFO] - GPU cache cleared: 2520.76MB → 2520.76MB (freed 0.00MB)
2025-04-02 12:29:57,805 [INFO] - GPU cache cleared: 2517.90MB → 2517.90MB (freed 0.00MB)
2025-04-02 12:36:24,284 [INFO] - GPU cache cleared: 2522.33MB → 2522.33MB (freed 0.00MB)
2025-04-02 12:42:21,933 [INFO] - GPU cache cleared: 2519.50MB → 2519.50MB (freed 0.00MB)
2025-04-02 12:48:51,113 [INFO] - GPU cache cleared: 2522.11MB → 2522.11MB (freed 0.00MB)
2025-04-02 12:55:33,745 [INFO] - GPU cache cleared: 2517.96MB → 2517.96MB (freed 0.00MB)
2025-04-02 13:02:50,131 [INFO] - GPU cache cleared: 2522.27MB → 2522.27MB (freed 0.00MB)
2025-04-02 13:08:51,388 [INFO] - GPU cache cleared: 2517.05MB → 2517.05MB (freed 0.00MB)
2025-04-02 13:15:30,791 [INFO] - GPU cache cleared: 2515.31MB → 2515.31MB (freed 0.00MB)
2025-04-02 13:21:58,044 [INFO] - GPU cache cleared: 2521.78MB → 2521.78MB (freed 0.00MB)
2025-04-02 13:29:12,215 [INFO] - GPU cache cleared: 2521.10MB → 2521.10MB (freed 0.00MB)
2025-04-02 13:35:46,827 [INFO] - GPU cache cleared: 2518.89MB → 2518.89MB (freed 0.00MB)
2025-04-02 13:41:55,905 [INFO] - GPU cache cleared: 2520.14MB → 2520.14MB (freed 0.00MB)
2025-04-02 13:49:48,972 [INFO] -   vit: Train Loss=0.7290, Train Acc=64.41%, Val Loss=1.1248, Val Acc=60.54%, ECE=0.0334
2025-04-02 13:49:48,977 [INFO] -   New best model for vit (Val Acc: 60.54%)
2025-04-02 13:49:49,958 [INFO] -   efficientnet: Train Loss=0.1102, Train Acc=99.78%, Val Loss=0.1337, Val Acc=97.40%, ECE=0.0470
2025-04-02 13:49:49,964 [INFO] -   inception: Train Loss=0.1466, Train Acc=99.72%, Val Loss=0.1649, Val Acc=96.52%, ECE=0.0441
2025-04-02 13:49:49,964 [INFO] -   mobilenet: Train Loss=0.1414, Train Acc=99.82%, Val Loss=0.1483, Val Acc=96.76%, ECE=0.0456
2025-04-02 13:49:49,968 [INFO] -   New best model for mobilenet (Val Acc: 96.76%)
2025-04-02 13:49:50,118 [INFO] -   resnet: Train Loss=0.1311, Train Acc=99.71%, Val Loss=0.1725, Val Acc=96.26%, ECE=0.0461
2025-04-02 13:49:50,124 [INFO] -   densenet: Train Loss=0.1440, Train Acc=99.76%, Val Loss=0.1626, Val Acc=96.56%, ECE=0.0435
2025-04-02 13:49:50,124 [INFO] -   student: Train Loss=0.1066, Train Acc=99.74%, Val Loss=0.1415, Val Acc=97.44%, ECE=0.0521
2025-04-02 13:49:50,128 [INFO] - Mutual learning epoch 42 completed in 7425.38s
2025-04-02 13:49:50,128 [INFO] - Mutual Learning Epoch 43/50
2025-04-02 13:49:50,128 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-02 13:49:50,128 [INFO] - Current temperatures: {'vit': 4.952723503112793, 'efficientnet': 6.407732963562012, 'inception': 6.291434288024902, 'mobilenet': 6.394956111907959, 'resnet': 6.317750453948975, 'densenet': 6.329872131347656, 'student': 6.139149188995361}
2025-04-02 13:49:50,407 [INFO] - GPU cache cleared: 2446.22MB → 2446.22MB (freed 0.00MB)
2025-04-02 13:49:55,820 [INFO] - GPU cache cleared: 2518.71MB → 2518.71MB (freed 0.00MB)
2025-04-02 13:55:44,794 [INFO] - GPU cache cleared: 2521.21MB → 2521.21MB (freed 0.00MB)
2025-04-02 14:02:05,453 [INFO] - GPU cache cleared: 2520.42MB → 2520.42MB (freed 0.00MB)
2025-04-02 14:08:14,112 [INFO] - GPU cache cleared: 2523.14MB → 2523.14MB (freed 0.00MB)
2025-04-02 14:14:51,227 [INFO] - GPU cache cleared: 2519.66MB → 2519.66MB (freed 0.00MB)
2025-04-02 14:20:43,380 [INFO] - GPU cache cleared: 2519.79MB → 2519.79MB (freed 0.00MB)
2025-04-02 14:27:50,904 [INFO] - GPU cache cleared: 2523.87MB → 2523.87MB (freed 0.00MB)
2025-04-02 14:33:51,877 [INFO] - GPU cache cleared: 2520.17MB → 2520.17MB (freed 0.00MB)
2025-04-02 14:40:03,909 [INFO] - GPU cache cleared: 2519.21MB → 2519.21MB (freed 0.00MB)
2025-04-02 14:46:50,358 [INFO] - GPU cache cleared: 2520.57MB → 2520.57MB (freed 0.00MB)
2025-04-02 14:53:18,791 [INFO] - GPU cache cleared: 2516.76MB → 2516.76MB (freed 0.00MB)
2025-04-02 14:59:51,117 [INFO] - GPU cache cleared: 2520.77MB → 2520.77MB (freed 0.00MB)
2025-04-02 15:06:12,660 [INFO] - GPU cache cleared: 2520.00MB → 2520.00MB (freed 0.00MB)
2025-04-02 15:12:54,955 [INFO] - GPU cache cleared: 2516.48MB → 2516.48MB (freed 0.00MB)
2025-04-02 15:19:36,432 [INFO] - GPU cache cleared: 2522.19MB → 2522.19MB (freed 0.00MB)
2025-04-02 15:26:14,429 [INFO] - GPU cache cleared: 2521.11MB → 2521.11MB (freed 0.00MB)
2025-04-02 15:33:24,624 [INFO] - GPU cache cleared: 2519.06MB → 2519.06MB (freed 0.00MB)
2025-04-02 15:40:06,164 [INFO] - GPU cache cleared: 2520.00MB → 2520.00MB (freed 0.00MB)
2025-04-02 15:46:12,225 [INFO] - GPU cache cleared: 2521.06MB → 2521.06MB (freed 0.00MB)
2025-04-02 15:54:31,157 [INFO] -   vit: Train Loss=0.7279, Train Acc=64.81%, Val Loss=1.1209, Val Acc=60.68%, ECE=0.0324
2025-04-02 15:54:31,163 [INFO] -   New best model for vit (Val Acc: 60.68%)
2025-04-02 15:54:31,908 [INFO] -   efficientnet: Train Loss=0.1090, Train Acc=99.78%, Val Loss=0.1332, Val Acc=97.38%, ECE=0.0458
2025-04-02 15:54:31,908 [INFO] -   inception: Train Loss=0.1451, Train Acc=99.78%, Val Loss=0.1593, Val Acc=96.72%, ECE=0.0453
2025-04-02 15:54:31,908 [INFO] -   mobilenet: Train Loss=0.1399, Train Acc=99.86%, Val Loss=0.1496, Val Acc=96.82%, ECE=0.0470
2025-04-02 15:54:31,916 [INFO] -   New best model for mobilenet (Val Acc: 96.82%)
2025-04-02 15:54:32,025 [INFO] -   resnet: Train Loss=0.1297, Train Acc=99.75%, Val Loss=0.1761, Val Acc=96.06%, ECE=0.0453
2025-04-02 15:54:32,026 [INFO] -   densenet: Train Loss=0.1425, Train Acc=99.79%, Val Loss=0.1621, Val Acc=96.66%, ECE=0.0467
2025-04-02 15:54:32,030 [INFO] -   student: Train Loss=0.1055, Train Acc=99.78%, Val Loss=0.1407, Val Acc=97.46%, ECE=0.0508
2025-04-02 15:54:32,031 [INFO] - Mutual learning epoch 43 completed in 7481.90s
2025-04-02 15:54:32,032 [INFO] - Mutual Learning Epoch 44/50
2025-04-02 15:54:32,033 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-02 15:54:32,033 [INFO] - Current temperatures: {'vit': 4.952677249908447, 'efficientnet': 6.409528732299805, 'inception': 6.2942118644714355, 'mobilenet': 6.397096633911133, 'resnet': 6.321228504180908, 'densenet': 6.332889080047607, 'student': 6.143161773681641}
2025-04-02 15:54:32,308 [INFO] - GPU cache cleared: 2444.61MB → 2444.61MB (freed 0.00MB)
2025-04-02 15:54:39,321 [INFO] - GPU cache cleared: 2523.78MB → 2523.78MB (freed 0.00MB)
2025-04-02 16:00:16,273 [INFO] - GPU cache cleared: 2517.24MB → 2517.24MB (freed 0.00MB)
2025-04-02 16:07:00,813 [INFO] - GPU cache cleared: 2520.95MB → 2520.95MB (freed 0.00MB)
2025-04-02 16:12:33,095 [INFO] - GPU cache cleared: 2519.91MB → 2519.91MB (freed 0.00MB)
2025-04-02 16:18:50,069 [INFO] - GPU cache cleared: 2519.54MB → 2519.54MB (freed 0.00MB)
2025-04-02 16:25:22,458 [INFO] - GPU cache cleared: 2517.38MB → 2517.38MB (freed 0.00MB)
2025-04-02 16:32:22,285 [INFO] - GPU cache cleared: 2519.99MB → 2519.99MB (freed 0.00MB)
2025-04-02 16:38:33,510 [INFO] - GPU cache cleared: 2523.31MB → 2523.31MB (freed 0.00MB)
2025-04-02 16:43:45,095 [INFO] - GPU cache cleared: 2517.26MB → 2517.26MB (freed 0.00MB)
2025-04-02 16:48:55,466 [INFO] - GPU cache cleared: 2517.20MB → 2517.20MB (freed 0.00MB)
2025-04-02 16:54:55,369 [INFO] - GPU cache cleared: 2523.70MB → 2523.70MB (freed 0.00MB)
2025-04-02 17:00:18,053 [INFO] - GPU cache cleared: 2520.49MB → 2520.49MB (freed 0.00MB)
2025-04-02 17:06:07,530 [INFO] - GPU cache cleared: 2521.29MB → 2521.29MB (freed 0.00MB)
2025-04-02 17:11:37,229 [INFO] - GPU cache cleared: 2517.47MB → 2517.47MB (freed 0.00MB)
2025-04-02 17:17:27,659 [INFO] - GPU cache cleared: 2520.00MB → 2520.00MB (freed 0.00MB)
2025-04-02 17:23:17,595 [INFO] - GPU cache cleared: 2520.54MB → 2520.54MB (freed 0.00MB)
2025-04-02 17:28:39,441 [INFO] - GPU cache cleared: 2521.86MB → 2521.86MB (freed 0.00MB)
2025-04-02 17:33:45,765 [INFO] - GPU cache cleared: 2521.68MB → 2521.68MB (freed 0.00MB)
2025-04-02 17:40:12,033 [INFO] - GPU cache cleared: 2519.92MB → 2519.92MB (freed 0.00MB)
2025-04-02 17:46:15,625 [INFO] -   vit: Train Loss=0.7255, Train Acc=64.68%, Val Loss=1.1231, Val Acc=60.42%, ECE=0.0329
2025-04-02 17:46:15,625 [INFO] -   efficientnet: Train Loss=0.1087, Train Acc=99.78%, Val Loss=0.1323, Val Acc=97.60%, ECE=0.0455
2025-04-02 17:46:15,632 [INFO] -   New best model for efficientnet (Val Acc: 97.60%)
2025-04-02 17:46:15,764 [INFO] -   inception: Train Loss=0.1442, Train Acc=99.80%, Val Loss=0.1566, Val Acc=96.96%, ECE=0.0467
2025-04-02 17:46:15,768 [INFO] -   New best model for inception (Val Acc: 96.96%)
2025-04-02 17:46:16,027 [INFO] -   mobilenet: Train Loss=0.1393, Train Acc=99.87%, Val Loss=0.1463, Val Acc=97.02%, ECE=0.0451
2025-04-02 17:46:16,034 [INFO] -   New best model for mobilenet (Val Acc: 97.02%)
2025-04-02 17:46:16,142 [INFO] -   resnet: Train Loss=0.1289, Train Acc=99.76%, Val Loss=0.1720, Val Acc=96.20%, ECE=0.0470
2025-04-02 17:46:16,142 [INFO] -   densenet: Train Loss=0.1419, Train Acc=99.81%, Val Loss=0.1570, Val Acc=96.74%, ECE=0.0448
2025-04-02 17:46:16,146 [INFO] -   student: Train Loss=0.1055, Train Acc=99.76%, Val Loss=0.1406, Val Acc=97.44%, ECE=0.0515
2025-04-02 17:46:16,146 [INFO] - Mutual learning epoch 44 completed in 6704.11s
2025-04-02 17:46:16,146 [INFO] - Mutual Learning Epoch 45/50
2025-04-02 17:46:16,146 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-02 17:46:16,152 [INFO] - Current temperatures: {'vit': 4.952645778656006, 'efficientnet': 6.41099214553833, 'inception': 6.2964701652526855, 'mobilenet': 6.398584365844727, 'resnet': 6.323892116546631, 'densenet': 6.335033893585205, 'student': 6.146273136138916}
2025-04-02 17:46:16,424 [INFO] - GPU cache cleared: 2444.15MB → 2444.15MB (freed 0.00MB)
2025-04-02 17:46:21,952 [INFO] - GPU cache cleared: 2518.61MB → 2518.61MB (freed 0.00MB)
2025-04-02 17:52:15,976 [INFO] - GPU cache cleared: 2520.35MB → 2520.35MB (freed 0.00MB)
2025-04-02 17:59:49,503 [INFO] - GPU cache cleared: 2519.32MB → 2519.32MB (freed 0.00MB)
2025-04-02 18:05:56,085 [INFO] - GPU cache cleared: 2519.36MB → 2519.36MB (freed 0.00MB)
2025-04-02 18:13:03,283 [INFO] - GPU cache cleared: 2521.55MB → 2521.55MB (freed 0.00MB)
2025-04-02 18:19:23,255 [INFO] - GPU cache cleared: 2519.02MB → 2519.02MB (freed 0.00MB)
2025-04-02 18:25:37,907 [INFO] - GPU cache cleared: 2519.16MB → 2519.16MB (freed 0.00MB)
2025-04-02 18:31:18,516 [INFO] - GPU cache cleared: 2521.27MB → 2521.27MB (freed 0.00MB)
2025-04-02 18:38:00,380 [INFO] - GPU cache cleared: 2518.93MB → 2518.93MB (freed 0.00MB)
2025-04-02 18:43:17,225 [INFO] - GPU cache cleared: 2517.97MB → 2517.97MB (freed 0.00MB)
2025-04-02 18:48:47,438 [INFO] - GPU cache cleared: 2522.51MB → 2522.51MB (freed 0.00MB)
2025-04-02 18:54:08,929 [INFO] - GPU cache cleared: 2518.51MB → 2518.51MB (freed 0.00MB)
2025-04-02 18:59:30,874 [INFO] - GPU cache cleared: 2520.02MB → 2520.02MB (freed 0.00MB)
2025-04-02 19:04:54,543 [INFO] - GPU cache cleared: 2520.07MB → 2520.07MB (freed 0.00MB)
2025-04-02 19:11:20,866 [INFO] - GPU cache cleared: 2521.06MB → 2521.06MB (freed 0.00MB)
2025-04-02 19:16:54,800 [INFO] - GPU cache cleared: 2518.62MB → 2518.62MB (freed 0.00MB)
2025-04-02 19:23:24,123 [INFO] - GPU cache cleared: 2521.54MB → 2521.54MB (freed 0.00MB)
2025-04-02 19:29:12,626 [INFO] - GPU cache cleared: 2518.57MB → 2518.57MB (freed 0.00MB)
2025-04-02 19:35:35,004 [INFO] - GPU cache cleared: 2516.50MB → 2516.50MB (freed 0.00MB)
2025-04-02 19:42:10,960 [INFO] -   vit: Train Loss=0.7252, Train Acc=64.82%, Val Loss=1.1226, Val Acc=60.50%, ECE=0.0338
2025-04-02 19:42:10,966 [INFO] -   efficientnet: Train Loss=0.1080, Train Acc=99.80%, Val Loss=0.1352, Val Acc=97.44%, ECE=0.0454
2025-04-02 19:42:10,969 [INFO] -   inception: Train Loss=0.1436, Train Acc=99.78%, Val Loss=0.1623, Val Acc=96.84%, ECE=0.0471
2025-04-02 19:42:10,971 [INFO] -   mobilenet: Train Loss=0.1389, Train Acc=99.87%, Val Loss=0.1484, Val Acc=96.72%, ECE=0.0445
2025-04-02 19:42:10,973 [INFO] -   resnet: Train Loss=0.1281, Train Acc=99.78%, Val Loss=0.1696, Val Acc=96.32%, ECE=0.0468
2025-04-02 19:42:10,975 [INFO] -   densenet: Train Loss=0.1409, Train Acc=99.86%, Val Loss=0.1603, Val Acc=96.64%, ECE=0.0448
2025-04-02 19:42:10,977 [INFO] -   student: Train Loss=0.1040, Train Acc=99.81%, Val Loss=0.1421, Val Acc=97.48%, ECE=0.0503
2025-04-02 19:42:10,979 [INFO] - Mutual learning epoch 45 completed in 6954.83s
2025-04-02 19:42:10,980 [INFO] - Mutual Learning Epoch 46/50
2025-04-02 19:42:10,981 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-02 19:42:10,983 [INFO] - Current temperatures: {'vit': 4.9526190757751465, 'efficientnet': 6.412142753601074, 'inception': 6.298152446746826, 'mobilenet': 6.399807453155518, 'resnet': 6.3259782791137695, 'densenet': 6.33673620223999, 'student': 6.148732662200928}
2025-04-02 19:42:11,306 [INFO] - GPU cache cleared: 2442.01MB → 2442.01MB (freed 0.00MB)
2025-04-02 19:42:18,306 [INFO] - GPU cache cleared: 2520.04MB → 2520.04MB (freed 0.00MB)
2025-04-02 19:47:46,595 [INFO] - GPU cache cleared: 2517.65MB → 2517.65MB (freed 0.00MB)
2025-04-02 19:55:43,433 [INFO] - GPU cache cleared: 2519.13MB → 2519.13MB (freed 0.00MB)
2025-04-02 20:04:09,474 [INFO] - GPU cache cleared: 2520.77MB → 2520.77MB (freed 0.00MB)
2025-04-02 20:13:58,046 [INFO] - GPU cache cleared: 2517.60MB → 2517.60MB (freed 0.00MB)
2025-04-02 20:22:45,451 [INFO] - GPU cache cleared: 2517.57MB → 2517.57MB (freed 0.00MB)
2025-04-02 20:29:48,020 [INFO] - GPU cache cleared: 2518.98MB → 2518.98MB (freed 0.00MB)
2025-04-02 20:35:37,166 [INFO] - GPU cache cleared: 2521.39MB → 2521.39MB (freed 0.00MB)
2025-04-02 20:41:26,538 [INFO] - GPU cache cleared: 2521.48MB → 2521.48MB (freed 0.00MB)
2025-04-02 20:47:06,669 [INFO] - GPU cache cleared: 2520.33MB → 2520.33MB (freed 0.00MB)
2025-04-02 20:52:59,451 [INFO] - GPU cache cleared: 2518.69MB → 2518.69MB (freed 0.00MB)
2025-04-02 20:58:26,103 [INFO] - GPU cache cleared: 2519.96MB → 2519.96MB (freed 0.00MB)
2025-04-02 21:04:50,335 [INFO] - GPU cache cleared: 2521.79MB → 2521.79MB (freed 0.00MB)
2025-04-02 21:10:11,160 [INFO] - GPU cache cleared: 2517.69MB → 2517.69MB (freed 0.00MB)
2025-04-02 21:15:29,154 [INFO] - GPU cache cleared: 2517.59MB → 2517.59MB (freed 0.00MB)
2025-04-02 21:21:05,387 [INFO] - GPU cache cleared: 2519.37MB → 2519.37MB (freed 0.00MB)
2025-04-02 21:27:02,175 [INFO] - GPU cache cleared: 2515.96MB → 2515.96MB (freed 0.00MB)
2025-04-02 21:32:36,291 [INFO] - GPU cache cleared: 2522.37MB → 2522.37MB (freed 0.00MB)
2025-04-02 21:38:32,786 [INFO] - GPU cache cleared: 2521.51MB → 2521.51MB (freed 0.00MB)
2025-04-02 21:44:39,175 [INFO] -   vit: Train Loss=0.7245, Train Acc=64.74%, Val Loss=1.1233, Val Acc=60.16%, ECE=0.0334
2025-04-02 21:44:39,177 [INFO] -   efficientnet: Train Loss=0.1078, Train Acc=99.79%, Val Loss=0.1325, Val Acc=97.52%, ECE=0.0453
2025-04-02 21:44:39,180 [INFO] -   inception: Train Loss=0.1431, Train Acc=99.79%, Val Loss=0.1595, Val Acc=96.80%, ECE=0.0443
2025-04-02 21:44:39,182 [INFO] -   mobilenet: Train Loss=0.1386, Train Acc=99.85%, Val Loss=0.1484, Val Acc=96.92%, ECE=0.0481
2025-04-02 21:44:39,184 [INFO] -   resnet: Train Loss=0.1275, Train Acc=99.77%, Val Loss=0.1673, Val Acc=96.30%, ECE=0.0474
2025-04-02 21:44:39,187 [INFO] -   densenet: Train Loss=0.1407, Train Acc=99.84%, Val Loss=0.1605, Val Acc=96.80%, ECE=0.0453
2025-04-02 21:44:39,188 [INFO] -   student: Train Loss=0.1045, Train Acc=99.77%, Val Loss=0.1421, Val Acc=97.36%, ECE=0.0493
2025-04-02 21:44:39,191 [INFO] - Mutual learning epoch 46 completed in 7348.21s
2025-04-02 21:44:39,192 [INFO] - Mutual Learning Epoch 47/50
2025-04-02 21:44:39,193 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-02 21:44:39,194 [INFO] - Current temperatures: {'vit': 4.95259952545166, 'efficientnet': 6.41295862197876, 'inception': 6.29940938949585, 'mobilenet': 6.400637626647949, 'resnet': 6.3274407386779785, 'densenet': 6.338067531585693, 'student': 6.1504716873168945}
2025-04-02 21:44:39,611 [INFO] - GPU cache cleared: 2444.13MB → 2444.13MB (freed 0.00MB)
2025-04-02 21:44:45,061 [INFO] - GPU cache cleared: 2520.52MB → 2520.52MB (freed 0.00MB)
2025-04-02 21:50:00,814 [INFO] - GPU cache cleared: 2518.43MB → 2518.43MB (freed 0.00MB)
2025-04-02 21:55:24,220 [INFO] - GPU cache cleared: 2515.66MB → 2515.66MB (freed 0.00MB)
2025-04-02 22:00:31,435 [INFO] - GPU cache cleared: 2519.90MB → 2519.90MB (freed 0.00MB)
2025-04-02 22:05:33,824 [INFO] - GPU cache cleared: 2520.58MB → 2520.58MB (freed 0.00MB)
2025-04-02 22:10:39,535 [INFO] - GPU cache cleared: 2520.01MB → 2520.01MB (freed 0.00MB)
2025-04-02 22:16:41,655 [INFO] - GPU cache cleared: 2522.90MB → 2522.90MB (freed 0.00MB)
2025-04-02 22:21:48,907 [INFO] - GPU cache cleared: 2521.61MB → 2521.61MB (freed 0.00MB)
2025-04-02 22:27:11,036 [INFO] - GPU cache cleared: 2519.37MB → 2519.37MB (freed 0.00MB)
2025-04-02 22:32:55,227 [INFO] - GPU cache cleared: 2521.07MB → 2521.07MB (freed 0.00MB)
2025-04-02 22:38:02,942 [INFO] - GPU cache cleared: 2516.53MB → 2516.53MB (freed 0.00MB)
2025-04-02 22:43:42,392 [INFO] - GPU cache cleared: 2520.58MB → 2520.58MB (freed 0.00MB)
2025-04-02 22:49:08,226 [INFO] - GPU cache cleared: 2522.13MB → 2522.13MB (freed 0.00MB)
2025-04-02 22:54:30,025 [INFO] - GPU cache cleared: 2520.36MB → 2520.36MB (freed 0.00MB)
2025-04-02 22:59:29,637 [INFO] - GPU cache cleared: 2518.27MB → 2518.27MB (freed 0.00MB)
2025-04-02 23:04:02,325 [INFO] - GPU cache cleared: 2519.46MB → 2519.46MB (freed 0.00MB)
2025-04-02 23:10:56,994 [INFO] - GPU cache cleared: 2520.61MB → 2520.61MB (freed 0.00MB)
2025-04-02 23:16:43,627 [INFO] - GPU cache cleared: 2519.80MB → 2519.80MB (freed 0.00MB)
2025-04-02 23:22:59,995 [INFO] - GPU cache cleared: 2521.18MB → 2521.18MB (freed 0.00MB)
2025-04-02 23:30:23,474 [INFO] -   vit: Train Loss=0.7264, Train Acc=64.74%, Val Loss=1.1218, Val Acc=60.36%, ECE=0.0315
2025-04-02 23:30:23,475 [INFO] -   efficientnet: Train Loss=0.1074, Train Acc=99.81%, Val Loss=0.1326, Val Acc=97.52%, ECE=0.0475
2025-04-02 23:30:23,475 [INFO] -   inception: Train Loss=0.1430, Train Acc=99.82%, Val Loss=0.1586, Val Acc=96.94%, ECE=0.0476
2025-04-02 23:30:23,475 [INFO] -   mobilenet: Train Loss=0.1385, Train Acc=99.86%, Val Loss=0.1493, Val Acc=96.84%, ECE=0.0443
2025-04-02 23:30:23,483 [INFO] -   resnet: Train Loss=0.1271, Train Acc=99.80%, Val Loss=0.1684, Val Acc=96.34%, ECE=0.0478
2025-04-02 23:30:23,489 [INFO] -   New best model for resnet (Val Acc: 96.34%)
2025-04-02 23:30:23,742 [INFO] -   densenet: Train Loss=0.1404, Train Acc=99.84%, Val Loss=0.1579, Val Acc=96.76%, ECE=0.0448
2025-04-02 23:30:23,743 [INFO] -   student: Train Loss=0.1039, Train Acc=99.83%, Val Loss=0.1414, Val Acc=97.46%, ECE=0.0502
2025-04-02 23:30:23,745 [INFO] - Mutual learning epoch 47 completed in 6344.55s
2025-04-02 23:30:23,745 [INFO] - Mutual Learning Epoch 48/50
2025-04-02 23:30:23,745 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-02 23:30:23,749 [INFO] - Current temperatures: {'vit': 4.952587604522705, 'efficientnet': 6.413517475128174, 'inception': 6.300122261047363, 'mobilenet': 6.401119232177734, 'resnet': 6.328396797180176, 'densenet': 6.338815212249756, 'student': 6.151622772216797}
2025-04-02 23:30:24,118 [INFO] - GPU cache cleared: 2446.78MB → 2446.78MB (freed 0.00MB)
2025-04-02 23:30:29,925 [INFO] - GPU cache cleared: 2518.85MB → 2518.85MB (freed 0.00MB)
2025-04-02 23:35:58,841 [INFO] - GPU cache cleared: 2517.74MB → 2517.74MB (freed 0.00MB)
2025-04-02 23:41:52,614 [INFO] - GPU cache cleared: 2520.97MB → 2520.97MB (freed 0.00MB)
2025-04-02 23:47:18,373 [INFO] - GPU cache cleared: 2519.99MB → 2519.99MB (freed 0.00MB)
2025-04-02 23:53:19,444 [INFO] - GPU cache cleared: 2520.91MB → 2520.91MB (freed 0.00MB)
2025-04-02 23:58:22,059 [INFO] - GPU cache cleared: 2520.71MB → 2520.71MB (freed 0.00MB)
2025-04-03 00:04:22,616 [INFO] - GPU cache cleared: 2520.38MB → 2520.38MB (freed 0.00MB)
2025-04-03 00:09:50,266 [INFO] - GPU cache cleared: 2521.32MB → 2521.32MB (freed 0.00MB)
2025-04-03 00:15:54,007 [INFO] - GPU cache cleared: 2520.44MB → 2520.44MB (freed 0.00MB)
2025-04-03 00:21:54,387 [INFO] - GPU cache cleared: 2520.51MB → 2520.51MB (freed 0.00MB)
2025-04-03 00:28:31,473 [INFO] - GPU cache cleared: 2516.13MB → 2516.13MB (freed 0.00MB)
2025-04-03 00:34:24,407 [INFO] - GPU cache cleared: 2519.80MB → 2519.80MB (freed 0.00MB)
2025-04-03 00:40:58,538 [INFO] - GPU cache cleared: 2518.45MB → 2518.45MB (freed 0.00MB)
2025-04-03 00:47:06,251 [INFO] - GPU cache cleared: 2521.87MB → 2521.87MB (freed 0.00MB)
2025-04-03 00:54:04,785 [INFO] - GPU cache cleared: 2518.29MB → 2518.29MB (freed 0.00MB)
2025-04-03 00:59:55,531 [INFO] - GPU cache cleared: 2519.40MB → 2519.40MB (freed 0.00MB)
2025-04-03 01:05:53,320 [INFO] - GPU cache cleared: 2521.76MB → 2521.76MB (freed 0.00MB)
2025-04-03 01:11:22,230 [INFO] - GPU cache cleared: 2521.95MB → 2521.95MB (freed 0.00MB)
2025-04-03 01:17:30,239 [INFO] - GPU cache cleared: 2518.98MB → 2518.98MB (freed 0.00MB)
2025-04-03 01:24:05,475 [INFO] -   vit: Train Loss=0.7215, Train Acc=64.83%, Val Loss=1.1219, Val Acc=60.34%, ECE=0.0332
2025-04-03 01:24:05,476 [INFO] -   efficientnet: Train Loss=0.1073, Train Acc=99.80%, Val Loss=0.1331, Val Acc=97.42%, ECE=0.0459
2025-04-03 01:24:05,478 [INFO] -   inception: Train Loss=0.1421, Train Acc=99.82%, Val Loss=0.1606, Val Acc=96.82%, ECE=0.0468
2025-04-03 01:24:05,478 [INFO] -   mobilenet: Train Loss=0.1379, Train Acc=99.86%, Val Loss=0.1481, Val Acc=96.84%, ECE=0.0447
2025-04-03 01:24:05,484 [INFO] -   resnet: Train Loss=0.1270, Train Acc=99.79%, Val Loss=0.1692, Val Acc=96.34%, ECE=0.0460
2025-04-03 01:24:05,487 [INFO] -   densenet: Train Loss=0.1401, Train Acc=99.84%, Val Loss=0.1570, Val Acc=96.74%, ECE=0.0446
2025-04-03 01:24:05,490 [INFO] -   student: Train Loss=0.1038, Train Acc=99.79%, Val Loss=0.1424, Val Acc=97.44%, ECE=0.0530
2025-04-03 01:24:05,492 [INFO] - Mutual learning epoch 48 completed in 6821.75s
2025-04-03 01:24:05,493 [INFO] - Mutual Learning Epoch 49/50
2025-04-03 01:24:05,494 [INFO] - Mutual weight: 0.6000, Calibration weight: 0.2000
2025-04-03 01:24:05,496 [INFO] - Current temperatures: {'vit': 4.952579498291016, 'efficientnet': 6.413904190063477, 'inception': 6.300600528717041, 'mobilenet': 6.401436805725098, 'resnet': 6.3289923667907715, 'densenet': 6.339330196380615, 'student': 6.152282238006592}
2025-04-03 01:24:05,826 [INFO] - GPU cache cleared: 2446.00MB → 2446.00MB (freed 0.00MB)
2025-04-03 01:24:11,566 [INFO] - GPU cache cleared: 2516.01MB → 2516.01MB (freed 0.00MB)
2025-04-03 01:30:15,891 [INFO] - GPU cache cleared: 2523.06MB → 2523.06MB (freed 0.00MB)
2025-04-03 01:37:04,224 [INFO] - GPU cache cleared: 2517.67MB → 2517.67MB (freed 0.00MB)
2025-04-03 01:43:58,870 [INFO] - GPU cache cleared: 2520.21MB → 2520.21MB (freed 0.00MB)
2025-04-03 01:51:12,121 [INFO] - GPU cache cleared: 2519.34MB → 2519.34MB (freed 0.00MB)
2025-04-03 01:57:50,823 [INFO] - GPU cache cleared: 2521.96MB → 2521.96MB (freed 0.00MB)
2025-04-03 02:04:35,500 [INFO] - GPU cache cleared: 2520.05MB → 2520.05MB (freed 0.00MB)
2025-04-03 02:10:41,997 [INFO] - GPU cache cleared: 2518.32MB → 2518.32MB (freed 0.00MB)
2025-04-03 02:16:50,293 [INFO] - GPU cache cleared: 2518.62MB → 2518.62MB (freed 0.00MB)
2025-04-03 02:22:14,558 [INFO] - GPU cache cleared: 2519.16MB → 2519.16MB (freed 0.00MB)
2025-04-03 02:27:31,879 [INFO] - GPU cache cleared: 2519.35MB → 2519.35MB (freed 0.00MB)
2025-04-03 02:33:06,517 [INFO] - GPU cache cleared: 2523.47MB → 2523.47MB (freed 0.00MB)
2025-04-03 02:38:54,401 [INFO] - GPU cache cleared: 2521.92MB → 2521.92MB (freed 0.00MB)
2025-04-03 02:44:03,457 [INFO] - GPU cache cleared: 2524.32MB → 2524.32MB (freed 0.00MB)
2025-04-03 02:49:59,324 [INFO] - GPU cache cleared: 2519.64MB → 2519.64MB (freed 0.00MB)
2025-04-03 02:55:40,093 [INFO] - GPU cache cleared: 2519.68MB → 2519.68MB (freed 0.00MB)
2025-04-03 03:02:21,405 [INFO] - GPU cache cleared: 2523.38MB → 2523.38MB (freed 0.00MB)
2025-04-03 03:08:25,077 [INFO] - GPU cache cleared: 2519.08MB → 2519.08MB (freed 0.00MB)
2025-04-03 03:14:55,688 [INFO] - GPU cache cleared: 2519.03MB → 2519.03MB (freed 0.00MB)
2025-04-03 03:21:37,979 [INFO] -   vit: Train Loss=0.7249, Train Acc=64.86%, Val Loss=1.1219, Val Acc=60.38%, ECE=0.0333
2025-04-03 03:21:37,979 [INFO] -   efficientnet: Train Loss=0.1073, Train Acc=99.81%, Val Loss=0.1322, Val Acc=97.48%, ECE=0.0474
2025-04-03 03:21:37,983 [INFO] -   inception: Train Loss=0.1428, Train Acc=99.81%, Val Loss=0.1607, Val Acc=96.84%, ECE=0.0475
2025-04-03 03:21:37,983 [INFO] -   mobilenet: Train Loss=0.1383, Train Acc=99.86%, Val Loss=0.1490, Val Acc=96.84%, ECE=0.0436
2025-04-03 03:21:37,987 [INFO] -   resnet: Train Loss=0.1269, Train Acc=99.82%, Val Loss=0.1711, Val Acc=96.32%, ECE=0.0457
2025-04-03 03:21:37,991 [INFO] -   densenet: Train Loss=0.1406, Train Acc=99.82%, Val Loss=0.1584, Val Acc=96.70%, ECE=0.0476
2025-04-03 03:21:37,993 [INFO] -   student: Train Loss=0.1037, Train Acc=99.82%, Val Loss=0.1417, Val Acc=97.36%, ECE=0.0507
2025-04-03 03:21:37,995 [INFO] - Mutual learning epoch 49 completed in 7052.50s
2025-04-03 03:21:37,996 [INFO] - Early stopping triggered after 49 epochs
2025-04-03 03:21:37,999 [ERROR] - An error occurred: Error(s) in loading state_dict for VisionTransformer:
	Missing key(s) in state_dict: "class_token", "conv_proj.weight", "conv_proj.bias", "encoder.pos_embedding", "encoder.layers.encoder_layer_0.ln_1.weight", "encoder.layers.encoder_layer_0.ln_1.bias", "encoder.layers.encoder_layer_0.self_attention.in_proj_weight", "encoder.layers.encoder_layer_0.self_attention.in_proj_bias", "encoder.layers.encoder_layer_0.self_attention.out_proj.weight", "encoder.layers.encoder_layer_0.self_attention.out_proj.bias", "encoder.layers.encoder_layer_0.ln_2.weight", "encoder.layers.encoder_layer_0.ln_2.bias", "encoder.layers.encoder_layer_0.mlp.0.weight", "encoder.layers.encoder_layer_0.mlp.0.bias", "encoder.layers.encoder_layer_0.mlp.3.weight", "encoder.layers.encoder_layer_0.mlp.3.bias", "encoder.layers.encoder_layer_1.ln_1.weight", "encoder.layers.encoder_layer_1.ln_1.bias", "encoder.layers.encoder_layer_1.self_attention.in_proj_weight", "encoder.layers.encoder_layer_1.self_attention.in_proj_bias", "encoder.layers.encoder_layer_1.self_attention.out_proj.weight", "encoder.layers.encoder_layer_1.self_attention.out_proj.bias", "encoder.layers.encoder_layer_1.ln_2.weight", "encoder.layers.encoder_layer_1.ln_2.bias", "encoder.layers.encoder_layer_1.mlp.0.weight", "encoder.layers.encoder_layer_1.mlp.0.bias", "encoder.layers.encoder_layer_1.mlp.3.weight", "encoder.layers.encoder_layer_1.mlp.3.bias", "encoder.layers.encoder_layer_2.ln_1.weight", "encoder.layers.encoder_layer_2.ln_1.bias", "encoder.layers.encoder_layer_2.self_attention.in_proj_weight", "encoder.layers.encoder_layer_2.self_attention.in_proj_bias", "encoder.layers.encoder_layer_2.self_attention.out_proj.weight", "encoder.layers.encoder_layer_2.self_attention.out_proj.bias", "encoder.layers.encoder_layer_2.ln_2.weight", "encoder.layers.encoder_layer_2.ln_2.bias", "encoder.layers.encoder_layer_2.mlp.0.weight", "encoder.layers.encoder_layer_2.mlp.0.bias", "encoder.layers.encoder_layer_2.mlp.3.weight", "encoder.layers.encoder_layer_2.mlp.3.bias", "encoder.layers.encoder_layer_3.ln_1.weight", "encoder.layers.encoder_layer_3.ln_1.bias", "encoder.layers.encoder_layer_3.self_attention.in_proj_weight", "encoder.layers.encoder_layer_3.self_attention.in_proj_bias", "encoder.layers.encoder_layer_3.self_attention.out_proj.weight", "encoder.layers.encoder_layer_3.self_attention.out_proj.bias", "encoder.layers.encoder_layer_3.ln_2.weight", "encoder.layers.encoder_layer_3.ln_2.bias", "encoder.layers.encoder_layer_3.mlp.0.weight", "encoder.layers.encoder_layer_3.mlp.0.bias", "encoder.layers.encoder_layer_3.mlp.3.weight", "encoder.layers.encoder_layer_3.mlp.3.bias", "encoder.layers.encoder_layer_4.ln_1.weight", "encoder.layers.encoder_layer_4.ln_1.bias", "encoder.layers.encoder_layer_4.self_attention.in_proj_weight", "encoder.layers.encoder_layer_4.self_attention.in_proj_bias", "encoder.layers.encoder_layer_4.self_attention.out_proj.weight", "encoder.layers.encoder_layer_4.self_attention.out_proj.bias", "encoder.layers.encoder_layer_4.ln_2.weight", "encoder.layers.encoder_layer_4.ln_2.bias", "encoder.layers.encoder_layer_4.mlp.0.weight", "encoder.layers.encoder_layer_4.mlp.0.bias", "encoder.layers.encoder_layer_4.mlp.3.weight", "encoder.layers.encoder_layer_4.mlp.3.bias", "encoder.layers.encoder_layer_5.ln_1.weight", "encoder.layers.encoder_layer_5.ln_1.bias", "encoder.layers.encoder_layer_5.self_attention.in_proj_weight", "encoder.layers.encoder_layer_5.self_attention.in_proj_bias", "encoder.layers.encoder_layer_5.self_attention.out_proj.weight", "encoder.layers.encoder_layer_5.self_attention.out_proj.bias", "encoder.layers.encoder_layer_5.ln_2.weight", "encoder.layers.encoder_layer_5.ln_2.bias", "encoder.layers.encoder_layer_5.mlp.0.weight", "encoder.layers.encoder_layer_5.mlp.0.bias", "encoder.layers.encoder_layer_5.mlp.3.weight", "encoder.layers.encoder_layer_5.mlp.3.bias", "encoder.layers.encoder_layer_6.ln_1.weight", "encoder.layers.encoder_layer_6.ln_1.bias", "encoder.layers.encoder_layer_6.self_attention.in_proj_weight", "encoder.layers.encoder_layer_6.self_attention.in_proj_bias", "encoder.layers.encoder_layer_6.self_attention.out_proj.weight", "encoder.layers.encoder_layer_6.self_attention.out_proj.bias", "encoder.layers.encoder_layer_6.ln_2.weight", "encoder.layers.encoder_layer_6.ln_2.bias", "encoder.layers.encoder_layer_6.mlp.0.weight", "encoder.layers.encoder_layer_6.mlp.0.bias", "encoder.layers.encoder_layer_6.mlp.3.weight", "encoder.layers.encoder_layer_6.mlp.3.bias", "encoder.layers.encoder_layer_7.ln_1.weight", "encoder.layers.encoder_layer_7.ln_1.bias", "encoder.layers.encoder_layer_7.self_attention.in_proj_weight", "encoder.layers.encoder_layer_7.self_attention.in_proj_bias", "encoder.layers.encoder_layer_7.self_attention.out_proj.weight", "encoder.layers.encoder_layer_7.self_attention.out_proj.bias", "encoder.layers.encoder_layer_7.ln_2.weight", "encoder.layers.encoder_layer_7.ln_2.bias", "encoder.layers.encoder_layer_7.mlp.0.weight", "encoder.layers.encoder_layer_7.mlp.0.bias", "encoder.layers.encoder_layer_7.mlp.3.weight", "encoder.layers.encoder_layer_7.mlp.3.bias", "encoder.layers.encoder_layer_8.ln_1.weight", "encoder.layers.encoder_layer_8.ln_1.bias", "encoder.layers.encoder_layer_8.self_attention.in_proj_weight", "encoder.layers.encoder_layer_8.self_attention.in_proj_bias", "encoder.layers.encoder_layer_8.self_attention.out_proj.weight", "encoder.layers.encoder_layer_8.self_attention.out_proj.bias", "encoder.layers.encoder_layer_8.ln_2.weight", "encoder.layers.encoder_layer_8.ln_2.bias", "encoder.layers.encoder_layer_8.mlp.0.weight", "encoder.layers.encoder_layer_8.mlp.0.bias", "encoder.layers.encoder_layer_8.mlp.3.weight", "encoder.layers.encoder_layer_8.mlp.3.bias", "encoder.layers.encoder_layer_9.ln_1.weight", "encoder.layers.encoder_layer_9.ln_1.bias", "encoder.layers.encoder_layer_9.self_attention.in_proj_weight", "encoder.layers.encoder_layer_9.self_attention.in_proj_bias", "encoder.layers.encoder_layer_9.self_attention.out_proj.weight", "encoder.layers.encoder_layer_9.self_attention.out_proj.bias", "encoder.layers.encoder_layer_9.ln_2.weight", "encoder.layers.encoder_layer_9.ln_2.bias", "encoder.layers.encoder_layer_9.mlp.0.weight", "encoder.layers.encoder_layer_9.mlp.0.bias", "encoder.layers.encoder_layer_9.mlp.3.weight", "encoder.layers.encoder_layer_9.mlp.3.bias", "encoder.layers.encoder_layer_10.ln_1.weight", "encoder.layers.encoder_layer_10.ln_1.bias", "encoder.layers.encoder_layer_10.self_attention.in_proj_weight", "encoder.layers.encoder_layer_10.self_attention.in_proj_bias", "encoder.layers.encoder_layer_10.self_attention.out_proj.weight", "encoder.layers.encoder_layer_10.self_attention.out_proj.bias", "encoder.layers.encoder_layer_10.ln_2.weight", "encoder.layers.encoder_layer_10.ln_2.bias", "encoder.layers.encoder_layer_10.mlp.0.weight", "encoder.layers.encoder_layer_10.mlp.0.bias", "encoder.layers.encoder_layer_10.mlp.3.weight", "encoder.layers.encoder_layer_10.mlp.3.bias", "encoder.layers.encoder_layer_11.ln_1.weight", "encoder.layers.encoder_layer_11.ln_1.bias", "encoder.layers.encoder_layer_11.self_attention.in_proj_weight", "encoder.layers.encoder_layer_11.self_attention.in_proj_bias", "encoder.layers.encoder_layer_11.self_attention.out_proj.weight", "encoder.layers.encoder_layer_11.self_attention.out_proj.bias", "encoder.layers.encoder_layer_11.ln_2.weight", "encoder.layers.encoder_layer_11.ln_2.bias", "encoder.layers.encoder_layer_11.mlp.0.weight", "encoder.layers.encoder_layer_11.mlp.0.bias", "encoder.layers.encoder_layer_11.mlp.3.weight", "encoder.layers.encoder_layer_11.mlp.3.bias", "encoder.ln.weight", "encoder.ln.bias", "heads.head.weight", "heads.head.bias". 
	Unexpected key(s) in state_dict: "features.0.0.weight", "features.0.1.weight", "features.0.1.bias", "features.0.1.running_mean", "features.0.1.running_var", "features.0.1.num_batches_tracked", "features.1.0.block.0.0.weight", "features.1.0.block.0.1.weight", "features.1.0.block.0.1.bias", "features.1.0.block.0.1.running_mean", "features.1.0.block.0.1.running_var", "features.1.0.block.0.1.num_batches_tracked", "features.1.0.block.1.fc1.weight", "features.1.0.block.1.fc1.bias", "features.1.0.block.1.fc2.weight", "features.1.0.block.1.fc2.bias", "features.1.0.block.2.0.weight", "features.1.0.block.2.1.weight", "features.1.0.block.2.1.bias", "features.1.0.block.2.1.running_mean", "features.1.0.block.2.1.running_var", "features.1.0.block.2.1.num_batches_tracked", "features.2.0.block.0.0.weight", "features.2.0.block.0.1.weight", "features.2.0.block.0.1.bias", "features.2.0.block.0.1.running_mean", "features.2.0.block.0.1.running_var", "features.2.0.block.0.1.num_batches_tracked", "features.2.0.block.1.0.weight", "features.2.0.block.1.1.weight", "features.2.0.block.1.1.bias", "features.2.0.block.1.1.running_mean", "features.2.0.block.1.1.running_var", "features.2.0.block.1.1.num_batches_tracked", "features.2.0.block.2.fc1.weight", "features.2.0.block.2.fc1.bias", "features.2.0.block.2.fc2.weight", "features.2.0.block.2.fc2.bias", "features.2.0.block.3.0.weight", "features.2.0.block.3.1.weight", "features.2.0.block.3.1.bias", "features.2.0.block.3.1.running_mean", "features.2.0.block.3.1.running_var", "features.2.0.block.3.1.num_batches_tracked", "features.2.1.block.0.0.weight", "features.2.1.block.0.1.weight", "features.2.1.block.0.1.bias", "features.2.1.block.0.1.running_mean", "features.2.1.block.0.1.running_var", "features.2.1.block.0.1.num_batches_tracked", "features.2.1.block.1.0.weight", "features.2.1.block.1.1.weight", "features.2.1.block.1.1.bias", "features.2.1.block.1.1.running_mean", "features.2.1.block.1.1.running_var", "features.2.1.block.1.1.num_batches_tracked", "features.2.1.block.2.fc1.weight", "features.2.1.block.2.fc1.bias", "features.2.1.block.2.fc2.weight", "features.2.1.block.2.fc2.bias", "features.2.1.block.3.0.weight", "features.2.1.block.3.1.weight", "features.2.1.block.3.1.bias", "features.2.1.block.3.1.running_mean", "features.2.1.block.3.1.running_var", "features.2.1.block.3.1.num_batches_tracked", "features.3.0.block.0.0.weight", "features.3.0.block.0.1.weight", "features.3.0.block.0.1.bias", "features.3.0.block.0.1.running_mean", "features.3.0.block.0.1.running_var", "features.3.0.block.0.1.num_batches_tracked", "features.3.0.block.1.0.weight", "features.3.0.block.1.1.weight", "features.3.0.block.1.1.bias", "features.3.0.block.1.1.running_mean", "features.3.0.block.1.1.running_var", "features.3.0.block.1.1.num_batches_tracked", "features.3.0.block.2.fc1.weight", "features.3.0.block.2.fc1.bias", "features.3.0.block.2.fc2.weight", "features.3.0.block.2.fc2.bias", "features.3.0.block.3.0.weight", "features.3.0.block.3.1.weight", "features.3.0.block.3.1.bias", "features.3.0.block.3.1.running_mean", "features.3.0.block.3.1.running_var", "features.3.0.block.3.1.num_batches_tracked", "features.3.1.block.0.0.weight", "features.3.1.block.0.1.weight", "features.3.1.block.0.1.bias", "features.3.1.block.0.1.running_mean", "features.3.1.block.0.1.running_var", "features.3.1.block.0.1.num_batches_tracked", "features.3.1.block.1.0.weight", "features.3.1.block.1.1.weight", "features.3.1.block.1.1.bias", "features.3.1.block.1.1.running_mean", "features.3.1.block.1.1.running_var", "features.3.1.block.1.1.num_batches_tracked", "features.3.1.block.2.fc1.weight", "features.3.1.block.2.fc1.bias", "features.3.1.block.2.fc2.weight", "features.3.1.block.2.fc2.bias", "features.3.1.block.3.0.weight", "features.3.1.block.3.1.weight", "features.3.1.block.3.1.bias", "features.3.1.block.3.1.running_mean", "features.3.1.block.3.1.running_var", "features.3.1.block.3.1.num_batches_tracked", "features.4.0.block.0.0.weight", "features.4.0.block.0.1.weight", "features.4.0.block.0.1.bias", "features.4.0.block.0.1.running_mean", "features.4.0.block.0.1.running_var", "features.4.0.block.0.1.num_batches_tracked", "features.4.0.block.1.0.weight", "features.4.0.block.1.1.weight", "features.4.0.block.1.1.bias", "features.4.0.block.1.1.running_mean", "features.4.0.block.1.1.running_var", "features.4.0.block.1.1.num_batches_tracked", "features.4.0.block.2.fc1.weight", "features.4.0.block.2.fc1.bias", "features.4.0.block.2.fc2.weight", "features.4.0.block.2.fc2.bias", "features.4.0.block.3.0.weight", "features.4.0.block.3.1.weight", "features.4.0.block.3.1.bias", "features.4.0.block.3.1.running_mean", "features.4.0.block.3.1.running_var", "features.4.0.block.3.1.num_batches_tracked", "features.4.1.block.0.0.weight", "features.4.1.block.0.1.weight", "features.4.1.block.0.1.bias", "features.4.1.block.0.1.running_mean", "features.4.1.block.0.1.running_var", "features.4.1.block.0.1.num_batches_tracked", "features.4.1.block.1.0.weight", "features.4.1.block.1.1.weight", "features.4.1.block.1.1.bias", "features.4.1.block.1.1.running_mean", "features.4.1.block.1.1.running_var", "features.4.1.block.1.1.num_batches_tracked", "features.4.1.block.2.fc1.weight", "features.4.1.block.2.fc1.bias", "features.4.1.block.2.fc2.weight", "features.4.1.block.2.fc2.bias", "features.4.1.block.3.0.weight", "features.4.1.block.3.1.weight", "features.4.1.block.3.1.bias", "features.4.1.block.3.1.running_mean", "features.4.1.block.3.1.running_var", "features.4.1.block.3.1.num_batches_tracked", "features.4.2.block.0.0.weight", "features.4.2.block.0.1.weight", "features.4.2.block.0.1.bias", "features.4.2.block.0.1.running_mean", "features.4.2.block.0.1.running_var", "features.4.2.block.0.1.num_batches_tracked", "features.4.2.block.1.0.weight", "features.4.2.block.1.1.weight", "features.4.2.block.1.1.bias", "features.4.2.block.1.1.running_mean", "features.4.2.block.1.1.running_var", "features.4.2.block.1.1.num_batches_tracked", "features.4.2.block.2.fc1.weight", "features.4.2.block.2.fc1.bias", "features.4.2.block.2.fc2.weight", "features.4.2.block.2.fc2.bias", "features.4.2.block.3.0.weight", "features.4.2.block.3.1.weight", "features.4.2.block.3.1.bias", "features.4.2.block.3.1.running_mean", "features.4.2.block.3.1.running_var", "features.4.2.block.3.1.num_batches_tracked", "features.5.0.block.0.0.weight", "features.5.0.block.0.1.weight", "features.5.0.block.0.1.bias", "features.5.0.block.0.1.running_mean", "features.5.0.block.0.1.running_var", "features.5.0.block.0.1.num_batches_tracked", "features.5.0.block.1.0.weight", "features.5.0.block.1.1.weight", "features.5.0.block.1.1.bias", "features.5.0.block.1.1.running_mean", "features.5.0.block.1.1.running_var", "features.5.0.block.1.1.num_batches_tracked", "features.5.0.block.2.fc1.weight", "features.5.0.block.2.fc1.bias", "features.5.0.block.2.fc2.weight", "features.5.0.block.2.fc2.bias", "features.5.0.block.3.0.weight", "features.5.0.block.3.1.weight", "features.5.0.block.3.1.bias", "features.5.0.block.3.1.running_mean", "features.5.0.block.3.1.running_var", "features.5.0.block.3.1.num_batches_tracked", "features.5.1.block.0.0.weight", "features.5.1.block.0.1.weight", "features.5.1.block.0.1.bias", "features.5.1.block.0.1.running_mean", "features.5.1.block.0.1.running_var", "features.5.1.block.0.1.num_batches_tracked", "features.5.1.block.1.0.weight", "features.5.1.block.1.1.weight", "features.5.1.block.1.1.bias", "features.5.1.block.1.1.running_mean", "features.5.1.block.1.1.running_var", "features.5.1.block.1.1.num_batches_tracked", "features.5.1.block.2.fc1.weight", "features.5.1.block.2.fc1.bias", "features.5.1.block.2.fc2.weight", "features.5.1.block.2.fc2.bias", "features.5.1.block.3.0.weight", "features.5.1.block.3.1.weight", "features.5.1.block.3.1.bias", "features.5.1.block.3.1.running_mean", "features.5.1.block.3.1.running_var", "features.5.1.block.3.1.num_batches_tracked", "features.5.2.block.0.0.weight", "features.5.2.block.0.1.weight", "features.5.2.block.0.1.bias", "features.5.2.block.0.1.running_mean", "features.5.2.block.0.1.running_var", "features.5.2.block.0.1.num_batches_tracked", "features.5.2.block.1.0.weight", "features.5.2.block.1.1.weight", "features.5.2.block.1.1.bias", "features.5.2.block.1.1.running_mean", "features.5.2.block.1.1.running_var", "features.5.2.block.1.1.num_batches_tracked", "features.5.2.block.2.fc1.weight", "features.5.2.block.2.fc1.bias", "features.5.2.block.2.fc2.weight", "features.5.2.block.2.fc2.bias", "features.5.2.block.3.0.weight", "features.5.2.block.3.1.weight", "features.5.2.block.3.1.bias", "features.5.2.block.3.1.running_mean", "features.5.2.block.3.1.running_var", "features.5.2.block.3.1.num_batches_tracked", "features.6.0.block.0.0.weight", "features.6.0.block.0.1.weight", "features.6.0.block.0.1.bias", "features.6.0.block.0.1.running_mean", "features.6.0.block.0.1.running_var", "features.6.0.block.0.1.num_batches_tracked", "features.6.0.block.1.0.weight", "features.6.0.block.1.1.weight", "features.6.0.block.1.1.bias", "features.6.0.block.1.1.running_mean", "features.6.0.block.1.1.running_var", "features.6.0.block.1.1.num_batches_tracked", "features.6.0.block.2.fc1.weight", "features.6.0.block.2.fc1.bias", "features.6.0.block.2.fc2.weight", "features.6.0.block.2.fc2.bias", "features.6.0.block.3.0.weight", "features.6.0.block.3.1.weight", "features.6.0.block.3.1.bias", "features.6.0.block.3.1.running_mean", "features.6.0.block.3.1.running_var", "features.6.0.block.3.1.num_batches_tracked", "features.6.1.block.0.0.weight", "features.6.1.block.0.1.weight", "features.6.1.block.0.1.bias", "features.6.1.block.0.1.running_mean", "features.6.1.block.0.1.running_var", "features.6.1.block.0.1.num_batches_tracked", "features.6.1.block.1.0.weight", "features.6.1.block.1.1.weight", "features.6.1.block.1.1.bias", "features.6.1.block.1.1.running_mean", "features.6.1.block.1.1.running_var", "features.6.1.block.1.1.num_batches_tracked", "features.6.1.block.2.fc1.weight", "features.6.1.block.2.fc1.bias", "features.6.1.block.2.fc2.weight", "features.6.1.block.2.fc2.bias", "features.6.1.block.3.0.weight", "features.6.1.block.3.1.weight", "features.6.1.block.3.1.bias", "features.6.1.block.3.1.running_mean", "features.6.1.block.3.1.running_var", "features.6.1.block.3.1.num_batches_tracked", "features.6.2.block.0.0.weight", "features.6.2.block.0.1.weight", "features.6.2.block.0.1.bias", "features.6.2.block.0.1.running_mean", "features.6.2.block.0.1.running_var", "features.6.2.block.0.1.num_batches_tracked", "features.6.2.block.1.0.weight", "features.6.2.block.1.1.weight", "features.6.2.block.1.1.bias", "features.6.2.block.1.1.running_mean", "features.6.2.block.1.1.running_var", "features.6.2.block.1.1.num_batches_tracked", "features.6.2.block.2.fc1.weight", "features.6.2.block.2.fc1.bias", "features.6.2.block.2.fc2.weight", "features.6.2.block.2.fc2.bias", "features.6.2.block.3.0.weight", "features.6.2.block.3.1.weight", "features.6.2.block.3.1.bias", "features.6.2.block.3.1.running_mean", "features.6.2.block.3.1.running_var", "features.6.2.block.3.1.num_batches_tracked", "features.6.3.block.0.0.weight", "features.6.3.block.0.1.weight", "features.6.3.block.0.1.bias", "features.6.3.block.0.1.running_mean", "features.6.3.block.0.1.running_var", "features.6.3.block.0.1.num_batches_tracked", "features.6.3.block.1.0.weight", "features.6.3.block.1.1.weight", "features.6.3.block.1.1.bias", "features.6.3.block.1.1.running_mean", "features.6.3.block.1.1.running_var", "features.6.3.block.1.1.num_batches_tracked", "features.6.3.block.2.fc1.weight", "features.6.3.block.2.fc1.bias", "features.6.3.block.2.fc2.weight", "features.6.3.block.2.fc2.bias", "features.6.3.block.3.0.weight", "features.6.3.block.3.1.weight", "features.6.3.block.3.1.bias", "features.6.3.block.3.1.running_mean", "features.6.3.block.3.1.running_var", "features.6.3.block.3.1.num_batches_tracked", "features.7.0.block.0.0.weight", "features.7.0.block.0.1.weight", "features.7.0.block.0.1.bias", "features.7.0.block.0.1.running_mean", "features.7.0.block.0.1.running_var", "features.7.0.block.0.1.num_batches_tracked", "features.7.0.block.1.0.weight", "features.7.0.block.1.1.weight", "features.7.0.block.1.1.bias", "features.7.0.block.1.1.running_mean", "features.7.0.block.1.1.running_var", "features.7.0.block.1.1.num_batches_tracked", "features.7.0.block.2.fc1.weight", "features.7.0.block.2.fc1.bias", "features.7.0.block.2.fc2.weight", "features.7.0.block.2.fc2.bias", "features.7.0.block.3.0.weight", "features.7.0.block.3.1.weight", "features.7.0.block.3.1.bias", "features.7.0.block.3.1.running_mean", "features.7.0.block.3.1.running_var", "features.7.0.block.3.1.num_batches_tracked", "features.8.0.weight", "features.8.1.weight", "features.8.1.bias", "features.8.1.running_mean", "features.8.1.running_var", "features.8.1.num_batches_tracked", "classifier.1.weight", "classifier.1.bias". 
2025-04-03 03:21:38,020 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\1562496040.py", line 22, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\4274962273.py", line 1870, in mutual_learning_phase
    models[name].load_state_dict(state)
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 2584, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for VisionTransformer:
	Missing key(s) in state_dict: "class_token", "conv_proj.weight", "conv_proj.bias", "encoder.pos_embedding", "encoder.layers.encoder_layer_0.ln_1.weight", "encoder.layers.encoder_layer_0.ln_1.bias", "encoder.layers.encoder_layer_0.self_attention.in_proj_weight", "encoder.layers.encoder_layer_0.self_attention.in_proj_bias", "encoder.layers.encoder_layer_0.self_attention.out_proj.weight", "encoder.layers.encoder_layer_0.self_attention.out_proj.bias", "encoder.layers.encoder_layer_0.ln_2.weight", "encoder.layers.encoder_layer_0.ln_2.bias", "encoder.layers.encoder_layer_0.mlp.0.weight", "encoder.layers.encoder_layer_0.mlp.0.bias", "encoder.layers.encoder_layer_0.mlp.3.weight", "encoder.layers.encoder_layer_0.mlp.3.bias", "encoder.layers.encoder_layer_1.ln_1.weight", "encoder.layers.encoder_layer_1.ln_1.bias", "encoder.layers.encoder_layer_1.self_attention.in_proj_weight", "encoder.layers.encoder_layer_1.self_attention.in_proj_bias", "encoder.layers.encoder_layer_1.self_attention.out_proj.weight", "encoder.layers.encoder_layer_1.self_attention.out_proj.bias", "encoder.layers.encoder_layer_1.ln_2.weight", "encoder.layers.encoder_layer_1.ln_2.bias", "encoder.layers.encoder_layer_1.mlp.0.weight", "encoder.layers.encoder_layer_1.mlp.0.bias", "encoder.layers.encoder_layer_1.mlp.3.weight", "encoder.layers.encoder_layer_1.mlp.3.bias", "encoder.layers.encoder_layer_2.ln_1.weight", "encoder.layers.encoder_layer_2.ln_1.bias", "encoder.layers.encoder_layer_2.self_attention.in_proj_weight", "encoder.layers.encoder_layer_2.self_attention.in_proj_bias", "encoder.layers.encoder_layer_2.self_attention.out_proj.weight", "encoder.layers.encoder_layer_2.self_attention.out_proj.bias", "encoder.layers.encoder_layer_2.ln_2.weight", "encoder.layers.encoder_layer_2.ln_2.bias", "encoder.layers.encoder_layer_2.mlp.0.weight", "encoder.layers.encoder_layer_2.mlp.0.bias", "encoder.layers.encoder_layer_2.mlp.3.weight", "encoder.layers.encoder_layer_2.mlp.3.bias", "encoder.layers.encoder_layer_3.ln_1.weight", "encoder.layers.encoder_layer_3.ln_1.bias", "encoder.layers.encoder_layer_3.self_attention.in_proj_weight", "encoder.layers.encoder_layer_3.self_attention.in_proj_bias", "encoder.layers.encoder_layer_3.self_attention.out_proj.weight", "encoder.layers.encoder_layer_3.self_attention.out_proj.bias", "encoder.layers.encoder_layer_3.ln_2.weight", "encoder.layers.encoder_layer_3.ln_2.bias", "encoder.layers.encoder_layer_3.mlp.0.weight", "encoder.layers.encoder_layer_3.mlp.0.bias", "encoder.layers.encoder_layer_3.mlp.3.weight", "encoder.layers.encoder_layer_3.mlp.3.bias", "encoder.layers.encoder_layer_4.ln_1.weight", "encoder.layers.encoder_layer_4.ln_1.bias", "encoder.layers.encoder_layer_4.self_attention.in_proj_weight", "encoder.layers.encoder_layer_4.self_attention.in_proj_bias", "encoder.layers.encoder_layer_4.self_attention.out_proj.weight", "encoder.layers.encoder_layer_4.self_attention.out_proj.bias", "encoder.layers.encoder_layer_4.ln_2.weight", "encoder.layers.encoder_layer_4.ln_2.bias", "encoder.layers.encoder_layer_4.mlp.0.weight", "encoder.layers.encoder_layer_4.mlp.0.bias", "encoder.layers.encoder_layer_4.mlp.3.weight", "encoder.layers.encoder_layer_4.mlp.3.bias", "encoder.layers.encoder_layer_5.ln_1.weight", "encoder.layers.encoder_layer_5.ln_1.bias", "encoder.layers.encoder_layer_5.self_attention.in_proj_weight", "encoder.layers.encoder_layer_5.self_attention.in_proj_bias", "encoder.layers.encoder_layer_5.self_attention.out_proj.weight", "encoder.layers.encoder_layer_5.self_attention.out_proj.bias", "encoder.layers.encoder_layer_5.ln_2.weight", "encoder.layers.encoder_layer_5.ln_2.bias", "encoder.layers.encoder_layer_5.mlp.0.weight", "encoder.layers.encoder_layer_5.mlp.0.bias", "encoder.layers.encoder_layer_5.mlp.3.weight", "encoder.layers.encoder_layer_5.mlp.3.bias", "encoder.layers.encoder_layer_6.ln_1.weight", "encoder.layers.encoder_layer_6.ln_1.bias", "encoder.layers.encoder_layer_6.self_attention.in_proj_weight", "encoder.layers.encoder_layer_6.self_attention.in_proj_bias", "encoder.layers.encoder_layer_6.self_attention.out_proj.weight", "encoder.layers.encoder_layer_6.self_attention.out_proj.bias", "encoder.layers.encoder_layer_6.ln_2.weight", "encoder.layers.encoder_layer_6.ln_2.bias", "encoder.layers.encoder_layer_6.mlp.0.weight", "encoder.layers.encoder_layer_6.mlp.0.bias", "encoder.layers.encoder_layer_6.mlp.3.weight", "encoder.layers.encoder_layer_6.mlp.3.bias", "encoder.layers.encoder_layer_7.ln_1.weight", "encoder.layers.encoder_layer_7.ln_1.bias", "encoder.layers.encoder_layer_7.self_attention.in_proj_weight", "encoder.layers.encoder_layer_7.self_attention.in_proj_bias", "encoder.layers.encoder_layer_7.self_attention.out_proj.weight", "encoder.layers.encoder_layer_7.self_attention.out_proj.bias", "encoder.layers.encoder_layer_7.ln_2.weight", "encoder.layers.encoder_layer_7.ln_2.bias", "encoder.layers.encoder_layer_7.mlp.0.weight", "encoder.layers.encoder_layer_7.mlp.0.bias", "encoder.layers.encoder_layer_7.mlp.3.weight", "encoder.layers.encoder_layer_7.mlp.3.bias", "encoder.layers.encoder_layer_8.ln_1.weight", "encoder.layers.encoder_layer_8.ln_1.bias", "encoder.layers.encoder_layer_8.self_attention.in_proj_weight", "encoder.layers.encoder_layer_8.self_attention.in_proj_bias", "encoder.layers.encoder_layer_8.self_attention.out_proj.weight", "encoder.layers.encoder_layer_8.self_attention.out_proj.bias", "encoder.layers.encoder_layer_8.ln_2.weight", "encoder.layers.encoder_layer_8.ln_2.bias", "encoder.layers.encoder_layer_8.mlp.0.weight", "encoder.layers.encoder_layer_8.mlp.0.bias", "encoder.layers.encoder_layer_8.mlp.3.weight", "encoder.layers.encoder_layer_8.mlp.3.bias", "encoder.layers.encoder_layer_9.ln_1.weight", "encoder.layers.encoder_layer_9.ln_1.bias", "encoder.layers.encoder_layer_9.self_attention.in_proj_weight", "encoder.layers.encoder_layer_9.self_attention.in_proj_bias", "encoder.layers.encoder_layer_9.self_attention.out_proj.weight", "encoder.layers.encoder_layer_9.self_attention.out_proj.bias", "encoder.layers.encoder_layer_9.ln_2.weight", "encoder.layers.encoder_layer_9.ln_2.bias", "encoder.layers.encoder_layer_9.mlp.0.weight", "encoder.layers.encoder_layer_9.mlp.0.bias", "encoder.layers.encoder_layer_9.mlp.3.weight", "encoder.layers.encoder_layer_9.mlp.3.bias", "encoder.layers.encoder_layer_10.ln_1.weight", "encoder.layers.encoder_layer_10.ln_1.bias", "encoder.layers.encoder_layer_10.self_attention.in_proj_weight", "encoder.layers.encoder_layer_10.self_attention.in_proj_bias", "encoder.layers.encoder_layer_10.self_attention.out_proj.weight", "encoder.layers.encoder_layer_10.self_attention.out_proj.bias", "encoder.layers.encoder_layer_10.ln_2.weight", "encoder.layers.encoder_layer_10.ln_2.bias", "encoder.layers.encoder_layer_10.mlp.0.weight", "encoder.layers.encoder_layer_10.mlp.0.bias", "encoder.layers.encoder_layer_10.mlp.3.weight", "encoder.layers.encoder_layer_10.mlp.3.bias", "encoder.layers.encoder_layer_11.ln_1.weight", "encoder.layers.encoder_layer_11.ln_1.bias", "encoder.layers.encoder_layer_11.self_attention.in_proj_weight", "encoder.layers.encoder_layer_11.self_attention.in_proj_bias", "encoder.layers.encoder_layer_11.self_attention.out_proj.weight", "encoder.layers.encoder_layer_11.self_attention.out_proj.bias", "encoder.layers.encoder_layer_11.ln_2.weight", "encoder.layers.encoder_layer_11.ln_2.bias", "encoder.layers.encoder_layer_11.mlp.0.weight", "encoder.layers.encoder_layer_11.mlp.0.bias", "encoder.layers.encoder_layer_11.mlp.3.weight", "encoder.layers.encoder_layer_11.mlp.3.bias", "encoder.ln.weight", "encoder.ln.bias", "heads.head.weight", "heads.head.bias". 
	Unexpected key(s) in state_dict: "features.0.0.weight", "features.0.1.weight", "features.0.1.bias", "features.0.1.running_mean", "features.0.1.running_var", "features.0.1.num_batches_tracked", "features.1.0.block.0.0.weight", "features.1.0.block.0.1.weight", "features.1.0.block.0.1.bias", "features.1.0.block.0.1.running_mean", "features.1.0.block.0.1.running_var", "features.1.0.block.0.1.num_batches_tracked", "features.1.0.block.1.fc1.weight", "features.1.0.block.1.fc1.bias", "features.1.0.block.1.fc2.weight", "features.1.0.block.1.fc2.bias", "features.1.0.block.2.0.weight", "features.1.0.block.2.1.weight", "features.1.0.block.2.1.bias", "features.1.0.block.2.1.running_mean", "features.1.0.block.2.1.running_var", "features.1.0.block.2.1.num_batches_tracked", "features.2.0.block.0.0.weight", "features.2.0.block.0.1.weight", "features.2.0.block.0.1.bias", "features.2.0.block.0.1.running_mean", "features.2.0.block.0.1.running_var", "features.2.0.block.0.1.num_batches_tracked", "features.2.0.block.1.0.weight", "features.2.0.block.1.1.weight", "features.2.0.block.1.1.bias", "features.2.0.block.1.1.running_mean", "features.2.0.block.1.1.running_var", "features.2.0.block.1.1.num_batches_tracked", "features.2.0.block.2.fc1.weight", "features.2.0.block.2.fc1.bias", "features.2.0.block.2.fc2.weight", "features.2.0.block.2.fc2.bias", "features.2.0.block.3.0.weight", "features.2.0.block.3.1.weight", "features.2.0.block.3.1.bias", "features.2.0.block.3.1.running_mean", "features.2.0.block.3.1.running_var", "features.2.0.block.3.1.num_batches_tracked", "features.2.1.block.0.0.weight", "features.2.1.block.0.1.weight", "features.2.1.block.0.1.bias", "features.2.1.block.0.1.running_mean", "features.2.1.block.0.1.running_var", "features.2.1.block.0.1.num_batches_tracked", "features.2.1.block.1.0.weight", "features.2.1.block.1.1.weight", "features.2.1.block.1.1.bias", "features.2.1.block.1.1.running_mean", "features.2.1.block.1.1.running_var", "features.2.1.block.1.1.num_batches_tracked", "features.2.1.block.2.fc1.weight", "features.2.1.block.2.fc1.bias", "features.2.1.block.2.fc2.weight", "features.2.1.block.2.fc2.bias", "features.2.1.block.3.0.weight", "features.2.1.block.3.1.weight", "features.2.1.block.3.1.bias", "features.2.1.block.3.1.running_mean", "features.2.1.block.3.1.running_var", "features.2.1.block.3.1.num_batches_tracked", "features.3.0.block.0.0.weight", "features.3.0.block.0.1.weight", "features.3.0.block.0.1.bias", "features.3.0.block.0.1.running_mean", "features.3.0.block.0.1.running_var", "features.3.0.block.0.1.num_batches_tracked", "features.3.0.block.1.0.weight", "features.3.0.block.1.1.weight", "features.3.0.block.1.1.bias", "features.3.0.block.1.1.running_mean", "features.3.0.block.1.1.running_var", "features.3.0.block.1.1.num_batches_tracked", "features.3.0.block.2.fc1.weight", "features.3.0.block.2.fc1.bias", "features.3.0.block.2.fc2.weight", "features.3.0.block.2.fc2.bias", "features.3.0.block.3.0.weight", "features.3.0.block.3.1.weight", "features.3.0.block.3.1.bias", "features.3.0.block.3.1.running_mean", "features.3.0.block.3.1.running_var", "features.3.0.block.3.1.num_batches_tracked", "features.3.1.block.0.0.weight", "features.3.1.block.0.1.weight", "features.3.1.block.0.1.bias", "features.3.1.block.0.1.running_mean", "features.3.1.block.0.1.running_var", "features.3.1.block.0.1.num_batches_tracked", "features.3.1.block.1.0.weight", "features.3.1.block.1.1.weight", "features.3.1.block.1.1.bias", "features.3.1.block.1.1.running_mean", "features.3.1.block.1.1.running_var", "features.3.1.block.1.1.num_batches_tracked", "features.3.1.block.2.fc1.weight", "features.3.1.block.2.fc1.bias", "features.3.1.block.2.fc2.weight", "features.3.1.block.2.fc2.bias", "features.3.1.block.3.0.weight", "features.3.1.block.3.1.weight", "features.3.1.block.3.1.bias", "features.3.1.block.3.1.running_mean", "features.3.1.block.3.1.running_var", "features.3.1.block.3.1.num_batches_tracked", "features.4.0.block.0.0.weight", "features.4.0.block.0.1.weight", "features.4.0.block.0.1.bias", "features.4.0.block.0.1.running_mean", "features.4.0.block.0.1.running_var", "features.4.0.block.0.1.num_batches_tracked", "features.4.0.block.1.0.weight", "features.4.0.block.1.1.weight", "features.4.0.block.1.1.bias", "features.4.0.block.1.1.running_mean", "features.4.0.block.1.1.running_var", "features.4.0.block.1.1.num_batches_tracked", "features.4.0.block.2.fc1.weight", "features.4.0.block.2.fc1.bias", "features.4.0.block.2.fc2.weight", "features.4.0.block.2.fc2.bias", "features.4.0.block.3.0.weight", "features.4.0.block.3.1.weight", "features.4.0.block.3.1.bias", "features.4.0.block.3.1.running_mean", "features.4.0.block.3.1.running_var", "features.4.0.block.3.1.num_batches_tracked", "features.4.1.block.0.0.weight", "features.4.1.block.0.1.weight", "features.4.1.block.0.1.bias", "features.4.1.block.0.1.running_mean", "features.4.1.block.0.1.running_var", "features.4.1.block.0.1.num_batches_tracked", "features.4.1.block.1.0.weight", "features.4.1.block.1.1.weight", "features.4.1.block.1.1.bias", "features.4.1.block.1.1.running_mean", "features.4.1.block.1.1.running_var", "features.4.1.block.1.1.num_batches_tracked", "features.4.1.block.2.fc1.weight", "features.4.1.block.2.fc1.bias", "features.4.1.block.2.fc2.weight", "features.4.1.block.2.fc2.bias", "features.4.1.block.3.0.weight", "features.4.1.block.3.1.weight", "features.4.1.block.3.1.bias", "features.4.1.block.3.1.running_mean", "features.4.1.block.3.1.running_var", "features.4.1.block.3.1.num_batches_tracked", "features.4.2.block.0.0.weight", "features.4.2.block.0.1.weight", "features.4.2.block.0.1.bias", "features.4.2.block.0.1.running_mean", "features.4.2.block.0.1.running_var", "features.4.2.block.0.1.num_batches_tracked", "features.4.2.block.1.0.weight", "features.4.2.block.1.1.weight", "features.4.2.block.1.1.bias", "features.4.2.block.1.1.running_mean", "features.4.2.block.1.1.running_var", "features.4.2.block.1.1.num_batches_tracked", "features.4.2.block.2.fc1.weight", "features.4.2.block.2.fc1.bias", "features.4.2.block.2.fc2.weight", "features.4.2.block.2.fc2.bias", "features.4.2.block.3.0.weight", "features.4.2.block.3.1.weight", "features.4.2.block.3.1.bias", "features.4.2.block.3.1.running_mean", "features.4.2.block.3.1.running_var", "features.4.2.block.3.1.num_batches_tracked", "features.5.0.block.0.0.weight", "features.5.0.block.0.1.weight", "features.5.0.block.0.1.bias", "features.5.0.block.0.1.running_mean", "features.5.0.block.0.1.running_var", "features.5.0.block.0.1.num_batches_tracked", "features.5.0.block.1.0.weight", "features.5.0.block.1.1.weight", "features.5.0.block.1.1.bias", "features.5.0.block.1.1.running_mean", "features.5.0.block.1.1.running_var", "features.5.0.block.1.1.num_batches_tracked", "features.5.0.block.2.fc1.weight", "features.5.0.block.2.fc1.bias", "features.5.0.block.2.fc2.weight", "features.5.0.block.2.fc2.bias", "features.5.0.block.3.0.weight", "features.5.0.block.3.1.weight", "features.5.0.block.3.1.bias", "features.5.0.block.3.1.running_mean", "features.5.0.block.3.1.running_var", "features.5.0.block.3.1.num_batches_tracked", "features.5.1.block.0.0.weight", "features.5.1.block.0.1.weight", "features.5.1.block.0.1.bias", "features.5.1.block.0.1.running_mean", "features.5.1.block.0.1.running_var", "features.5.1.block.0.1.num_batches_tracked", "features.5.1.block.1.0.weight", "features.5.1.block.1.1.weight", "features.5.1.block.1.1.bias", "features.5.1.block.1.1.running_mean", "features.5.1.block.1.1.running_var", "features.5.1.block.1.1.num_batches_tracked", "features.5.1.block.2.fc1.weight", "features.5.1.block.2.fc1.bias", "features.5.1.block.2.fc2.weight", "features.5.1.block.2.fc2.bias", "features.5.1.block.3.0.weight", "features.5.1.block.3.1.weight", "features.5.1.block.3.1.bias", "features.5.1.block.3.1.running_mean", "features.5.1.block.3.1.running_var", "features.5.1.block.3.1.num_batches_tracked", "features.5.2.block.0.0.weight", "features.5.2.block.0.1.weight", "features.5.2.block.0.1.bias", "features.5.2.block.0.1.running_mean", "features.5.2.block.0.1.running_var", "features.5.2.block.0.1.num_batches_tracked", "features.5.2.block.1.0.weight", "features.5.2.block.1.1.weight", "features.5.2.block.1.1.bias", "features.5.2.block.1.1.running_mean", "features.5.2.block.1.1.running_var", "features.5.2.block.1.1.num_batches_tracked", "features.5.2.block.2.fc1.weight", "features.5.2.block.2.fc1.bias", "features.5.2.block.2.fc2.weight", "features.5.2.block.2.fc2.bias", "features.5.2.block.3.0.weight", "features.5.2.block.3.1.weight", "features.5.2.block.3.1.bias", "features.5.2.block.3.1.running_mean", "features.5.2.block.3.1.running_var", "features.5.2.block.3.1.num_batches_tracked", "features.6.0.block.0.0.weight", "features.6.0.block.0.1.weight", "features.6.0.block.0.1.bias", "features.6.0.block.0.1.running_mean", "features.6.0.block.0.1.running_var", "features.6.0.block.0.1.num_batches_tracked", "features.6.0.block.1.0.weight", "features.6.0.block.1.1.weight", "features.6.0.block.1.1.bias", "features.6.0.block.1.1.running_mean", "features.6.0.block.1.1.running_var", "features.6.0.block.1.1.num_batches_tracked", "features.6.0.block.2.fc1.weight", "features.6.0.block.2.fc1.bias", "features.6.0.block.2.fc2.weight", "features.6.0.block.2.fc2.bias", "features.6.0.block.3.0.weight", "features.6.0.block.3.1.weight", "features.6.0.block.3.1.bias", "features.6.0.block.3.1.running_mean", "features.6.0.block.3.1.running_var", "features.6.0.block.3.1.num_batches_tracked", "features.6.1.block.0.0.weight", "features.6.1.block.0.1.weight", "features.6.1.block.0.1.bias", "features.6.1.block.0.1.running_mean", "features.6.1.block.0.1.running_var", "features.6.1.block.0.1.num_batches_tracked", "features.6.1.block.1.0.weight", "features.6.1.block.1.1.weight", "features.6.1.block.1.1.bias", "features.6.1.block.1.1.running_mean", "features.6.1.block.1.1.running_var", "features.6.1.block.1.1.num_batches_tracked", "features.6.1.block.2.fc1.weight", "features.6.1.block.2.fc1.bias", "features.6.1.block.2.fc2.weight", "features.6.1.block.2.fc2.bias", "features.6.1.block.3.0.weight", "features.6.1.block.3.1.weight", "features.6.1.block.3.1.bias", "features.6.1.block.3.1.running_mean", "features.6.1.block.3.1.running_var", "features.6.1.block.3.1.num_batches_tracked", "features.6.2.block.0.0.weight", "features.6.2.block.0.1.weight", "features.6.2.block.0.1.bias", "features.6.2.block.0.1.running_mean", "features.6.2.block.0.1.running_var", "features.6.2.block.0.1.num_batches_tracked", "features.6.2.block.1.0.weight", "features.6.2.block.1.1.weight", "features.6.2.block.1.1.bias", "features.6.2.block.1.1.running_mean", "features.6.2.block.1.1.running_var", "features.6.2.block.1.1.num_batches_tracked", "features.6.2.block.2.fc1.weight", "features.6.2.block.2.fc1.bias", "features.6.2.block.2.fc2.weight", "features.6.2.block.2.fc2.bias", "features.6.2.block.3.0.weight", "features.6.2.block.3.1.weight", "features.6.2.block.3.1.bias", "features.6.2.block.3.1.running_mean", "features.6.2.block.3.1.running_var", "features.6.2.block.3.1.num_batches_tracked", "features.6.3.block.0.0.weight", "features.6.3.block.0.1.weight", "features.6.3.block.0.1.bias", "features.6.3.block.0.1.running_mean", "features.6.3.block.0.1.running_var", "features.6.3.block.0.1.num_batches_tracked", "features.6.3.block.1.0.weight", "features.6.3.block.1.1.weight", "features.6.3.block.1.1.bias", "features.6.3.block.1.1.running_mean", "features.6.3.block.1.1.running_var", "features.6.3.block.1.1.num_batches_tracked", "features.6.3.block.2.fc1.weight", "features.6.3.block.2.fc1.bias", "features.6.3.block.2.fc2.weight", "features.6.3.block.2.fc2.bias", "features.6.3.block.3.0.weight", "features.6.3.block.3.1.weight", "features.6.3.block.3.1.bias", "features.6.3.block.3.1.running_mean", "features.6.3.block.3.1.running_var", "features.6.3.block.3.1.num_batches_tracked", "features.7.0.block.0.0.weight", "features.7.0.block.0.1.weight", "features.7.0.block.0.1.bias", "features.7.0.block.0.1.running_mean", "features.7.0.block.0.1.running_var", "features.7.0.block.0.1.num_batches_tracked", "features.7.0.block.1.0.weight", "features.7.0.block.1.1.weight", "features.7.0.block.1.1.bias", "features.7.0.block.1.1.running_mean", "features.7.0.block.1.1.running_var", "features.7.0.block.1.1.num_batches_tracked", "features.7.0.block.2.fc1.weight", "features.7.0.block.2.fc1.bias", "features.7.0.block.2.fc2.weight", "features.7.0.block.2.fc2.bias", "features.7.0.block.3.0.weight", "features.7.0.block.3.1.weight", "features.7.0.block.3.1.bias", "features.7.0.block.3.1.running_mean", "features.7.0.block.3.1.running_var", "features.7.0.block.3.1.num_batches_tracked", "features.8.0.weight", "features.8.1.weight", "features.8.1.bias", "features.8.1.running_mean", "features.8.1.running_var", "features.8.1.num_batches_tracked", "classifier.1.weight", "classifier.1.bias". 

2025-04-03 06:13:27,124 [INFO] - Using device: cuda
2025-04-03 06:13:27,132 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-03 06:13:27,133 [INFO] - GPU Memory: 6.00 GB
2025-04-03 06:13:27,134 [INFO] - CUDA Version: 12.4
2025-04-03 06:13:27,136 [INFO] - cuDNN benchmark mode enabled
2025-04-03 06:13:39,815 [INFO] - Using device: cuda
2025-04-03 06:13:39,815 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-03 06:13:39,820 [INFO] - GPU Memory: 6.00 GB
2025-04-03 06:13:39,820 [INFO] - CUDA Version: 12.4
2025-04-03 06:13:39,821 [INFO] - cuDNN benchmark mode enabled
2025-04-03 06:16:52,769 [INFO] - Using device: cuda
2025-04-03 06:16:52,769 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-03 06:16:52,769 [INFO] - GPU Memory: 6.00 GB
2025-04-03 06:16:52,774 [INFO] - CUDA Version: 12.4
2025-04-03 06:16:52,774 [INFO] - cuDNN benchmark mode enabled
2025-04-03 06:16:53,929 [INFO] - Using device: cuda
2025-04-03 06:16:53,929 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-03 06:16:53,935 [INFO] - GPU Memory: 6.00 GB
2025-04-03 06:16:53,935 [INFO] - CUDA Version: 12.4
2025-04-03 06:16:53,935 [INFO] - cuDNN benchmark mode enabled
2025-04-03 06:16:55,129 [INFO] - Using device: cuda
2025-04-03 06:16:55,129 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-03 06:16:55,129 [INFO] - GPU Memory: 6.00 GB
2025-04-03 06:16:55,129 [INFO] - CUDA Version: 12.4
2025-04-03 06:16:55,129 [INFO] - cuDNN benchmark mode enabled
2025-04-03 06:25:18,922 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 06:25:18,931 [INFO] - Random seed set to 42
2025-04-03 06:25:18,936 [INFO] - Preparing data loaders...
2025-04-03 06:25:20,531 [INFO] - Training samples: 45000
2025-04-03 06:25:20,532 [INFO] - Validation samples: 5000
2025-04-03 06:25:20,532 [INFO] - Test samples: 10000
2025-04-03 06:25:20,533 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 06:25:20,533 [INFO] - EMERGENCY RECOVERY: Loading models from best checkpoints...
2025-04-03 06:25:20,773 [ERROR] - An error occurred: empty() received an invalid combination of arguments - got (tuple, dtype=NoneType, device=NoneType), but expected one of:
 * (tuple of ints size, *, tuple of names names, torch.memory_format memory_format = None, torch.dtype dtype = None, torch.layout layout = None, torch.device device = None, bool pin_memory = False, bool requires_grad = False)
 * (tuple of ints size, *, torch.memory_format memory_format = None, Tensor out = None, torch.dtype dtype = None, torch.layout layout = None, torch.device device = None, bool pin_memory = False, bool requires_grad = False)

2025-04-03 06:25:20,773 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\393671559.py", line 74, in main
    models = recover_models_from_checkpoints(config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\393671559.py", line 9, in recover_models_from_checkpoints
    models = create_models(config)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\3269040925.py", line 32, in create_models
    models['efficientnet'].classifier[1] = nn.Linear(models['efficientnet'].classifier[1].in_features, num_classes)
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\linear.py", line 106, in __init__
    torch.empty((out_features, in_features), **factory_kwargs)
TypeError: empty() received an invalid combination of arguments - got (tuple, dtype=NoneType, device=NoneType), but expected one of:
 * (tuple of ints size, *, tuple of names names, torch.memory_format memory_format = None, torch.dtype dtype = None, torch.layout layout = None, torch.device device = None, bool pin_memory = False, bool requires_grad = False)
 * (tuple of ints size, *, torch.memory_format memory_format = None, Tensor out = None, torch.dtype dtype = None, torch.layout layout = None, torch.device device = None, bool pin_memory = False, bool requires_grad = False)


2025-04-03 06:26:54,468 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 06:26:54,468 [INFO] - Random seed set to 42
2025-04-03 06:26:54,468 [INFO] - Preparing data loaders...
2025-04-03 06:26:56,018 [INFO] - Training samples: 45000
2025-04-03 06:26:56,018 [INFO] - Validation samples: 5000
2025-04-03 06:26:56,018 [INFO] - Test samples: 10000
2025-04-03 06:26:56,018 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 06:26:56,018 [INFO] - EMERGENCY RECOVERY: Loading models from best checkpoints...
2025-04-03 06:26:56,798 [INFO] - Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-04-03 06:26:57,646 [INFO] - [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-03 06:26:58,248 [INFO] - Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-04-03 06:27:00,789 [ERROR] - An error occurred: name 'StudentModel' is not defined
2025-04-03 06:27:00,795 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\1046968762.py", line 111, in main
    models = recover_models_from_checkpoints(config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\1046968762.py", line 20, in recover_models_from_checkpoints
    'student': StudentModel(num_classes=10)
               ^^^^^^^^^^^^
NameError: name 'StudentModel' is not defined

2025-04-03 06:28:41,828 [INFO] - Using device: cuda
2025-04-03 06:28:41,828 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-03 06:28:41,828 [INFO] - GPU Memory: 6.00 GB
2025-04-03 06:28:41,828 [INFO] - CUDA Version: 12.4
2025-04-03 06:28:41,828 [INFO] - cuDNN benchmark mode enabled
2025-04-03 06:28:41,838 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 06:28:41,848 [INFO] - Random seed set to 42
2025-04-03 06:28:41,850 [INFO] - Preparing data loaders...
2025-04-03 06:28:43,740 [INFO] - Training samples: 45000
2025-04-03 06:28:43,740 [INFO] - Validation samples: 5000
2025-04-03 06:28:43,740 [INFO] - Test samples: 10000
2025-04-03 06:28:43,740 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 06:28:43,740 [INFO] - EMERGENCY RECOVERY: Loading models from best checkpoints...
2025-04-03 06:28:44,574 [INFO] - Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-04-03 06:28:44,894 [INFO] - [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-03 06:28:44,949 [INFO] - Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-04-03 06:28:46,032 [ERROR] - An error occurred: name 'StudentModel' is not defined
2025-04-03 06:28:46,037 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\2314214133.py", line 2348, in main
    models = recover_models_from_checkpoints(config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\2314214133.py", line 2257, in recover_models_from_checkpoints
    'student': StudentModel(num_classes=10)
               ^^^^^^^^^^^^
NameError: name 'StudentModel' is not defined

2025-04-03 06:29:26,016 [INFO] - Using device: cuda
2025-04-03 06:29:26,016 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-03 06:29:26,018 [INFO] - GPU Memory: 6.00 GB
2025-04-03 06:29:26,018 [INFO] - CUDA Version: 12.4
2025-04-03 06:29:26,018 [INFO] - cuDNN benchmark mode enabled
2025-04-03 06:29:26,037 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 06:29:26,039 [INFO] - Random seed set to 42
2025-04-03 06:29:26,039 [INFO] - Preparing data loaders...
2025-04-03 06:29:27,618 [INFO] - Training samples: 45000
2025-04-03 06:29:27,620 [INFO] - Validation samples: 5000
2025-04-03 06:29:27,620 [INFO] - Test samples: 10000
2025-04-03 06:29:27,620 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 06:29:27,622 [INFO] - EMERGENCY RECOVERY: Loading models from best checkpoints...
2025-04-03 06:29:28,368 [INFO] - Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-04-03 06:29:28,827 [INFO] - [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-03 06:29:28,881 [INFO] - Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-04-03 06:29:29,823 [ERROR] - An error occurred: name 'StudentModel' is not defined
2025-04-03 06:29:29,833 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\2314214133.py", line 2348, in main
    models = recover_models_from_checkpoints(config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\2314214133.py", line 2257, in recover_models_from_checkpoints
    'student': StudentModel(num_classes=10)
               ^^^^^^^^^^^^
NameError: name 'StudentModel' is not defined

2025-04-03 06:30:00,627 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 06:30:00,630 [INFO] - Random seed set to 42
2025-04-03 06:30:00,631 [INFO] - Preparing data loaders...
2025-04-03 06:30:02,291 [INFO] - Training samples: 45000
2025-04-03 06:30:02,298 [INFO] - Validation samples: 5000
2025-04-03 06:30:02,298 [INFO] - Test samples: 10000
2025-04-03 06:30:02,298 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 06:30:02,298 [INFO] - EMERGENCY RECOVERY: Loading models from best checkpoints...
2025-04-03 06:30:03,072 [INFO] - Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-04-03 06:30:03,358 [INFO] - [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-03 06:30:03,408 [INFO] - Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-04-03 06:30:04,582 [INFO] - Created base model for vit
2025-04-03 06:30:04,608 [INFO] - Created base model for efficientnet
2025-04-03 06:30:04,645 [INFO] - Created base model for inception
2025-04-03 06:30:04,658 [INFO] - Created base model for mobilenet
2025-04-03 06:30:04,682 [INFO] - Created base model for resnet
2025-04-03 06:30:04,738 [INFO] - Created base model for densenet
2025-04-03 06:30:04,762 [INFO] - Created base model for student
2025-04-03 06:30:04,762 [INFO] - Found checkpoint for vit: vit_init_best_5.pth
2025-04-03 06:30:04,846 [INFO] - Successfully loaded checkpoint for vit
2025-04-03 06:30:04,846 [INFO] - Found checkpoint for efficientnet: efficientnet_init_best_5.pth
2025-04-03 06:30:04,950 [INFO] - Successfully loaded checkpoint for efficientnet
2025-04-03 06:30:04,950 [INFO] - Found checkpoint for inception: inception_init_best_5.pth
2025-04-03 06:30:05,033 [INFO] - Successfully loaded checkpoint for inception
2025-04-03 06:30:05,033 [INFO] - Found checkpoint for mobilenet: mobilenet_init_best_5.pth
2025-04-03 06:30:05,107 [INFO] - Successfully loaded checkpoint for mobilenet
2025-04-03 06:30:05,116 [INFO] - Found checkpoint for resnet: resnet_init_best_5.pth
2025-04-03 06:30:05,195 [INFO] - Successfully loaded checkpoint for resnet
2025-04-03 06:30:05,195 [INFO] - Found checkpoint for densenet: densenet_init_best_5.pth
2025-04-03 06:30:05,278 [INFO] - Successfully loaded checkpoint for densenet
2025-04-03 06:30:05,278 [INFO] - Found checkpoint for student: student_init_best_4.pth
2025-04-03 06:30:05,373 [INFO] - Successfully loaded checkpoint for student
2025-04-03 06:30:05,373 [INFO] - Model vit is ready for evaluation
2025-04-03 06:30:05,376 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 06:30:05,378 [INFO] - Model inception is ready for evaluation
2025-04-03 06:30:05,379 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 06:30:05,379 [INFO] - Model resnet is ready for evaluation
2025-04-03 06:30:05,379 [INFO] - Model densenet is ready for evaluation
2025-04-03 06:30:05,383 [INFO] - Model student is ready for evaluation
2025-04-03 06:30:05,384 [INFO] - Model recovery completed.
2025-04-03 06:30:05,385 [INFO] - Plotting calibration curves...
2025-04-03 06:31:54,647 [INFO] - Teacher calibration curves saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\teacher_calibration_curves.png
2025-04-03 06:31:54,648 [INFO] - Evaluating final student model...
2025-04-03 06:31:54,648 [INFO] - Evaluating student model...
2025-04-03 06:32:00,115 [INFO] - Test Results:
2025-04-03 06:32:00,116 [INFO] - Loss: 0.1143
2025-04-03 06:32:00,117 [INFO] - Accuracy: 96.46%
2025-04-03 06:32:00,118 [INFO] - F1 Score: 0.9646
2025-04-03 06:32:00,118 [INFO] - Precision: 0.9648
2025-04-03 06:32:00,119 [INFO] - Recall: 0.9646
2025-04-03 06:32:00,119 [INFO] - ECE: 0.0094
2025-04-03 06:32:00,121 [INFO] - Exporting final student model...
2025-04-03 06:32:00,188 [INFO] - Final model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\cal_aware_mutual_model.pth
2025-04-03 06:32:00,188 [INFO] - RECOVERY completed successfully. Your models have been saved.
2025-04-03 06:35:09,863 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 06:35:09,865 [INFO] - Random seed set to 42
2025-04-03 06:35:09,866 [INFO] - Preparing data loaders...
2025-04-03 06:35:11,381 [INFO] - Training samples: 45000
2025-04-03 06:35:11,381 [INFO] - Validation samples: 5000
2025-04-03 06:35:11,381 [INFO] - Test samples: 10000
2025-04-03 06:35:11,381 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 06:35:11,381 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 06:35:12,141 [INFO] - Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-04-03 06:35:12,567 [INFO] - [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-03 06:35:12,938 [INFO] - Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-04-03 06:35:14,258 [INFO] - Created base model for vit
2025-04-03 06:35:14,258 [INFO] - Loading specific checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 06:35:15,181 [INFO] - Successfully loaded final checkpoint for vit
2025-04-03 06:35:15,201 [INFO] - Created base model for efficientnet
2025-04-03 06:35:15,202 [INFO] - Loading specific checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 06:35:15,423 [INFO] - Successfully loaded final checkpoint for efficientnet
2025-04-03 06:35:15,462 [INFO] - Created base model for inception
2025-04-03 06:35:15,463 [INFO] - Loading specific checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 06:35:15,755 [INFO] - Successfully loaded final checkpoint for inception
2025-04-03 06:35:15,770 [INFO] - Created base model for mobilenet
2025-04-03 06:35:15,771 [INFO] - Loading specific checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 06:35:15,977 [INFO] - Successfully loaded final checkpoint for mobilenet
2025-04-03 06:35:16,007 [INFO] - Created base model for resnet
2025-04-03 06:35:16,007 [INFO] - Loading specific checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 06:35:16,312 [INFO] - Successfully loaded final checkpoint for resnet
2025-04-03 06:35:16,367 [INFO] - Created base model for densenet
2025-04-03 06:35:16,367 [INFO] - Loading specific checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 06:35:16,698 [INFO] - Successfully loaded final checkpoint for densenet
2025-04-03 06:35:16,760 [INFO] - Created base model for student
2025-04-03 06:35:16,760 [INFO] - Loading specific checkpoint for student: student_20250330_014216_best.pth
2025-04-03 06:35:16,992 [INFO] - Successfully loaded final checkpoint for student
2025-04-03 06:35:16,992 [INFO] - Model vit is ready for evaluation
2025-04-03 06:35:16,997 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 06:35:16,997 [INFO] - Model inception is ready for evaluation
2025-04-03 06:35:17,000 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 06:35:17,000 [INFO] - Model resnet is ready for evaluation
2025-04-03 06:35:17,002 [INFO] - Model densenet is ready for evaluation
2025-04-03 06:35:17,002 [INFO] - Model student is ready for evaluation
2025-04-03 06:35:17,007 [INFO] - Model recovery completed with specified checkpoints.
2025-04-03 06:35:17,009 [INFO] - Plotting calibration curves...
2025-04-03 06:36:37,394 [INFO] - Teacher calibration curves saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\teacher_calibration_curves.png
2025-04-03 06:36:37,395 [INFO] - Evaluating final student model...
2025-04-03 06:36:37,397 [INFO] - Evaluating student model...
2025-04-03 06:36:42,830 [INFO] - Test Results:
2025-04-03 06:36:42,831 [INFO] - Loss: 0.1551
2025-04-03 06:36:42,831 [INFO] - Accuracy: 96.87%
2025-04-03 06:36:42,832 [INFO] - F1 Score: 0.9686
2025-04-03 06:36:42,832 [INFO] - Precision: 0.9689
2025-04-03 06:36:42,833 [INFO] - Recall: 0.9687
2025-04-03 06:36:42,834 [INFO] - ECE: 0.0501
2025-04-03 06:36:42,836 [INFO] - Exporting final student model...
2025-04-03 06:36:42,897 [INFO] - Final model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\cal_aware_mutual_model.pth
2025-04-03 06:36:42,897 [INFO] - RECOVERY completed successfully. Your models have been saved.
2025-04-03 06:38:30,822 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 06:38:30,822 [INFO] - Random seed set to 42
2025-04-03 06:38:30,826 [INFO] - Preparing data loaders...
2025-04-03 06:38:32,376 [INFO] - Training samples: 45000
2025-04-03 06:38:32,376 [INFO] - Validation samples: 5000
2025-04-03 06:38:32,376 [INFO] - Test samples: 10000
2025-04-03 06:38:32,376 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 06:38:32,376 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 06:38:34,588 [INFO] - Created base model for vit
2025-04-03 06:38:34,588 [INFO] - Loading specific checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 06:38:34,916 [INFO] - Loaded ViT model with non-strict loading
2025-04-03 06:38:34,934 [INFO] - Created base model for efficientnet
2025-04-03 06:38:34,934 [INFO] - Loading specific checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 06:38:35,091 [INFO] - Successfully loaded final checkpoint for efficientnet
2025-04-03 06:38:35,129 [INFO] - Created base model for inception
2025-04-03 06:38:35,130 [INFO] - Loading specific checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 06:38:35,356 [INFO] - Successfully loaded final checkpoint for inception
2025-04-03 06:38:35,370 [INFO] - Created base model for mobilenet
2025-04-03 06:38:35,371 [INFO] - Loading specific checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 06:38:35,502 [ERROR] - Error loading checkpoint for mobilenet: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 06:38:35,504 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\883581438.py", line 80, in recover_models_from_checkpoints
    model.load_state_dict(state_dict, strict=False)
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 2584, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).

2025-04-03 06:38:35,526 [INFO] - Created base model for resnet
2025-04-03 06:38:35,526 [INFO] - Loading specific checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 06:38:35,696 [INFO] - Successfully loaded final checkpoint for resnet
2025-04-03 06:38:35,726 [INFO] - Created base model for densenet
2025-04-03 06:38:35,726 [INFO] - Loading specific checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 06:38:36,128 [INFO] - Successfully loaded final checkpoint for densenet
2025-04-03 06:38:36,148 [INFO] - Created base model for student
2025-04-03 06:38:36,150 [INFO] - Loading specific checkpoint for student: student_20250330_014216_best.pth
2025-04-03 06:38:36,309 [INFO] - Successfully loaded final checkpoint for student
2025-04-03 06:38:36,309 [INFO] - Model vit is ready for evaluation
2025-04-03 06:38:36,314 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 06:38:36,316 [INFO] - Model inception is ready for evaluation
2025-04-03 06:38:36,316 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 06:38:36,321 [INFO] - Model resnet is ready for evaluation
2025-04-03 06:38:36,323 [INFO] - Model densenet is ready for evaluation
2025-04-03 06:38:36,323 [INFO] - Model student is ready for evaluation
2025-04-03 06:38:36,323 [INFO] - Hook registered for encoder.ln
2025-04-03 06:38:36,326 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-04-03 06:38:36,351 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-04-03 06:38:36,352 [INFO] - Hook registered for features.8
2025-04-03 06:38:36,352 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-04-03 06:38:36,396 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-04-03 06:38:36,396 [INFO] - Hook registered for inception.Mixed_7c
2025-04-03 06:38:36,398 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-04-03 06:38:36,428 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-04-03 06:38:36,429 [INFO] - Hook registered for features
2025-04-03 06:38:36,430 [INFO] - Feature extractor registered for mobilenet at layer features
2025-04-03 06:38:36,449 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-04-03 06:38:36,451 [INFO] - Hook registered for layer4
2025-04-03 06:38:36,451 [INFO] - Feature extractor registered for resnet at layer layer4
2025-04-03 06:38:36,468 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-04-03 06:38:36,468 [INFO] - Hook registered for features
2025-04-03 06:38:36,468 [INFO] - Feature extractor registered for densenet at layer features
2025-04-03 06:38:36,503 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-04-03 06:38:36,504 [INFO] - Hook registered for features.8
2025-04-03 06:38:36,505 [INFO] - Feature extractor registered for student at layer features.8
2025-04-03 06:38:36,517 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-04-03 06:38:36,519 [INFO] - Model recovery completed with specified checkpoints.
2025-04-03 06:38:36,521 [INFO] - Plotting training history...
2025-04-03 06:38:38,939 [INFO] - Training history plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\mutual_learning_history.png
2025-04-03 06:38:38,940 [INFO] - Plotting calibration curves...
2025-04-03 06:40:02,747 [INFO] - Teacher calibration curves saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\teacher_calibration_curves.png
2025-04-03 06:40:02,748 [INFO] - Evaluating final student model...
2025-04-03 06:40:02,748 [INFO] - Evaluating student model...
2025-04-03 06:40:08,269 [INFO] - Test Results:
2025-04-03 06:40:08,270 [INFO] - Loss: 0.1551
2025-04-03 06:40:08,271 [INFO] - Accuracy: 96.87%
2025-04-03 06:40:08,272 [INFO] - F1 Score: 0.9686
2025-04-03 06:40:08,272 [INFO] - Precision: 0.9689
2025-04-03 06:40:08,273 [INFO] - Recall: 0.9687
2025-04-03 06:40:08,273 [INFO] - ECE: 0.0501
2025-04-03 06:40:08,275 [INFO] - Exporting final student model...
2025-04-03 06:40:08,342 [INFO] - Final model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\cal_aware_mutual_model.pth
2025-04-03 06:40:08,342 [INFO] - RECOVERY completed successfully. Your models have been saved.
2025-04-03 06:41:17,339 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 06:41:17,340 [INFO] - Random seed set to 42
2025-04-03 06:41:17,341 [INFO] - Preparing data loaders...
2025-04-03 06:41:19,020 [INFO] - Training samples: 45000
2025-04-03 06:41:19,021 [INFO] - Validation samples: 5000
2025-04-03 06:41:19,021 [INFO] - Test samples: 10000
2025-04-03 06:41:19,022 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 06:41:19,022 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 06:41:21,124 [INFO] - Created base model for vit
2025-04-03 06:41:21,125 [INFO] - Loading specific checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 06:41:21,527 [INFO] - Loaded ViT model with non-strict loading
2025-04-03 06:41:21,542 [INFO] - Created base model for efficientnet
2025-04-03 06:41:21,542 [INFO] - Loading specific checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 06:41:21,723 [INFO] - Successfully loaded final checkpoint for efficientnet
2025-04-03 06:41:21,765 [INFO] - Created base model for inception
2025-04-03 06:41:21,765 [INFO] - Loading specific checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 06:41:22,019 [INFO] - Successfully loaded final checkpoint for inception
2025-04-03 06:41:22,034 [INFO] - Created base model for mobilenet
2025-04-03 06:41:22,035 [INFO] - Loading specific checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 06:41:22,190 [ERROR] - Error loading checkpoint for mobilenet: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 06:41:22,192 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\3841566026.py", line 80, in recover_models_from_checkpoints
    model.load_state_dict(state_dict, strict=False)
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 2584, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).

2025-04-03 06:41:22,216 [INFO] - Created base model for resnet
2025-04-03 06:41:22,216 [INFO] - Loading specific checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 06:41:22,419 [INFO] - Successfully loaded final checkpoint for resnet
2025-04-03 06:41:22,483 [INFO] - Created base model for densenet
2025-04-03 06:41:22,484 [INFO] - Loading specific checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 06:41:22,730 [INFO] - Successfully loaded final checkpoint for densenet
2025-04-03 06:41:22,747 [INFO] - Created base model for student
2025-04-03 06:41:22,748 [INFO] - Loading specific checkpoint for student: student_20250330_014216_best.pth
2025-04-03 06:41:22,926 [INFO] - Successfully loaded final checkpoint for student
2025-04-03 06:41:22,930 [INFO] - Model vit is ready for evaluation
2025-04-03 06:41:22,931 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 06:41:22,935 [INFO] - Model inception is ready for evaluation
2025-04-03 06:41:22,937 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 06:41:22,938 [INFO] - Model resnet is ready for evaluation
2025-04-03 06:41:22,940 [INFO] - Model densenet is ready for evaluation
2025-04-03 06:41:22,940 [INFO] - Model student is ready for evaluation
2025-04-03 06:41:22,943 [INFO] - Hook registered for encoder.ln
2025-04-03 06:41:22,943 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-04-03 06:41:22,955 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-04-03 06:41:22,956 [INFO] - Hook registered for features.8
2025-04-03 06:41:22,956 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-04-03 06:41:22,970 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-04-03 06:41:22,971 [INFO] - Hook registered for inception.Mixed_7c
2025-04-03 06:41:22,972 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-04-03 06:41:22,991 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-04-03 06:41:22,992 [INFO] - Hook registered for features
2025-04-03 06:41:22,993 [INFO] - Feature extractor registered for mobilenet at layer features
2025-04-03 06:41:23,007 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-04-03 06:41:23,008 [INFO] - Hook registered for layer4
2025-04-03 06:41:23,008 [INFO] - Feature extractor registered for resnet at layer layer4
2025-04-03 06:41:23,020 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-04-03 06:41:23,021 [INFO] - Hook registered for features
2025-04-03 06:41:23,021 [INFO] - Feature extractor registered for densenet at layer features
2025-04-03 06:41:23,051 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-04-03 06:41:23,052 [INFO] - Hook registered for features.8
2025-04-03 06:41:23,053 [INFO] - Feature extractor registered for student at layer features.8
2025-04-03 06:41:23,066 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-04-03 06:41:23,068 [INFO] - Model recovery completed with specified checkpoints.
2025-04-03 06:41:23,070 [INFO] - Plotting training history...
2025-04-03 06:41:25,444 [INFO] - Training history plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\mutual_learning_history.png
2025-04-03 06:41:25,444 [INFO] - Plotting calibration curves...
2025-04-03 06:42:19,910 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 06:42:19,915 [INFO] - Random seed set to 42
2025-04-03 06:42:19,915 [INFO] - Preparing data loaders...
2025-04-03 06:42:21,650 [INFO] - Training samples: 45000
2025-04-03 06:42:21,651 [INFO] - Validation samples: 5000
2025-04-03 06:42:21,651 [INFO] - Test samples: 10000
2025-04-03 06:42:21,652 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 06:42:21,652 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 06:42:21,653 [INFO] - Creating models with correct architectures...
2025-04-03 06:42:24,476 [INFO] - Loading checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 06:42:25,373 [INFO] - Using pretrained weights for vit due to architecture mismatch
2025-04-03 06:42:25,373 [INFO] - Loading checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 06:42:25,566 [INFO] - Successfully loaded efficientnet checkpoint
2025-04-03 06:42:25,567 [INFO] - Loading checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 06:42:25,873 [INFO] - Successfully loaded inception checkpoint
2025-04-03 06:42:25,873 [INFO] - Loading checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 06:42:26,079 [ERROR] - Error loading mobilenet checkpoint: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 06:42:26,081 [INFO] - Loading checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 06:42:26,428 [INFO] - Successfully loaded resnet checkpoint
2025-04-03 06:42:26,428 [INFO] - Loading checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 06:42:26,736 [INFO] - Successfully loaded densenet checkpoint
2025-04-03 06:42:26,736 [INFO] - Loading checkpoint for student: student_20250330_014216_best.pth
2025-04-03 06:42:26,959 [INFO] - Successfully loaded student checkpoint
2025-04-03 06:42:26,969 [INFO] - Creating plots for training history...
2025-04-03 06:42:29,836 [INFO] - Training history plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\mutual_learning_history.png
2025-04-03 06:42:29,836 [INFO] - Plotting calibration curves...
2025-04-03 06:43:55,546 [INFO] - Teacher calibration curves saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\teacher_calibration_curves.png
2025-04-03 06:43:55,548 [INFO] - Evaluating all models on test set...
2025-04-03 06:43:55,700 [ERROR] - An error occurred: to() received an invalid combination of arguments - got (Config), but expected one of:
 * (torch.device device = None, torch.dtype dtype = None, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (torch.dtype dtype, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (Tensor tensor, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)

2025-04-03 06:43:55,702 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\1647675741.py", line 222, in main
    metrics = evaluate_model(model, test_loader, config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\3269040925.py", line 71, in evaluate_model
    inputs, targets = inputs.to(device), targets.to(device)
                      ^^^^^^^^^^^^^^^^^
TypeError: to() received an invalid combination of arguments - got (Config), but expected one of:
 * (torch.device device = None, torch.dtype dtype = None, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (torch.dtype dtype, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (Tensor tensor, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)


2025-04-03 06:53:00,816 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 06:53:00,823 [INFO] - Random seed set to 42
2025-04-03 06:53:00,823 [INFO] - Preparing data loaders...
2025-04-03 06:53:02,351 [INFO] - Training samples: 45000
2025-04-03 06:53:02,352 [INFO] - Validation samples: 5000
2025-04-03 06:53:02,352 [INFO] - Test samples: 10000
2025-04-03 06:53:02,353 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 06:53:02,354 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 06:53:02,354 [INFO] - Creating models with correct architectures...
2025-04-03 06:53:05,135 [INFO] - Loading checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 06:53:06,106 [INFO] - Using pretrained weights for vit due to architecture mismatch
2025-04-03 06:53:06,106 [INFO] - Original ViT accuracy: 60.68% (epoch 43)
2025-04-03 06:53:06,106 [INFO] - Loading checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 06:53:06,354 [INFO] - Successfully loaded efficientnet checkpoint
2025-04-03 06:53:06,357 [INFO] - Loading checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 06:53:06,726 [INFO] - Successfully loaded inception checkpoint
2025-04-03 06:53:06,726 [INFO] - Loading checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 06:53:06,945 [ERROR] - Error loading mobilenet checkpoint: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 06:53:06,945 [INFO] - Loading checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 06:53:07,316 [INFO] - Successfully loaded resnet checkpoint
2025-04-03 06:53:07,316 [INFO] - Loading checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 06:53:07,624 [INFO] - Successfully loaded densenet checkpoint
2025-04-03 06:53:07,624 [INFO] - Loading checkpoint for student: student_20250330_014216_best.pth
2025-04-03 06:53:07,843 [INFO] - Successfully loaded student checkpoint
2025-04-03 06:53:07,845 [ERROR] - An error occurred: 'Config' object has no attribute 'log_file'
2025-04-03 06:53:07,853 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\512794480.py", line 334, in main
    models, history = recover_models_from_checkpoints(config)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\512794480.py", line 118, in recover_models_from_checkpoints
    history = extract_history_from_logs(config.log_file)
                                        ^^^^^^^^^^^^^^^
AttributeError: 'Config' object has no attribute 'log_file'

2025-04-03 06:56:46,235 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 06:56:46,235 [INFO] - Random seed set to 42
2025-04-03 06:56:46,235 [INFO] - Preparing data loaders...
2025-04-03 06:56:47,849 [INFO] - Training samples: 45000
2025-04-03 06:56:47,853 [INFO] - Validation samples: 5000
2025-04-03 06:56:47,854 [INFO] - Test samples: 10000
2025-04-03 06:56:47,854 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 06:56:47,854 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 06:56:47,854 [INFO] - Using log file: C:\Users\Gading\Downloads\Research\Results\MutualLearning\logs\mutual_learning.log
2025-04-03 06:56:47,854 [INFO] - Creating models with correct architectures...
2025-04-03 06:56:49,968 [INFO] - Loading checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 06:56:50,299 [INFO] - Using pretrained weights for vit due to architecture mismatch
2025-04-03 06:56:50,299 [INFO] - Original ViT accuracy: 60.68% (epoch 43)
2025-04-03 06:56:50,299 [INFO] - Loading checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 06:56:50,457 [INFO] - Successfully loaded efficientnet checkpoint
2025-04-03 06:56:50,457 [INFO] - Loading checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 06:56:50,674 [INFO] - Successfully loaded inception checkpoint
2025-04-03 06:56:50,674 [INFO] - Loading checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 06:56:50,814 [ERROR] - Error loading mobilenet checkpoint: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 06:56:50,816 [INFO] - Loading checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 06:56:50,986 [INFO] - Successfully loaded resnet checkpoint
2025-04-03 06:56:50,986 [INFO] - Loading checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 06:56:51,218 [INFO] - Successfully loaded densenet checkpoint
2025-04-03 06:56:51,218 [INFO] - Loading checkpoint for student: student_20250330_014216_best.pth
2025-04-03 06:56:51,384 [INFO] - Successfully loaded student checkpoint
2025-04-03 06:56:51,425 [INFO] - Successfully extracted training history from logs for 49 epochs
2025-04-03 06:56:51,429 [INFO] - Plotting training history...
2025-04-03 06:56:51,473 [ERROR] - An error occurred: 'mutual_loss'
2025-04-03 06:56:51,474 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\408097560.py", line 339, in main
    plot_mutual_learning_history(history, config)
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\2314214133.py", line 1925, in plot_mutual_learning_history
    plt.plot(history[name]['mutual_loss'], label=f"{name}")
             ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
KeyError: 'mutual_loss'

2025-04-03 06:57:44,387 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 06:57:44,394 [INFO] - Random seed set to 42
2025-04-03 06:57:44,394 [INFO] - Preparing data loaders...
2025-04-03 06:57:45,984 [INFO] - Training samples: 45000
2025-04-03 06:57:45,984 [INFO] - Validation samples: 5000
2025-04-03 06:57:45,984 [INFO] - Test samples: 10000
2025-04-03 06:57:45,984 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 06:57:45,984 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 06:57:45,984 [INFO] - Using log file: C:\Users\Gading\Downloads\Research\Results\MutualLearning\logs\error.log
2025-04-03 06:57:45,984 [INFO] - Creating models with correct architectures...
2025-04-03 06:57:48,734 [INFO] - Loading checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 06:57:49,061 [INFO] - Using pretrained weights for vit due to architecture mismatch
2025-04-03 06:57:49,061 [INFO] - Original ViT accuracy: 60.68% (epoch 43)
2025-04-03 06:57:49,061 [INFO] - Loading checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 06:57:49,214 [INFO] - Successfully loaded efficientnet checkpoint
2025-04-03 06:57:49,214 [INFO] - Loading checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 06:57:49,435 [INFO] - Successfully loaded inception checkpoint
2025-04-03 06:57:49,435 [INFO] - Loading checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 06:57:49,579 [ERROR] - Error loading mobilenet checkpoint: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 06:57:49,579 [INFO] - Loading checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 06:57:49,751 [INFO] - Successfully loaded resnet checkpoint
2025-04-03 06:57:49,754 [INFO] - Loading checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 06:57:49,968 [INFO] - Successfully loaded densenet checkpoint
2025-04-03 06:57:49,974 [INFO] - Loading checkpoint for student: student_20250330_014216_best.pth
2025-04-03 06:57:50,144 [INFO] - Successfully loaded student checkpoint
2025-04-03 06:57:50,169 [INFO] - Successfully extracted training history from logs for 49 epochs
2025-04-03 06:57:50,173 [INFO] - Plotting training history...
2025-04-03 06:57:50,213 [ERROR] - An error occurred: 'mutual_loss'
2025-04-03 06:57:50,214 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\3383150867.py", line 339, in main
    plot_mutual_learning_history(history, config)
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\2314214133.py", line 1925, in plot_mutual_learning_history
    plt.plot(history[name]['mutual_loss'], label=f"{name}")
             ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
KeyError: 'mutual_loss'

2025-04-03 07:11:11,174 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 07:11:11,176 [INFO] - Random seed set to 42
2025-04-03 07:11:11,177 [INFO] - Preparing data loaders...
2025-04-03 07:11:12,822 [INFO] - Training samples: 45000
2025-04-03 07:11:12,822 [INFO] - Validation samples: 5000
2025-04-03 07:11:12,822 [INFO] - Test samples: 10000
2025-04-03 07:11:12,822 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 07:11:12,822 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 07:11:12,822 [INFO] - Using log file: C:\Users\Gading\Downloads\Research\Results\MutualLearning\logs\error.log
2025-04-03 07:11:12,822 [INFO] - Creating models with correct architectures...
2025-04-03 07:11:14,767 [INFO] - Loading checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 07:11:15,082 [INFO] - Using pretrained weights for vit due to architecture mismatch
2025-04-03 07:11:15,082 [INFO] - Original ViT accuracy: 60.68% (epoch 43)
2025-04-03 07:11:15,082 [INFO] - Loading checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 07:11:15,254 [INFO] - Successfully loaded efficientnet checkpoint
2025-04-03 07:11:15,254 [INFO] - Loading checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 07:11:15,482 [INFO] - Successfully loaded inception checkpoint
2025-04-03 07:11:15,482 [INFO] - Loading checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 07:11:15,622 [ERROR] - Error loading mobilenet checkpoint: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 07:11:15,622 [INFO] - Loading checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 07:11:15,797 [INFO] - Successfully loaded resnet checkpoint
2025-04-03 07:11:15,797 [INFO] - Loading checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 07:11:16,024 [INFO] - Successfully loaded densenet checkpoint
2025-04-03 07:11:16,024 [INFO] - Loading checkpoint for student: student_20250330_014216_best.pth
2025-04-03 07:11:16,184 [INFO] - Successfully loaded student checkpoint
2025-04-03 07:11:16,205 [INFO] - Successfully extracted training history from logs for 49 epochs
2025-04-03 07:11:16,205 [INFO] - Plotting training history...
2025-04-03 07:11:18,252 [INFO] - Training history plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_history_plot.png
2025-04-03 07:11:19,600 [INFO] - Student comparison plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\student_comparison_plot.png
2025-04-03 07:11:19,781 [INFO] - Plotting calibration curves...
2025-04-03 07:12:45,002 [INFO] - Teacher calibration curves saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\teacher_calibration_curves.png
2025-04-03 07:12:45,002 [INFO] - Evaluating all models...
2025-04-03 07:12:45,146 [ERROR] - An error occurred: to() received an invalid combination of arguments - got (Config), but expected one of:
 * (torch.device device = None, torch.dtype dtype = None, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (torch.dtype dtype, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (Tensor tensor, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)

2025-04-03 07:12:45,151 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\1562654687.py", line 411, in main
    metrics = evaluate_model(model, test_loader, config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\3269040925.py", line 71, in evaluate_model
    inputs, targets = inputs.to(device), targets.to(device)
                      ^^^^^^^^^^^^^^^^^
TypeError: to() received an invalid combination of arguments - got (Config), but expected one of:
 * (torch.device device = None, torch.dtype dtype = None, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (torch.dtype dtype, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (Tensor tensor, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)


2025-04-03 07:12:51,539 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 07:12:51,542 [INFO] - Random seed set to 42
2025-04-03 07:12:51,542 [INFO] - Preparing data loaders...
2025-04-03 07:12:53,112 [INFO] - Training samples: 45000
2025-04-03 07:12:53,122 [INFO] - Validation samples: 5000
2025-04-03 07:12:53,122 [INFO] - Test samples: 10000
2025-04-03 07:12:53,122 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 07:12:53,122 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 07:12:53,122 [INFO] - Using log file: C:\Users\Gading\Downloads\Research\Results\MutualLearning\logs\error.log
2025-04-03 07:12:53,122 [INFO] - Creating models with correct architectures...
2025-04-03 07:12:56,117 [INFO] - Loading checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 07:12:56,972 [INFO] - Using pretrained weights for vit due to architecture mismatch
2025-04-03 07:12:56,972 [INFO] - Original ViT accuracy: 60.68% (epoch 43)
2025-04-03 07:12:56,981 [INFO] - Loading checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 07:12:57,172 [INFO] - Successfully loaded efficientnet checkpoint
2025-04-03 07:12:57,172 [INFO] - Loading checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 07:12:57,434 [INFO] - Successfully loaded inception checkpoint
2025-04-03 07:12:57,434 [INFO] - Loading checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 07:12:57,592 [ERROR] - Error loading mobilenet checkpoint: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 07:12:57,592 [INFO] - Loading checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 07:12:57,790 [INFO] - Successfully loaded resnet checkpoint
2025-04-03 07:12:57,790 [INFO] - Loading checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 07:12:58,072 [INFO] - Successfully loaded densenet checkpoint
2025-04-03 07:12:58,072 [INFO] - Loading checkpoint for student: student_20250330_014216_best.pth
2025-04-03 07:12:58,282 [INFO] - Successfully loaded student checkpoint
2025-04-03 07:12:58,292 [INFO] - Successfully extracted training history from logs for 49 epochs
2025-04-03 07:12:58,293 [INFO] - Plotting training history...
2025-04-03 07:13:00,612 [INFO] - Complete training history plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_history_full.png
2025-04-03 07:13:01,972 [INFO] - Student comparison plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\student_vs_teachers_comparison.png
2025-04-03 07:13:02,556 [INFO] - Final performance comparison saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\final_model_performance.png
2025-04-03 07:13:02,662 [INFO] - Plotting calibration curves...
2025-04-03 07:14:27,211 [INFO] - Teacher calibration curves saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\teacher_calibration_curves.png
2025-04-03 07:14:27,211 [INFO] - Evaluating all models...
2025-04-03 07:14:27,332 [ERROR] - An error occurred: to() received an invalid combination of arguments - got (Config), but expected one of:
 * (torch.device device = None, torch.dtype dtype = None, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (torch.dtype dtype, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (Tensor tensor, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)

2025-04-03 07:14:27,333 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\1187987962.py", line 582, in main
    metrics = evaluate_model(model, test_loader, config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\3269040925.py", line 71, in evaluate_model
    inputs, targets = inputs.to(device), targets.to(device)
                      ^^^^^^^^^^^^^^^^^
TypeError: to() received an invalid combination of arguments - got (Config), but expected one of:
 * (torch.device device = None, torch.dtype dtype = None, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (torch.dtype dtype, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (Tensor tensor, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)


2025-04-03 07:25:48,304 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 07:25:48,307 [INFO] - Random seed set to 42
2025-04-03 07:25:48,308 [INFO] - Preparing data loaders...
2025-04-03 07:25:49,900 [INFO] - Training samples: 45000
2025-04-03 07:25:49,900 [INFO] - Validation samples: 5000
2025-04-03 07:25:49,900 [INFO] - Test samples: 10000
2025-04-03 07:25:49,900 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 07:25:49,900 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 07:25:49,904 [INFO] - Using log file: C:\Users\Gading\Downloads\Research\Results\MutualLearning\logs\error.log
2025-04-03 07:25:49,904 [INFO] - Creating models with correct architectures...
2025-04-03 07:25:52,480 [INFO] - Loading checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 07:25:53,380 [INFO] - Using pretrained weights for vit due to architecture mismatch
2025-04-03 07:25:53,380 [INFO] - Original ViT accuracy: 60.68% (epoch 43)
2025-04-03 07:25:53,380 [INFO] - Loading checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 07:25:53,595 [INFO] - Successfully loaded efficientnet checkpoint
2025-04-03 07:25:53,595 [INFO] - Loading checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 07:25:53,884 [INFO] - Successfully loaded inception checkpoint
2025-04-03 07:25:53,884 [INFO] - Loading checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 07:25:54,082 [ERROR] - Error loading mobilenet checkpoint: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 07:25:54,082 [INFO] - Loading checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 07:25:54,390 [INFO] - Successfully loaded resnet checkpoint
2025-04-03 07:25:54,395 [INFO] - Loading checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 07:25:54,700 [INFO] - Successfully loaded densenet checkpoint
2025-04-03 07:25:54,700 [INFO] - Loading checkpoint for student: student_20250330_014216_best.pth
2025-04-03 07:25:54,910 [INFO] - Successfully loaded student checkpoint
2025-04-03 07:25:54,920 [INFO] - Successfully extracted training history from logs for 49 epochs
2025-04-03 07:25:54,929 [INFO] - Plotting training history...
2025-04-03 07:25:57,830 [INFO] - Complete training history plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_history_full.png
2025-04-03 07:25:59,208 [INFO] - Student comparison plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\student_vs_teachers_comparison.png
2025-04-03 07:25:59,756 [INFO] - Final performance comparison saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\final_model_performance.png
2025-04-03 07:25:59,854 [INFO] - Plotting calibration curves...
2025-04-03 07:27:26,432 [INFO] - Teacher calibration curves saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\teacher_calibration_curves.png
2025-04-03 07:27:26,432 [INFO] - Evaluating all models...
2025-04-03 07:27:26,580 [ERROR] - An error occurred: to() received an invalid combination of arguments - got (Config), but expected one of:
 * (torch.device device = None, torch.dtype dtype = None, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (torch.dtype dtype, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (Tensor tensor, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)

2025-04-03 07:27:26,580 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\1527897424.py", line 561, in main
    metrics = evaluate_model(model, test_loader, config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\3269040925.py", line 71, in evaluate_model
    inputs, targets = inputs.to(device), targets.to(device)
                      ^^^^^^^^^^^^^^^^^
TypeError: to() received an invalid combination of arguments - got (Config), but expected one of:
 * (torch.device device = None, torch.dtype dtype = None, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (torch.dtype dtype, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (Tensor tensor, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)


2025-04-03 07:30:35,565 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 07:30:35,566 [INFO] - Random seed set to 42
2025-04-03 07:30:35,566 [INFO] - Preparing data loaders...
2025-04-03 07:30:37,075 [INFO] - Training samples: 45000
2025-04-03 07:30:37,079 [INFO] - Validation samples: 5000
2025-04-03 07:30:37,079 [INFO] - Test samples: 10000
2025-04-03 07:30:37,079 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 07:30:37,079 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 07:30:37,079 [INFO] - Using log file: C:\Users\Gading\Downloads\Research\Results\MutualLearning\logs\error.log
2025-04-03 07:30:37,079 [INFO] - Creating models with correct architectures...
2025-04-03 07:30:39,570 [INFO] - Loading checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 07:30:40,439 [INFO] - Using pretrained weights for vit due to architecture mismatch
2025-04-03 07:30:40,446 [INFO] - Original ViT accuracy: 60.68% (epoch 43)
2025-04-03 07:30:40,446 [INFO] - Loading checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 07:30:40,629 [INFO] - Successfully loaded efficientnet checkpoint
2025-04-03 07:30:40,632 [INFO] - Loading checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 07:30:40,910 [INFO] - Successfully loaded inception checkpoint
2025-04-03 07:30:40,910 [INFO] - Loading checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 07:30:41,105 [ERROR] - Error loading mobilenet checkpoint: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 07:30:41,105 [INFO] - Loading checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 07:30:41,390 [INFO] - Successfully loaded resnet checkpoint
2025-04-03 07:30:41,390 [INFO] - Loading checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 07:30:41,693 [INFO] - Successfully loaded densenet checkpoint
2025-04-03 07:30:41,695 [INFO] - Loading checkpoint for student: student_20250330_014216_best.pth
2025-04-03 07:30:41,892 [INFO] - Successfully loaded student checkpoint
2025-04-03 07:30:41,911 [INFO] - Successfully extracted training history from logs for 49 epochs
2025-04-03 07:30:41,911 [INFO] - Plotting training history...
2025-04-03 07:30:44,210 [INFO] - Complete training history plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_history_full.png
2025-04-03 07:30:45,679 [INFO] - Student comparison plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\student_vs_teachers_comparison.png
2025-04-03 07:30:46,211 [INFO] - Final performance comparison saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\final_model_performance.png
2025-04-03 07:30:46,314 [INFO] - Plotting calibration curves...
2025-04-03 07:32:16,279 [INFO] - Teacher calibration curves saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\teacher_calibration_curves.png
2025-04-03 07:32:16,279 [INFO] - Evaluating all models...
2025-04-03 07:32:16,429 [ERROR] - An error occurred: to() received an invalid combination of arguments - got (Config), but expected one of:
 * (torch.device device = None, torch.dtype dtype = None, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (torch.dtype dtype, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (Tensor tensor, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)

2025-04-03 07:32:16,433 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\3978453968.py", line 595, in main
    metrics = evaluate_model(model, test_loader, config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\3269040925.py", line 71, in evaluate_model
    inputs, targets = inputs.to(device), targets.to(device)
                      ^^^^^^^^^^^^^^^^^
TypeError: to() received an invalid combination of arguments - got (Config), but expected one of:
 * (torch.device device = None, torch.dtype dtype = None, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (torch.dtype dtype, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)
 * (Tensor tensor, bool non_blocking = False, bool copy = False, *, torch.memory_format memory_format = None)


2025-04-03 07:35:27,134 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 07:35:27,137 [INFO] - Random seed set to 42
2025-04-03 07:35:27,138 [INFO] - Preparing data loaders...
2025-04-03 07:35:28,676 [INFO] - Training samples: 45000
2025-04-03 07:35:28,677 [INFO] - Validation samples: 5000
2025-04-03 07:35:28,677 [INFO] - Test samples: 10000
2025-04-03 07:35:28,678 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 07:35:28,679 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 07:35:28,679 [INFO] - Using log file: C:\Users\Gading\Downloads\Research\Results\MutualLearning\logs\mutual_learning.log
2025-04-03 07:35:28,679 [INFO] - Creating models with correct architectures...
2025-04-03 07:35:31,554 [INFO] - Loading checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 07:35:32,459 [INFO] - Using pretrained weights for vit due to architecture mismatch
2025-04-03 07:35:32,459 [INFO] - Original ViT accuracy: 60.68% (epoch 43)
2025-04-03 07:35:32,459 [INFO] - Loading checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 07:35:33,289 [INFO] - Successfully loaded efficientnet checkpoint
2025-04-03 07:35:33,297 [INFO] - Loading checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 07:35:33,708 [INFO] - Successfully loaded inception checkpoint
2025-04-03 07:35:33,708 [INFO] - Loading checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 07:35:33,971 [ERROR] - Error loading mobilenet checkpoint: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 07:35:33,972 [INFO] - Loading checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 07:35:34,307 [INFO] - Successfully loaded resnet checkpoint
2025-04-03 07:35:34,309 [INFO] - Loading checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 07:35:34,621 [INFO] - Successfully loaded densenet checkpoint
2025-04-03 07:35:34,621 [INFO] - Loading checkpoint for student: student_20250330_014216_best.pth
2025-04-03 07:35:34,857 [INFO] - Successfully loaded student checkpoint
2025-04-03 07:35:34,879 [INFO] - Successfully extracted training history from logs for 49 epochs
2025-04-03 07:35:34,879 [INFO] - Plotting training history...
2025-04-03 07:35:37,160 [INFO] - Complete training history plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_history_full.png
2025-04-03 07:35:38,498 [INFO] - Student comparison plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\student_vs_teachers_comparison.png
2025-04-03 07:35:39,029 [INFO] - Final performance comparison saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\final_model_performance.png
2025-04-03 07:35:39,139 [INFO] - Plotting calibration curves...
2025-04-03 07:36:12,863 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 07:36:12,865 [INFO] - Random seed set to 42
2025-04-03 07:36:12,866 [INFO] - Preparing data loaders...
2025-04-03 07:36:14,646 [INFO] - Training samples: 45000
2025-04-03 07:36:14,649 [INFO] - Validation samples: 5000
2025-04-03 07:36:14,649 [INFO] - Test samples: 10000
2025-04-03 07:36:14,649 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 07:36:14,649 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 07:36:16,964 [INFO] - Created base model for vit
2025-04-03 07:36:16,966 [INFO] - Loading specific checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 07:36:18,028 [INFO] - Loaded ViT model with non-strict loading
2025-04-03 07:36:18,068 [INFO] - Created base model for efficientnet
2025-04-03 07:36:18,069 [INFO] - Loading specific checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 07:36:18,324 [INFO] - Successfully loaded final checkpoint for efficientnet
2025-04-03 07:36:18,399 [INFO] - Created base model for inception
2025-04-03 07:36:18,399 [INFO] - Loading specific checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 07:36:18,776 [INFO] - Successfully loaded final checkpoint for inception
2025-04-03 07:36:18,800 [INFO] - Created base model for mobilenet
2025-04-03 07:36:18,801 [INFO] - Loading specific checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 07:36:19,038 [ERROR] - Error loading checkpoint for mobilenet: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 07:36:19,040 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\883581438.py", line 80, in recover_models_from_checkpoints
    model.load_state_dict(state_dict, strict=False)
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 2584, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).

2025-04-03 07:36:19,107 [INFO] - Created base model for resnet
2025-04-03 07:36:19,109 [INFO] - Loading specific checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 07:36:19,459 [INFO] - Successfully loaded final checkpoint for resnet
2025-04-03 07:36:19,524 [INFO] - Created base model for densenet
2025-04-03 07:36:19,524 [INFO] - Loading specific checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 07:36:19,963 [INFO] - Successfully loaded final checkpoint for densenet
2025-04-03 07:36:20,013 [INFO] - Created base model for student
2025-04-03 07:36:20,014 [INFO] - Loading specific checkpoint for student: student_20250330_014216_best.pth
2025-04-03 07:36:20,265 [INFO] - Successfully loaded final checkpoint for student
2025-04-03 07:36:20,265 [INFO] - Model vit is ready for evaluation
2025-04-03 07:36:20,270 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 07:36:20,272 [INFO] - Model inception is ready for evaluation
2025-04-03 07:36:20,272 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 07:36:20,277 [INFO] - Model resnet is ready for evaluation
2025-04-03 07:36:20,279 [INFO] - Model densenet is ready for evaluation
2025-04-03 07:36:20,280 [INFO] - Model student is ready for evaluation
2025-04-03 07:36:20,280 [INFO] - Hook registered for encoder.ln
2025-04-03 07:36:20,283 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-04-03 07:36:20,309 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-04-03 07:36:20,310 [INFO] - Hook registered for features.8
2025-04-03 07:36:20,311 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-04-03 07:36:20,489 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-04-03 07:36:20,489 [INFO] - Hook registered for inception.Mixed_7c
2025-04-03 07:36:20,489 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-04-03 07:36:20,519 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-04-03 07:36:20,520 [INFO] - Hook registered for features
2025-04-03 07:36:20,520 [INFO] - Feature extractor registered for mobilenet at layer features
2025-04-03 07:36:20,579 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-04-03 07:36:20,579 [INFO] - Hook registered for layer4
2025-04-03 07:36:20,579 [INFO] - Feature extractor registered for resnet at layer layer4
2025-04-03 07:36:20,589 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-04-03 07:36:20,599 [INFO] - Hook registered for features
2025-04-03 07:36:20,599 [INFO] - Feature extractor registered for densenet at layer features
2025-04-03 07:36:20,625 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-04-03 07:36:20,626 [INFO] - Hook registered for features.8
2025-04-03 07:36:20,626 [INFO] - Feature extractor registered for student at layer features.8
2025-04-03 07:36:20,639 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-04-03 07:36:20,639 [INFO] - Model recovery completed with specified checkpoints.
2025-04-03 07:36:20,639 [INFO] - Plotting training history...
2025-04-03 07:36:23,129 [INFO] - Complete training history plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_history_full.png
2025-04-03 07:36:24,814 [INFO] - Student comparison plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\student_vs_teachers_comparison.png
2025-04-03 07:36:25,661 [INFO] - Final performance comparison saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\final_model_performance.png
2025-04-03 07:36:25,819 [INFO] - Plotting calibration curves...
2025-04-03 07:37:55,974 [INFO] - Teacher calibration curves saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\teacher_calibration_curves.png
2025-04-03 07:37:55,975 [INFO] - Evaluating final student model...
2025-04-03 07:37:55,976 [INFO] - Evaluating student model...
2025-04-03 07:38:01,548 [INFO] - Test Results:
2025-04-03 07:38:01,548 [INFO] - Loss: 0.1551
2025-04-03 07:38:01,548 [INFO] - Accuracy: 96.87%
2025-04-03 07:38:01,552 [INFO] - F1 Score: 0.9686
2025-04-03 07:38:01,553 [INFO] - Precision: 0.9689
2025-04-03 07:38:01,554 [INFO] - Recall: 0.9687
2025-04-03 07:38:01,554 [INFO] - ECE: 0.0501
2025-04-03 07:38:01,555 [INFO] - Exporting final student model...
2025-04-03 07:38:01,619 [INFO] - Final model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\cal_aware_mutual_model.pth
2025-04-03 07:38:01,621 [INFO] - RECOVERY completed successfully. Your models have been saved.
2025-04-03 07:38:21,617 [INFO] - Configuration: {'num_classes': 10, 'checkpoint_dir': 'C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints', 'export_dir': 'C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports', 'results_dir': 'C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning', 'seed': 42}
2025-04-03 07:38:21,621 [INFO] - Preparing data loaders...
2025-04-03 07:38:21,629 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 07:38:21,630 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 07:38:44,723 [INFO] - Created base model for vit
2025-04-03 07:38:44,725 [INFO] - Loading specific checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 07:38:45,578 [INFO] - Loaded ViT model with non-strict loading
2025-04-03 07:38:45,595 [INFO] - Created base model for efficientnet
2025-04-03 07:38:45,596 [INFO] - Loading specific checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 07:38:45,781 [INFO] - Successfully loaded final checkpoint for efficientnet
2025-04-03 07:38:45,815 [INFO] - Created base model for inception
2025-04-03 07:38:45,816 [INFO] - Loading specific checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 07:38:46,093 [INFO] - Successfully loaded final checkpoint for inception
2025-04-03 07:38:46,108 [INFO] - Created base model for mobilenet
2025-04-03 07:38:46,110 [INFO] - Loading specific checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 07:38:46,305 [ERROR] - Error loading checkpoint for mobilenet: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 07:38:46,305 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\3752584099.py", line 191, in recover_models_from_checkpoints
    model.load_state_dict(state_dict, strict=False)
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 2584, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).

2025-04-03 07:38:46,331 [INFO] - Created base model for resnet
2025-04-03 07:38:46,332 [INFO] - Loading specific checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 07:38:46,614 [INFO] - Successfully loaded final checkpoint for resnet
2025-04-03 07:38:46,669 [INFO] - Created base model for densenet
2025-04-03 07:38:46,670 [INFO] - Loading specific checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 07:38:46,958 [INFO] - Successfully loaded final checkpoint for densenet
2025-04-03 07:38:46,980 [INFO] - Created base model for student
2025-04-03 07:38:46,982 [INFO] - Loading specific checkpoint for student: student_20250330_014216_best.pth
2025-04-03 07:38:47,190 [INFO] - Successfully loaded final checkpoint for student
2025-04-03 07:38:47,191 [INFO] - Model vit is ready for evaluation
2025-04-03 07:38:47,191 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 07:38:47,191 [INFO] - Model inception is ready for evaluation
2025-04-03 07:38:47,191 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 07:38:47,197 [INFO] - Model resnet is ready for evaluation
2025-04-03 07:38:47,198 [INFO] - Model densenet is ready for evaluation
2025-04-03 07:38:47,198 [INFO] - Model student is ready for evaluation
2025-04-03 07:38:47,198 [INFO] - Model recovery completed with specified checkpoints.
2025-04-03 07:38:47,198 [INFO] - Plotting training history...
2025-04-03 07:38:47,204 [INFO] - Plotting mutual learning history (dummy implementation).
2025-04-03 07:38:47,301 [INFO] - Plotting calibration curves...
2025-04-03 07:38:47,303 [INFO] - Plotting teacher calibration curves (dummy implementation).
2025-04-03 07:38:47,404 [INFO] - Evaluating final student model...
2025-04-03 07:38:47,405 [INFO] - Evaluating student model (dummy evaluation).
2025-04-03 07:38:47,405 [INFO] - Exporting final student model...
2025-04-03 07:38:47,466 [INFO] - Final model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\cal_aware_mutual_model.pth
2025-04-03 07:38:47,467 [INFO] - RECOVERY completed successfully. Your models have been saved.
2025-04-03 07:40:37,189 [INFO] - Configuration: <__main__.Config object at 0x00000261B4C09CD0>
2025-04-03 07:40:37,196 [INFO] - Preparing data loaders...
2025-04-03 07:40:37,198 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 07:40:37,198 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 07:40:39,038 [INFO] - Created base model for vit
2025-04-03 07:40:39,038 [INFO] - Loading specific checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 07:40:39,358 [INFO] - Loaded ViT model with non-strict loading
2025-04-03 07:40:39,378 [INFO] - Created base model for efficientnet
2025-04-03 07:40:39,380 [INFO] - Loading specific checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 07:40:39,564 [INFO] - Successfully loaded final checkpoint for efficientnet
2025-04-03 07:40:39,600 [INFO] - Created base model for inception
2025-04-03 07:40:39,601 [INFO] - Loading specific checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 07:40:39,818 [INFO] - Successfully loaded final checkpoint for inception
2025-04-03 07:40:39,834 [INFO] - Created base model for mobilenet
2025-04-03 07:40:39,838 [INFO] - Loading specific checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 07:40:39,968 [ERROR] - Error loading checkpoint for mobilenet: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 07:40:39,968 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\883581438.py", line 80, in recover_models_from_checkpoints
    model.load_state_dict(state_dict, strict=False)
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 2584, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).

2025-04-03 07:40:39,996 [INFO] - Created base model for resnet
2025-04-03 07:40:39,998 [INFO] - Loading specific checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 07:40:40,197 [INFO] - Successfully loaded final checkpoint for resnet
2025-04-03 07:40:40,228 [INFO] - Created base model for densenet
2025-04-03 07:40:40,228 [INFO] - Loading specific checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 07:40:40,452 [INFO] - Successfully loaded final checkpoint for densenet
2025-04-03 07:40:40,468 [INFO] - Created base model for student
2025-04-03 07:40:40,468 [INFO] - Loading specific checkpoint for student: student_20250330_014216_best.pth
2025-04-03 07:40:40,638 [INFO] - Successfully loaded final checkpoint for student
2025-04-03 07:40:40,638 [INFO] - Model vit is ready for evaluation
2025-04-03 07:40:40,638 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 07:40:40,638 [INFO] - Model inception is ready for evaluation
2025-04-03 07:40:40,638 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 07:40:40,646 [INFO] - Model resnet is ready for evaluation
2025-04-03 07:40:40,648 [INFO] - Model densenet is ready for evaluation
2025-04-03 07:40:40,648 [INFO] - Model student is ready for evaluation
2025-04-03 07:40:40,648 [INFO] - Model recovery completed with specified checkpoints.
2025-04-03 07:40:40,648 [INFO] - Plotting training history...
2025-04-03 07:40:40,654 [INFO] - Plotting mutual learning history (dummy implementation).
2025-04-03 07:40:40,741 [INFO] - Plotting calibration curves...
2025-04-03 07:40:40,741 [INFO] - Plotting teacher calibration curves (dummy implementation).
2025-04-03 07:40:40,850 [INFO] - Evaluating final student model...
2025-04-03 07:40:40,850 [INFO] - Evaluating student model (dummy evaluation).
2025-04-03 07:40:40,850 [INFO] - Exporting final student model...
2025-04-03 07:40:40,904 [INFO] - Final model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\cal_aware_mutual_model.pth
2025-04-03 07:40:40,908 [INFO] - RECOVERY completed successfully. Your models have been saved.
2025-04-03 07:43:12,268 [INFO] - Configuration: <__main__.Config object at 0x000002619C8D8AA0>
2025-04-03 07:43:12,270 [INFO] - Preparing data loaders...
2025-04-03 07:43:12,273 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 07:43:12,273 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 07:43:13,105 [INFO] - Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-04-03 07:43:13,541 [INFO] - [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-03 07:43:14,128 [INFO] - Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-04-03 07:43:15,427 [INFO] - Created base model for vit
2025-04-03 07:43:15,427 [INFO] - Loading specific checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 07:43:16,028 [INFO] - Successfully loaded final checkpoint for vit
2025-04-03 07:43:16,057 [INFO] - Created base model for efficientnet
2025-04-03 07:43:16,058 [INFO] - Loading specific checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 07:43:16,248 [INFO] - Successfully loaded final checkpoint for efficientnet
2025-04-03 07:43:16,285 [INFO] - Created base model for inception
2025-04-03 07:43:16,285 [INFO] - Loading specific checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 07:43:16,518 [INFO] - Successfully loaded final checkpoint for inception
2025-04-03 07:43:16,528 [INFO] - Created base model for mobilenet
2025-04-03 07:43:16,528 [INFO] - Loading specific checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 07:43:16,693 [INFO] - Successfully loaded final checkpoint for mobilenet
2025-04-03 07:43:16,719 [INFO] - Created base model for resnet
2025-04-03 07:43:16,720 [INFO] - Loading specific checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 07:43:16,945 [INFO] - Successfully loaded final checkpoint for resnet
2025-04-03 07:43:16,985 [INFO] - Created base model for densenet
2025-04-03 07:43:16,988 [INFO] - Loading specific checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 07:43:17,264 [INFO] - Successfully loaded final checkpoint for densenet
2025-04-03 07:43:17,287 [INFO] - Created base model for student
2025-04-03 07:43:17,289 [INFO] - Loading specific checkpoint for student: student_20250330_014216_best.pth
2025-04-03 07:43:17,787 [INFO] - Successfully loaded final checkpoint for student
2025-04-03 07:43:17,787 [INFO] - Model vit is ready for evaluation
2025-04-03 07:43:17,787 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 07:43:17,797 [INFO] - Model inception is ready for evaluation
2025-04-03 07:43:17,798 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 07:43:17,800 [INFO] - Model resnet is ready for evaluation
2025-04-03 07:43:17,802 [INFO] - Model densenet is ready for evaluation
2025-04-03 07:43:17,802 [INFO] - Model student is ready for evaluation
2025-04-03 07:43:17,802 [INFO] - Model recovery completed with specified checkpoints.
2025-04-03 07:43:17,802 [INFO] - Plotting calibration curves...
2025-04-03 07:43:17,808 [INFO] - Plotting teacher calibration curves (dummy implementation).
2025-04-03 07:43:18,053 [INFO] - Evaluating final student model...
2025-04-03 07:43:18,053 [INFO] - Evaluating student model (dummy evaluation).
2025-04-03 07:43:18,053 [INFO] - Exporting final student model...
2025-04-03 07:43:18,116 [INFO] - Final model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\cal_aware_mutual_model.pth
2025-04-03 07:43:18,117 [INFO] - RECOVERY completed successfully. Your models have been saved.
2025-04-03 07:44:05,586 [INFO] - Configuration: <__main__.Config object at 0x00000261B4173AD0>
2025-04-03 07:44:05,588 [INFO] - Preparing data loaders...
2025-04-03 07:44:05,591 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 07:44:05,591 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 07:44:07,697 [INFO] - Created base model for vit
2025-04-03 07:44:07,697 [INFO] - Loading specific checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 07:44:08,256 [INFO] - Loaded ViT model with non-strict loading
2025-04-03 07:44:08,280 [INFO] - Created base model for efficientnet
2025-04-03 07:44:08,280 [INFO] - Loading specific checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 07:44:08,468 [INFO] - Successfully loaded final checkpoint for efficientnet
2025-04-03 07:44:08,533 [INFO] - Created base model for inception
2025-04-03 07:44:08,538 [INFO] - Loading specific checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 07:44:08,848 [INFO] - Successfully loaded final checkpoint for inception
2025-04-03 07:44:08,874 [INFO] - Created base model for mobilenet
2025-04-03 07:44:08,875 [INFO] - Loading specific checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 07:44:09,049 [ERROR] - Error loading checkpoint for mobilenet: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 07:44:09,049 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\3359851626.py", line 80, in recover_models_from_checkpoints
    model.load_state_dict(state_dict, strict=False)
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 2584, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).

2025-04-03 07:44:09,098 [INFO] - Created base model for resnet
2025-04-03 07:44:09,098 [INFO] - Loading specific checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 07:44:09,347 [INFO] - Successfully loaded final checkpoint for resnet
2025-04-03 07:44:09,388 [INFO] - Created base model for densenet
2025-04-03 07:44:09,390 [INFO] - Loading specific checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 07:44:09,651 [INFO] - Successfully loaded final checkpoint for densenet
2025-04-03 07:44:09,681 [INFO] - Created base model for student
2025-04-03 07:44:09,682 [INFO] - Loading specific checkpoint for student: student_20250330_014216_best.pth
2025-04-03 07:44:09,883 [INFO] - Successfully loaded final checkpoint for student
2025-04-03 07:44:09,883 [INFO] - Model vit is ready for evaluation
2025-04-03 07:44:09,887 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 07:44:09,887 [INFO] - Model inception is ready for evaluation
2025-04-03 07:44:09,887 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 07:44:09,892 [INFO] - Model resnet is ready for evaluation
2025-04-03 07:44:09,892 [INFO] - Model densenet is ready for evaluation
2025-04-03 07:44:09,892 [INFO] - Model student is ready for evaluation
2025-04-03 07:44:09,892 [INFO] - Model recovery completed with specified checkpoints.
2025-04-03 07:44:09,897 [INFO] - Plotting training history...
2025-04-03 07:44:09,897 [INFO] - Plotting mutual learning history (dummy implementation).
2025-04-03 07:44:09,987 [INFO] - Plotting calibration curves...
2025-04-03 07:44:09,987 [INFO] - Plotting teacher calibration curves (dummy implementation).
2025-04-03 07:44:10,098 [INFO] - Evaluating final student model...
2025-04-03 07:44:10,098 [INFO] - Evaluating student model (dummy evaluation).
2025-04-03 07:44:10,098 [INFO] - Exporting final student model...
2025-04-03 07:44:10,155 [INFO] - Final model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\cal_aware_mutual_model.pth
2025-04-03 07:44:10,156 [INFO] - RECOVERY completed successfully. Your models have been saved.
2025-04-03 07:44:39,077 [INFO] - Configuration: <__main__.Config object at 0x00000261B25BE8D0>
2025-04-03 07:44:39,080 [INFO] - Preparing data loaders...
2025-04-03 07:44:39,080 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 07:44:39,080 [INFO] - EMERGENCY RECOVERY: Loading models from best checkpoints...
2025-04-03 07:44:40,017 [INFO] - Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-04-03 07:44:40,298 [INFO] - [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-03 07:44:40,838 [INFO] - Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-04-03 07:44:42,014 [INFO] - Created base model for vit
2025-04-03 07:44:42,032 [INFO] - Created base model for efficientnet
2025-04-03 07:44:42,067 [INFO] - Created base model for inception
2025-04-03 07:44:42,077 [INFO] - Created base model for mobilenet
2025-04-03 07:44:42,117 [INFO] - Created base model for resnet
2025-04-03 07:44:42,148 [INFO] - Created base model for densenet
2025-04-03 07:44:42,164 [INFO] - Created base model for student
2025-04-03 07:44:42,164 [INFO] - Found checkpoint for vit: vit_init_best_5.pth
2025-04-03 07:44:42,248 [INFO] - Successfully loaded checkpoint for vit
2025-04-03 07:44:42,248 [INFO] - Found checkpoint for efficientnet: efficientnet_init_best_5.pth
2025-04-03 07:44:42,346 [INFO] - Successfully loaded checkpoint for efficientnet
2025-04-03 07:44:42,348 [INFO] - Found checkpoint for inception: inception_init_best_5.pth
2025-04-03 07:44:42,428 [INFO] - Successfully loaded checkpoint for inception
2025-04-03 07:44:42,430 [INFO] - Found checkpoint for mobilenet: mobilenet_init_best_5.pth
2025-04-03 07:44:42,512 [INFO] - Successfully loaded checkpoint for mobilenet
2025-04-03 07:44:42,514 [INFO] - Found checkpoint for resnet: resnet_init_best_5.pth
2025-04-03 07:44:42,612 [INFO] - Successfully loaded checkpoint for resnet
2025-04-03 07:44:42,612 [INFO] - Found checkpoint for densenet: densenet_init_best_5.pth
2025-04-03 07:44:42,695 [INFO] - Successfully loaded checkpoint for densenet
2025-04-03 07:44:42,695 [INFO] - Found checkpoint for student: student_init_best_4.pth
2025-04-03 07:44:42,790 [INFO] - Successfully loaded checkpoint for student
2025-04-03 07:44:42,790 [INFO] - Model vit is ready for evaluation
2025-04-03 07:44:42,790 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 07:44:42,790 [INFO] - Model inception is ready for evaluation
2025-04-03 07:44:42,797 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 07:44:42,797 [INFO] - Model resnet is ready for evaluation
2025-04-03 07:44:42,801 [INFO] - Model densenet is ready for evaluation
2025-04-03 07:44:42,801 [INFO] - Model student is ready for evaluation
2025-04-03 07:44:42,801 [INFO] - Model recovery completed.
2025-04-03 07:44:42,805 [INFO] - Plotting calibration curves...
2025-04-03 07:44:42,805 [INFO] - Plotting teacher calibration curves (dummy implementation).
2025-04-03 07:44:42,907 [INFO] - Evaluating final student model...
2025-04-03 07:44:42,907 [INFO] - Evaluating student model (dummy evaluation).
2025-04-03 07:44:42,907 [INFO] - Exporting final student model...
2025-04-03 07:44:42,967 [INFO] - Final model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\cal_aware_mutual_model.pth
2025-04-03 07:44:42,967 [INFO] - RECOVERY completed successfully. Your models have been saved.
2025-04-03 12:10:55,681 [INFO] - Configuration: <__main__.Config object at 0x00000261B2564890>
2025-04-03 12:10:55,681 [INFO] - Preparing data loaders...
2025-04-03 12:10:55,687 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 12:10:55,688 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 12:10:57,943 [INFO] - Created base model for vit
2025-04-03 12:10:57,943 [INFO] - Loading specific checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 12:10:59,021 [INFO] - Loaded ViT model with non-strict loading
2025-04-03 12:10:59,051 [INFO] - Created base model for efficientnet
2025-04-03 12:10:59,055 [INFO] - Loading specific checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 12:10:59,349 [INFO] - Successfully loaded final checkpoint for efficientnet
2025-04-03 12:10:59,455 [INFO] - Created base model for inception
2025-04-03 12:10:59,455 [INFO] - Loading specific checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 12:10:59,850 [INFO] - Successfully loaded final checkpoint for inception
2025-04-03 12:10:59,874 [INFO] - Created base model for mobilenet
2025-04-03 12:10:59,875 [INFO] - Loading specific checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 12:11:00,163 [ERROR] - Error loading checkpoint for mobilenet: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-04-03 12:11:00,165 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\3359851626.py", line 80, in recover_models_from_checkpoints
    model.load_state_dict(state_dict, strict=False)
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 2584, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).

2025-04-03 12:11:00,225 [INFO] - Created base model for resnet
2025-04-03 12:11:00,225 [INFO] - Loading specific checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 12:11:00,565 [INFO] - Successfully loaded final checkpoint for resnet
2025-04-03 12:11:00,645 [INFO] - Created base model for densenet
2025-04-03 12:11:00,647 [INFO] - Loading specific checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 12:11:01,073 [INFO] - Successfully loaded final checkpoint for densenet
2025-04-03 12:11:01,110 [INFO] - Created base model for student
2025-04-03 12:11:01,111 [INFO] - Loading specific checkpoint for student: student_20250330_014216_best.pth
2025-04-03 12:11:01,355 [INFO] - Successfully loaded final checkpoint for student
2025-04-03 12:11:01,361 [INFO] - Model vit is ready for evaluation
2025-04-03 12:11:01,361 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 12:11:01,361 [INFO] - Model inception is ready for evaluation
2025-04-03 12:11:01,361 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 12:11:01,366 [INFO] - Model resnet is ready for evaluation
2025-04-03 12:11:01,366 [INFO] - Model densenet is ready for evaluation
2025-04-03 12:11:01,366 [INFO] - Model student is ready for evaluation
2025-04-03 12:11:01,366 [INFO] - Model recovery completed with specified checkpoints.
2025-04-03 12:11:01,371 [INFO] - Plotting training history...
2025-04-03 12:11:01,371 [INFO] - Plotting mutual learning history (dummy implementation).
2025-04-03 12:11:01,463 [INFO] - Plotting calibration curves...
2025-04-03 12:11:01,463 [INFO] - Plotting teacher calibration curves (dummy implementation).
2025-04-03 12:11:01,561 [INFO] - Evaluating final student model...
2025-04-03 12:11:01,561 [INFO] - Evaluating student model (dummy evaluation).
2025-04-03 12:11:01,561 [INFO] - Exporting final student model...
2025-04-03 12:11:01,628 [INFO] - Final model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\cal_aware_mutual_model.pth
2025-04-03 12:11:01,628 [INFO] - RECOVERY completed successfully. Your models have been saved.
2025-04-03 12:12:15,071 [INFO] - Configuration: <__main__.Config object at 0x00000261AB29E120>
2025-04-03 12:12:15,071 [INFO] - Preparing data loaders...
2025-04-03 12:12:15,071 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 12:12:15,071 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 12:12:15,922 [INFO] - Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-04-03 12:12:16,361 [INFO] - [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-03 12:12:16,964 [INFO] - Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-04-03 12:12:18,623 [INFO] - Created base model for vit
2025-04-03 12:12:18,623 [INFO] - Loading specific checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 12:12:19,344 [INFO] - Successfully loaded final checkpoint for vit
2025-04-03 12:12:19,367 [INFO] - Created base model for efficientnet
2025-04-03 12:12:19,367 [INFO] - Loading specific checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 12:12:19,561 [INFO] - Successfully loaded final checkpoint for efficientnet
2025-04-03 12:12:19,596 [INFO] - Created base model for inception
2025-04-03 12:12:19,596 [INFO] - Loading specific checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 12:12:19,839 [INFO] - Successfully loaded final checkpoint for inception
2025-04-03 12:12:19,851 [INFO] - Created base model for mobilenet
2025-04-03 12:12:19,851 [INFO] - Loading specific checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 12:12:19,991 [INFO] - Successfully loaded final checkpoint for mobilenet
2025-04-03 12:12:20,022 [INFO] - Created base model for resnet
2025-04-03 12:12:20,023 [INFO] - Loading specific checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 12:12:20,205 [INFO] - Successfully loaded final checkpoint for resnet
2025-04-03 12:12:20,239 [INFO] - Created base model for densenet
2025-04-03 12:12:20,240 [INFO] - Loading specific checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 12:12:20,569 [INFO] - Successfully loaded final checkpoint for densenet
2025-04-03 12:12:20,592 [INFO] - Created base model for student
2025-04-03 12:12:20,592 [INFO] - Loading specific checkpoint for student: student_20250330_014216_best.pth
2025-04-03 12:12:20,792 [INFO] - Successfully loaded final checkpoint for student
2025-04-03 12:12:20,801 [INFO] - Model vit is ready for evaluation
2025-04-03 12:12:20,804 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 12:12:20,806 [INFO] - Model inception is ready for evaluation
2025-04-03 12:12:20,807 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 12:12:20,809 [INFO] - Model resnet is ready for evaluation
2025-04-03 12:12:20,811 [INFO] - Model densenet is ready for evaluation
2025-04-03 12:12:20,811 [INFO] - Model student is ready for evaluation
2025-04-03 12:12:20,811 [INFO] - Model recovery completed with specified checkpoints.
2025-04-03 12:12:20,818 [INFO] - Plotting calibration curves...
2025-04-03 12:12:20,818 [INFO] - Plotting teacher calibration curves (dummy implementation).
2025-04-03 12:12:20,923 [INFO] - Evaluating final student model...
2025-04-03 12:12:20,923 [INFO] - Evaluating student model (dummy evaluation).
2025-04-03 12:12:20,923 [INFO] - Exporting final student model...
2025-04-03 12:12:20,985 [INFO] - Final model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\cal_aware_mutual_model.pth
2025-04-03 12:12:20,986 [INFO] - RECOVERY completed successfully. Your models have been saved.
2025-04-03 12:16:25,010 [INFO] - Configuration: <__main__.Config object at 0x00000261A39AE0F0>
2025-04-03 12:16:25,010 [INFO] - Preparing data loaders...
2025-04-03 12:16:25,016 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 12:16:25,017 [INFO] - EMERGENCY RECOVERY: Loading models from their final checkpoints...
2025-04-03 12:16:25,835 [INFO] - Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-04-03 12:16:26,203 [INFO] - [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-03 12:16:26,800 [INFO] - Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-04-03 12:16:28,330 [INFO] - Created base model for vit
2025-04-03 12:16:28,330 [INFO] - Loading specific checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 12:16:29,210 [INFO] - Successfully loaded final checkpoint for vit
2025-04-03 12:16:29,231 [INFO] - Created base model for efficientnet
2025-04-03 12:16:29,231 [INFO] - Loading specific checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 12:16:29,550 [INFO] - Successfully loaded final checkpoint for efficientnet
2025-04-03 12:16:29,599 [INFO] - Created base model for inception
2025-04-03 12:16:29,601 [INFO] - Loading specific checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 12:16:29,913 [INFO] - Successfully loaded final checkpoint for inception
2025-04-03 12:16:29,925 [INFO] - Created base model for mobilenet
2025-04-03 12:16:29,927 [INFO] - Loading specific checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 12:16:30,121 [INFO] - Successfully loaded final checkpoint for mobilenet
2025-04-03 12:16:30,170 [INFO] - Created base model for resnet
2025-04-03 12:16:30,170 [INFO] - Loading specific checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 12:16:30,495 [INFO] - Successfully loaded final checkpoint for resnet
2025-04-03 12:16:30,543 [INFO] - Created base model for densenet
2025-04-03 12:16:30,544 [INFO] - Loading specific checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 12:16:30,856 [INFO] - Successfully loaded final checkpoint for densenet
2025-04-03 12:16:30,880 [INFO] - Created base model for student
2025-04-03 12:16:30,880 [INFO] - Loading specific checkpoint for student: student_20250330_014216_best.pth
2025-04-03 12:16:31,106 [INFO] - Successfully loaded final checkpoint for student
2025-04-03 12:16:31,106 [INFO] - Model vit is ready for evaluation
2025-04-03 12:16:31,110 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 12:16:31,112 [INFO] - Model inception is ready for evaluation
2025-04-03 12:16:31,113 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 12:16:31,113 [INFO] - Model resnet is ready for evaluation
2025-04-03 12:16:31,113 [INFO] - Model densenet is ready for evaluation
2025-04-03 12:16:31,113 [INFO] - Model student is ready for evaluation
2025-04-03 12:16:31,113 [INFO] - Model recovery completed with specified checkpoints.
2025-04-03 12:16:31,121 [INFO] - Plotting calibration curves...
2025-04-03 12:16:31,122 [INFO] - Plotting teacher calibration curves (dummy implementation).
2025-04-03 12:16:31,220 [INFO] - Evaluating all models with detailed metrics...
2025-04-03 12:16:31,220 [INFO] - 
=== Evaluating VIT model ===
2025-04-03 12:16:31,237 [ERROR] - An error occurred: 'Config' object has no attribute 'use_amp'
2025-04-03 12:16:31,238 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\982163255.py", line 213, in main
    all_metrics[name] = evaluate_with_detailed_report(model, test_loader, config)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_6856\982163255.py", line 103, in evaluate_with_detailed_report
    with autocast(device_type='cuda' if torch.cuda.is_available() else 'cpu', enabled=config.use_amp):
                                                                                      ^^^^^^^^^^^^^^
AttributeError: 'Config' object has no attribute 'use_amp'

2025-04-03 12:20:38,762 [INFO] - Configuration: <__main__.Config object at 0x00000261B26B70B0>
2025-04-03 12:20:38,764 [INFO] - Preparing data loaders...
2025-04-03 12:20:38,766 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 12:20:38,766 [INFO] - EMERGENCY RECOVERY: Loading models from best checkpoints...
2025-04-03 12:20:39,660 [INFO] - Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-04-03 12:20:40,050 [INFO] - [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-03 12:20:40,640 [INFO] - Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-04-03 12:20:42,255 [INFO] - Created base model for vit
2025-04-03 12:20:42,273 [INFO] - Created base model for efficientnet
2025-04-03 12:20:42,308 [INFO] - Created base model for inception
2025-04-03 12:20:42,321 [INFO] - Created base model for mobilenet
2025-04-03 12:20:42,343 [INFO] - Created base model for resnet
2025-04-03 12:20:42,373 [INFO] - Created base model for densenet
2025-04-03 12:20:42,390 [INFO] - Created base model for student
2025-04-03 12:20:42,391 [INFO] - Found checkpoint for vit: vit_init_best_5.pth
2025-04-03 12:20:42,494 [INFO] - Successfully loaded checkpoint for vit
2025-04-03 12:20:42,495 [INFO] - Found checkpoint for efficientnet: efficientnet_init_best_5.pth
2025-04-03 12:20:42,603 [INFO] - Successfully loaded checkpoint for efficientnet
2025-04-03 12:20:42,604 [INFO] - Found checkpoint for inception: inception_init_best_5.pth
2025-04-03 12:20:42,707 [INFO] - Successfully loaded checkpoint for inception
2025-04-03 12:20:42,707 [INFO] - Found checkpoint for mobilenet: mobilenet_init_best_5.pth
2025-04-03 12:20:42,803 [INFO] - Successfully loaded checkpoint for mobilenet
2025-04-03 12:20:42,804 [INFO] - Found checkpoint for resnet: resnet_init_best_5.pth
2025-04-03 12:20:42,900 [INFO] - Successfully loaded checkpoint for resnet
2025-04-03 12:20:42,901 [INFO] - Found checkpoint for densenet: densenet_init_best_5.pth
2025-04-03 12:20:42,998 [INFO] - Successfully loaded checkpoint for densenet
2025-04-03 12:20:42,998 [INFO] - Found checkpoint for student: student_init_best_4.pth
2025-04-03 12:20:43,102 [INFO] - Successfully loaded checkpoint for student
2025-04-03 12:20:43,103 [INFO] - Model vit is ready for evaluation
2025-04-03 12:20:43,106 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 12:20:43,106 [INFO] - Model inception is ready for evaluation
2025-04-03 12:20:43,108 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 12:20:43,110 [INFO] - Model resnet is ready for evaluation
2025-04-03 12:20:43,110 [INFO] - Model densenet is ready for evaluation
2025-04-03 12:20:43,110 [INFO] - Model student is ready for evaluation
2025-04-03 12:20:43,110 [INFO] - Model recovery completed.
2025-04-03 12:20:43,115 [INFO] - Plotting calibration curves...
2025-04-03 12:20:43,116 [INFO] - Plotting teacher calibration curves (dummy implementation).
2025-04-03 12:20:43,221 [INFO] - Evaluating final student model...
2025-04-03 12:20:43,221 [INFO] - Evaluating student model (dummy evaluation).
2025-04-03 12:20:43,221 [INFO] - Exporting final student model...
2025-04-03 12:20:43,280 [INFO] - Final model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\cal_aware_mutual_model.pth
2025-04-03 12:20:43,280 [INFO] - RECOVERY completed successfully. Your models have been saved.
2025-04-03 12:22:25,881 [INFO] - Using device: cuda
2025-04-03 12:22:25,890 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-03 12:22:25,890 [INFO] - GPU Memory: 6.00 GB
2025-04-03 12:22:25,890 [INFO] - CUDA Version: 12.4
2025-04-03 12:22:25,892 [INFO] - cuDNN benchmark mode enabled
2025-04-03 12:23:33,372 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 12:23:33,810 [INFO] - Random seed set to 42
2025-04-03 12:23:33,810 [INFO] - Preparing data loaders...
2025-04-03 12:23:35,748 [INFO] - Training samples: 45000
2025-04-03 12:23:35,749 [INFO] - Validation samples: 5000
2025-04-03 12:23:35,749 [INFO] - Test samples: 10000
2025-04-03 12:23:35,750 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 12:23:35,751 [INFO] - EMERGENCY RECOVERY: Loading models from best checkpoints...
2025-04-03 12:23:36,620 [INFO] - Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-04-03 12:23:36,899 [INFO] - [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-03 12:23:36,959 [INFO] - Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-04-03 12:23:38,717 [INFO] - Created base model for vit
2025-04-03 12:23:38,789 [INFO] - Created base model for efficientnet
2025-04-03 12:23:38,837 [INFO] - Created base model for inception
2025-04-03 12:23:38,851 [INFO] - Created base model for mobilenet
2025-04-03 12:23:38,872 [INFO] - Created base model for resnet
2025-04-03 12:23:38,916 [INFO] - Created base model for densenet
2025-04-03 12:23:38,933 [INFO] - Created base model for student
2025-04-03 12:23:38,934 [INFO] - Found checkpoint for vit: vit_init_best_5.pth
2025-04-03 12:23:39,010 [INFO] - Successfully loaded checkpoint for vit
2025-04-03 12:23:39,010 [INFO] - Found checkpoint for efficientnet: efficientnet_init_best_5.pth
2025-04-03 12:23:39,085 [INFO] - Successfully loaded checkpoint for efficientnet
2025-04-03 12:23:39,086 [INFO] - Found checkpoint for inception: inception_init_best_5.pth
2025-04-03 12:23:39,150 [INFO] - Successfully loaded checkpoint for inception
2025-04-03 12:23:39,150 [INFO] - Found checkpoint for mobilenet: mobilenet_init_best_5.pth
2025-04-03 12:23:39,205 [INFO] - Successfully loaded checkpoint for mobilenet
2025-04-03 12:23:39,210 [INFO] - Found checkpoint for resnet: resnet_init_best_5.pth
2025-04-03 12:23:39,266 [INFO] - Successfully loaded checkpoint for resnet
2025-04-03 12:23:39,267 [INFO] - Found checkpoint for densenet: densenet_init_best_5.pth
2025-04-03 12:23:39,324 [INFO] - Successfully loaded checkpoint for densenet
2025-04-03 12:23:39,328 [INFO] - Found checkpoint for student: student_init_best_4.pth
2025-04-03 12:23:39,398 [INFO] - Successfully loaded checkpoint for student
2025-04-03 12:23:39,399 [INFO] - Model vit is ready for evaluation
2025-04-03 12:23:39,400 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 12:23:39,400 [INFO] - Model inception is ready for evaluation
2025-04-03 12:23:39,400 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 12:23:39,406 [INFO] - Model resnet is ready for evaluation
2025-04-03 12:23:39,407 [INFO] - Model densenet is ready for evaluation
2025-04-03 12:23:39,409 [INFO] - Model student is ready for evaluation
2025-04-03 12:23:39,410 [INFO] - Model recovery completed.
2025-04-03 12:23:39,411 [INFO] - Plotting calibration curves...
2025-04-03 12:25:04,606 [INFO] - Teacher calibration curves saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\teacher_calibration_curves.png
2025-04-03 12:25:04,607 [INFO] - Evaluating final student model...
2025-04-03 12:25:04,607 [INFO] - Evaluating student model...
2025-04-03 12:25:10,047 [INFO] - Test Results:
2025-04-03 12:25:10,047 [INFO] - Loss: 0.1143
2025-04-03 12:25:10,049 [INFO] - Accuracy: 96.46%
2025-04-03 12:25:10,050 [INFO] - F1 Score: 0.9646
2025-04-03 12:25:10,050 [INFO] - Precision: 0.9648
2025-04-03 12:25:10,051 [INFO] - Recall: 0.9646
2025-04-03 12:25:10,052 [INFO] - ECE: 0.0094
2025-04-03 12:25:10,053 [INFO] - Exporting final student model...
2025-04-03 12:25:10,113 [INFO] - Final model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\cal_aware_mutual_model.pth
2025-04-03 12:25:10,114 [INFO] - RECOVERY completed successfully. Your models have been saved.
2025-04-03 12:26:34,701 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "find_batch_size": false,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-03 12:26:34,703 [INFO] - Random seed set to 42
2025-04-03 12:26:34,704 [INFO] - Preparing data loaders...
2025-04-03 12:26:36,345 [INFO] - Training samples: 45000
2025-04-03 12:26:36,347 [INFO] - Validation samples: 5000
2025-04-03 12:26:36,347 [INFO] - Test samples: 10000
2025-04-03 12:26:36,347 [INFO] - Entering RECOVERY MODE to skip training
2025-04-03 12:26:36,349 [INFO] - EMERGENCY RECOVERY: Loading models from best checkpoints...
2025-04-03 12:26:37,203 [INFO] - Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-04-03 12:26:37,633 [INFO] - [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-03 12:26:38,216 [INFO] - Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-04-03 12:26:39,634 [INFO] - Created base model for vit
2025-04-03 12:26:39,682 [INFO] - Created base model for efficientnet
2025-04-03 12:26:39,794 [INFO] - Created base model for inception
2025-04-03 12:26:39,814 [INFO] - Created base model for mobilenet
2025-04-03 12:26:39,884 [INFO] - Created base model for resnet
2025-04-03 12:26:39,932 [INFO] - Created base model for densenet
2025-04-03 12:26:39,959 [INFO] - Created base model for student
2025-04-03 12:26:39,959 [INFO] - Loading specified checkpoint for densenet: densenet_20250330_014216_best.pth
2025-04-03 12:26:40,307 [INFO] - Successfully loaded checkpoint for densenet
2025-04-03 12:26:40,307 [INFO] - Loading specified checkpoint for resnet: resnet_20250330_014216_best.pth
2025-04-03 12:26:40,629 [INFO] - Successfully loaded checkpoint for resnet
2025-04-03 12:26:40,638 [INFO] - Loading specified checkpoint for inception: inception_20250330_014216_best.pth
2025-04-03 12:26:40,987 [INFO] - Successfully loaded checkpoint for inception
2025-04-03 12:26:40,987 [INFO] - Loading specified checkpoint for mobilenet: mobilenet_20250330_014216_best.pth
2025-04-03 12:26:41,207 [INFO] - Successfully loaded checkpoint for mobilenet
2025-04-03 12:26:41,208 [INFO] - Loading specified checkpoint for efficientnet: efficientnet_20250330_014216_best.pth
2025-04-03 12:26:41,432 [INFO] - Successfully loaded checkpoint for efficientnet
2025-04-03 12:26:41,432 [INFO] - Loading specified checkpoint for vit: vit_20250330_014216_best.pth
2025-04-03 12:26:42,418 [INFO] - Successfully loaded checkpoint for vit
2025-04-03 12:26:42,419 [INFO] - Loading specified checkpoint for student: student_20250330_014216_best.pth
2025-04-03 12:26:42,684 [INFO] - Successfully loaded checkpoint for student
2025-04-03 12:26:42,684 [INFO] - Model vit is ready for evaluation
2025-04-03 12:26:42,684 [INFO] - Model efficientnet is ready for evaluation
2025-04-03 12:26:42,689 [INFO] - Model inception is ready for evaluation
2025-04-03 12:26:42,689 [INFO] - Model mobilenet is ready for evaluation
2025-04-03 12:26:42,689 [INFO] - Model resnet is ready for evaluation
2025-04-03 12:26:42,689 [INFO] - Model densenet is ready for evaluation
2025-04-03 12:26:42,689 [INFO] - Model student is ready for evaluation
2025-04-03 12:26:42,689 [INFO] - Model recovery completed.
2025-04-03 12:26:42,700 [INFO] - Plotting calibration curves...
2025-04-03 12:28:02,800 [INFO] - Teacher calibration curves saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\teacher_calibration_curves.png
2025-04-03 12:28:02,801 [INFO] - Evaluating final student model...
2025-04-03 12:28:02,802 [INFO] - Evaluating student model...
2025-04-03 12:28:08,279 [INFO] - Test Results:
2025-04-03 12:28:08,279 [INFO] - Loss: 0.1551
2025-04-03 12:28:08,280 [INFO] - Accuracy: 96.87%
2025-04-03 12:28:08,281 [INFO] - F1 Score: 0.9686
2025-04-03 12:28:08,281 [INFO] - Precision: 0.9689
2025-04-03 12:28:08,282 [INFO] - Recall: 0.9687
2025-04-03 12:28:08,282 [INFO] - ECE: 0.0501
2025-04-03 12:28:08,284 [INFO] - Exporting final student model...
2025-04-03 12:28:08,341 [INFO] - Final model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\cal_aware_mutual_model.pth
2025-04-03 12:28:08,341 [INFO] - RECOVERY completed successfully. Your models have been saved.
2025-04-27 19:20:00,044 [INFO] - Using device: cuda
2025-04-27 19:20:00,060 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-27 19:20:00,060 [INFO] - GPU Memory: 6.00 GB
2025-04-27 19:20:00,060 [INFO] - CUDA Version: 12.4
2025-04-27 19:20:00,144 [INFO] - cuDNN benchmark mode enabled
2025-04-27 19:20:00,153 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-27 19:20:00,219 [INFO] - Random seed set to 42
2025-04-27 19:20:00,225 [INFO] - Preparing data loaders...
2025-04-27 19:20:11,826 [INFO] - Training samples: 45000 per model
2025-04-27 19:20:11,826 [INFO] - Validation samples: 5000 per model
2025-04-27 19:20:11,826 [INFO] - Test samples: 10000 per model
2025-04-27 19:20:11,826 [INFO] - Creating models for mutual learning...
2025-04-27 19:20:11,826 [INFO] - Loading ViT-B16 model...
2025-04-27 19:20:12,805 [INFO] - Loading EfficientNetB0 model...
2025-04-27 19:20:12,935 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-27 19:20:13,336 [INFO] - Loading MobileNetV3 model...
2025-04-27 19:20:13,449 [INFO] - Loading ResNet50 model...
2025-04-27 19:20:13,837 [INFO] - Loading DenseNet121 model...
2025-04-27 19:20:13,971 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-27 19:20:14,340 [INFO] - Model vit moved to cuda
2025-04-27 19:20:14,367 [INFO] - Model efficientnet moved to cuda
2025-04-27 19:20:14,413 [INFO] - Model inception moved to cuda
2025-04-27 19:20:14,439 [INFO] - Model mobilenet moved to cuda
2025-04-27 19:20:14,475 [INFO] - Model resnet moved to cuda
2025-04-27 19:20:14,512 [INFO] - Model densenet moved to cuda
2025-04-27 19:20:14,532 [INFO] - Model student moved to cuda
2025-04-27 19:20:14,535 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-27 19:20:14,536 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-27 19:20:14,538 [INFO] - Model inception: 25.13M parameters (25.13M trainable)
2025-04-27 19:20:14,540 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-27 19:20:14,541 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-27 19:20:14,541 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-27 19:20:14,546 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-27 19:20:14,546 [INFO] - Starting initialization phase...
2025-04-27 19:20:14,552 [INFO] - Initialization Epoch 1/5
2025-04-27 19:20:14,709 [INFO] - GPU cache cleared: 595.11MB → 595.11MB (freed 0.00MB)
2025-04-27 19:20:14,716 [ERROR] - An error occurred: too many values to unpack (expected 2)
2025-04-27 19:20:14,716 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_2596\3847419200.py", line 2597, in main
    models = initialization_phase(models, train_loader, val_loader, config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_2596\3847419200.py", line 1670, in initialization_phase
    for batch_idx, (inputs, targets) in enumerate(pbar):
                   ^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-04-27 19:32:08,870 [INFO] - Using device: cuda
2025-04-27 19:32:08,870 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-27 19:32:08,870 [INFO] - GPU Memory: 6.00 GB
2025-04-27 19:32:08,875 [INFO] - CUDA Version: 12.4
2025-04-27 19:32:08,876 [INFO] - cuDNN benchmark mode enabled
2025-04-27 19:32:08,895 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 15,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-27 19:32:08,896 [INFO] - Random seed set to 42
2025-04-27 19:32:08,896 [INFO] - Preparing data loaders...
2025-04-27 19:32:19,778 [INFO] - Training samples: 45000 per model
2025-04-27 19:32:19,778 [INFO] - Validation samples: 5000 per model
2025-04-27 19:32:19,778 [INFO] - Test samples: 10000 per model
2025-04-27 19:32:19,778 [INFO] - Creating models for mutual learning...
2025-04-27 19:32:19,778 [INFO] - Loading ViT-B16 model...
2025-04-27 19:32:20,500 [INFO] - Loading EfficientNetB0 model...
2025-04-27 19:32:20,632 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-27 19:32:20,842 [INFO] - Loading MobileNetV3 model...
2025-04-27 19:32:20,950 [INFO] - Loading ResNet50 model...
2025-04-27 19:32:21,272 [INFO] - Loading DenseNet121 model...
2025-04-27 19:32:21,555 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-27 19:32:21,895 [INFO] - Model vit moved to cuda
2025-04-27 19:32:21,917 [INFO] - Model efficientnet moved to cuda
2025-04-27 19:32:21,953 [INFO] - Model inception moved to cuda
2025-04-27 19:32:21,967 [INFO] - Model mobilenet moved to cuda
2025-04-27 19:32:21,990 [INFO] - Model resnet moved to cuda
2025-04-27 19:32:22,019 [INFO] - Model densenet moved to cuda
2025-04-27 19:32:22,034 [INFO] - Model student moved to cuda
2025-04-27 19:32:22,034 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-27 19:32:22,034 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-27 19:32:22,042 [INFO] - Model inception: 25.13M parameters (25.13M trainable)
2025-04-27 19:32:22,042 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-27 19:32:22,042 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-27 19:32:22,046 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-27 19:32:22,048 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-27 19:32:22,049 [INFO] - Starting initialization phase...
2025-04-27 19:32:22,055 [INFO] - Initialization Epoch 1/5
2025-04-27 19:32:22,202 [INFO] - GPU cache cleared: 595.11MB → 595.11MB (freed 0.00MB)
2025-04-27 19:32:22,216 [ERROR] - An error occurred: 'str' object has no attribute 'to'
2025-04-27 19:32:22,216 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_2596\3728347462.py", line 2599, in main
    models = initialization_phase(models, train_loader, val_loader, config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_2596\3728347462.py", line 1673, in initialization_phase
    inputs, targets = inputs.to(device), targets.to(device)
                      ^^^^^^^^^
AttributeError: 'str' object has no attribute 'to'

2025-04-27 19:34:40,958 [INFO] - Using device: cuda
2025-04-27 19:34:40,959 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-27 19:34:40,959 [INFO] - GPU Memory: 6.00 GB
2025-04-27 19:34:40,959 [INFO] - CUDA Version: 12.4
2025-04-27 19:34:40,959 [INFO] - cuDNN benchmark mode enabled
2025-04-27 19:34:40,976 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-27 19:34:40,979 [INFO] - Random seed set to 42
2025-04-27 19:34:40,979 [INFO] - Preparing data loaders...
2025-04-27 19:34:51,820 [INFO] - Training samples: 45000 per model
2025-04-27 19:34:51,820 [INFO] - Validation samples: 5000 per model
2025-04-27 19:34:51,825 [INFO] - Test samples: 10000 per model
2025-04-27 19:34:51,825 [INFO] - Creating models for mutual learning...
2025-04-27 19:34:51,825 [INFO] - Loading ViT-B16 model...
2025-04-27 19:34:52,502 [INFO] - Loading EfficientNetB0 model...
2025-04-27 19:34:52,620 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-27 19:34:52,811 [INFO] - Loading MobileNetV3 model...
2025-04-27 19:34:52,931 [INFO] - Loading ResNet50 model...
2025-04-27 19:34:53,230 [INFO] - Loading DenseNet121 model...
2025-04-27 19:34:53,560 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-27 19:34:53,859 [INFO] - Model vit moved to cuda
2025-04-27 19:34:53,876 [INFO] - Model efficientnet moved to cuda
2025-04-27 19:34:53,917 [INFO] - Model inception moved to cuda
2025-04-27 19:34:53,932 [INFO] - Model mobilenet moved to cuda
2025-04-27 19:34:53,953 [INFO] - Model resnet moved to cuda
2025-04-27 19:34:53,985 [INFO] - Model densenet moved to cuda
2025-04-27 19:34:53,999 [INFO] - Model student moved to cuda
2025-04-27 19:34:53,999 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-27 19:34:54,005 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-27 19:34:54,007 [INFO] - Model inception: 25.13M parameters (25.13M trainable)
2025-04-27 19:34:54,009 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-27 19:34:54,009 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-27 19:34:54,012 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-27 19:34:54,014 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-27 19:34:54,015 [INFO] - Starting initialization phase...
2025-04-27 19:34:54,021 [INFO] - Initialization Epoch 1/5
2025-04-27 19:34:54,177 [INFO] - GPU cache cleared: 595.11MB → 595.11MB (freed 0.00MB)
2025-04-27 19:34:54,185 [ERROR] - An error occurred: 'str' object has no attribute 'to'
2025-04-27 19:34:54,185 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_2596\2132720273.py", line 2611, in main
    models = initialization_phase(models, train_loader, val_loader, config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_2596\2132720273.py", line 1685, in initialization_phase
    inputs, targets = inputs.to(device), targets.to(device)
                      ^^^^^^^^^
AttributeError: 'str' object has no attribute 'to'

2025-04-27 19:37:40,193 [INFO] - Using device: cuda
2025-04-27 19:37:40,193 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-27 19:37:40,194 [INFO] - GPU Memory: 6.00 GB
2025-04-27 19:37:40,195 [INFO] - CUDA Version: 12.4
2025-04-27 19:37:40,195 [INFO] - cuDNN benchmark mode enabled
2025-04-27 19:37:40,212 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-27 19:37:40,214 [INFO] - Random seed set to 42
2025-04-27 19:37:40,215 [INFO] - Preparing data loaders...
2025-04-27 19:37:50,948 [INFO] - Training samples: 45000 per model
2025-04-27 19:37:50,949 [INFO] - Validation samples: 5000 per model
2025-04-27 19:37:50,950 [INFO] - Test samples: 10000 per model
2025-04-27 19:37:50,950 [INFO] - Creating models for mutual learning...
2025-04-27 19:37:50,951 [INFO] - Loading ViT-B16 model...
2025-04-27 19:37:51,601 [INFO] - Loading EfficientNetB0 model...
2025-04-27 19:37:51,716 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-27 19:37:51,905 [INFO] - Loading MobileNetV3 model...
2025-04-27 19:37:51,994 [INFO] - Loading ResNet50 model...
2025-04-27 19:37:52,258 [INFO] - Loading DenseNet121 model...
2025-04-27 19:37:52,377 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-27 19:37:52,877 [INFO] - Model vit moved to cuda
2025-04-27 19:37:52,918 [INFO] - Model efficientnet moved to cuda
2025-04-27 19:37:53,023 [INFO] - Model inception moved to cuda
2025-04-27 19:37:53,053 [INFO] - Model mobilenet moved to cuda
2025-04-27 19:37:53,118 [INFO] - Model resnet moved to cuda
2025-04-27 19:37:53,177 [INFO] - Model densenet moved to cuda
2025-04-27 19:37:53,204 [INFO] - Model student moved to cuda
2025-04-27 19:37:53,204 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-27 19:37:53,204 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-27 19:37:53,210 [INFO] - Model inception: 25.13M parameters (25.13M trainable)
2025-04-27 19:37:53,212 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-27 19:37:53,213 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-27 19:37:53,215 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-27 19:37:53,217 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-27 19:37:53,218 [INFO] - Starting initialization phase...
2025-04-27 19:37:53,224 [INFO] - Initialization Epoch 1/5
2025-04-27 19:37:53,378 [INFO] - GPU cache cleared: 595.11MB → 595.11MB (freed 0.00MB)
2025-04-27 19:37:53,384 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:37:53,384 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:37:53,384 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:37:53,384 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:37:53,384 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:37:53,391 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:37:53,391 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:37:53,402 [ERROR] - An error occurred: too many values to unpack (expected 2)
2025-04-27 19:37:53,403 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_2596\3299400427.py", line 2615, in main
    models = initialization_phase(models, train_loader, val_loader, config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_2596\3299400427.py", line 1761, in initialization_phase
    for inputs, targets in tqdm(val_loader, desc="Validation"):
        ^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-04-27 19:39:20,703 [INFO] - Using device: cuda
2025-04-27 19:39:20,703 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-27 19:39:20,703 [INFO] - GPU Memory: 6.00 GB
2025-04-27 19:39:20,703 [INFO] - CUDA Version: 12.4
2025-04-27 19:39:20,703 [INFO] - cuDNN benchmark mode enabled
2025-04-27 19:39:20,723 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-27 19:39:20,726 [INFO] - Random seed set to 42
2025-04-27 19:39:20,726 [INFO] - Preparing data loaders...
2025-04-27 19:39:31,448 [INFO] - Training samples: 45000 per model
2025-04-27 19:39:31,448 [INFO] - Validation samples: 5000 per model
2025-04-27 19:39:31,448 [INFO] - Test samples: 10000 per model
2025-04-27 19:39:31,448 [INFO] - Creating models for mutual learning...
2025-04-27 19:39:31,448 [INFO] - Loading ViT-B16 model...
2025-04-27 19:39:32,124 [INFO] - Loading EfficientNetB0 model...
2025-04-27 19:39:32,232 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-27 19:39:32,434 [INFO] - Loading MobileNetV3 model...
2025-04-27 19:39:32,537 [INFO] - Loading ResNet50 model...
2025-04-27 19:39:32,799 [INFO] - Loading DenseNet121 model...
2025-04-27 19:39:32,932 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-27 19:39:33,375 [INFO] - Model vit moved to cuda
2025-04-27 19:39:33,392 [INFO] - Model efficientnet moved to cuda
2025-04-27 19:39:33,428 [INFO] - Model inception moved to cuda
2025-04-27 19:39:33,438 [INFO] - Model mobilenet moved to cuda
2025-04-27 19:39:33,464 [INFO] - Model resnet moved to cuda
2025-04-27 19:39:33,495 [INFO] - Model densenet moved to cuda
2025-04-27 19:39:33,512 [INFO] - Model student moved to cuda
2025-04-27 19:39:33,512 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-27 19:39:33,514 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-27 19:39:33,517 [INFO] - Model inception: 25.13M parameters (25.13M trainable)
2025-04-27 19:39:33,517 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-27 19:39:33,517 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-27 19:39:33,521 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-27 19:39:33,523 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-27 19:39:33,524 [INFO] - Starting initialization phase...
2025-04-27 19:39:33,530 [INFO] - Initialization Epoch 1/5
2025-04-27 19:39:33,688 [INFO] - GPU cache cleared: 595.11MB → 595.11MB (freed 0.00MB)
2025-04-27 19:39:33,698 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:39:33,699 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:39:33,700 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:39:33,700 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:39:33,701 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:39:33,701 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:39:33,701 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:39:33,713 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:39:33,713 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:39:33,714 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:39:33,714 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:39:33,715 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:39:33,716 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:39:33,716 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:39:33,718 [ERROR] - An error occurred: float division by zero
2025-04-27 19:39:33,718 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_2596\1945760449.py", line 2629, in main
    models = initialization_phase(models, train_loader, val_loader, config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_2596\1945760449.py", line 1799, in initialization_phase
    train_acc = 100. * train_correct[name] / train_total[name]
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-04-27 19:41:43,917 [INFO] - Using device: cuda
2025-04-27 19:41:43,918 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-27 19:41:43,918 [INFO] - GPU Memory: 6.00 GB
2025-04-27 19:41:43,918 [INFO] - CUDA Version: 12.4
2025-04-27 19:41:43,918 [INFO] - cuDNN benchmark mode enabled
2025-04-27 19:41:43,937 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-27 19:41:43,940 [INFO] - Random seed set to 42
2025-04-27 19:41:43,941 [INFO] - Preparing data loaders...
2025-04-27 19:41:54,759 [INFO] - Training samples: 45000 per model
2025-04-27 19:41:54,759 [INFO] - Validation samples: 5000 per model
2025-04-27 19:41:54,759 [INFO] - Test samples: 10000 per model
2025-04-27 19:41:54,759 [INFO] - Creating models for mutual learning...
2025-04-27 19:41:54,759 [INFO] - Loading ViT-B16 model...
2025-04-27 19:41:55,420 [INFO] - Loading EfficientNetB0 model...
2025-04-27 19:41:55,508 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-27 19:41:55,710 [INFO] - Loading MobileNetV3 model...
2025-04-27 19:41:55,800 [INFO] - Loading ResNet50 model...
2025-04-27 19:41:56,082 [INFO] - Loading DenseNet121 model...
2025-04-27 19:41:56,363 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-27 19:41:56,723 [INFO] - Model vit moved to cuda
2025-04-27 19:41:56,739 [INFO] - Model efficientnet moved to cuda
2025-04-27 19:41:56,775 [INFO] - Model inception moved to cuda
2025-04-27 19:41:56,776 [INFO] - Model mobilenet moved to cuda
2025-04-27 19:41:56,813 [INFO] - Model resnet moved to cuda
2025-04-27 19:41:56,842 [INFO] - Model densenet moved to cuda
2025-04-27 19:41:56,859 [INFO] - Model student moved to cuda
2025-04-27 19:41:56,861 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-27 19:41:56,863 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-27 19:41:56,865 [INFO] - Model inception: 25.13M parameters (25.13M trainable)
2025-04-27 19:41:56,866 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-27 19:41:56,867 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-27 19:41:56,867 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-27 19:41:56,867 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-27 19:41:56,873 [INFO] - Starting initialization phase...
2025-04-27 19:41:56,879 [INFO] - Initialization Epoch 1/5
2025-04-27 19:41:57,030 [INFO] - GPU cache cleared: 595.11MB → 595.11MB (freed 0.00MB)
2025-04-27 19:41:57,030 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,030 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,030 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,030 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,045 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,045 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,046 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,057 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,057 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,057 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,057 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,057 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,057 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,057 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,061 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,065 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,068 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,069 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,069 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,069 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,069 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,069 [INFO] - Initialization epoch 1 completed in 0.19s
2025-04-27 19:41:57,075 [INFO] - Initialization Epoch 2/5
2025-04-27 19:41:57,222 [INFO] - GPU cache cleared: 595.11MB → 595.11MB (freed 0.00MB)
2025-04-27 19:41:57,236 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,236 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,238 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,239 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,239 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,239 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,240 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,250 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,251 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,252 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,252 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,253 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,253 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,254 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,255 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,255 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,256 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,258 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,259 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,261 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,262 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,263 [INFO] - Initialization epoch 2 completed in 0.19s
2025-04-27 19:41:57,264 [INFO] - Initialization Epoch 3/5
2025-04-27 19:41:57,419 [INFO] - GPU cache cleared: 595.11MB → 595.11MB (freed 0.00MB)
2025-04-27 19:41:57,430 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,430 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,431 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,432 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,432 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,432 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,432 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,444 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,445 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,445 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,445 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,445 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,445 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,445 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,445 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,450 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,451 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,453 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,453 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,453 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,453 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,457 [INFO] - Initialization epoch 3 completed in 0.19s
2025-04-27 19:41:57,458 [INFO] - Initialization Epoch 4/5
2025-04-27 19:41:57,611 [INFO] - GPU cache cleared: 595.11MB → 595.11MB (freed 0.00MB)
2025-04-27 19:41:57,619 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,619 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,619 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,619 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,623 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,623 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,624 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,634 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,634 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,634 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,634 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,637 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,638 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,638 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,640 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,641 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,642 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,643 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,644 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,645 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,646 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,647 [INFO] - Initialization epoch 4 completed in 0.19s
2025-04-27 19:41:57,647 [INFO] - Initialization Epoch 5/5
2025-04-27 19:41:57,801 [INFO] - GPU cache cleared: 595.11MB → 595.11MB (freed 0.00MB)
2025-04-27 19:41:57,813 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,813 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,813 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,813 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,816 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,816 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,817 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,827 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,827 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,827 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,827 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,827 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,827 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,827 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:41:57,833 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,833 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,835 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,835 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,835 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,839 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,840 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:41:57,841 [INFO] - Initialization epoch 5 completed in 0.19s
2025-04-27 19:41:57,841 [INFO] - Initialization phase completed
2025-04-27 19:41:57,843 [INFO] - Starting mutual learning phase...
2025-04-27 19:41:57,843 [INFO] - Hook registered for encoder.ln
2025-04-27 19:41:57,843 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-04-27 19:41:58,343 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-04-27 19:41:58,344 [INFO] - Hook registered for features.8
2025-04-27 19:41:58,344 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-04-27 19:41:58,694 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-04-27 19:41:58,696 [INFO] - Hook registered for inception.Mixed_7c
2025-04-27 19:41:58,696 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-04-27 19:41:59,147 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-04-27 19:41:59,147 [INFO] - Hook registered for features
2025-04-27 19:41:59,148 [INFO] - Feature extractor registered for mobilenet at layer features
2025-04-27 19:41:59,300 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-04-27 19:41:59,300 [INFO] - Hook registered for layer4
2025-04-27 19:41:59,300 [INFO] - Feature extractor registered for resnet at layer layer4
2025-04-27 19:41:59,557 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-04-27 19:41:59,557 [INFO] - Hook registered for features
2025-04-27 19:41:59,557 [INFO] - Feature extractor registered for densenet at layer features
2025-04-27 19:41:59,856 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-04-27 19:41:59,856 [INFO] - Hook registered for features.8
2025-04-27 19:41:59,856 [INFO] - Feature extractor registered for student at layer features.8
2025-04-27 19:41:59,872 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-04-27 19:42:00,227 [INFO] - HFI module initialized with 6 teachers
2025-04-27 19:42:00,227 [INFO] - Target student feature shape: torch.Size([1, 1280, 7, 7])
2025-04-27 19:42:00,272 [INFO] - Using learning rate 5e-05 for vit
2025-04-27 19:42:00,273 [INFO] - Using 16 gradient accumulation steps for ViT
2025-04-27 19:42:00,274 [INFO] - Using learning rate 0.001 for efficientnet
2025-04-27 19:42:00,276 [INFO] - Using learning rate 0.001 for inception
2025-04-27 19:42:00,277 [INFO] - Using learning rate 0.001 for mobilenet
2025-04-27 19:42:00,278 [INFO] - Using learning rate 0.001 for resnet
2025-04-27 19:42:00,280 [INFO] - Using learning rate 0.001 for densenet
2025-04-27 19:42:00,281 [INFO] - Using learning rate 0.001 for student
2025-04-27 19:42:00,284 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250427_194200_config.json
2025-04-27 19:42:00,284 [INFO] - Mutual Learning Epoch 1/50
2025-04-27 19:42:00,285 [INFO] - Mutual weight: 0.0200, Calibration weight: 0.0067, Feature weight: 0.0033
2025-04-27 19:42:00,299 [INFO] - Current temperatures: {'vit': 4.118149757385254, 'efficientnet': 4.118149757385254, 'inception': 5.106715202331543, 'mobilenet': 4.118149757385254, 'resnet': 4.118149757385254, 'densenet': 4.118149757385254, 'student': 3.148587226867676}
2025-04-27 19:42:00,485 [INFO] - GPU cache cleared: 641.82MB → 641.82MB (freed 0.00MB)
2025-04-27 19:42:00,493 [ERROR] - An error occurred: too many values to unpack (expected 2)
2025-04-27 19:42:00,493 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_2596\2811154748.py", line 2631, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_2596\2811154748.py", line 1998, in mutual_learning_phase
    for batch_idx, (inputs, targets) in enumerate(pbar):
                   ^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)

2025-04-27 19:47:28,925 [INFO] - Using device: cuda
2025-04-27 19:47:28,925 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-27 19:47:28,925 [INFO] - GPU Memory: 6.00 GB
2025-04-27 19:47:28,925 [INFO] - CUDA Version: 12.4
2025-04-27 19:47:28,925 [INFO] - cuDNN benchmark mode enabled
2025-04-27 19:47:28,944 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": true,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-27 19:47:28,944 [INFO] - Random seed set to 42
2025-04-27 19:47:28,947 [INFO] - Preparing data loaders...
2025-04-27 19:47:40,084 [INFO] - Training samples: 45000 per model
2025-04-27 19:47:40,084 [INFO] - Validation samples: 5000 per model
2025-04-27 19:47:40,084 [INFO] - Test samples: 10000 per model
2025-04-27 19:47:40,084 [INFO] - Creating models for mutual learning...
2025-04-27 19:47:40,091 [INFO] - Loading ViT-B16 model...
2025-04-27 19:47:40,838 [INFO] - Loading EfficientNetB0 model...
2025-04-27 19:47:40,961 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-27 19:47:41,362 [INFO] - Loading MobileNetV3 model...
2025-04-27 19:47:41,463 [INFO] - Loading ResNet50 model...
2025-04-27 19:47:41,836 [INFO] - Loading DenseNet121 model...
2025-04-27 19:47:41,979 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-27 19:47:42,080 [INFO] - Loading pre-trained weights for vit from C:\Users\Gading\Downloads\Research\Models\ViT\checkpoints\vit_b16_teacher_20250321_053628_best.pth
2025-04-27 19:47:44,278 [INFO] - Successfully loaded pre-trained weights for vit
2025-04-27 19:47:44,279 [INFO] - Loading pre-trained weights for efficientnet from C:\Users\Gading\Downloads\Research\Models\EfficientNetB0\checkpoints\efficientnet_b0_teacher_20250325_132652_best.pth
2025-04-27 19:47:44,542 [INFO] - Successfully loaded pre-trained weights for efficientnet
2025-04-27 19:47:44,557 [INFO] - Loading pre-trained weights for inception from C:\Users\Gading\Downloads\Research\Models\InceptionV3\checkpoints\inception_v3_teacher_20250321_153825_best.pth
2025-04-27 19:47:45,073 [INFO] - Successfully loaded pre-trained weights for inception
2025-04-27 19:47:45,075 [INFO] - Loading pre-trained weights for mobilenet from C:\Users\Gading\Downloads\Research\Models\MobileNetV3\checkpoints\mobilenetv3_20250326_035725_best.pth
2025-04-27 19:47:45,300 [INFO] - Successfully loaded pre-trained weights for mobilenet
2025-04-27 19:47:45,300 [INFO] - Loading pre-trained weights for resnet from C:\Users\Gading\Downloads\Research\Models\ResNet50\checkpoints\resnet50_teacher_20250322_225032_best.pth
2025-04-27 19:47:45,773 [INFO] - Successfully loaded pre-trained weights for resnet
2025-04-27 19:47:45,773 [INFO] - Loading pre-trained weights for densenet from C:\Users\Gading\Downloads\Research\Models\DenseNet121\checkpoints\densenet121_teacher_20250325_160534_best.pth
2025-04-27 19:47:46,179 [INFO] - Successfully loaded pre-trained weights for densenet
2025-04-27 19:47:46,388 [INFO] - Model vit moved to cuda
2025-04-27 19:47:46,415 [INFO] - Model efficientnet moved to cuda
2025-04-27 19:47:46,450 [INFO] - Model inception moved to cuda
2025-04-27 19:47:46,464 [INFO] - Model mobilenet moved to cuda
2025-04-27 19:47:46,490 [INFO] - Model resnet moved to cuda
2025-04-27 19:47:46,552 [INFO] - Model densenet moved to cuda
2025-04-27 19:47:46,574 [INFO] - Model student moved to cuda
2025-04-27 19:47:46,575 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-27 19:47:46,578 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-27 19:47:46,580 [INFO] - Model inception: 25.13M parameters (25.13M trainable)
2025-04-27 19:47:46,581 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-27 19:47:46,582 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-27 19:47:46,584 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-27 19:47:46,586 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-27 19:47:46,591 [INFO] - Starting initialization phase...
2025-04-27 19:47:46,597 [INFO] - Initialization Epoch 1/5
2025-04-27 19:47:46,758 [INFO] - GPU cache cleared: 604.67MB → 604.67MB (freed 0.00MB)
2025-04-27 19:47:46,765 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,765 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,765 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,765 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,765 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,765 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,765 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,776 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,782 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,782 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,783 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,783 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,784 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,784 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,785 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:46,787 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:46,788 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:46,789 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:46,790 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:46,791 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:46,792 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:46,793 [INFO] - Initialization epoch 1 completed in 0.19s
2025-04-27 19:47:46,794 [INFO] - Initialization Epoch 2/5
2025-04-27 19:47:46,946 [INFO] - GPU cache cleared: 604.67MB → 604.67MB (freed 0.00MB)
2025-04-27 19:47:46,960 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,961 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,962 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,962 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,962 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,963 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,964 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,972 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,972 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,972 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,972 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,979 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,979 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,981 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:46,982 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:46,984 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:46,987 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:46,989 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:46,991 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:46,993 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:46,994 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:46,997 [INFO] - Initialization epoch 2 completed in 0.20s
2025-04-27 19:47:46,998 [INFO] - Initialization Epoch 3/5
2025-04-27 19:47:47,159 [INFO] - GPU cache cleared: 604.67MB → 604.67MB (freed 0.00MB)
2025-04-27 19:47:47,173 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,173 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,173 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,174 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,175 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,175 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,175 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,186 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,187 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,187 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,188 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,188 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,189 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,189 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,190 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,191 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,192 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,193 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,194 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,195 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,197 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,198 [INFO] - Initialization epoch 3 completed in 0.20s
2025-04-27 19:47:47,198 [INFO] - Initialization Epoch 4/5
2025-04-27 19:47:47,345 [INFO] - GPU cache cleared: 604.67MB → 604.67MB (freed 0.00MB)
2025-04-27 19:47:47,355 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,355 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,355 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,366 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,366 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,366 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,366 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,377 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,379 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,379 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,379 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,380 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,380 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,381 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,382 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,382 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,383 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,384 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,385 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,386 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,387 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,389 [INFO] - Initialization epoch 4 completed in 0.19s
2025-04-27 19:47:47,390 [INFO] - Initialization Epoch 5/5
2025-04-27 19:47:47,542 [INFO] - GPU cache cleared: 604.67MB → 604.67MB (freed 0.00MB)
2025-04-27 19:47:47,552 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,552 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,552 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,552 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,552 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,552 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,552 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,562 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,568 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,568 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,569 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,570 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,570 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,571 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:47,572 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,572 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,573 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,574 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,576 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,577 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,578 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-27 19:47:47,579 [INFO] - Initialization epoch 5 completed in 0.19s
2025-04-27 19:47:47,580 [INFO] - Initialization phase completed
2025-04-27 19:47:47,580 [INFO] - Starting mutual learning phase...
2025-04-27 19:47:47,581 [INFO] - Hook registered for encoder.ln
2025-04-27 19:47:47,582 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-04-27 19:47:47,590 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-04-27 19:47:47,591 [INFO] - Hook registered for features.8
2025-04-27 19:47:47,592 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-04-27 19:47:47,604 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-04-27 19:47:47,605 [INFO] - Hook registered for inception.Mixed_7c
2025-04-27 19:47:47,605 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-04-27 19:47:47,622 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-04-27 19:47:47,623 [INFO] - Hook registered for features
2025-04-27 19:47:47,623 [INFO] - Feature extractor registered for mobilenet at layer features
2025-04-27 19:47:47,633 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-04-27 19:47:47,634 [INFO] - Hook registered for layer4
2025-04-27 19:47:47,634 [INFO] - Feature extractor registered for resnet at layer layer4
2025-04-27 19:47:47,644 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-04-27 19:47:47,645 [INFO] - Hook registered for features
2025-04-27 19:47:47,645 [INFO] - Feature extractor registered for densenet at layer features
2025-04-27 19:47:47,680 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-04-27 19:47:47,681 [INFO] - Hook registered for features.8
2025-04-27 19:47:47,682 [INFO] - Feature extractor registered for student at layer features.8
2025-04-27 19:47:47,706 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-04-27 19:47:47,847 [INFO] - HFI module initialized with 6 teachers
2025-04-27 19:47:47,847 [INFO] - Target student feature shape: torch.Size([1, 1280, 7, 7])
2025-04-27 19:47:47,896 [INFO] - Using learning rate 5e-05 for vit
2025-04-27 19:47:47,896 [INFO] - Using 16 gradient accumulation steps for ViT
2025-04-27 19:47:47,896 [INFO] - Using learning rate 0.001 for efficientnet
2025-04-27 19:47:47,896 [INFO] - Using learning rate 0.001 for inception
2025-04-27 19:47:47,896 [INFO] - Using learning rate 0.001 for mobilenet
2025-04-27 19:47:47,905 [INFO] - Using learning rate 0.001 for resnet
2025-04-27 19:47:47,905 [INFO] - Using learning rate 0.001 for densenet
2025-04-27 19:47:47,905 [INFO] - Using learning rate 0.001 for student
2025-04-27 19:47:47,905 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250427_194747_config.json
2025-04-27 19:47:47,905 [INFO] - Mutual Learning Epoch 1/50
2025-04-27 19:47:47,905 [INFO] - Mutual weight: 0.0200, Calibration weight: 0.0067, Feature weight: 0.0033
2025-04-27 19:47:47,912 [INFO] - Current temperatures: {'vit': 4.118149757385254, 'efficientnet': 4.118149757385254, 'inception': 5.106715202331543, 'mobilenet': 4.118149757385254, 'resnet': 4.118149757385254, 'densenet': 4.118149757385254, 'student': 3.148587226867676}
2025-04-27 19:47:48,069 [INFO] - GPU cache cleared: 644.01MB → 644.01MB (freed 0.00MB)
2025-04-27 19:47:48,080 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:48,080 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:48,080 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:48,087 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:48,087 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:48,088 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:48,088 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:48,098 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:48,099 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:48,099 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:48,100 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:48,100 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:48,101 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:48,101 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-27 19:47:48,114 [ERROR] - An error occurred: torch.cat(): expected a non-empty list of Tensors
2025-04-27 19:47:48,115 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_2596\807453548.py", line 2621, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_2596\807453548.py", line 2122, in mutual_learning_phase
    val_targets_tensor = torch.cat(val_targets_list)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: torch.cat(): expected a non-empty list of Tensors

2025-04-29 16:53:09,586 [INFO] - Using device: cuda
2025-04-29 16:53:09,586 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-29 16:53:09,600 [INFO] - GPU Memory: 6.00 GB
2025-04-29 16:53:09,600 [INFO] - CUDA Version: 12.4
2025-04-29 16:53:09,702 [INFO] - cuDNN benchmark mode enabled
2025-04-29 16:53:09,720 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-29 16:53:09,783 [INFO] - Random seed set to 42
2025-04-29 16:53:09,783 [INFO] - Preparing data loaders...
2025-04-29 16:53:21,170 [INFO] - Training samples: 45000 per model
2025-04-29 16:53:21,171 [INFO] - Validation samples: 5000 per model
2025-04-29 16:53:21,171 [INFO] - Test samples: 10000 per model
2025-04-29 16:53:21,171 [INFO] - Creating models for mutual learning...
2025-04-29 16:53:21,173 [INFO] - Loading ViT-B16 model...
2025-04-29 16:53:22,117 [INFO] - Loading EfficientNetB0 model...
2025-04-29 16:53:22,247 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-29 16:53:22,627 [INFO] - Loading MobileNetV3-Large model...
2025-04-29 16:53:22,759 [INFO] - Loading ResNet50 model...
2025-04-29 16:53:23,138 [INFO] - Loading DenseNet121 model...
2025-04-29 16:53:23,303 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-29 16:53:23,635 [INFO] - Model vit moved to cuda
2025-04-29 16:53:23,661 [INFO] - Model efficientnet moved to cuda
2025-04-29 16:53:23,733 [INFO] - Model inception moved to cuda
2025-04-29 16:53:23,750 [INFO] - Model mobilenet moved to cuda
2025-04-29 16:53:23,784 [INFO] - Model resnet moved to cuda
2025-04-29 16:53:23,851 [INFO] - Model densenet moved to cuda
2025-04-29 16:53:23,880 [INFO] - Model student moved to cuda
2025-04-29 16:53:23,880 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-29 16:53:23,880 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-29 16:53:23,887 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-29 16:53:23,888 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-29 16:53:23,890 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-29 16:53:23,892 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-29 16:53:23,893 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-29 16:53:23,894 [INFO] - Starting initialization phase...
2025-04-29 16:53:23,900 [INFO] - Initialization Epoch 1/5
2025-04-29 16:53:24,053 [INFO] - GPU cache cleared: 592.14MB → 592.14MB (freed 0.00MB)
2025-04-29 16:53:24,060 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,066 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,066 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,068 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,069 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,069 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,069 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,080 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,080 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,081 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,081 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,081 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,081 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,081 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,081 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,088 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,090 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,090 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,090 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,094 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,095 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,096 [INFO] - Initialization epoch 1 completed in 0.20s
2025-04-29 16:53:24,097 [INFO] - Initialization Epoch 2/5
2025-04-29 16:53:24,249 [INFO] - GPU cache cleared: 592.14MB → 592.14MB (freed 0.00MB)
2025-04-29 16:53:24,254 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,254 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,261 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,261 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,261 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,263 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,263 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,275 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,275 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,275 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,275 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,275 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,275 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,275 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,275 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,275 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,280 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,282 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,283 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,284 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,285 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,286 [INFO] - Initialization epoch 2 completed in 0.19s
2025-04-29 16:53:24,287 [INFO] - Initialization Epoch 3/5
2025-04-29 16:53:24,438 [INFO] - GPU cache cleared: 592.14MB → 592.14MB (freed 0.00MB)
2025-04-29 16:53:24,447 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,447 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,448 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,449 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,449 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,449 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,449 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,456 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,456 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,462 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,463 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,463 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,464 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,464 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,465 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,465 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,465 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,465 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,469 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,470 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,471 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,472 [INFO] - Initialization epoch 3 completed in 0.18s
2025-04-29 16:53:24,472 [INFO] - Initialization Epoch 4/5
2025-04-29 16:53:24,623 [INFO] - GPU cache cleared: 592.14MB → 592.14MB (freed 0.00MB)
2025-04-29 16:53:24,633 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,634 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,635 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,635 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,636 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,636 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,636 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,647 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,648 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,648 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,649 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,649 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,650 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,650 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,651 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,651 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,651 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,651 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,651 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,651 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,657 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,658 [INFO] - Initialization epoch 4 completed in 0.18s
2025-04-29 16:53:24,659 [INFO] - Initialization Epoch 5/5
2025-04-29 16:53:24,810 [INFO] - GPU cache cleared: 592.14MB → 592.14MB (freed 0.00MB)
2025-04-29 16:53:24,819 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,820 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,820 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,821 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,821 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,822 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,822 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,833 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,834 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,834 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,835 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,835 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,835 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,835 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:24,837 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,838 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,839 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,840 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,841 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,841 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,841 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:53:24,845 [INFO] - Initialization epoch 5 completed in 0.19s
2025-04-29 16:53:24,846 [INFO] - Initialization phase completed
2025-04-29 16:53:24,847 [INFO] - Starting mutual learning phase...
2025-04-29 16:53:24,848 [INFO] - Hook registered for encoder.ln
2025-04-29 16:53:24,851 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-04-29 16:53:25,289 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-04-29 16:53:25,289 [INFO] - Hook registered for features.8
2025-04-29 16:53:25,289 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-04-29 16:53:25,627 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-04-29 16:53:25,629 [INFO] - Hook registered for inception.Mixed_7c
2025-04-29 16:53:25,629 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-04-29 16:53:26,069 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-04-29 16:53:26,070 [INFO] - Hook registered for features
2025-04-29 16:53:26,070 [INFO] - Feature extractor registered for mobilenet at layer features
2025-04-29 16:53:26,219 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-04-29 16:53:26,220 [INFO] - Hook registered for layer4
2025-04-29 16:53:26,220 [INFO] - Feature extractor registered for resnet at layer layer4
2025-04-29 16:53:26,465 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-04-29 16:53:26,465 [INFO] - Hook registered for features
2025-04-29 16:53:26,465 [INFO] - Feature extractor registered for densenet at layer features
2025-04-29 16:53:26,740 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-04-29 16:53:26,740 [INFO] - Hook registered for features.8
2025-04-29 16:53:26,740 [INFO] - Feature extractor registered for student at layer features.8
2025-04-29 16:53:26,754 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-04-29 16:53:27,109 [INFO] - HFI module initialized with 6 teachers
2025-04-29 16:53:27,109 [INFO] - Target student feature shape: torch.Size([1, 1280, 7, 7])
2025-04-29 16:53:27,165 [INFO] - Using learning rate 5e-05 for vit
2025-04-29 16:53:27,166 [INFO] - Using 16 gradient accumulation steps for ViT
2025-04-29 16:53:27,167 [INFO] - Using learning rate 0.001 for efficientnet
2025-04-29 16:53:27,169 [INFO] - Using learning rate 0.001 for inception
2025-04-29 16:53:27,170 [INFO] - Using learning rate 0.0015 for mobilenet
2025-04-29 16:53:27,171 [INFO] - Using learning rate 0.001 for resnet
2025-04-29 16:53:27,171 [INFO] - Using learning rate 0.0008 for densenet
2025-04-29 16:53:27,171 [INFO] - Using learning rate 0.002 for student
2025-04-29 16:53:27,171 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250429_165327_config.json
2025-04-29 16:53:27,171 [INFO] - Mutual Learning Epoch 1/50
2025-04-29 16:53:27,178 [INFO] - Mutual weight: 0.0200, Calibration weight: 0.0067, Feature weight: 0.0033
2025-04-29 16:53:27,185 [INFO] - Current temperatures: {'vit': 4.118149757385254, 'efficientnet': 4.118149757385254, 'inception': 5.106715202331543, 'mobilenet': 4.118149757385254, 'resnet': 4.118149757385254, 'densenet': 4.118149757385254, 'student': 3.148587226867676}
2025-04-29 16:53:27,345 [INFO] - GPU cache cleared: 638.84MB → 638.84MB (freed 0.00MB)
2025-04-29 16:53:27,351 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:27,351 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:27,351 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:27,351 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:27,351 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:27,351 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:27,351 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:27,368 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:27,369 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:27,369 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:27,370 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:27,370 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:27,370 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:27,372 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:53:27,380 [ERROR] - An error occurred: torch.cat(): expected a non-empty list of Tensors
2025-04-29 16:53:27,385 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_14604\1601285696.py", line 2647, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_14604\1601285696.py", line 2148, in mutual_learning_phase
    val_targets_tensor = torch.cat(val_targets_list)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: torch.cat(): expected a non-empty list of Tensors

2025-04-29 16:54:11,144 [INFO] - Using device: cuda
2025-04-29 16:54:11,144 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-29 16:54:11,144 [INFO] - GPU Memory: 6.00 GB
2025-04-29 16:54:11,149 [INFO] - CUDA Version: 12.4
2025-04-29 16:54:11,150 [INFO] - cuDNN benchmark mode enabled
2025-04-29 16:54:11,166 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-29 16:54:11,168 [INFO] - Random seed set to 42
2025-04-29 16:54:11,168 [INFO] - Preparing data loaders...
2025-04-29 16:54:21,996 [INFO] - Training samples: 45000 per model
2025-04-29 16:54:21,996 [INFO] - Validation samples: 5000 per model
2025-04-29 16:54:21,996 [INFO] - Test samples: 10000 per model
2025-04-29 16:54:21,996 [INFO] - Creating models for mutual learning...
2025-04-29 16:54:21,996 [INFO] - Loading ViT-B16 model...
2025-04-29 16:54:22,647 [INFO] - Loading EfficientNetB0 model...
2025-04-29 16:54:22,774 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-29 16:54:22,978 [INFO] - Loading MobileNetV3-Large model...
2025-04-29 16:54:23,078 [INFO] - Loading ResNet50 model...
2025-04-29 16:54:23,391 [INFO] - Loading DenseNet121 model...
2025-04-29 16:54:23,688 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-29 16:54:23,993 [INFO] - Model vit moved to cuda
2025-04-29 16:54:24,025 [INFO] - Model efficientnet moved to cuda
2025-04-29 16:54:24,060 [INFO] - Model inception moved to cuda
2025-04-29 16:54:24,073 [INFO] - Model mobilenet moved to cuda
2025-04-29 16:54:24,099 [INFO] - Model resnet moved to cuda
2025-04-29 16:54:24,115 [INFO] - Model densenet moved to cuda
2025-04-29 16:54:24,144 [INFO] - Model student moved to cuda
2025-04-29 16:54:24,144 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-29 16:54:24,144 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-29 16:54:24,150 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-29 16:54:24,151 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-29 16:54:24,152 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-29 16:54:24,155 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-29 16:54:24,156 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-29 16:54:24,156 [INFO] - Starting initialization phase...
2025-04-29 16:54:24,163 [INFO] - Initialization Epoch 1/5
2025-04-29 16:54:24,306 [INFO] - GPU cache cleared: 600.81MB → 600.81MB (freed 0.00MB)
2025-04-29 16:54:24,321 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,321 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,321 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,321 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,321 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,321 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,321 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,337 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,337 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,343 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,343 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,343 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,345 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,345 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,346 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,348 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,348 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,348 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,350 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,352 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,352 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,352 [INFO] - Initialization epoch 1 completed in 0.19s
2025-04-29 16:54:24,352 [INFO] - Initialization Epoch 2/5
2025-04-29 16:54:24,507 [INFO] - GPU cache cleared: 600.81MB → 600.81MB (freed 0.00MB)
2025-04-29 16:54:24,514 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,514 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,514 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,514 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,514 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,514 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,514 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,531 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,532 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,532 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,533 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,534 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,534 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,535 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,536 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,536 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,536 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,539 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,539 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,539 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,539 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,539 [INFO] - Initialization epoch 2 completed in 0.19s
2025-04-29 16:54:24,539 [INFO] - Initialization Epoch 3/5
2025-04-29 16:54:24,691 [INFO] - GPU cache cleared: 600.81MB → 600.81MB (freed 0.00MB)
2025-04-29 16:54:24,707 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,707 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,707 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,707 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,707 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,707 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,707 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,715 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,715 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,715 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,715 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,715 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,723 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,723 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,724 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,725 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,726 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,727 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,728 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,729 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,730 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,731 [INFO] - Initialization epoch 3 completed in 0.19s
2025-04-29 16:54:24,732 [INFO] - Initialization Epoch 4/5
2025-04-29 16:54:24,876 [INFO] - GPU cache cleared: 600.81MB → 600.81MB (freed 0.00MB)
2025-04-29 16:54:24,889 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,889 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,898 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,898 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,898 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,898 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,898 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,911 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,912 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,912 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,913 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,913 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,914 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,914 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:24,915 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,916 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,917 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,918 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,919 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,920 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,921 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:24,921 [INFO] - Initialization epoch 4 completed in 0.19s
2025-04-29 16:54:24,921 [INFO] - Initialization Epoch 5/5
2025-04-29 16:54:25,072 [INFO] - GPU cache cleared: 600.81MB → 600.81MB (freed 0.00MB)
2025-04-29 16:54:25,083 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,083 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,083 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,090 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,090 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,090 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,090 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,093 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,093 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,103 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,103 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,105 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,105 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,106 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,107 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:25,107 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:25,108 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:25,109 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:25,110 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:25,111 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:25,113 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 16:54:25,113 [INFO] - Initialization epoch 5 completed in 0.19s
2025-04-29 16:54:25,114 [INFO] - Initialization phase completed
2025-04-29 16:54:25,116 [INFO] - Starting mutual learning phase...
2025-04-29 16:54:25,117 [INFO] - Hook registered for encoder.ln
2025-04-29 16:54:25,117 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-04-29 16:54:25,125 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-04-29 16:54:25,125 [INFO] - Hook registered for features.8
2025-04-29 16:54:25,128 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-04-29 16:54:25,140 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-04-29 16:54:25,142 [INFO] - Hook registered for inception.Mixed_7c
2025-04-29 16:54:25,142 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-04-29 16:54:25,159 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-04-29 16:54:25,160 [INFO] - Hook registered for features
2025-04-29 16:54:25,161 [INFO] - Feature extractor registered for mobilenet at layer features
2025-04-29 16:54:25,171 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-04-29 16:54:25,171 [INFO] - Hook registered for layer4
2025-04-29 16:54:25,172 [INFO] - Feature extractor registered for resnet at layer layer4
2025-04-29 16:54:25,189 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-04-29 16:54:25,190 [INFO] - Hook registered for features
2025-04-29 16:54:25,191 [INFO] - Feature extractor registered for densenet at layer features
2025-04-29 16:54:25,223 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-04-29 16:54:25,224 [INFO] - Hook registered for features.8
2025-04-29 16:54:25,225 [INFO] - Feature extractor registered for student at layer features.8
2025-04-29 16:54:25,243 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-04-29 16:54:25,367 [INFO] - HFI module initialized with 6 teachers
2025-04-29 16:54:25,367 [INFO] - Target student feature shape: torch.Size([1, 1280, 7, 7])
2025-04-29 16:54:25,416 [INFO] - Using learning rate 5e-05 for vit
2025-04-29 16:54:25,416 [INFO] - Using 16 gradient accumulation steps for ViT
2025-04-29 16:54:25,416 [INFO] - Using learning rate 0.001 for efficientnet
2025-04-29 16:54:25,416 [INFO] - Using learning rate 0.001 for inception
2025-04-29 16:54:25,421 [INFO] - Using learning rate 0.0015 for mobilenet
2025-04-29 16:54:25,421 [INFO] - Using learning rate 0.001 for resnet
2025-04-29 16:54:25,422 [INFO] - Using learning rate 0.0008 for densenet
2025-04-29 16:54:25,423 [INFO] - Using learning rate 0.002 for student
2025-04-29 16:54:25,423 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250429_165425_config.json
2025-04-29 16:54:25,423 [INFO] - Mutual Learning Epoch 1/50
2025-04-29 16:54:25,423 [INFO] - Mutual weight: 0.0200, Calibration weight: 0.0067, Feature weight: 0.0033
2025-04-29 16:54:25,423 [INFO] - Current temperatures: {'vit': 4.118149757385254, 'efficientnet': 4.118149757385254, 'inception': 5.106715202331543, 'mobilenet': 4.118149757385254, 'resnet': 4.118149757385254, 'densenet': 4.118149757385254, 'student': 3.148587226867676}
2025-04-29 16:54:25,578 [INFO] - GPU cache cleared: 639.14MB → 639.14MB (freed 0.00MB)
2025-04-29 16:54:25,590 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,590 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,590 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,590 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,590 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,590 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,590 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,609 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,609 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,609 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,609 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,609 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,613 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,613 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'str'>, <class 'str'>)
2025-04-29 16:54:25,615 [ERROR] - An error occurred: torch.cat(): expected a non-empty list of Tensors
2025-04-29 16:54:25,616 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_14604\2546651977.py", line 2647, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_14604\2546651977.py", line 2148, in mutual_learning_phase
    val_targets_tensor = torch.cat(val_targets_list)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: torch.cat(): expected a non-empty list of Tensors

2025-04-29 17:09:56,793 [INFO] - Using device: cuda
2025-04-29 17:09:56,793 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-29 17:09:56,793 [INFO] - GPU Memory: 6.00 GB
2025-04-29 17:09:56,793 [INFO] - CUDA Version: 12.4
2025-04-29 17:09:56,793 [INFO] - cuDNN benchmark mode enabled
2025-04-29 17:09:56,810 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-29 17:09:56,813 [INFO] - Random seed set to 42
2025-04-29 17:09:56,813 [INFO] - Preparing data loaders...
2025-04-29 17:10:05,341 [INFO] - Training samples: 45000 per model
2025-04-29 17:10:05,356 [INFO] - Validation samples: 5000 per model
2025-04-29 17:10:05,356 [INFO] - Test samples: 10000 per model
2025-04-29 17:10:05,356 [INFO] - Creating models for mutual learning...
2025-04-29 17:10:05,356 [INFO] - Loading ViT-B16 model...
2025-04-29 17:10:06,073 [INFO] - Loading EfficientNetB0 model...
2025-04-29 17:10:06,160 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-29 17:10:06,344 [INFO] - Loading MobileNetV3-Large model...
2025-04-29 17:10:06,432 [INFO] - Loading ResNet50 model...
2025-04-29 17:10:06,715 [INFO] - Loading DenseNet121 model...
2025-04-29 17:10:06,849 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-29 17:10:07,220 [INFO] - Model vit moved to cuda
2025-04-29 17:10:07,283 [INFO] - Model efficientnet moved to cuda
2025-04-29 17:10:07,346 [INFO] - Model inception moved to cuda
2025-04-29 17:10:07,380 [INFO] - Model mobilenet moved to cuda
2025-04-29 17:10:07,424 [INFO] - Model resnet moved to cuda
2025-04-29 17:10:07,493 [INFO] - Model densenet moved to cuda
2025-04-29 17:10:07,513 [INFO] - Model student moved to cuda
2025-04-29 17:10:07,514 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-29 17:10:07,514 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-29 17:10:07,519 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-29 17:10:07,521 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-29 17:10:07,521 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-29 17:10:07,521 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-29 17:10:07,526 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-29 17:10:07,526 [INFO] - Starting initialization phase...
2025-04-29 17:10:07,532 [INFO] - Initialization Epoch 1/5
2025-04-29 17:10:07,703 [INFO] - GPU cache cleared: 1196.46MB → 601.46MB (freed 594.99MB)
2025-04-29 17:10:07,712 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,712 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,712 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,715 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,715 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,717 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,717 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,728 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,728 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,728 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,728 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,728 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,728 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,728 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,728 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:07,734 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:07,735 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:07,737 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:07,738 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:07,738 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:07,738 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:07,742 [INFO] - Initialization epoch 1 completed in 0.21s
2025-04-29 17:10:07,743 [INFO] - Initialization Epoch 2/5
2025-04-29 17:10:07,924 [INFO] - GPU cache cleared: 601.46MB → 601.46MB (freed 0.00MB)
2025-04-29 17:10:07,936 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,937 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,937 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,938 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,939 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,940 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,940 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,951 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,952 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,952 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,952 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,952 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,952 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,952 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:07,952 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:07,956 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:07,958 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:07,959 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:07,959 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:07,959 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:07,959 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:07,963 [INFO] - Initialization epoch 2 completed in 0.22s
2025-04-29 17:10:07,965 [INFO] - Initialization Epoch 3/5
2025-04-29 17:10:08,123 [INFO] - GPU cache cleared: 601.46MB → 601.46MB (freed 0.00MB)
2025-04-29 17:10:08,134 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,135 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,135 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,136 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,136 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,137 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,137 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,146 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,146 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,146 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,146 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,151 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,152 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,152 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,153 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,153 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,153 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,153 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,157 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,159 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,160 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,160 [INFO] - Initialization epoch 3 completed in 0.19s
2025-04-29 17:10:08,160 [INFO] - Initialization Epoch 4/5
2025-04-29 17:10:08,320 [INFO] - GPU cache cleared: 601.46MB → 601.46MB (freed 0.00MB)
2025-04-29 17:10:08,330 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,331 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,332 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,332 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,333 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,333 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,334 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,341 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,345 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,346 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,346 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,347 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,347 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,348 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,348 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,348 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,348 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,352 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,353 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,354 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,355 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,355 [INFO] - Initialization epoch 4 completed in 0.19s
2025-04-29 17:10:08,355 [INFO] - Initialization Epoch 5/5
2025-04-29 17:10:08,534 [INFO] - GPU cache cleared: 601.46MB → 601.46MB (freed 0.00MB)
2025-04-29 17:10:08,544 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,544 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,545 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,545 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,546 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,546 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,547 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,558 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,559 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,559 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,561 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,561 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,562 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,562 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:08,562 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,562 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,562 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,562 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,567 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,569 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,570 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:10:08,570 [INFO] - Initialization epoch 5 completed in 0.21s
2025-04-29 17:10:08,570 [INFO] - Initialization phase completed
2025-04-29 17:10:08,570 [INFO] - Starting mutual learning phase...
2025-04-29 17:10:08,570 [INFO] - Hook registered for encoder.ln
2025-04-29 17:10:08,570 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-04-29 17:10:08,581 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-04-29 17:10:08,582 [INFO] - Hook registered for features.8
2025-04-29 17:10:08,583 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-04-29 17:10:08,607 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-04-29 17:10:08,607 [INFO] - Hook registered for inception.Mixed_7c
2025-04-29 17:10:08,607 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-04-29 17:10:08,624 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-04-29 17:10:08,625 [INFO] - Hook registered for features
2025-04-29 17:10:08,625 [INFO] - Feature extractor registered for mobilenet at layer features
2025-04-29 17:10:08,637 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-04-29 17:10:08,638 [INFO] - Hook registered for layer4
2025-04-29 17:10:08,639 [INFO] - Feature extractor registered for resnet at layer layer4
2025-04-29 17:10:08,647 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-04-29 17:10:08,648 [INFO] - Hook registered for features
2025-04-29 17:10:08,649 [INFO] - Feature extractor registered for densenet at layer features
2025-04-29 17:10:08,679 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-04-29 17:10:08,680 [INFO] - Hook registered for features.8
2025-04-29 17:10:08,680 [INFO] - Feature extractor registered for student at layer features.8
2025-04-29 17:10:08,692 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-04-29 17:10:08,811 [INFO] - HFI module initialized with 6 teachers
2025-04-29 17:10:08,812 [INFO] - Target student feature shape: torch.Size([1, 1280, 7, 7])
2025-04-29 17:10:08,866 [INFO] - Using learning rate 5e-05 for vit
2025-04-29 17:10:08,866 [INFO] - Using 16 gradient accumulation steps for ViT
2025-04-29 17:10:08,868 [INFO] - Using learning rate 0.001 for efficientnet
2025-04-29 17:10:08,868 [INFO] - Using learning rate 0.001 for inception
2025-04-29 17:10:08,868 [INFO] - Using learning rate 0.0015 for mobilenet
2025-04-29 17:10:08,873 [INFO] - Using learning rate 0.001 for resnet
2025-04-29 17:10:08,873 [INFO] - Using learning rate 0.0008 for densenet
2025-04-29 17:10:08,875 [INFO] - Using learning rate 0.002 for student
2025-04-29 17:10:08,878 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250429_171008_config.json
2025-04-29 17:10:08,878 [INFO] - Mutual Learning Epoch 1/50
2025-04-29 17:10:08,878 [INFO] - Mutual weight: 0.0200, Calibration weight: 0.0067, Feature weight: 0.0033
2025-04-29 17:10:08,881 [INFO] - Current temperatures: {'vit': 4.118149757385254, 'efficientnet': 4.118149757385254, 'inception': 5.106715202331543, 'mobilenet': 4.118149757385254, 'resnet': 4.118149757385254, 'densenet': 4.118149757385254, 'student': 3.148587226867676}
2025-04-29 17:10:09,040 [INFO] - GPU cache cleared: 640.03MB → 640.03MB (freed 0.00MB)
2025-04-29 17:10:09,049 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:09,049 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:09,049 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:09,049 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:09,049 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:09,053 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:09,054 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:09,065 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:09,065 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:09,066 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:09,066 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:09,067 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:09,068 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:09,069 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:10:09,070 [WARNING] - No validation data was processed. Check your data loading.
2025-04-29 17:10:09,072 [ERROR] - An error occurred: float division by zero
2025-04-29 17:10:09,074 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_14604\2757239979.py", line 2689, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_14604\2757239979.py", line 2203, in mutual_learning_phase
    train_acc = 100. * train_correct[name] / train_total[name]
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-04-29 17:21:44,810 [INFO] - Using device: cuda
2025-04-29 17:21:44,810 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-29 17:21:44,810 [INFO] - GPU Memory: 6.00 GB
2025-04-29 17:21:44,810 [INFO] - CUDA Version: 12.4
2025-04-29 17:21:44,810 [INFO] - cuDNN benchmark mode enabled
2025-04-29 17:21:44,834 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 5e-05,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-29 17:21:44,834 [INFO] - Random seed set to 42
2025-04-29 17:21:44,834 [INFO] - Preparing data loaders...
2025-04-29 17:21:53,619 [INFO] - Training samples: 45000 per model
2025-04-29 17:21:53,619 [INFO] - Validation samples: 5000 per model
2025-04-29 17:21:53,619 [INFO] - Test samples: 10000 per model
2025-04-29 17:21:53,619 [INFO] - Creating models for mutual learning...
2025-04-29 17:21:53,619 [INFO] - Loading ViT-B16 model...
2025-04-29 17:21:54,329 [INFO] - Loading EfficientNetB0 model...
2025-04-29 17:21:54,446 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-29 17:21:54,645 [INFO] - Loading MobileNetV3-Large model...
2025-04-29 17:21:54,732 [INFO] - Loading ResNet50 model...
2025-04-29 17:21:55,006 [INFO] - Loading DenseNet121 model...
2025-04-29 17:21:55,291 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-29 17:21:55,619 [INFO] - Model vit moved to cuda
2025-04-29 17:21:55,676 [INFO] - Model efficientnet moved to cuda
2025-04-29 17:21:55,748 [INFO] - Model inception moved to cuda
2025-04-29 17:21:55,759 [INFO] - Model mobilenet moved to cuda
2025-04-29 17:21:55,816 [INFO] - Model resnet moved to cuda
2025-04-29 17:21:55,846 [INFO] - Model densenet moved to cuda
2025-04-29 17:21:55,866 [INFO] - Model student moved to cuda
2025-04-29 17:21:55,866 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-29 17:21:55,874 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-29 17:21:55,877 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-29 17:21:55,877 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-29 17:21:55,877 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-29 17:21:55,883 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-29 17:21:55,884 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-29 17:21:55,884 [INFO] - Starting initialization phase...
2025-04-29 17:21:55,884 [INFO] - Initialization Epoch 1/5
2025-04-29 17:21:56,054 [INFO] - GPU cache cleared: 602.81MB → 602.81MB (freed 0.00MB)
2025-04-29 17:21:56,054 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,054 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,054 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,054 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,054 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,070 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,070 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,070 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,070 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,070 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,070 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,070 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,070 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,086 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,086 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,088 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,090 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,090 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,092 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,094 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,094 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,094 [INFO] - Initialization epoch 1 completed in 0.21s
2025-04-29 17:21:56,094 [INFO] - Initialization Epoch 2/5
2025-04-29 17:21:56,255 [INFO] - GPU cache cleared: 602.81MB → 602.81MB (freed 0.00MB)
2025-04-29 17:21:56,255 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,255 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,255 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,255 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,255 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,255 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,255 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,270 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,270 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,270 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,270 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,270 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,270 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,270 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,270 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,270 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,286 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,288 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,288 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,288 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,288 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,292 [INFO] - Initialization epoch 2 completed in 0.19s
2025-04-29 17:21:56,292 [INFO] - Initialization Epoch 3/5
2025-04-29 17:21:56,478 [INFO] - GPU cache cleared: 602.81MB → 602.81MB (freed 0.00MB)
2025-04-29 17:21:56,490 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,490 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,490 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,490 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,490 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,493 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,493 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,500 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,500 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,500 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,500 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,500 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,500 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,500 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,509 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,509 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,509 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,512 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,512 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,512 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,516 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,516 [INFO] - Initialization epoch 3 completed in 0.22s
2025-04-29 17:21:56,517 [INFO] - Initialization Epoch 4/5
2025-04-29 17:21:56,680 [INFO] - GPU cache cleared: 602.81MB → 602.81MB (freed 0.00MB)
2025-04-29 17:21:56,690 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,690 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,692 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,692 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,692 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,694 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,694 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,701 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,701 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,701 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,701 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,709 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,709 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,709 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,711 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,711 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,712 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,712 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,712 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,712 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,717 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,717 [INFO] - Initialization epoch 4 completed in 0.20s
2025-04-29 17:21:56,717 [INFO] - Initialization Epoch 5/5
2025-04-29 17:21:56,893 [INFO] - GPU cache cleared: 602.81MB → 602.81MB (freed 0.00MB)
2025-04-29 17:21:56,902 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,902 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,902 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,902 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,902 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,902 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,902 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,913 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,913 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,913 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,913 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,913 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,923 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,923 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:56,923 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,926 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,926 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,926 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,929 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,929 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,931 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-29 17:21:56,931 [INFO] - Initialization epoch 5 completed in 0.21s
2025-04-29 17:21:56,931 [INFO] - Initialization phase completed
2025-04-29 17:21:56,931 [INFO] - Starting mutual learning phase...
2025-04-29 17:21:56,931 [INFO] - Hook registered for encoder.ln
2025-04-29 17:21:56,931 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-04-29 17:21:56,942 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-04-29 17:21:56,942 [INFO] - Hook registered for features.8
2025-04-29 17:21:56,942 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-04-29 17:21:56,959 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-04-29 17:21:56,959 [INFO] - Hook registered for inception.Mixed_7c
2025-04-29 17:21:56,959 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-04-29 17:21:56,976 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-04-29 17:21:56,976 [INFO] - Hook registered for features
2025-04-29 17:21:56,976 [INFO] - Feature extractor registered for mobilenet at layer features
2025-04-29 17:21:57,000 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-04-29 17:21:57,002 [INFO] - Hook registered for layer4
2025-04-29 17:21:57,003 [INFO] - Feature extractor registered for resnet at layer layer4
2025-04-29 17:21:57,013 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-04-29 17:21:57,013 [INFO] - Hook registered for features
2025-04-29 17:21:57,013 [INFO] - Feature extractor registered for densenet at layer features
2025-04-29 17:21:57,035 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-04-29 17:21:57,042 [INFO] - Hook registered for features.8
2025-04-29 17:21:57,042 [INFO] - Feature extractor registered for student at layer features.8
2025-04-29 17:21:57,052 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-04-29 17:21:57,192 [INFO] - HFI module initialized with 6 teachers
2025-04-29 17:21:57,193 [INFO] - Target student feature shape: torch.Size([1, 1280, 7, 7])
2025-04-29 17:21:57,242 [INFO] - Using learning rate 5e-05 for vit
2025-04-29 17:21:57,246 [INFO] - Using 16 gradient accumulation steps for ViT
2025-04-29 17:21:57,246 [INFO] - Using learning rate 0.001 for efficientnet
2025-04-29 17:21:57,246 [INFO] - Using learning rate 0.001 for inception
2025-04-29 17:21:57,246 [INFO] - Using learning rate 0.0015 for mobilenet
2025-04-29 17:21:57,246 [INFO] - Using learning rate 0.001 for resnet
2025-04-29 17:21:57,246 [INFO] - Using learning rate 0.0008 for densenet
2025-04-29 17:21:57,254 [INFO] - Using learning rate 0.002 for student
2025-04-29 17:21:57,254 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250429_172157_config.json
2025-04-29 17:21:57,254 [INFO] - Mutual Learning Epoch 1/50
2025-04-29 17:21:57,259 [INFO] - Mutual weight: 0.0200, Calibration weight: 0.0067, Feature weight: 0.0033
2025-04-29 17:21:57,259 [INFO] - Current temperatures: {'vit': 4.118149757385254, 'efficientnet': 4.118149757385254, 'inception': 5.106715202331543, 'mobilenet': 4.118149757385254, 'resnet': 4.118149757385254, 'densenet': 4.118149757385254, 'student': 3.148587226867676}
2025-04-29 17:21:57,426 [INFO] - GPU cache cleared: 642.14MB → 642.14MB (freed 0.00MB)
2025-04-29 17:21:57,437 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:57,437 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:57,437 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:57,437 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:57,437 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:57,437 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:57,437 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:57,447 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:57,447 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:57,447 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:57,447 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:57,455 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:57,455 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:57,455 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-29 17:21:57,455 [WARNING] - No validation data was processed. Check your data loading.
2025-04-29 17:21:57,455 [ERROR] - An error occurred: float division by zero
2025-04-29 17:21:57,459 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_14604\3196668440.py", line 2688, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_14604\3196668440.py", line 2202, in mutual_learning_phase
    train_acc = 100. * train_correct[name] / train_total[name]
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-04-30 12:15:00,440 [INFO] - Using device: cuda
2025-04-30 12:15:00,446 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-30 12:15:00,447 [INFO] - GPU Memory: 6.00 GB
2025-04-30 12:15:00,447 [INFO] - CUDA Version: 12.4
2025-04-30 12:15:00,567 [INFO] - cuDNN benchmark mode enabled
2025-04-30 12:15:00,585 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 100,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": true,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-30 12:15:00,657 [INFO] - Random seed set to 42
2025-04-30 12:15:00,657 [INFO] - Preparing data loaders...
2025-04-30 12:15:10,121 [INFO] - Training samples: 45000 per model
2025-04-30 12:15:10,123 [INFO] - Validation samples: 5000 per model
2025-04-30 12:15:10,123 [INFO] - Test samples: 10000 per model
2025-04-30 12:15:10,123 [INFO] - Creating models for mutual learning...
2025-04-30 12:15:10,125 [INFO] - Loading ViT-B16 model...
2025-04-30 12:15:11,166 [INFO] - Loading EfficientNetB0 model...
2025-04-30 12:15:11,296 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-30 12:15:11,679 [INFO] - Loading MobileNetV3-Large model...
2025-04-30 12:15:11,804 [INFO] - Loading ResNet50 model...
2025-04-30 12:15:12,222 [INFO] - Loading DenseNet121 model...
2025-04-30 12:15:12,396 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-30 12:15:12,491 [INFO] - Loading pre-trained weights for vit from C:\Users\Gading\Downloads\Research\Models\ViT\checkpoints\vit_b16_teacher_20250321_053628_best.pth
2025-04-30 12:15:14,616 [INFO] - Successfully loaded pre-trained weights for vit
2025-04-30 12:15:14,616 [INFO] - Loading pre-trained weights for efficientnet from C:\Users\Gading\Downloads\Research\Models\EfficientNetB0\checkpoints\efficientnet_b0_teacher_20250325_132652_best.pth
2025-04-30 12:15:14,906 [INFO] - Successfully loaded pre-trained weights for efficientnet
2025-04-30 12:15:14,907 [INFO] - Loading pre-trained weights for inception from C:\Users\Gading\Downloads\Research\Models\InceptionV3\checkpoints\inception_v3_teacher_20250321_153825_best.pth
2025-04-30 12:15:15,516 [ERROR] - Error loading weights for inception: Error(s) in loading state_dict for Inception3:
	size mismatch for AuxLogits.fc.weight: copying a param with shape torch.Size([1000, 768]) from checkpoint, the shape in current model is torch.Size([10, 768]).
	size mismatch for AuxLogits.fc.bias: copying a param with shape torch.Size([1000]) from checkpoint, the shape in current model is torch.Size([10]).
2025-04-30 12:15:15,516 [INFO] - Loading pre-trained weights for mobilenet from C:\Users\Gading\Downloads\Research\Models\MobileNetV3\checkpoints\mobilenetv3_20250326_035725_best.pth
2025-04-30 12:15:15,750 [INFO] - Successfully loaded pre-trained weights for mobilenet
2025-04-30 12:15:15,750 [INFO] - Loading pre-trained weights for resnet from C:\Users\Gading\Downloads\Research\Models\ResNet50\checkpoints\resnet50_teacher_20250322_225032_best.pth
2025-04-30 12:15:16,256 [INFO] - Successfully loaded pre-trained weights for resnet
2025-04-30 12:15:16,256 [INFO] - Loading pre-trained weights for densenet from C:\Users\Gading\Downloads\Research\Models\DenseNet121\checkpoints\densenet121_teacher_20250325_160534_best.pth
2025-04-30 12:15:16,708 [INFO] - Successfully loaded pre-trained weights for densenet
2025-04-30 12:15:16,841 [INFO] - Model vit moved to cuda
2025-04-30 12:15:16,869 [INFO] - Model efficientnet moved to cuda
2025-04-30 12:15:16,948 [INFO] - Model inception moved to cuda
2025-04-30 12:15:16,976 [INFO] - Model mobilenet moved to cuda
2025-04-30 12:15:17,034 [INFO] - Model resnet moved to cuda
2025-04-30 12:15:17,100 [INFO] - Model densenet moved to cuda
2025-04-30 12:15:17,136 [INFO] - Model student moved to cuda
2025-04-30 12:15:17,139 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-30 12:15:17,142 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-30 12:15:17,143 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-30 12:15:17,145 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-30 12:15:17,147 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-30 12:15:17,149 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-30 12:15:17,150 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-30 12:15:17,155 [INFO] - Starting initialization phase...
2025-04-30 12:15:17,161 [INFO] - Initialization Epoch 1/5
2025-04-30 12:15:17,325 [INFO] - GPU cache cleared: 590.57MB → 590.57MB (freed 0.00MB)
2025-04-30 12:15:17,337 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,337 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,338 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,338 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,338 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,338 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,338 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,351 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,351 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,351 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,351 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,351 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,351 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,355 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,357 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,357 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,362 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,364 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,364 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,365 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,367 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,369 [INFO] - Initialization epoch 1 completed in 0.21s
2025-04-30 12:15:17,370 [INFO] - Initialization Epoch 2/5
2025-04-30 12:15:17,524 [INFO] - GPU cache cleared: 590.57MB → 590.57MB (freed 0.00MB)
2025-04-30 12:15:17,532 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,534 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,535 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,536 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,536 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,536 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,536 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,546 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,546 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,549 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,549 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,551 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,551 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,552 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,553 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,553 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,553 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,555 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,557 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,558 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,560 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,560 [INFO] - Initialization epoch 2 completed in 0.19s
2025-04-30 12:15:17,562 [INFO] - Initialization Epoch 3/5
2025-04-30 12:15:17,716 [INFO] - GPU cache cleared: 590.57MB → 590.57MB (freed 0.00MB)
2025-04-30 12:15:17,725 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,727 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,727 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,727 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,727 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,727 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,727 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,739 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,740 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,740 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,740 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,740 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,740 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,740 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,740 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,744 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,745 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,747 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,747 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,747 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,747 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,751 [INFO] - Initialization epoch 3 completed in 0.19s
2025-04-30 12:15:17,753 [INFO] - Initialization Epoch 4/5
2025-04-30 12:15:17,904 [INFO] - GPU cache cleared: 590.57MB → 590.57MB (freed 0.00MB)
2025-04-30 12:15:17,913 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,913 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,913 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,915 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,915 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,915 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,916 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,927 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,928 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,928 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,929 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,929 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,930 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,930 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:17,931 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,932 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,933 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,935 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,937 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,937 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,938 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:17,940 [INFO] - Initialization epoch 4 completed in 0.19s
2025-04-30 12:15:17,941 [INFO] - Initialization Epoch 5/5
2025-04-30 12:15:18,093 [INFO] - GPU cache cleared: 590.57MB → 590.57MB (freed 0.00MB)
2025-04-30 12:15:18,103 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:18,103 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:18,103 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:18,104 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:18,105 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:18,106 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:18,106 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:18,116 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:18,116 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:18,116 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:18,119 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:18,120 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:18,122 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:18,122 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:18,122 [INFO] -   vit: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:18,125 [INFO] -   efficientnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:18,127 [INFO] -   inception: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:18,128 [INFO] -   mobilenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:18,130 [INFO] -   resnet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:18,131 [INFO] -   densenet: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:18,133 [INFO] -   student: Train Loss=0.0000, Train Acc=0.00%, Val Loss=0.0000, Val Acc=0.00%
2025-04-30 12:15:18,135 [INFO] - Initialization epoch 5 completed in 0.19s
2025-04-30 12:15:18,136 [INFO] - Initialization phase completed
2025-04-30 12:15:18,138 [INFO] - Starting mutual learning phase...
2025-04-30 12:15:18,138 [INFO] - Hook registered for encoder.ln
2025-04-30 12:15:18,138 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-04-30 12:15:18,675 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-04-30 12:15:18,676 [INFO] - Hook registered for features.8
2025-04-30 12:15:18,676 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-04-30 12:15:19,066 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-04-30 12:15:19,067 [INFO] - Hook registered for inception.Mixed_7c
2025-04-30 12:15:19,068 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-04-30 12:15:19,561 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-04-30 12:15:19,561 [INFO] - Hook registered for features
2025-04-30 12:15:19,561 [INFO] - Feature extractor registered for mobilenet at layer features
2025-04-30 12:15:19,698 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-04-30 12:15:19,705 [INFO] - Hook registered for layer4
2025-04-30 12:15:19,705 [INFO] - Feature extractor registered for resnet at layer layer4
2025-04-30 12:15:19,895 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-04-30 12:15:19,896 [INFO] - Hook registered for features
2025-04-30 12:15:19,897 [INFO] - Feature extractor registered for densenet at layer features
2025-04-30 12:15:20,237 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-04-30 12:15:20,237 [INFO] - Hook registered for features.8
2025-04-30 12:15:20,237 [INFO] - Feature extractor registered for student at layer features.8
2025-04-30 12:15:20,256 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-04-30 12:15:20,625 [INFO] - HFI module initialized with 6 teachers
2025-04-30 12:15:20,626 [INFO] - Target student feature shape: torch.Size([1, 1280, 7, 7])
2025-04-30 12:15:20,673 [INFO] - Using learning rate 0.0003 for vit
2025-04-30 12:15:20,673 [INFO] - Using 16 gradient accumulation steps for ViT
2025-04-30 12:15:20,675 [INFO] - Using learning rate 0.001 for efficientnet
2025-04-30 12:15:20,676 [INFO] - Using learning rate 0.001 for inception
2025-04-30 12:15:20,676 [INFO] - Using learning rate 0.0015 for mobilenet
2025-04-30 12:15:20,676 [INFO] - Using learning rate 0.001 for resnet
2025-04-30 12:15:20,676 [INFO] - Using learning rate 0.0008 for densenet
2025-04-30 12:15:20,676 [INFO] - Using learning rate 0.002 for student
2025-04-30 12:15:20,684 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250430_121520_config.json
2025-04-30 12:15:20,684 [INFO] - Mutual Learning Epoch 1/50
2025-04-30 12:15:20,685 [INFO] - Mutual weight: 0.0200, Calibration weight: 0.0067, Feature weight: 0.0033
2025-04-30 12:15:20,700 [INFO] - Current temperatures: {'vit': 4.118149757385254, 'efficientnet': 4.118149757385254, 'inception': 5.106715202331543, 'mobilenet': 4.118149757385254, 'resnet': 4.118149757385254, 'densenet': 4.118149757385254, 'student': 3.148587226867676}
2025-04-30 12:15:20,853 [INFO] - GPU cache cleared: 637.28MB → 637.28MB (freed 0.00MB)
2025-04-30 12:15:20,863 [WARNING] - Skipping batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:20,863 [WARNING] - Skipping batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:20,865 [WARNING] - Skipping batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:20,865 [WARNING] - Skipping batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:20,866 [WARNING] - Skipping batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:20,867 [WARNING] - Skipping batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:20,867 [WARNING] - Skipping batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:20,877 [WARNING] - Skipping validation batch 0: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:20,877 [WARNING] - Skipping validation batch 1: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:20,877 [WARNING] - Skipping validation batch 2: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:20,877 [WARNING] - Skipping validation batch 3: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:20,877 [WARNING] - Skipping validation batch 4: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:20,877 [WARNING] - Skipping validation batch 5: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:20,877 [WARNING] - Skipping validation batch 6: inputs or targets are not tensors (types: <class 'NoneType'>, <class 'NoneType'>)
2025-04-30 12:15:20,883 [WARNING] - No validation data was processed. Check your data loading.
2025-04-30 12:15:20,886 [ERROR] - An error occurred: float division by zero
2025-04-30 12:15:20,887 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_23120\523268848.py", line 2688, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_23120\523268848.py", line 2202, in mutual_learning_phase
    train_acc = 100. * train_correct[name] / train_total[name]
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~
ZeroDivisionError: float division by zero

2025-04-30 17:17:14,789 [INFO] - Using device: cuda
2025-04-30 17:17:14,796 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-30 17:17:14,796 [INFO] - GPU Memory: 6.00 GB
2025-04-30 17:17:14,797 [INFO] - CUDA Version: 12.4
2025-04-30 17:17:14,876 [INFO] - cuDNN benchmark mode enabled
2025-04-30 17:17:14,889 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 100,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": true,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-30 17:17:14,968 [INFO] - Random seed set to 42
2025-04-30 17:17:14,968 [INFO] - Preparing data loaders...
2025-04-30 17:17:24,391 [INFO] - Training samples: 45000 per model
2025-04-30 17:17:24,391 [INFO] - Validation samples: 5000 per model
2025-04-30 17:17:24,391 [INFO] - Test samples: 10000 per model
2025-04-30 17:17:24,399 [INFO] - Creating models for mutual learning...
2025-04-30 17:17:24,399 [INFO] - Loading ViT-B16 model...
2025-04-30 17:17:25,381 [INFO] - Loading EfficientNetB0 model...
2025-04-30 17:17:25,561 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-30 17:17:25,936 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-04-30 17:17:25,938 [INFO] - Loading MobileNetV3-Large model...
2025-04-30 17:17:26,046 [INFO] - Loading ResNet50 model...
2025-04-30 17:17:26,470 [INFO] - Loading DenseNet121 model...
2025-04-30 17:17:26,639 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-30 17:17:26,732 [INFO] - Loading pre-trained weights for vit from C:\Users\Gading\Downloads\Research\Models\ViT\checkpoints\vit_b16_teacher_20250321_053628_best.pth
2025-04-30 17:17:28,759 [INFO] - Successfully loaded pre-trained weights for vit
2025-04-30 17:17:28,765 [INFO] - Loading pre-trained weights for efficientnet from C:\Users\Gading\Downloads\Research\Models\EfficientNetB0\checkpoints\efficientnet_b0_teacher_20250325_132652_best.pth
2025-04-30 17:17:29,075 [INFO] - Successfully loaded pre-trained weights for efficientnet
2025-04-30 17:17:29,075 [INFO] - Loading pre-trained weights for inception from C:\Users\Gading\Downloads\Research\Models\InceptionV3\checkpoints\inception_v3_teacher_20250321_153825_best.pth
2025-04-30 17:17:29,700 [ERROR] - Error loading weights for inception: Error(s) in loading state_dict for Inception3:
	size mismatch for AuxLogits.fc.weight: copying a param with shape torch.Size([1000, 768]) from checkpoint, the shape in current model is torch.Size([10, 768]).
	size mismatch for AuxLogits.fc.bias: copying a param with shape torch.Size([1000]) from checkpoint, the shape in current model is torch.Size([10]).
2025-04-30 17:17:29,706 [INFO] - Loading pre-trained weights for mobilenet from C:\Users\Gading\Downloads\Research\Models\MobileNetV3\checkpoints\mobilenetv3_20250326_035725_best.pth
2025-04-30 17:17:29,942 [INFO] - Successfully loaded pre-trained weights for mobilenet
2025-04-30 17:17:29,942 [INFO] - Loading pre-trained weights for resnet from C:\Users\Gading\Downloads\Research\Models\ResNet50\checkpoints\resnet50_teacher_20250322_225032_best.pth
2025-04-30 17:17:30,471 [INFO] - Successfully loaded pre-trained weights for resnet
2025-04-30 17:17:30,471 [INFO] - Loading pre-trained weights for densenet from C:\Users\Gading\Downloads\Research\Models\DenseNet121\checkpoints\densenet121_teacher_20250325_160534_best.pth
2025-04-30 17:17:30,957 [INFO] - Successfully loaded pre-trained weights for densenet
2025-04-30 17:17:31,093 [INFO] - Model vit moved to cuda
2025-04-30 17:17:31,117 [INFO] - Model efficientnet moved to cuda
2025-04-30 17:17:31,193 [INFO] - Model inception moved to cuda
2025-04-30 17:17:31,213 [INFO] - Model mobilenet moved to cuda
2025-04-30 17:17:31,268 [INFO] - Model resnet moved to cuda
2025-04-30 17:17:31,323 [INFO] - Model densenet moved to cuda
2025-04-30 17:17:31,348 [INFO] - Model student moved to cuda
2025-04-30 17:17:31,352 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-30 17:17:31,354 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-30 17:17:31,356 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-30 17:17:31,357 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-30 17:17:31,358 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-30 17:17:31,361 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-30 17:17:31,361 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-30 17:17:31,366 [INFO] - Starting initialization phase...
2025-04-30 17:17:31,366 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-04-30 17:17:31,366 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-04-30 17:17:31,371 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-04-30 17:17:31,372 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-04-30 17:17:31,374 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-04-30 17:17:31,375 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-04-30 17:17:31,377 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-04-30 17:17:31,378 [INFO] - Initialization Epoch 1/5
2025-04-30 17:17:49,407 [ERROR] - An error occurred: autocast.__init__() missing 1 required positional argument: 'device_type'
2025-04-30 17:17:49,408 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_18460\1665293863.py", line 2719, in main
    models = initialization_phase(models, train_loader, val_loader, config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_18460\1665293863.py", line 1739, in initialization_phase
    with autocast(enabled=config.use_amp, dtype=torch.float16 if config.mixed_precision_dtype == 'float16' else torch.bfloat16):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: autocast.__init__() missing 1 required positional argument: 'device_type'

2025-04-30 17:25:47,621 [INFO] - Using device: cuda
2025-04-30 17:25:47,621 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-30 17:25:47,621 [INFO] - GPU Memory: 6.00 GB
2025-04-30 17:25:47,621 [INFO] - CUDA Version: 12.4
2025-04-30 17:25:47,621 [INFO] - cuDNN benchmark mode enabled
2025-04-30 17:25:47,641 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 100,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": true,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-30 17:25:47,643 [INFO] - Random seed set to 42
2025-04-30 17:25:47,644 [INFO] - Preparing data loaders...
2025-04-30 17:25:55,896 [INFO] - Training samples: 45000 per model
2025-04-30 17:25:55,901 [INFO] - Validation samples: 5000 per model
2025-04-30 17:25:55,901 [INFO] - Test samples: 10000 per model
2025-04-30 17:25:55,901 [INFO] - Creating models for mutual learning...
2025-04-30 17:25:55,901 [INFO] - Loading ViT-B16 model...
2025-04-30 17:25:56,815 [INFO] - Loading EfficientNetB0 model...
2025-04-30 17:25:56,952 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-30 17:25:57,298 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-04-30 17:25:57,300 [INFO] - Loading MobileNetV3-Large model...
2025-04-30 17:25:57,402 [INFO] - Loading ResNet50 model...
2025-04-30 17:25:57,771 [INFO] - Loading DenseNet121 model...
2025-04-30 17:25:57,932 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-30 17:25:58,031 [INFO] - Loading pre-trained weights for vit from C:\Users\Gading\Downloads\Research\Models\ViT\checkpoints\vit_b16_teacher_20250321_053628_best.pth
2025-04-30 17:26:00,003 [INFO] - Successfully loaded pre-trained weights for vit
2025-04-30 17:26:00,003 [INFO] - Loading pre-trained weights for efficientnet from C:\Users\Gading\Downloads\Research\Models\EfficientNetB0\checkpoints\efficientnet_b0_teacher_20250325_132652_best.pth
2025-04-30 17:26:00,409 [INFO] - Successfully loaded pre-trained weights for efficientnet
2025-04-30 17:26:00,409 [INFO] - Loading pre-trained weights for inception from C:\Users\Gading\Downloads\Research\Models\InceptionV3\checkpoints\inception_v3_teacher_20250321_153825_best.pth
2025-04-30 17:26:00,931 [ERROR] - Error loading weights for inception: Error(s) in loading state_dict for Inception3:
	size mismatch for AuxLogits.fc.weight: copying a param with shape torch.Size([1000, 768]) from checkpoint, the shape in current model is torch.Size([10, 768]).
	size mismatch for AuxLogits.fc.bias: copying a param with shape torch.Size([1000]) from checkpoint, the shape in current model is torch.Size([10]).
2025-04-30 17:26:00,931 [INFO] - Loading pre-trained weights for mobilenet from C:\Users\Gading\Downloads\Research\Models\MobileNetV3\checkpoints\mobilenetv3_20250326_035725_best.pth
2025-04-30 17:26:01,159 [INFO] - Successfully loaded pre-trained weights for mobilenet
2025-04-30 17:26:01,161 [INFO] - Loading pre-trained weights for resnet from C:\Users\Gading\Downloads\Research\Models\ResNet50\checkpoints\resnet50_teacher_20250322_225032_best.pth
2025-04-30 17:26:01,671 [INFO] - Successfully loaded pre-trained weights for resnet
2025-04-30 17:26:01,676 [INFO] - Loading pre-trained weights for densenet from C:\Users\Gading\Downloads\Research\Models\DenseNet121\checkpoints\densenet121_teacher_20250325_160534_best.pth
2025-04-30 17:26:02,110 [INFO] - Successfully loaded pre-trained weights for densenet
2025-04-30 17:26:02,241 [INFO] - Model vit moved to cuda
2025-04-30 17:26:02,284 [INFO] - Model efficientnet moved to cuda
2025-04-30 17:26:02,346 [INFO] - Model inception moved to cuda
2025-04-30 17:26:02,385 [INFO] - Model mobilenet moved to cuda
2025-04-30 17:26:02,434 [INFO] - Model resnet moved to cuda
2025-04-30 17:26:02,475 [INFO] - Model densenet moved to cuda
2025-04-30 17:26:02,509 [INFO] - Model student moved to cuda
2025-04-30 17:26:02,510 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-30 17:26:02,512 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-30 17:26:02,514 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-30 17:26:02,516 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-30 17:26:02,517 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-30 17:26:02,520 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-30 17:26:02,521 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-30 17:26:02,525 [INFO] - Starting initialization phase...
2025-04-30 17:26:02,527 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-04-30 17:26:02,528 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-04-30 17:26:02,530 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-04-30 17:26:02,531 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-04-30 17:26:02,532 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-04-30 17:26:02,534 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-04-30 17:26:02,536 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-04-30 17:26:02,536 [INFO] - Initialization Epoch 1/5
2025-04-30 17:26:42,968 [INFO] - GPU cache cleared: 1618.05MB → 1618.05MB (freed 0.00MB)
2025-04-30 17:27:06,498 [INFO] - GPU cache cleared: 1616.40MB → 1616.40MB (freed 0.00MB)
2025-04-30 17:27:30,342 [INFO] - GPU cache cleared: 1280.18MB → 1280.18MB (freed 0.00MB)
2025-04-30 17:27:54,624 [INFO] - GPU cache cleared: 1616.46MB → 1616.46MB (freed 0.00MB)
2025-04-30 17:28:19,546 [INFO] - GPU cache cleared: 1614.46MB → 1614.46MB (freed 0.00MB)
2025-04-30 17:28:44,488 [INFO] - GPU cache cleared: 1280.18MB → 1280.18MB (freed 0.00MB)
2025-04-30 17:29:09,538 [INFO] - GPU cache cleared: 1616.46MB → 1616.46MB (freed 0.00MB)
2025-04-30 17:29:34,636 [INFO] - GPU cache cleared: 1614.46MB → 1614.46MB (freed 0.00MB)
2025-04-30 17:29:59,774 [INFO] - GPU cache cleared: 1280.18MB → 1280.18MB (freed 0.00MB)
2025-04-30 17:30:24,951 [INFO] - GPU cache cleared: 1616.46MB → 1616.46MB (freed 0.00MB)
2025-04-30 17:30:50,042 [INFO] - GPU cache cleared: 1614.46MB → 1614.46MB (freed 0.00MB)
2025-04-30 17:31:15,321 [INFO] - GPU cache cleared: 1280.18MB → 1280.18MB (freed 0.00MB)
2025-04-30 17:31:40,532 [INFO] - GPU cache cleared: 1616.46MB → 1616.46MB (freed 0.00MB)
2025-04-30 17:32:05,773 [INFO] - GPU cache cleared: 1614.46MB → 1614.46MB (freed 0.00MB)
2025-04-30 17:32:42,016 [INFO] - GPU cache cleared: 1346.88MB → 1346.88MB (freed 0.00MB)
2025-04-30 17:32:53,476 [INFO] - GPU cache cleared: 1346.75MB → 1346.75MB (freed 0.00MB)
2025-04-30 17:33:05,131 [INFO] - GPU cache cleared: 1331.27MB → 1331.27MB (freed 0.00MB)
2025-04-30 17:33:16,800 [INFO] - GPU cache cleared: 1346.75MB → 1346.75MB (freed 0.00MB)
2025-04-30 17:33:28,679 [INFO] - GPU cache cleared: 1346.75MB → 1346.75MB (freed 0.00MB)
2025-04-30 17:33:40,437 [INFO] - GPU cache cleared: 1331.27MB → 1331.27MB (freed 0.00MB)
2025-04-30 17:33:52,231 [INFO] - GPU cache cleared: 1346.75MB → 1346.75MB (freed 0.00MB)
2025-04-30 17:34:37,378 [INFO] - GPU cache cleared: 1608.91MB → 1608.91MB (freed 0.00MB)
2025-04-30 17:34:59,505 [INFO] - GPU cache cleared: 1523.22MB → 1523.22MB (freed 0.00MB)
2025-04-30 17:35:51,417 [INFO] - Using device: cuda
2025-04-30 17:35:51,417 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-30 17:35:51,417 [INFO] - GPU Memory: 6.00 GB
2025-04-30 17:35:51,417 [INFO] - CUDA Version: 12.4
2025-04-30 17:35:51,497 [INFO] - cuDNN benchmark mode enabled
2025-04-30 17:35:51,515 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 100,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-30 17:35:51,582 [INFO] - Random seed set to 42
2025-04-30 17:35:51,582 [INFO] - Preparing data loaders...
2025-04-30 17:35:59,832 [INFO] - Training samples: 45000 per model
2025-04-30 17:35:59,832 [INFO] - Validation samples: 5000 per model
2025-04-30 17:35:59,834 [INFO] - Test samples: 10000 per model
2025-04-30 17:35:59,834 [INFO] - Creating models for mutual learning...
2025-04-30 17:35:59,834 [INFO] - Loading ViT-B16 model...
2025-04-30 17:36:00,743 [INFO] - Loading EfficientNetB0 model...
2025-04-30 17:36:00,892 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-30 17:36:01,310 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-04-30 17:36:01,312 [INFO] - Loading MobileNetV3-Large model...
2025-04-30 17:36:01,437 [INFO] - Loading ResNet50 model...
2025-04-30 17:36:01,826 [INFO] - Loading DenseNet121 model...
2025-04-30 17:36:02,003 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-30 17:36:02,320 [INFO] - Model vit moved to cuda
2025-04-30 17:36:02,336 [INFO] - Model efficientnet moved to cuda
2025-04-30 17:36:02,386 [INFO] - Model inception moved to cuda
2025-04-30 17:36:02,402 [INFO] - Model mobilenet moved to cuda
2025-04-30 17:36:02,452 [INFO] - Model resnet moved to cuda
2025-04-30 17:36:02,498 [INFO] - Model densenet moved to cuda
2025-04-30 17:36:02,511 [INFO] - Model student moved to cuda
2025-04-30 17:36:02,518 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-30 17:36:02,522 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-30 17:36:02,522 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-30 17:36:02,526 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-30 17:36:02,527 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-30 17:36:02,530 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-30 17:36:02,532 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-30 17:36:02,533 [INFO] - Starting initialization phase...
2025-04-30 17:36:02,533 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-04-30 17:36:02,537 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-04-30 17:36:02,540 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-04-30 17:36:02,542 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-04-30 17:36:02,543 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-04-30 17:36:02,545 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-04-30 17:36:02,546 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-04-30 17:36:02,547 [INFO] - Initialization Epoch 1/5
2025-04-30 17:36:42,420 [INFO] - GPU cache cleared: 1619.73MB → 1619.73MB (freed 0.00MB)
2025-04-30 17:37:05,960 [INFO] - GPU cache cleared: 1619.19MB → 1619.19MB (freed 0.00MB)
2025-04-30 17:37:30,301 [INFO] - GPU cache cleared: 1281.99MB → 1281.99MB (freed 0.00MB)
2025-04-30 17:37:55,041 [INFO] - GPU cache cleared: 1619.19MB → 1619.19MB (freed 0.00MB)
2025-04-30 17:38:19,906 [INFO] - GPU cache cleared: 1618.18MB → 1618.18MB (freed 0.00MB)
2025-04-30 17:38:44,922 [INFO] - GPU cache cleared: 1281.99MB → 1281.99MB (freed 0.00MB)
2025-04-30 17:39:09,875 [INFO] - GPU cache cleared: 1619.19MB → 1619.19MB (freed 0.00MB)
2025-04-30 17:39:35,008 [INFO] - GPU cache cleared: 1618.18MB → 1618.18MB (freed 0.00MB)
2025-04-30 17:40:00,210 [INFO] - GPU cache cleared: 1281.99MB → 1281.99MB (freed 0.00MB)
2025-04-30 17:40:25,359 [INFO] - GPU cache cleared: 1619.19MB → 1619.19MB (freed 0.00MB)
2025-04-30 17:40:50,443 [INFO] - GPU cache cleared: 1618.18MB → 1618.18MB (freed 0.00MB)
2025-04-30 17:41:15,693 [INFO] - GPU cache cleared: 1281.99MB → 1281.99MB (freed 0.00MB)
2025-04-30 17:41:40,802 [INFO] - GPU cache cleared: 1619.19MB → 1619.19MB (freed 0.00MB)
2025-04-30 17:42:05,963 [INFO] - GPU cache cleared: 1618.18MB → 1618.18MB (freed 0.00MB)
2025-04-30 17:42:40,947 [INFO] - GPU cache cleared: 1348.04MB → 1348.04MB (freed 0.00MB)
2025-04-30 17:42:52,392 [INFO] - GPU cache cleared: 1348.22MB → 1348.22MB (freed 0.00MB)
2025-04-30 17:43:03,964 [INFO] - GPU cache cleared: 1332.52MB → 1332.52MB (freed 0.00MB)
2025-04-30 17:43:15,623 [INFO] - GPU cache cleared: 1348.22MB → 1348.22MB (freed 0.00MB)
2025-04-30 17:43:27,322 [INFO] - GPU cache cleared: 1348.14MB → 1348.14MB (freed 0.00MB)
2025-04-30 17:43:39,014 [INFO] - GPU cache cleared: 1332.52MB → 1332.52MB (freed 0.00MB)
2025-04-30 17:43:50,750 [INFO] - GPU cache cleared: 1348.22MB → 1348.22MB (freed 0.00MB)
2025-04-30 17:44:35,906 [INFO] - GPU cache cleared: 1610.92MB → 1610.92MB (freed 0.00MB)
2025-04-30 17:44:58,122 [INFO] - GPU cache cleared: 1525.95MB → 1525.95MB (freed 0.00MB)
2025-04-30 17:45:20,795 [INFO] - GPU cache cleared: 1611.47MB → 1611.47MB (freed 0.00MB)
2025-04-30 17:45:43,338 [INFO] - GPU cache cleared: 1525.95MB → 1525.95MB (freed 0.00MB)
2025-04-30 17:46:06,067 [INFO] - GPU cache cleared: 1611.47MB → 1611.47MB (freed 0.00MB)
2025-04-30 17:46:28,696 [INFO] - GPU cache cleared: 1525.95MB → 1525.95MB (freed 0.00MB)
2025-04-30 17:46:51,451 [INFO] - GPU cache cleared: 1611.47MB → 1611.47MB (freed 0.00MB)
2025-04-30 17:47:14,201 [INFO] - GPU cache cleared: 1525.95MB → 1525.95MB (freed 0.00MB)
2025-04-30 17:47:36,877 [INFO] - GPU cache cleared: 1611.47MB → 1611.47MB (freed 0.00MB)
2025-04-30 17:48:18,562 [INFO] - GPU cache cleared: 1563.30MB → 1563.30MB (freed 0.00MB)
2025-04-30 17:48:29,053 [INFO] - GPU cache cleared: 1563.30MB → 1563.30MB (freed 0.00MB)
2025-04-30 17:48:39,639 [INFO] - GPU cache cleared: 1563.30MB → 1563.30MB (freed 0.00MB)
2025-04-30 17:48:50,334 [INFO] - GPU cache cleared: 1563.30MB → 1563.30MB (freed 0.00MB)
2025-04-30 17:49:22,687 [ERROR] - An error occurred: CUDA out of memory. Tried to allocate 14.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 393.89 MiB is free. 4.50 GiB allowed; Of the allocated memory 4.43 GiB is allocated by PyTorch, and 58.75 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-04-30 17:49:22,705 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_13524\788914719.py", line 2719, in main
    models = initialization_phase(models, train_loader, val_loader, config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_13524\788914719.py", line 1740, in initialization_phase
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\resnet.py", line 276, in _forward_impl
    x = self.layer4(x)
        ^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\resnet.py", line 155, in forward
    out = self.bn3(out)
          ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\functional.py", line 2812, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 14.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 393.89 MiB is free. 4.50 GiB allowed; Of the allocated memory 4.43 GiB is allocated by PyTorch, and 58.75 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-04-30 18:23:59,051 [INFO] - Using device: cuda
2025-04-30 18:23:59,051 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-30 18:23:59,051 [INFO] - GPU Memory: 6.00 GB
2025-04-30 18:23:59,051 [INFO] - CUDA Version: 12.4
2025-04-30 18:23:59,051 [INFO] - cuDNN benchmark mode enabled
2025-04-30 18:23:59,067 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 25,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": true,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-30 18:23:59,084 [INFO] - Random seed set to 42
2025-04-30 18:23:59,084 [INFO] - Preparing data loaders...
2025-04-30 18:24:07,308 [INFO] - Training samples: 45000 per model
2025-04-30 18:24:07,308 [INFO] - Validation samples: 5000 per model
2025-04-30 18:24:07,308 [INFO] - Test samples: 10000 per model
2025-04-30 18:24:07,308 [INFO] - Creating models for mutual learning...
2025-04-30 18:24:07,308 [INFO] - Loading ViT-B16 model...
2025-04-30 18:24:08,914 [INFO] - Loading EfficientNetB0 model...
2025-04-30 18:24:09,049 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-30 18:24:09,428 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-04-30 18:24:09,428 [INFO] - Loading MobileNetV3-Large model...
2025-04-30 18:24:09,547 [INFO] - Loading ResNet50 model...
2025-04-30 18:24:09,904 [INFO] - Loading DenseNet121 model...
2025-04-30 18:24:10,262 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-30 18:24:10,361 [INFO] - Loading pre-trained weights for vit from C:\Users\Gading\Downloads\Research\Models\ViT\checkpoints\vit_b16_teacher_20250321_053628_best.pth
2025-04-30 18:24:12,397 [INFO] - Successfully loaded pre-trained weights for vit
2025-04-30 18:24:12,397 [INFO] - Loading pre-trained weights for efficientnet from C:\Users\Gading\Downloads\Research\Models\EfficientNetB0\checkpoints\efficientnet_b0_teacher_20250325_132652_best.pth
2025-04-30 18:24:12,593 [INFO] - Successfully loaded pre-trained weights for efficientnet
2025-04-30 18:24:12,593 [INFO] - Loading pre-trained weights for inception from C:\Users\Gading\Downloads\Research\Models\InceptionV3\checkpoints\inception_v3_teacher_20250321_153825_best.pth
2025-04-30 18:24:13,035 [ERROR] - Error loading weights for inception: Error(s) in loading state_dict for Inception3:
	size mismatch for AuxLogits.fc.weight: copying a param with shape torch.Size([1000, 768]) from checkpoint, the shape in current model is torch.Size([10, 768]).
	size mismatch for AuxLogits.fc.bias: copying a param with shape torch.Size([1000]) from checkpoint, the shape in current model is torch.Size([10]).
2025-04-30 18:24:13,046 [INFO] - Loading pre-trained weights for mobilenet from C:\Users\Gading\Downloads\Research\Models\MobileNetV3\checkpoints\mobilenetv3_20250326_035725_best.pth
2025-04-30 18:24:13,229 [INFO] - Successfully loaded pre-trained weights for mobilenet
2025-04-30 18:24:13,229 [INFO] - Loading pre-trained weights for resnet from C:\Users\Gading\Downloads\Research\Models\ResNet50\checkpoints\resnet50_teacher_20250322_225032_best.pth
2025-04-30 18:24:13,655 [INFO] - Successfully loaded pre-trained weights for resnet
2025-04-30 18:24:13,655 [INFO] - Loading pre-trained weights for densenet from C:\Users\Gading\Downloads\Research\Models\DenseNet121\checkpoints\densenet121_teacher_20250325_160534_best.pth
2025-04-30 18:24:14,032 [INFO] - Successfully loaded pre-trained weights for densenet
2025-04-30 18:24:14,074 [INFO] - Model vit moved to cuda
2025-04-30 18:24:14,084 [INFO] - Model efficientnet moved to cuda
2025-04-30 18:24:14,119 [INFO] - Model inception moved to cuda
2025-04-30 18:24:14,137 [INFO] - Model mobilenet moved to cuda
2025-04-30 18:24:14,158 [INFO] - Model resnet moved to cuda
2025-04-30 18:24:14,191 [INFO] - Model densenet moved to cuda
2025-04-30 18:24:14,206 [INFO] - Model student moved to cuda
2025-04-30 18:24:14,208 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-30 18:24:14,210 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-30 18:24:14,212 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-30 18:24:14,213 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-30 18:24:14,214 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-30 18:24:14,217 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-30 18:24:14,219 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-30 18:24:14,223 [INFO] - Starting initialization phase...
2025-04-30 18:24:14,224 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-04-30 18:24:14,226 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-04-30 18:24:14,227 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-04-30 18:24:14,228 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-04-30 18:24:14,229 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-04-30 18:24:14,230 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-04-30 18:24:14,232 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-04-30 18:24:14,232 [INFO] - Initialization Epoch 1/5
2025-04-30 18:24:38,067 [INFO] - GPU cache cleared: 1626.07MB → 1626.07MB (freed 0.00MB)
2025-04-30 18:24:43,921 [INFO] - GPU cache cleared: 1624.40MB → 1624.40MB (freed 0.00MB)
2025-04-30 18:24:49,794 [INFO] - GPU cache cleared: 1620.85MB → 1620.85MB (freed 0.00MB)
2025-04-30 18:24:55,700 [INFO] - GPU cache cleared: 1619.30MB → 1619.30MB (freed 0.00MB)
2025-04-30 18:25:01,758 [INFO] - GPU cache cleared: 1619.01MB → 1619.01MB (freed 0.00MB)
2025-04-30 18:25:07,914 [INFO] - GPU cache cleared: 1618.60MB → 1618.60MB (freed 0.00MB)
2025-04-30 18:25:13,910 [INFO] - GPU cache cleared: 1618.60MB → 1618.60MB (freed 0.00MB)
2025-04-30 18:25:19,939 [INFO] - GPU cache cleared: 1618.60MB → 1618.60MB (freed 0.00MB)
2025-04-30 18:25:26,081 [INFO] - GPU cache cleared: 1618.60MB → 1618.60MB (freed 0.00MB)
2025-04-30 18:26:04,768 [INFO] - Using device: cuda
2025-04-30 18:26:04,768 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-30 18:26:04,768 [INFO] - GPU Memory: 6.00 GB
2025-04-30 18:26:04,768 [INFO] - CUDA Version: 12.4
2025-04-30 18:26:04,768 [INFO] - cuDNN benchmark mode enabled
2025-04-30 18:26:04,782 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 25,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 32,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 12,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-30 18:26:04,788 [INFO] - Random seed set to 42
2025-04-30 18:26:04,788 [INFO] - Preparing data loaders...
2025-04-30 18:26:13,499 [INFO] - Training samples: 45000 per model
2025-04-30 18:26:13,499 [INFO] - Validation samples: 5000 per model
2025-04-30 18:26:13,504 [INFO] - Test samples: 10000 per model
2025-04-30 18:26:13,505 [INFO] - Creating models for mutual learning...
2025-04-30 18:26:13,505 [INFO] - Loading ViT-B16 model...
2025-04-30 18:26:14,422 [INFO] - Loading EfficientNetB0 model...
2025-04-30 18:26:14,544 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-30 18:26:14,893 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-04-30 18:26:14,893 [INFO] - Loading MobileNetV3-Large model...
2025-04-30 18:26:14,993 [INFO] - Loading ResNet50 model...
2025-04-30 18:26:15,367 [INFO] - Loading DenseNet121 model...
2025-04-30 18:26:15,508 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-30 18:26:15,840 [INFO] - Model vit moved to cuda
2025-04-30 18:26:15,896 [INFO] - Model efficientnet moved to cuda
2025-04-30 18:26:15,992 [INFO] - Model inception moved to cuda
2025-04-30 18:26:16,033 [INFO] - Model mobilenet moved to cuda
2025-04-30 18:26:16,109 [INFO] - Model resnet moved to cuda
2025-04-30 18:26:16,192 [INFO] - Model densenet moved to cuda
2025-04-30 18:26:16,233 [INFO] - Model student moved to cuda
2025-04-30 18:26:16,233 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-30 18:26:16,233 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-30 18:26:16,233 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-30 18:26:16,233 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-30 18:26:16,241 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-30 18:26:16,243 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-30 18:26:16,245 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-30 18:26:16,245 [INFO] - Starting initialization phase...
2025-04-30 18:26:16,247 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-04-30 18:26:16,248 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-04-30 18:26:16,249 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-04-30 18:26:16,249 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-04-30 18:26:16,249 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-04-30 18:26:16,253 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-04-30 18:26:16,256 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-04-30 18:26:16,257 [INFO] - Initialization Epoch 1/5
2025-04-30 18:26:33,277 [ERROR] - An error occurred: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 451.98 MiB is free. 4.50 GiB allowed; Of the allocated memory 4.28 GiB is allocated by PyTorch, and 205.95 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-04-30 18:26:33,281 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_13524\1865841446.py", line 2866, in main
    models = initialization_phase(models, train_loader, val_loader, config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_13524\1865841446.py", line 1654, in initialization_phase
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\vision_transformer.py", line 298, in forward
    x = self.encoder(x)
        ^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\vision_transformer.py", line 157, in forward
    return self.ln(self.layers(self.dropout(input)))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\vision_transformer.py", line 112, in forward
    x = self.ln_1(input)
        ^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\normalization.py", line 217, in forward
    return F.layer_norm(
           ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\functional.py", line 2900, in layer_norm
    return torch.layer_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 451.98 MiB is free. 4.50 GiB allowed; Of the allocated memory 4.28 GiB is allocated by PyTorch, and 205.95 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-04-30 18:31:17,558 [INFO] - Using device: cuda
2025-04-30 18:31:17,558 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-30 18:31:17,558 [INFO] - GPU Memory: 6.00 GB
2025-04-30 18:31:17,558 [INFO] - CUDA Version: 12.4
2025-04-30 18:31:17,558 [INFO] - cuDNN benchmark mode enabled
2025-04-30 18:31:17,580 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 25,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 16,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 24,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-30 18:31:17,582 [INFO] - Random seed set to 42
2025-04-30 18:31:17,583 [INFO] - Preparing data loaders...
2025-04-30 18:31:25,737 [INFO] - Training samples: 45000 per model
2025-04-30 18:31:25,737 [INFO] - Validation samples: 5000 per model
2025-04-30 18:31:25,737 [INFO] - Test samples: 10000 per model
2025-04-30 18:31:25,737 [INFO] - Creating models for mutual learning...
2025-04-30 18:31:25,737 [INFO] - Loading ViT-B16 model...
2025-04-30 18:31:26,632 [INFO] - Loading EfficientNetB0 model...
2025-04-30 18:31:26,746 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-30 18:31:27,128 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-04-30 18:31:27,129 [INFO] - Loading MobileNetV3-Large model...
2025-04-30 18:31:27,247 [INFO] - Loading ResNet50 model...
2025-04-30 18:31:27,607 [INFO] - Loading DenseNet121 model...
2025-04-30 18:31:27,754 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-30 18:31:28,081 [INFO] - Model vit moved to cuda
2025-04-30 18:31:28,099 [INFO] - Model efficientnet moved to cuda
2025-04-30 18:31:28,133 [INFO] - Model inception moved to cuda
2025-04-30 18:31:28,161 [INFO] - Model mobilenet moved to cuda
2025-04-30 18:31:28,183 [INFO] - Model resnet moved to cuda
2025-04-30 18:31:28,201 [INFO] - Model densenet moved to cuda
2025-04-30 18:31:28,247 [INFO] - Model student moved to cuda
2025-04-30 18:31:28,249 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-30 18:31:28,251 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-30 18:31:28,253 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-30 18:31:28,254 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-30 18:31:28,256 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-30 18:31:28,256 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-30 18:31:28,256 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-30 18:31:28,256 [INFO] - Starting initialization phase...
2025-04-30 18:31:28,256 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-04-30 18:31:28,264 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-04-30 18:31:28,266 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-04-30 18:31:28,266 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-04-30 18:31:28,268 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-04-30 18:31:28,268 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-04-30 18:31:28,271 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-04-30 18:31:28,271 [INFO] - Initialization Epoch 1/5
2025-04-30 18:31:47,840 [INFO] - GPU cache cleared: 3210.73MB → 3210.73MB (freed 0.00MB)
2025-04-30 18:31:47,882 [ERROR] - An error occurred: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 396.20 MiB is free. 4.50 GiB allowed; Of the allocated memory 4.27 GiB is allocated by PyTorch, and 238.14 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-04-30 18:31:47,890 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_13524\1089214800.py", line 2866, in main
    models = initialization_phase(models, train_loader, val_loader, config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_13524\1089214800.py", line 1654, in initialization_phase
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\vision_transformer.py", line 298, in forward
    x = self.encoder(x)
        ^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\vision_transformer.py", line 157, in forward
    return self.ln(self.layers(self.dropout(input)))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\vision_transformer.py", line 112, in forward
    x = self.ln_1(input)
        ^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\normalization.py", line 217, in forward
    return F.layer_norm(
           ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\functional.py", line 2900, in layer_norm
    return torch.layer_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 396.20 MiB is free. 4.50 GiB allowed; Of the allocated memory 4.27 GiB is allocated by PyTorch, and 238.14 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-04-30 18:35:10,379 [INFO] - Using device: cuda
2025-04-30 18:35:10,379 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-30 18:35:10,379 [INFO] - GPU Memory: 6.00 GB
2025-04-30 18:35:10,379 [INFO] - CUDA Version: 12.4
2025-04-30 18:35:10,379 [INFO] - cuDNN benchmark mode enabled
2025-04-30 18:35:10,393 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 25,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 8,
        "efficientnet": 64,
        "inception": 48,
        "mobilenet": 96,
        "resnet": 64,
        "densenet": 56,
        "student": 96
    },
    "model_grad_accum": {
        "vit": 48,
        "efficientnet": 6,
        "inception": 8,
        "mobilenet": 4,
        "resnet": 6,
        "densenet": 7,
        "student": 4
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-30 18:35:10,393 [INFO] - Random seed set to 42
2025-04-30 18:35:10,393 [INFO] - Preparing data loaders...
2025-04-30 18:35:18,732 [INFO] - Training samples: 45000 per model
2025-04-30 18:35:18,732 [INFO] - Validation samples: 5000 per model
2025-04-30 18:35:18,732 [INFO] - Test samples: 10000 per model
2025-04-30 18:35:18,732 [INFO] - Creating models for mutual learning...
2025-04-30 18:35:18,732 [INFO] - Loading ViT-B16 model...
2025-04-30 18:35:19,409 [INFO] - Loading EfficientNetB0 model...
2025-04-30 18:35:19,507 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-30 18:35:19,713 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-04-30 18:35:19,713 [INFO] - Loading MobileNetV3-Large model...
2025-04-30 18:35:19,819 [INFO] - Loading ResNet50 model...
2025-04-30 18:35:20,099 [INFO] - Loading DenseNet121 model...
2025-04-30 18:35:20,230 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-30 18:35:20,589 [INFO] - Model vit moved to cuda
2025-04-30 18:35:20,605 [INFO] - Model efficientnet moved to cuda
2025-04-30 18:35:20,646 [INFO] - Model inception moved to cuda
2025-04-30 18:35:20,661 [INFO] - Model mobilenet moved to cuda
2025-04-30 18:35:20,689 [INFO] - Model resnet moved to cuda
2025-04-30 18:35:20,719 [INFO] - Model densenet moved to cuda
2025-04-30 18:35:20,733 [INFO] - Model student moved to cuda
2025-04-30 18:35:20,733 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-30 18:35:20,733 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-30 18:35:20,741 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-30 18:35:20,743 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-30 18:35:20,745 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-30 18:35:20,749 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-30 18:35:20,751 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-30 18:35:20,752 [INFO] - Starting initialization phase...
2025-04-30 18:35:20,753 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-04-30 18:35:20,754 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-04-30 18:35:20,756 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-04-30 18:35:20,757 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-04-30 18:35:20,758 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-04-30 18:35:20,759 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-04-30 18:35:20,762 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-04-30 18:35:20,763 [INFO] - Initialization Epoch 1/5
2025-04-30 18:35:38,402 [INFO] - GPU cache cleared: 2554.18MB → 2554.18MB (freed 0.00MB)
2025-04-30 18:35:40,434 [INFO] - GPU cache cleared: 3214.37MB → 3214.37MB (freed 0.00MB)
2025-04-30 18:35:42,434 [INFO] - GPU cache cleared: 3214.37MB → 3214.37MB (freed 0.00MB)
2025-04-30 18:35:44,470 [INFO] - GPU cache cleared: 3214.25MB → 3214.25MB (freed 0.00MB)
2025-04-30 18:35:46,510 [INFO] - GPU cache cleared: 3214.25MB → 3214.25MB (freed 0.00MB)
2025-04-30 18:35:48,564 [INFO] - GPU cache cleared: 3214.15MB → 3214.15MB (freed 0.00MB)
2025-04-30 18:35:50,617 [INFO] - GPU cache cleared: 3214.15MB → 3214.15MB (freed 0.00MB)
2025-04-30 18:35:52,693 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:35:54,755 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:35:56,789 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:35:58,797 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:00,830 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:02,829 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:04,856 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:06,863 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:08,901 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:10,907 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:12,933 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:14,944 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:16,993 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:19,017 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:21,057 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:23,072 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:25,143 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:27,180 [INFO] - GPU cache cleared: 3213.47MB → 3213.47MB (freed 0.00MB)
2025-04-30 18:36:29,204 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:31,247 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:33,269 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:35,314 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:37,332 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:39,385 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:41,404 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:43,440 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:45,477 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:47,519 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:49,537 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:51,592 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:53,609 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:55,668 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:57,701 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:36:59,758 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:37:01,788 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:37:03,853 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:37:05,885 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:37:07,961 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:37:10,027 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:37:12,112 [INFO] - GPU cache cleared: 3213.09MB → 3213.09MB (freed 0.00MB)
2025-04-30 18:37:14,224 [INFO] - GPU cache cleared: 2883.08MB → 2883.08MB (freed 0.00MB)
2025-04-30 18:37:16,272 [INFO] - GPU cache cleared: 3212.22MB → 3212.22MB (freed 0.00MB)
2025-04-30 18:37:18,361 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:20,417 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:22,510 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:24,588 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:26,671 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:28,728 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:30,835 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:32,909 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:35,002 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:37,078 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:39,167 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:41,237 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:43,333 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:45,401 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:47,495 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:49,571 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:51,668 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:53,750 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:55,840 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:37:57,930 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:00,039 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:02,126 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:04,226 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:06,321 [INFO] - GPU cache cleared: 3212.72MB → 3212.72MB (freed 0.00MB)
2025-04-30 18:38:08,416 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:10,513 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:12,610 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:14,720 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:16,818 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:18,928 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:21,015 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:23,137 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:25,227 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:27,325 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:29,404 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:31,518 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:33,636 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:35,747 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:37,835 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:39,972 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:42,079 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:44,169 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:46,287 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:48,373 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:50,453 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:52,563 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:38:54,675 [INFO] - GPU cache cleared: 2883.08MB → 2883.08MB (freed 0.00MB)
2025-04-30 18:38:56,781 [INFO] - GPU cache cleared: 3212.22MB → 3212.22MB (freed 0.00MB)
2025-04-30 18:38:58,879 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:00,987 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:03,101 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:05,187 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:07,293 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:09,389 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:11,508 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:13,627 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:15,746 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:17,850 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:19,956 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:22,072 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:24,216 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:26,307 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:28,418 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:30,526 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:32,636 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:34,727 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:36,841 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:38,954 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:41,098 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:43,203 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:45,347 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:47,469 [INFO] - GPU cache cleared: 3212.72MB → 3212.72MB (freed 0.00MB)
2025-04-30 18:39:49,570 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:51,702 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:53,813 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:55,946 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:39:58,041 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:00,161 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:02,276 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:04,404 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:06,515 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:08,653 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:10,766 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:12,918 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:15,029 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:17,148 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:19,254 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:21,395 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:23,495 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:25,650 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:27,744 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:29,876 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:31,984 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:34,134 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:36,272 [INFO] - GPU cache cleared: 2883.08MB → 2883.08MB (freed 0.00MB)
2025-04-30 18:40:38,355 [INFO] - GPU cache cleared: 3212.22MB → 3212.22MB (freed 0.00MB)
2025-04-30 18:40:40,487 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:42,591 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:44,723 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:46,829 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:48,967 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:51,069 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:53,198 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:55,296 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:57,429 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:40:59,549 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:01,737 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:03,880 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:06,036 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:08,135 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:10,261 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:12,365 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:14,530 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:16,655 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:18,771 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:20,903 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:23,058 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:25,163 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:27,293 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:29,428 [INFO] - GPU cache cleared: 3212.72MB → 3212.72MB (freed 0.00MB)
2025-04-30 18:41:31,549 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:33,670 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:35,771 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:37,911 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:40,039 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:42,175 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:44,292 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:46,423 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:48,526 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:50,668 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:52,781 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:54,907 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:57,033 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:41:59,186 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:01,302 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:03,444 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:05,593 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:07,708 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:09,850 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:11,973 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:14,097 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:16,233 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:18,361 [INFO] - GPU cache cleared: 2883.08MB → 2883.08MB (freed 0.00MB)
2025-04-30 18:42:20,465 [INFO] - GPU cache cleared: 3212.22MB → 3212.22MB (freed 0.00MB)
2025-04-30 18:42:22,606 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:24,718 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:26,858 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:28,965 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:31,102 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:33,217 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:35,360 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:37,459 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:39,604 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:41,712 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:43,864 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:45,967 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:48,096 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:50,225 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:52,360 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:54,458 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:56,605 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:42:58,704 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:43:00,848 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:43:02,980 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:43:05,134 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:43:07,248 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:43:09,387 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:43:11,512 [INFO] - GPU cache cleared: 3212.72MB → 3212.72MB (freed 0.00MB)
2025-04-30 18:43:13,624 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:43:15,762 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:43:17,902 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:43:20,060 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:43:22,191 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:43:24,319 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:43:26,453 [INFO] - GPU cache cleared: 3212.34MB → 3212.34MB (freed 0.00MB)
2025-04-30 18:43:28,624 [INFO] - GPU cache cleared: 2883.08MB → 2883.08MB (freed 0.00MB)
2025-04-30 18:43:46,122 [ERROR] - An error occurred: CUDA out of memory. Tried to allocate 56.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 356.17 MiB is free. 4.50 GiB allowed; Of the allocated memory 4.18 GiB is allocated by PyTorch, and 293.83 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-04-30 18:43:46,124 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_13524\4103339061.py", line 2866, in main
    models = initialization_phase(models, train_loader, val_loader, config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_13524\4103339061.py", line 1654, in initialization_phase
    outputs = model(inputs)
              ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 343, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 333, in _forward_impl
    x = self.features(x)
        ^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 164, in forward
    result = self.block(input)
             ^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\ops\misc.py", line 260, in forward
    return scale * input
           ~~~~~~^~~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 56.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 356.17 MiB is free. 4.50 GiB allowed; Of the allocated memory 4.18 GiB is allocated by PyTorch, and 293.83 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-04-30 18:48:59,499 [INFO] - Using device: cuda
2025-04-30 18:48:59,499 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-30 18:48:59,515 [INFO] - GPU Memory: 6.00 GB
2025-04-30 18:48:59,515 [INFO] - CUDA Version: 12.4
2025-04-30 18:48:59,515 [INFO] - cuDNN benchmark mode enabled
2025-04-30 18:48:59,531 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 25,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 8,
        "efficientnet": 32,
        "inception": 12,
        "mobilenet": 32,
        "resnet": 24,
        "densenet": 24,
        "student": 32
    },
    "model_grad_accum": {
        "vit": 48,
        "efficientnet": 16,
        "inception": 32,
        "mobilenet": 12,
        "resnet": 16,
        "densenet": 16,
        "student": 16
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-30 18:48:59,537 [INFO] - Random seed set to 42
2025-04-30 18:48:59,538 [INFO] - Preparing data loaders...
2025-04-30 18:49:07,814 [INFO] - Training samples: 45000 per model
2025-04-30 18:49:07,814 [INFO] - Validation samples: 5000 per model
2025-04-30 18:49:07,814 [INFO] - Test samples: 10000 per model
2025-04-30 18:49:07,814 [INFO] - Creating models for mutual learning...
2025-04-30 18:49:07,814 [INFO] - Loading ViT-B16 model...
2025-04-30 18:49:08,806 [INFO] - Loading EfficientNetB0 model...
2025-04-30 18:49:08,930 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-30 18:49:09,292 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-04-30 18:49:09,292 [INFO] - Loading MobileNetV3-Large model...
2025-04-30 18:49:09,397 [INFO] - Loading ResNet50 model...
2025-04-30 18:49:09,767 [INFO] - Loading DenseNet121 model...
2025-04-30 18:49:09,910 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-30 18:49:10,247 [INFO] - Model vit moved to cuda
2025-04-30 18:49:10,300 [INFO] - Model efficientnet moved to cuda
2025-04-30 18:49:10,352 [INFO] - Model inception moved to cuda
2025-04-30 18:49:10,368 [INFO] - Model mobilenet moved to cuda
2025-04-30 18:49:10,399 [INFO] - Model resnet moved to cuda
2025-04-30 18:49:10,434 [INFO] - Model densenet moved to cuda
2025-04-30 18:49:10,446 [INFO] - Model student moved to cuda
2025-04-30 18:49:10,446 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-30 18:49:10,446 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-30 18:49:10,455 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-30 18:49:10,456 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-30 18:49:10,456 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-30 18:49:10,460 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-30 18:49:10,462 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-30 18:49:10,463 [INFO] - Starting initialization phase...
2025-04-30 18:49:10,464 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-04-30 18:49:10,466 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-04-30 18:49:10,467 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-04-30 18:49:10,470 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-04-30 18:49:10,471 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-04-30 18:49:10,473 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-04-30 18:49:10,474 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-04-30 18:49:10,474 [INFO] - Initialization Epoch 1/5
2025-04-30 18:49:28,759 [INFO] - GPU cache cleared: 2553.30MB → 2553.30MB (freed 0.00MB)
2025-04-30 18:49:30,793 [INFO] - GPU cache cleared: 3214.98MB → 3214.98MB (freed 0.00MB)
2025-04-30 18:49:32,797 [INFO] - GPU cache cleared: 3214.98MB → 3214.98MB (freed 0.00MB)
2025-04-30 18:49:34,828 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:49:36,843 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:49:38,877 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:49:40,895 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:49:42,936 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:49:44,956 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:49:46,998 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:49:49,029 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:49:51,076 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:49:53,104 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:49:55,147 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:49:57,177 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:49:59,225 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:01,258 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:03,311 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:05,342 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:07,399 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:09,454 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:11,551 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:13,625 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:15,717 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:17,812 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:19,880 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:21,960 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:24,005 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:26,070 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:28,114 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:30,180 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:32,223 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:34,280 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:36,327 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:38,397 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:40,443 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:42,516 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:44,557 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:46,636 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:48,689 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:50,761 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:52,805 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:54,878 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:56,932 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:50:59,019 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:01,078 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:03,167 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:05,277 [INFO] - GPU cache cleared: 2882.72MB → 2882.72MB (freed 0.00MB)
2025-04-30 18:51:07,338 [INFO] - GPU cache cleared: 3214.51MB → 3214.51MB (freed 0.00MB)
2025-04-30 18:51:09,466 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:11,535 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:13,639 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:15,748 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:17,859 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:19,945 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:22,042 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:24,148 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:26,252 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:28,357 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:30,475 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:32,571 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:34,667 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:36,754 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:38,862 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:40,966 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:43,080 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:45,188 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:47,294 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:49,388 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:51,505 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:53,591 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:55,728 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:57,858 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:51:59,954 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:02,066 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:04,161 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:06,303 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:08,414 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:10,528 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:12,658 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:14,771 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:16,868 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:19,003 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:21,112 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:23,241 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:25,354 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:27,495 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:29,597 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:31,757 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:33,858 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:35,986 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:38,077 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:40,222 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:42,329 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:44,462 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:46,589 [INFO] - GPU cache cleared: 2882.72MB → 2882.72MB (freed 0.00MB)
2025-04-30 18:52:48,706 [INFO] - GPU cache cleared: 3214.51MB → 3214.51MB (freed 0.00MB)
2025-04-30 18:52:50,843 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:52,957 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:55,076 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:57,198 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:52:59,338 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:01,433 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:03,572 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:05,683 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:07,803 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:09,919 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:12,070 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:14,182 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:16,331 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:18,441 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:20,607 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:22,717 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:24,860 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:26,945 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:29,124 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:31,251 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:33,385 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:35,493 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:37,646 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:39,768 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:41,884 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:44,026 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:46,146 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:48,280 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:50,389 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:52,517 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:54,638 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:56,796 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:53:58,916 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:01,041 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:03,165 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:05,313 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:07,428 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:09,581 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:11,707 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:13,867 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:16,025 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:18,214 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:20,379 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:22,583 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:24,728 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:26,914 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:29,090 [INFO] - GPU cache cleared: 2882.72MB → 2882.72MB (freed 0.00MB)
2025-04-30 18:54:31,240 [INFO] - GPU cache cleared: 3214.51MB → 3214.51MB (freed 0.00MB)
2025-04-30 18:54:33,431 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:35,583 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:37,749 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:39,946 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:42,153 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:44,328 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:46,546 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:48,703 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:50,929 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:53,089 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:55,268 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:57,404 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:54:59,590 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:01,749 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:03,917 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:06,082 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:08,249 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:10,388 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:12,568 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:14,740 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:16,922 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:19,089 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:21,268 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:23,436 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:25,589 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:27,745 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:29,881 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:32,053 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:34,215 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:36,366 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:38,519 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:40,686 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:42,839 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:45,003 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:47,158 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:49,332 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:51,508 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:53,679 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:55,860 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:55:58,047 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:00,216 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:02,438 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:04,643 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:06,834 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:09,061 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:11,248 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:13,471 [INFO] - GPU cache cleared: 2882.72MB → 2882.72MB (freed 0.00MB)
2025-04-30 18:56:15,651 [INFO] - GPU cache cleared: 3214.51MB → 3214.51MB (freed 0.00MB)
2025-04-30 18:56:17,846 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:20,034 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:22,231 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:24,387 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:26,578 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:28,727 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:30,940 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:33,116 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:35,318 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:37,505 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:39,671 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:41,808 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:43,985 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:46,165 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:48,342 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:50,514 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:52,675 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:54,810 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:56,999 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:56:59,158 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:57:01,331 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:57:03,512 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:57:05,697 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:57:07,897 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:57:10,056 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:57:12,237 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:57:14,426 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:57:16,620 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:57:18,810 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:57:21,010 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:57:23,185 [INFO] - GPU cache cleared: 3214.63MB → 3214.63MB (freed 0.00MB)
2025-04-30 18:57:25,386 [INFO] - GPU cache cleared: 2882.72MB → 2882.72MB (freed 0.00MB)
2025-04-30 18:57:51,108 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:57:53,108 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:57:55,060 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:57:57,011 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:57:58,964 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:00,915 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:02,872 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:04,792 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:06,865 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:08,810 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:10,747 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:12,700 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:14,671 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:16,624 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:18,559 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:20,532 [INFO] - GPU cache cleared: 2928.55MB → 2928.55MB (freed 0.00MB)
2025-04-30 18:58:22,470 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:24,438 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:26,406 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:28,322 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:30,282 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:32,242 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:34,322 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:36,289 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:38,247 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:40,195 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:42,129 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:44,102 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:46,060 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:48,032 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:49,985 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:51,951 [INFO] - GPU cache cleared: 2928.55MB → 2928.55MB (freed 0.00MB)
2025-04-30 18:58:53,927 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:55,899 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:57,900 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:58:59,939 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:01,919 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:03,897 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:05,867 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:07,830 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:09,847 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:11,851 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:13,830 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:15,830 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:17,771 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:19,746 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:21,712 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:23,677 [INFO] - GPU cache cleared: 2928.55MB → 2928.55MB (freed 0.00MB)
2025-04-30 18:59:25,703 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:27,677 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:29,705 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:31,736 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:33,719 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:35,768 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:37,788 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 18:59:39,802 [INFO] - GPU cache cleared: 2944.07MB → 2944.07MB (freed 0.00MB)
2025-04-30 19:06:09,055 [INFO] - Using device: cuda
2025-04-30 19:06:09,055 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-30 19:06:09,055 [INFO] - GPU Memory: 6.00 GB
2025-04-30 19:06:09,055 [INFO] - CUDA Version: 12.4
2025-04-30 19:06:09,137 [INFO] - cuDNN benchmark mode enabled
2025-04-30 19:06:09,137 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 25,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 8,
        "efficientnet": 32,
        "inception": 8,
        "mobilenet": 32,
        "resnet": 24,
        "densenet": 24,
        "student": 32
    },
    "model_grad_accum": {
        "vit": 48,
        "efficientnet": 16,
        "inception": 48,
        "mobilenet": 12,
        "resnet": 16,
        "densenet": 16,
        "student": 16
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-30 19:06:09,217 [INFO] - Random seed set to 42
2025-04-30 19:06:09,217 [INFO] - Preparing data loaders...
2025-04-30 19:06:17,319 [INFO] - Training samples: 45000 per model
2025-04-30 19:06:17,319 [INFO] - Validation samples: 5000 per model
2025-04-30 19:06:17,320 [INFO] - Test samples: 10000 per model
2025-04-30 19:06:17,321 [INFO] - Creating models for mutual learning...
2025-04-30 19:06:17,321 [INFO] - Loading ViT-B16 model...
2025-04-30 19:06:18,219 [INFO] - Loading EfficientNetB0 model...
2025-04-30 19:06:18,347 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-30 19:06:18,728 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-04-30 19:06:18,728 [INFO] - Loading MobileNetV3-Large model...
2025-04-30 19:06:18,846 [INFO] - Loading ResNet50 model...
2025-04-30 19:06:19,241 [INFO] - Loading DenseNet121 model...
2025-04-30 19:06:19,394 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-30 19:06:19,777 [INFO] - Model vit moved to cuda
2025-04-30 19:06:19,817 [INFO] - Model efficientnet moved to cuda
2025-04-30 19:06:19,867 [INFO] - Model inception moved to cuda
2025-04-30 19:06:19,889 [INFO] - Model mobilenet moved to cuda
2025-04-30 19:06:19,922 [INFO] - Model resnet moved to cuda
2025-04-30 19:06:19,984 [INFO] - Model densenet moved to cuda
2025-04-30 19:06:20,006 [INFO] - Model student moved to cuda
2025-04-30 19:06:20,008 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-30 19:06:20,009 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-30 19:06:20,013 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-30 19:06:20,015 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-30 19:06:20,016 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-30 19:06:20,018 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-30 19:06:20,020 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-30 19:06:20,021 [INFO] - Starting initialization phase...
2025-04-30 19:06:20,022 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-04-30 19:06:20,024 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-04-30 19:06:20,026 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-04-30 19:06:20,027 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-04-30 19:06:20,028 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-04-30 19:06:20,028 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-04-30 19:06:20,028 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-04-30 19:06:20,033 [INFO] - Initialization Epoch 1/5
2025-04-30 19:06:38,512 [INFO] - GPU cache cleared: 947.17MB → 947.17MB (freed 0.00MB)
2025-04-30 19:06:40,547 [INFO] - GPU cache cleared: 1601.64MB → 1601.64MB (freed 0.00MB)
2025-04-30 19:06:42,504 [INFO] - GPU cache cleared: 1601.64MB → 1601.64MB (freed 0.00MB)
2025-04-30 19:06:44,481 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:06:46,442 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:06:48,418 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:06:50,379 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:06:52,363 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:06:54,338 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:06:56,328 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:06:58,295 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:00,289 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:02,284 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:04,314 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:06,318 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:08,345 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:10,342 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:12,380 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:14,363 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:16,370 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:18,352 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:20,352 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:22,336 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:24,340 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:26,352 [INFO] - GPU cache cleared: 1602.50MB → 1602.50MB (freed 0.00MB)
2025-04-30 19:07:28,344 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:30,363 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:32,372 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:34,408 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:36,439 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:38,472 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:40,498 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:42,546 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:44,577 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:46,642 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:48,672 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:50,726 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:52,768 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:54,836 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:56,873 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:07:58,942 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:01,019 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:03,087 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:05,135 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:07,216 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:09,282 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:11,362 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:13,456 [INFO] - GPU cache cleared: 1271.58MB → 1271.58MB (freed 0.00MB)
2025-04-30 19:08:15,534 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:17,615 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:19,680 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:21,761 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:23,822 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:25,936 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:27,996 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:30,087 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:32,164 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:34,249 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:36,318 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:38,407 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:40,482 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:42,590 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:44,656 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:46,754 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:48,844 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:50,949 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:53,033 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:55,141 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:57,240 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:08:59,347 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:01,434 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:03,536 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:05,650 [INFO] - GPU cache cleared: 1602.50MB → 1602.50MB (freed 0.00MB)
2025-04-30 19:09:07,729 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:09,845 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:11,927 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:14,064 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:16,150 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:18,272 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:20,358 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:22,472 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:24,575 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:26,682 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:28,779 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:30,894 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:32,997 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:35,108 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:37,201 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:39,312 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:41,413 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:43,533 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:45,625 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:47,747 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:49,858 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:51,978 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:54,108 [INFO] - GPU cache cleared: 1271.58MB → 1271.58MB (freed 0.00MB)
2025-04-30 19:09:56,217 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:09:58,337 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:00,440 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:02,583 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:04,691 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:06,812 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:08,936 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:11,075 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:13,168 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:15,305 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:17,406 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:19,555 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:21,663 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:23,805 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:25,903 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:28,047 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:30,154 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:32,288 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:34,400 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:36,524 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:38,635 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:40,795 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:42,910 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:45,045 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:47,171 [INFO] - GPU cache cleared: 1602.50MB → 1602.50MB (freed 0.00MB)
2025-04-30 19:10:49,279 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:51,427 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:53,542 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:55,668 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:57,775 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:10:59,927 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:02,066 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:04,197 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:06,313 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:08,462 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:10,574 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:12,707 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:14,851 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:16,984 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:19,108 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:21,254 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:23,374 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:25,497 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:27,620 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:29,765 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:31,875 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:34,015 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:36,156 [INFO] - GPU cache cleared: 1271.58MB → 1271.58MB (freed 0.00MB)
2025-04-30 19:11:38,275 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:40,435 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:42,566 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:44,715 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:46,823 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:48,980 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:51,107 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:53,245 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:55,381 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:57,531 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:11:59,664 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:01,818 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:03,954 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:06,102 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:08,243 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:10,391 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:12,501 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:14,674 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:16,807 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:18,980 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:21,088 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:23,221 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:25,364 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:27,512 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:29,662 [INFO] - GPU cache cleared: 1602.50MB → 1602.50MB (freed 0.00MB)
2025-04-30 19:12:31,781 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:33,916 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:36,076 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:38,213 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:40,342 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:42,523 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:44,653 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:46,819 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:48,954 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:51,077 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:53,227 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:55,381 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:57,535 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:12:59,705 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:01,838 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:04,035 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:06,155 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:08,295 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:10,413 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:12,565 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:14,683 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:16,863 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:19,016 [INFO] - GPU cache cleared: 1271.58MB → 1271.58MB (freed 0.00MB)
2025-04-30 19:13:21,127 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:23,289 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:25,437 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:27,584 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:29,710 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:31,856 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:34,002 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:36,182 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:38,308 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:40,474 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:42,633 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:44,800 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:46,953 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:49,131 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:51,265 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:53,430 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:55,584 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:57,800 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:13:59,925 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:14:02,097 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:14:04,244 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:14:06,396 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:14:08,564 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:14:10,753 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:14:12,904 [INFO] - GPU cache cleared: 1602.50MB → 1602.50MB (freed 0.00MB)
2025-04-30 19:14:15,050 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:14:17,252 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:14:19,393 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:14:21,536 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:14:23,666 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:14:25,827 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:14:27,953 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 19:14:30,126 [INFO] - GPU cache cleared: 1271.58MB → 1271.58MB (freed 0.00MB)
2025-04-30 19:15:04,683 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:06,584 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:08,466 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:10,438 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:12,317 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:14,241 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:16,168 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:18,081 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:19,961 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:21,868 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:23,785 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:25,765 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:27,625 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:29,448 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:31,318 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:33,206 [INFO] - GPU cache cleared: 1317.58MB → 1317.58MB (freed 0.00MB)
2025-04-30 19:15:35,049 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:37,008 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:38,897 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:40,822 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:42,717 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:44,643 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:46,501 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:48,361 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:50,355 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:52,366 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:54,348 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:56,346 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:15:58,210 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:00,105 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:02,063 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:04,066 [INFO] - GPU cache cleared: 1317.58MB → 1317.58MB (freed 0.00MB)
2025-04-30 19:16:05,975 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:07,935 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:09,888 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:11,799 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:13,757 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:15,612 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:17,493 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:19,343 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:21,216 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:23,077 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:24,951 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:26,806 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:28,676 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:30,540 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:32,413 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:34,295 [INFO] - GPU cache cleared: 1317.58MB → 1317.58MB (freed 0.00MB)
2025-04-30 19:16:36,195 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:38,035 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:39,903 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:41,750 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:43,615 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:45,472 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:47,399 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:16:49,318 [INFO] - GPU cache cleared: 1333.10MB → 1333.10MB (freed 0.00MB)
2025-04-30 19:17:13,085 [INFO] - GPU cache cleared: 1393.33MB → 1393.33MB (freed 0.00MB)
2025-04-30 19:17:15,037 [INFO] - GPU cache cleared: 1567.85MB → 1567.85MB (freed 0.00MB)
2025-04-30 19:17:16,864 [INFO] - GPU cache cleared: 1567.85MB → 1567.85MB (freed 0.00MB)
2025-04-30 19:17:18,692 [INFO] - GPU cache cleared: 1568.42MB → 1568.42MB (freed 0.00MB)
2025-04-30 19:17:20,561 [INFO] - GPU cache cleared: 1568.42MB → 1568.42MB (freed 0.00MB)
2025-04-30 19:17:22,462 [INFO] - GPU cache cleared: 1567.66MB → 1567.66MB (freed 0.00MB)
2025-04-30 19:17:24,245 [INFO] - GPU cache cleared: 1567.66MB → 1567.66MB (freed 0.00MB)
2025-04-30 19:17:26,146 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:27,923 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:29,730 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:31,591 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:33,415 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:35,340 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:37,143 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:38,996 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:40,862 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:42,728 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:44,597 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:46,492 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:48,399 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:50,243 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:52,091 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:53,963 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:55,842 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:57,717 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:17:59,527 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:01,395 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:03,249 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:05,122 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:06,923 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:08,717 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:10,575 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:12,351 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:14,187 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:16,040 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:17,958 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:19,796 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:21,642 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:23,508 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:25,390 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:27,252 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:29,147 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:31,007 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:32,958 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:34,763 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:36,623 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:38,472 [INFO] - GPU cache cleared: 1567.64MB → 1567.64MB (freed 0.00MB)
2025-04-30 19:18:40,371 [INFO] - GPU cache cleared: 1481.11MB → 1481.11MB (freed 0.00MB)
2025-04-30 19:18:42,187 [INFO] - GPU cache cleared: 1568.36MB → 1568.36MB (freed 0.00MB)
2025-04-30 19:18:43,973 [INFO] - GPU cache cleared: 1568.36MB → 1568.36MB (freed 0.00MB)
2025-04-30 19:18:45,844 [INFO] - GPU cache cleared: 1568.36MB → 1568.36MB (freed 0.00MB)
2025-04-30 19:18:47,684 [INFO] - GPU cache cleared: 1567.34MB → 1567.34MB (freed 0.00MB)
2025-04-30 19:18:49,486 [INFO] - GPU cache cleared: 1567.34MB → 1567.34MB (freed 0.00MB)
2025-04-30 19:18:51,368 [INFO] - GPU cache cleared: 1568.26MB → 1568.26MB (freed 0.00MB)
2025-04-30 19:18:53,193 [INFO] - GPU cache cleared: 1568.26MB → 1568.26MB (freed 0.00MB)
2025-04-30 19:18:55,152 [INFO] - GPU cache cleared: 1568.71MB → 1568.71MB (freed 0.00MB)
2025-04-30 19:18:56,964 [INFO] - GPU cache cleared: 1568.71MB → 1568.71MB (freed 0.00MB)
2025-04-30 19:18:58,895 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:00,686 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:02,484 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:04,316 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:06,183 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:07,984 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:09,829 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:11,685 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:13,544 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:15,395 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:17,174 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:18,985 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:20,881 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:22,742 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:24,539 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:26,393 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:28,279 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:30,152 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:31,992 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:33,939 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:35,771 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:37,596 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:39,485 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:41,332 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:43,212 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:45,061 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:46,922 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:48,812 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:50,683 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:52,547 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:54,362 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:56,256 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:58,129 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:19:59,974 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:01,901 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:03,756 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:05,578 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:07,491 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:09,327 [INFO] - GPU cache cleared: 1481.11MB → 1481.11MB (freed 0.00MB)
2025-04-30 19:20:11,204 [INFO] - GPU cache cleared: 1568.36MB → 1568.36MB (freed 0.00MB)
2025-04-30 19:20:13,014 [INFO] - GPU cache cleared: 1568.36MB → 1568.36MB (freed 0.00MB)
2025-04-30 19:20:14,919 [INFO] - GPU cache cleared: 1568.36MB → 1568.36MB (freed 0.00MB)
2025-04-30 19:20:16,779 [INFO] - GPU cache cleared: 1567.34MB → 1567.34MB (freed 0.00MB)
2025-04-30 19:20:18,658 [INFO] - GPU cache cleared: 1567.34MB → 1567.34MB (freed 0.00MB)
2025-04-30 19:20:20,484 [INFO] - GPU cache cleared: 1568.26MB → 1568.26MB (freed 0.00MB)
2025-04-30 19:20:22,383 [INFO] - GPU cache cleared: 1568.26MB → 1568.26MB (freed 0.00MB)
2025-04-30 19:20:24,241 [INFO] - GPU cache cleared: 1568.71MB → 1568.71MB (freed 0.00MB)
2025-04-30 19:20:26,064 [INFO] - GPU cache cleared: 1568.71MB → 1568.71MB (freed 0.00MB)
2025-04-30 19:20:27,930 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:29,763 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:31,636 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:33,471 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:35,310 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:37,120 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:39,046 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:40,824 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:42,684 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:44,512 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:46,380 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:48,180 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:50,032 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:51,855 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:53,675 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:55,526 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:57,324 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:20:59,133 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:01,019 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:02,820 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:04,732 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:06,585 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:08,483 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:10,366 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:12,282 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:14,125 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:16,054 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:17,921 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:19,734 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:21,637 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:23,442 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:25,296 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:27,140 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:28,995 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:30,841 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:32,685 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:34,505 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:36,428 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:38,238 [INFO] - GPU cache cleared: 1481.11MB → 1481.11MB (freed 0.00MB)
2025-04-30 19:21:40,028 [INFO] - GPU cache cleared: 1568.36MB → 1568.36MB (freed 0.00MB)
2025-04-30 19:21:41,864 [INFO] - GPU cache cleared: 1568.36MB → 1568.36MB (freed 0.00MB)
2025-04-30 19:21:43,714 [INFO] - GPU cache cleared: 1568.36MB → 1568.36MB (freed 0.00MB)
2025-04-30 19:21:45,578 [INFO] - GPU cache cleared: 1567.34MB → 1567.34MB (freed 0.00MB)
2025-04-30 19:21:47,446 [INFO] - GPU cache cleared: 1567.34MB → 1567.34MB (freed 0.00MB)
2025-04-30 19:21:49,290 [INFO] - GPU cache cleared: 1568.26MB → 1568.26MB (freed 0.00MB)
2025-04-30 19:21:51,158 [INFO] - GPU cache cleared: 1568.26MB → 1568.26MB (freed 0.00MB)
2025-04-30 19:21:52,972 [INFO] - GPU cache cleared: 1568.71MB → 1568.71MB (freed 0.00MB)
2025-04-30 19:21:54,845 [INFO] - GPU cache cleared: 1568.71MB → 1568.71MB (freed 0.00MB)
2025-04-30 19:21:56,699 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:21:58,494 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:00,389 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:02,242 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:04,090 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:05,982 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:07,852 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:09,726 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:11,578 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:13,408 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:15,271 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:17,067 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:18,956 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:20,833 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:22,680 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:24,587 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:26,442 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:28,303 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:30,198 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:32,078 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:33,963 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:35,747 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:37,635 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:39,441 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:41,268 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:43,095 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:44,928 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:46,818 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:48,643 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:50,456 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:52,274 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:54,120 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:56,038 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:57,983 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:22:59,819 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:01,657 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:03,519 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:05,344 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:07,205 [INFO] - GPU cache cleared: 1481.11MB → 1481.11MB (freed 0.00MB)
2025-04-30 19:23:09,120 [INFO] - GPU cache cleared: 1568.36MB → 1568.36MB (freed 0.00MB)
2025-04-30 19:23:10,977 [INFO] - GPU cache cleared: 1568.36MB → 1568.36MB (freed 0.00MB)
2025-04-30 19:23:12,858 [INFO] - GPU cache cleared: 1568.36MB → 1568.36MB (freed 0.00MB)
2025-04-30 19:23:14,765 [INFO] - GPU cache cleared: 1567.34MB → 1567.34MB (freed 0.00MB)
2025-04-30 19:23:16,607 [INFO] - GPU cache cleared: 1567.34MB → 1567.34MB (freed 0.00MB)
2025-04-30 19:23:18,462 [INFO] - GPU cache cleared: 1568.26MB → 1568.26MB (freed 0.00MB)
2025-04-30 19:23:20,271 [INFO] - GPU cache cleared: 1568.26MB → 1568.26MB (freed 0.00MB)
2025-04-30 19:23:22,130 [INFO] - GPU cache cleared: 1568.71MB → 1568.71MB (freed 0.00MB)
2025-04-30 19:23:23,972 [INFO] - GPU cache cleared: 1568.71MB → 1568.71MB (freed 0.00MB)
2025-04-30 19:23:25,864 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:27,698 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:29,567 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:31,418 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:33,285 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:35,143 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:37,087 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:38,941 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:40,829 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:42,723 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:44,552 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:46,407 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:48,329 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:50,193 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:52,055 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:53,982 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:55,819 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:57,671 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:23:59,497 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:24:01,310 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:24:03,206 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:24:05,094 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:24:06,973 [INFO] - GPU cache cleared: 1567.68MB → 1567.68MB (freed 0.00MB)
2025-04-30 19:24:08,865 [INFO] - GPU cache cleared: 1481.11MB → 1481.11MB (freed 0.00MB)
2025-04-30 19:24:29,848 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:31,280 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:32,684 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:34,119 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:35,536 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:36,918 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:38,293 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:39,713 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:41,141 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:42,523 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:43,967 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:45,446 [INFO] - GPU cache cleared: 1523.70MB → 1523.70MB (freed 0.00MB)
2025-04-30 19:24:46,834 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:48,243 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:49,670 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:51,065 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:52,477 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:53,962 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:55,446 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:56,926 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:58,412 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:24:59,833 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:01,295 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:02,717 [INFO] - GPU cache cleared: 1523.70MB → 1523.70MB (freed 0.00MB)
2025-04-30 19:25:04,197 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:05,648 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:07,122 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:08,535 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:09,943 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:11,399 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:12,802 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:14,233 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:15,704 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:17,162 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:18,630 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:20,081 [INFO] - GPU cache cleared: 1523.70MB → 1523.70MB (freed 0.00MB)
2025-04-30 19:25:21,565 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:23,028 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:24,544 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:25,965 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:27,394 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:28,801 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:30,233 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:31,740 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:33,155 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:34,624 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:36,114 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:37,516 [INFO] - GPU cache cleared: 1523.70MB → 1523.70MB (freed 0.00MB)
2025-04-30 19:25:38,979 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:40,426 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:41,890 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:43,337 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:44,742 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:46,173 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:47,607 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:25:49,072 [INFO] - GPU cache cleared: 1539.81MB → 1539.81MB (freed 0.00MB)
2025-04-30 19:26:11,691 [INFO] - GPU cache cleared: 1794.00MB → 1794.00MB (freed 0.00MB)
2025-04-30 19:26:13,683 [INFO] - GPU cache cleared: 1793.70MB → 1793.70MB (freed 0.00MB)
2025-04-30 19:26:15,677 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:26:17,682 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:26:19,689 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:26:21,722 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:26:23,759 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:26:25,802 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:26:27,875 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:26:29,934 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:26:32,018 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:26:34,106 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:26:36,203 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:26:38,289 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:26:40,398 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:26:42,495 [INFO] - GPU cache cleared: 1701.54MB → 1701.54MB (freed 0.00MB)
2025-04-30 19:26:44,592 [INFO] - GPU cache cleared: 1794.08MB → 1794.08MB (freed 0.00MB)
2025-04-30 19:26:46,692 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:26:48,794 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:26:50,932 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:26:53,048 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:26:55,161 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:26:57,270 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:26:59,381 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:27:01,495 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:27:03,606 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:27:05,734 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:27:07,845 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:27:09,983 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:27:12,100 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:27:14,244 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:27:16,382 [INFO] - GPU cache cleared: 1701.54MB → 1701.54MB (freed 0.00MB)
2025-04-30 19:27:18,516 [INFO] - GPU cache cleared: 1794.08MB → 1794.08MB (freed 0.00MB)
2025-04-30 19:27:20,662 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:27:22,774 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:27:24,895 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:27:27,043 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:27:29,182 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:27:31,318 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:27:33,434 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:27:35,564 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:27:37,683 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:27:39,808 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:27:41,943 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:27:44,057 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:27:46,182 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:27:48,332 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:27:50,453 [INFO] - GPU cache cleared: 1701.54MB → 1701.54MB (freed 0.00MB)
2025-04-30 19:27:52,564 [INFO] - GPU cache cleared: 1794.08MB → 1794.08MB (freed 0.00MB)
2025-04-30 19:27:54,723 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:27:56,841 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:27:58,965 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:28:01,083 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:28:03,205 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:28:05,324 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:28:07,461 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:28:09,595 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:28:11,711 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:28:13,834 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:28:15,962 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:28:18,094 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:28:20,215 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:28:22,334 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:28:24,487 [INFO] - GPU cache cleared: 1701.54MB → 1701.54MB (freed 0.00MB)
2025-04-30 19:28:26,606 [INFO] - GPU cache cleared: 1794.08MB → 1794.08MB (freed 0.00MB)
2025-04-30 19:28:28,744 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:28:30,876 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:28:33,008 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:28:35,158 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:28:37,296 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:28:39,412 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:28:41,538 [INFO] - GPU cache cleared: 1793.14MB → 1793.14MB (freed 0.00MB)
2025-04-30 19:28:43,659 [INFO] - GPU cache cleared: 1793.61MB → 1793.61MB (freed 0.00MB)
2025-04-30 19:28:45,794 [INFO] - GPU cache cleared: 1794.80MB → 1794.80MB (freed 0.00MB)
2025-04-30 19:28:47,968 [INFO] - GPU cache cleared: 1701.54MB → 1701.54MB (freed 0.00MB)
2025-04-30 19:29:09,827 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:12,665 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:15,445 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:18,285 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:21,070 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:23,952 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:26,802 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:29,660 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:32,536 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:35,410 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:38,299 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:41,139 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:43,986 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:46,864 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:49,741 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:52,584 [INFO] - GPU cache cleared: 1754.71MB → 1754.71MB (freed 0.00MB)
2025-04-30 19:29:55,465 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:29:58,379 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:01,257 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:04,119 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:06,959 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:09,764 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:12,597 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:15,486 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:18,380 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:21,239 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:24,115 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:26,952 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:29,826 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:32,662 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:35,542 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:38,418 [INFO] - GPU cache cleared: 1754.71MB → 1754.71MB (freed 0.00MB)
2025-04-30 19:30:41,362 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:44,306 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:47,204 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:50,123 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:53,025 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:55,890 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:30:58,757 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:01,582 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:04,437 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:07,284 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:10,119 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:12,958 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:15,930 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:18,881 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:21,812 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:24,725 [INFO] - GPU cache cleared: 1754.71MB → 1754.71MB (freed 0.00MB)
2025-04-30 19:31:27,616 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:30,478 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:33,322 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:36,218 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:39,114 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:42,039 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:45,004 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:47,902 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:50,847 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:53,719 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:56,631 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:31:59,487 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:32:02,381 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:32:05,291 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:32:08,184 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:32:11,034 [INFO] - GPU cache cleared: 1754.71MB → 1754.71MB (freed 0.00MB)
2025-04-30 19:32:13,951 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:32:16,842 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:32:19,791 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:32:22,707 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:32:25,589 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:32:28,443 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:32:31,363 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:32:34,186 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:32:37,033 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:32:39,888 [INFO] - GPU cache cleared: 1781.62MB → 1781.62MB (freed 0.00MB)
2025-04-30 19:32:42,742 [INFO] - GPU cache cleared: 1754.71MB → 1754.71MB (freed 0.00MB)
2025-04-30 19:33:03,462 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:05,290 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:07,227 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:09,068 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:10,902 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:12,769 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:14,615 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:16,469 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:18,389 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:20,360 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:22,273 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:24,137 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:26,039 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:27,947 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:29,883 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:31,764 [INFO] - GPU cache cleared: 1791.38MB → 1791.38MB (freed 0.00MB)
2025-04-30 19:33:33,630 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:35,522 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:37,389 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:39,313 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:41,215 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:43,185 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:45,154 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:47,034 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:48,993 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:50,952 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:52,844 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:54,741 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:56,658 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:33:58,549 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:00,420 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:02,352 [INFO] - GPU cache cleared: 1791.38MB → 1791.38MB (freed 0.00MB)
2025-04-30 19:34:04,225 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:06,094 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:08,051 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:09,993 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:11,986 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:13,957 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:15,865 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:17,834 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:19,746 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:21,631 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:23,603 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:25,539 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:27,443 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:29,342 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:31,279 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:33,157 [INFO] - GPU cache cleared: 1791.38MB → 1791.38MB (freed 0.00MB)
2025-04-30 19:34:35,109 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:37,087 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:38,955 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:40,890 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:42,873 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:44,774 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:46,723 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 19:34:48,623 [INFO] - GPU cache cleared: 1806.90MB → 1806.90MB (freed 0.00MB)
2025-04-30 21:01:57,540 [INFO] - Using device: cuda
2025-04-30 21:01:57,554 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-30 21:01:57,554 [INFO] - GPU Memory: 6.00 GB
2025-04-30 21:01:57,554 [INFO] - CUDA Version: 12.4
2025-04-30 21:01:57,658 [INFO] - cuDNN benchmark mode enabled
2025-04-30 21:01:57,686 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 25,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 8,
        "efficientnet": 32,
        "inception": 8,
        "mobilenet": 32,
        "resnet": 24,
        "densenet": 24,
        "student": 32
    },
    "model_grad_accum": {
        "vit": 48,
        "efficientnet": 16,
        "inception": 48,
        "mobilenet": 12,
        "resnet": 16,
        "densenet": 16,
        "student": 16
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-30 21:01:57,750 [INFO] - Random seed set to 42
2025-04-30 21:01:57,750 [INFO] - Preparing data loaders...
2025-04-30 21:02:06,874 [INFO] - Training samples: 45000 per model
2025-04-30 21:02:06,874 [INFO] - Validation samples: 5000 per model
2025-04-30 21:02:06,874 [INFO] - Test samples: 10000 per model
2025-04-30 21:02:06,874 [INFO] - Creating models for mutual learning...
2025-04-30 21:02:06,880 [INFO] - Loading ViT-B16 model...
2025-04-30 21:02:07,841 [INFO] - Loading EfficientNetB0 model...
2025-04-30 21:02:07,971 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-30 21:02:08,326 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-04-30 21:02:08,327 [INFO] - Loading MobileNetV3-Large model...
2025-04-30 21:02:08,436 [INFO] - Loading ResNet50 model...
2025-04-30 21:02:08,846 [INFO] - Loading DenseNet121 model...
2025-04-30 21:02:08,985 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-30 21:02:09,304 [INFO] - Model vit moved to cuda
2025-04-30 21:02:09,321 [INFO] - Model efficientnet moved to cuda
2025-04-30 21:02:09,360 [INFO] - Model inception moved to cuda
2025-04-30 21:02:09,381 [INFO] - Model mobilenet moved to cuda
2025-04-30 21:02:09,416 [INFO] - Model resnet moved to cuda
2025-04-30 21:02:09,455 [INFO] - Model densenet moved to cuda
2025-04-30 21:02:09,473 [INFO] - Model student moved to cuda
2025-04-30 21:02:09,473 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-30 21:02:09,473 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-30 21:02:09,478 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-30 21:02:09,480 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-30 21:02:09,480 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-30 21:02:09,485 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-30 21:02:09,486 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-30 21:02:09,487 [INFO] - Starting initialization phase...
2025-04-30 21:02:09,488 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-04-30 21:02:09,488 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-04-30 21:02:09,491 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-04-30 21:02:09,492 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-04-30 21:02:09,493 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-04-30 21:02:09,494 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-04-30 21:02:09,494 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-04-30 21:02:09,494 [INFO] - Initialization Epoch 1/5
2025-04-30 21:02:28,098 [INFO] - GPU cache cleared: 947.17MB → 947.17MB (freed 0.00MB)
2025-04-30 21:02:30,145 [INFO] - GPU cache cleared: 1601.64MB → 1601.64MB (freed 0.00MB)
2025-04-30 21:02:32,113 [INFO] - GPU cache cleared: 1601.64MB → 1601.64MB (freed 0.00MB)
2025-04-30 21:02:34,178 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:02:36,205 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:02:38,247 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:02:40,269 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:02:42,279 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:02:44,261 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:02:46,268 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:02:48,266 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:02:50,280 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:02:52,264 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:02:54,271 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:02:56,266 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:02:58,276 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:00,274 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:02,310 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:04,306 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:06,319 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:08,324 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:10,343 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:12,354 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:14,373 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:16,399 [INFO] - GPU cache cleared: 1602.50MB → 1602.50MB (freed 0.00MB)
2025-04-30 21:03:18,400 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:20,427 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:22,448 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:24,544 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:26,616 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:28,711 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:30,787 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:32,896 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:34,966 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:37,065 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:39,141 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:41,238 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:43,316 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:45,427 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:47,510 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:49,609 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:51,706 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:53,819 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:55,895 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:57,945 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:03:59,959 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:02,032 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:04,105 [INFO] - GPU cache cleared: 1271.58MB → 1271.58MB (freed 0.00MB)
2025-04-30 21:04:06,124 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:08,189 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:10,233 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:12,280 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:14,317 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:16,365 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:18,419 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:20,485 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:22,529 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:24,588 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:26,615 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:28,713 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:30,761 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:32,841 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:34,880 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:36,948 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:38,992 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:41,085 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:43,132 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:45,219 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:47,277 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:49,362 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:51,420 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:53,532 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:55,615 [INFO] - GPU cache cleared: 1602.50MB → 1602.50MB (freed 0.00MB)
2025-04-30 21:04:57,753 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:04:59,878 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:01,957 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:04,045 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:06,122 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:08,181 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:10,195 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:12,251 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:14,277 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:16,372 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:18,513 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:20,570 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:22,590 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:24,636 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:26,710 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:28,740 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:30,753 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:32,802 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:34,845 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:36,920 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:38,972 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:41,049 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:43,124 [INFO] - GPU cache cleared: 1271.58MB → 1271.58MB (freed 0.00MB)
2025-04-30 21:05:45,225 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:47,343 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:49,445 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:51,559 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:05:53,678 [INFO] - GPU cache cleared: 1602.16MB → 1602.16MB (freed 0.00MB)
2025-04-30 21:06:43,242 [INFO] - Using device: cuda
2025-04-30 21:06:43,250 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-30 21:06:43,250 [INFO] - GPU Memory: 6.00 GB
2025-04-30 21:06:43,250 [INFO] - CUDA Version: 12.4
2025-04-30 21:06:43,323 [INFO] - cuDNN benchmark mode enabled
2025-04-30 21:06:43,332 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 25,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 8,
        "efficientnet": 32,
        "inception": 8,
        "mobilenet": 32,
        "resnet": 24,
        "densenet": 24,
        "student": 32
    },
    "model_grad_accum": {
        "vit": 48,
        "efficientnet": 16,
        "inception": 48,
        "mobilenet": 12,
        "resnet": 16,
        "densenet": 16,
        "student": 16
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-30 21:06:43,364 [INFO] - Random seed set to 42
2025-04-30 21:06:43,365 [INFO] - Preparing data loaders...
2025-04-30 21:06:51,995 [INFO] - Training samples: 45000 per model
2025-04-30 21:06:51,996 [INFO] - Validation samples: 5000 per model
2025-04-30 21:06:51,997 [INFO] - Test samples: 10000 per model
2025-04-30 21:06:51,997 [INFO] - Creating models for mutual learning...
2025-04-30 21:06:51,998 [INFO] - Loading ViT-B16 model...
2025-04-30 21:06:52,871 [INFO] - Loading EfficientNetB0 model...
2025-04-30 21:06:52,957 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-30 21:06:53,282 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-04-30 21:06:53,287 [INFO] - Loading MobileNetV3-Large model...
2025-04-30 21:06:53,391 [INFO] - Loading ResNet50 model...
2025-04-30 21:06:53,662 [INFO] - Loading DenseNet121 model...
2025-04-30 21:06:53,790 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-30 21:06:54,151 [INFO] - Model vit moved to cuda
2025-04-30 21:06:54,190 [INFO] - Model efficientnet moved to cuda
2025-04-30 21:06:54,239 [INFO] - Model inception moved to cuda
2025-04-30 21:06:54,255 [INFO] - Model mobilenet moved to cuda
2025-04-30 21:06:54,283 [INFO] - Model resnet moved to cuda
2025-04-30 21:06:54,318 [INFO] - Model densenet moved to cuda
2025-04-30 21:06:54,337 [INFO] - Model student moved to cuda
2025-04-30 21:06:54,337 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-30 21:06:54,342 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-30 21:06:54,344 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-30 21:06:54,345 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-30 21:06:54,347 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-30 21:06:54,349 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-30 21:06:54,352 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-30 21:06:54,353 [INFO] - Starting initialization phase...
2025-04-30 21:06:54,353 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-04-30 21:06:54,356 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-04-30 21:06:54,357 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-04-30 21:06:54,358 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-04-30 21:06:54,358 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-04-30 21:06:54,358 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-04-30 21:06:54,363 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-04-30 21:06:54,363 [INFO] - Initialization Epoch 1/5
2025-04-30 21:36:33,066 [ERROR] - An error occurred: 
2025-04-30 21:36:33,088 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_25012\1411225448.py", line 2891, in main
    models = initialization_phase(models, train_loader, val_loader, config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_25012\1411225448.py", line 1736, in initialization_phase
    pbar_val = tqdm(enumerate(current_val_loader), total=len(current_val_loader), desc=f"Val {name} E{epoch+1}")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 479, in __iter__
    self._iterator = self._get_iterator()
                     ^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\utils\data\dataloader.py", line 1138, in __init__
    w.start()
  File "c:\ProgramData\anaconda3\Lib\multiprocessing\process.py", line 121, in start
    self._popen = self._Popen(self)
                  ^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\multiprocessing\context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\multiprocessing\context.py", line 337, in _Popen
    return Popen(process_obj)
           ^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\multiprocessing\popen_spawn_win32.py", line 95, in __init__
    reduction.dump(process_obj, to_child)
  File "c:\ProgramData\anaconda3\Lib\multiprocessing\reduction.py", line 60, in dump
    ForkingPickler(file, protocol).dump(obj)
MemoryError

2025-04-30 21:43:11,539 [INFO] - Using device: cuda
2025-04-30 21:43:11,539 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-04-30 21:43:11,539 [INFO] - GPU Memory: 6.00 GB
2025-04-30 21:43:11,539 [INFO] - CUDA Version: 12.4
2025-04-30 21:43:11,539 [INFO] - cuDNN benchmark mode enabled
2025-04-30 21:43:11,563 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 48,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 25,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 8,
        "efficientnet": 32,
        "inception": 8,
        "mobilenet": 32,
        "resnet": 24,
        "densenet": 24,
        "student": 32
    },
    "model_grad_accum": {
        "vit": 48,
        "efficientnet": 16,
        "inception": 48,
        "mobilenet": 12,
        "resnet": 16,
        "densenet": 16,
        "student": 16
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-04-30 21:43:11,567 [INFO] - Random seed set to 42
2025-04-30 21:43:11,568 [INFO] - Preparing data loaders...
2025-04-30 21:43:20,014 [INFO] - Training samples: 45000 per model
2025-04-30 21:43:20,014 [INFO] - Validation samples: 5000 per model
2025-04-30 21:43:20,014 [INFO] - Test samples: 10000 per model
2025-04-30 21:43:20,014 [INFO] - Creating models for mutual learning...
2025-04-30 21:43:20,014 [INFO] - Loading ViT-B16 model...
2025-04-30 21:43:21,420 [INFO] - Loading EfficientNetB0 model...
2025-04-30 21:43:21,565 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-04-30 21:43:21,936 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-04-30 21:43:21,936 [INFO] - Loading MobileNetV3-Large model...
2025-04-30 21:43:22,035 [INFO] - Loading ResNet50 model...
2025-04-30 21:43:22,533 [INFO] - Loading DenseNet121 model...
2025-04-30 21:43:22,663 [INFO] - Creating student model (EfficientNetB0-based)...
2025-04-30 21:43:22,945 [INFO] - Model vit moved to cuda
2025-04-30 21:43:22,954 [INFO] - Model efficientnet moved to cuda
2025-04-30 21:43:22,989 [INFO] - Model inception moved to cuda
2025-04-30 21:43:23,010 [INFO] - Model mobilenet moved to cuda
2025-04-30 21:43:23,037 [INFO] - Model resnet moved to cuda
2025-04-30 21:43:23,067 [INFO] - Model densenet moved to cuda
2025-04-30 21:43:23,072 [INFO] - Model student moved to cuda
2025-04-30 21:43:23,072 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-04-30 21:43:23,088 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-04-30 21:43:23,090 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-04-30 21:43:23,091 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-04-30 21:43:23,093 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-04-30 21:43:23,095 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-04-30 21:43:23,098 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-04-30 21:43:23,098 [INFO] - Starting initialization phase...
2025-04-30 21:43:23,100 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-04-30 21:43:23,102 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-04-30 21:43:23,103 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-04-30 21:43:23,104 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-04-30 21:43:23,106 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-04-30 21:43:23,108 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-04-30 21:43:23,109 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-04-30 21:43:23,110 [INFO] - Initialization Epoch 1/5
2025-04-30 22:10:52,086 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-04-30 22:12:35,335 [INFO] - Restored num_workers to 4.
2025-04-30 22:12:35,340 [INFO] -   vit: Train Loss=0.5260, Train Acc=81.64%, Val Loss=0.0255, Val Acc=93.30%
2025-04-30 22:12:35,384 [INFO] -   New best validation accuracy for vit: 93.30%
2025-04-30 22:12:35,384 [INFO] -   efficientnet: Train Loss=0.4850, Train Acc=83.98%, Val Loss=0.0052, Val Acc=94.72%
2025-04-30 22:12:35,418 [INFO] -   New best validation accuracy for efficientnet: 94.72%
2025-04-30 22:12:35,418 [INFO] -   inception: Train Loss=0.6151, Train Acc=79.57%, Val Loss=0.0279, Val Acc=92.64%
2025-04-30 22:12:35,450 [INFO] -   New best validation accuracy for inception: 92.64%
2025-04-30 22:12:35,451 [INFO] -   mobilenet: Train Loss=0.4409, Train Acc=84.90%, Val Loss=0.0081, Val Acc=91.32%
2025-04-30 22:12:35,481 [INFO] -   New best validation accuracy for mobilenet: 91.32%
2025-04-30 22:12:35,481 [INFO] -   resnet: Train Loss=0.6519, Train Acc=77.66%, Val Loss=0.0187, Val Acc=85.32%
2025-04-30 22:12:35,515 [INFO] -   New best validation accuracy for resnet: 85.32%
2025-04-30 22:12:35,516 [INFO] -   densenet: Train Loss=0.4849, Train Acc=83.82%, Val Loss=0.0103, Val Acc=92.24%
2025-04-30 22:12:35,546 [INFO] -   New best validation accuracy for densenet: 92.24%
2025-04-30 22:12:35,547 [INFO] -   student: Train Loss=0.4854, Train Acc=83.65%, Val Loss=0.0061, Val Acc=93.20%
2025-04-30 22:12:35,585 [INFO] -   New best validation accuracy for student: 93.20%
2025-04-30 22:12:35,585 [INFO] - Initialization epoch 1 completed in 1752.48s
2025-04-30 22:12:35,585 [INFO] - Initialization Epoch 2/5
2025-04-30 22:38:35,795 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-04-30 22:40:17,414 [INFO] - Restored num_workers to 4.
2025-04-30 22:40:17,414 [INFO] -   vit: Train Loss=0.1300, Train Acc=95.63%, Val Loss=0.0177, Val Acc=95.58%
2025-04-30 22:40:17,447 [INFO] -   New best validation accuracy for vit: 95.58%
2025-04-30 22:40:17,454 [INFO] -   efficientnet: Train Loss=0.2041, Train Acc=93.10%, Val Loss=0.0043, Val Acc=95.22%
2025-04-30 22:40:17,485 [INFO] -   New best validation accuracy for efficientnet: 95.22%
2025-04-30 22:40:17,485 [INFO] -   inception: Train Loss=0.3220, Train Acc=89.58%, Val Loss=0.0244, Val Acc=93.44%
2025-04-30 22:40:17,518 [INFO] -   New best validation accuracy for inception: 93.44%
2025-04-30 22:40:17,519 [INFO] -   mobilenet: Train Loss=0.2196, Train Acc=92.54%, Val Loss=0.0074, Val Acc=91.98%
2025-04-30 22:40:17,552 [INFO] -   New best validation accuracy for mobilenet: 91.98%
2025-04-30 22:40:17,553 [INFO] -   resnet: Train Loss=0.3993, Train Acc=86.47%, Val Loss=0.0141, Val Acc=89.06%
2025-04-30 22:40:17,586 [INFO] -   New best validation accuracy for resnet: 89.06%
2025-04-30 22:40:17,587 [INFO] -   densenet: Train Loss=0.2480, Train Acc=91.67%, Val Loss=0.0079, Val Acc=93.86%
2025-04-30 22:40:17,618 [INFO] -   New best validation accuracy for densenet: 93.86%
2025-04-30 22:40:17,620 [INFO] -   student: Train Loss=0.2342, Train Acc=92.04%, Val Loss=0.0055, Val Acc=94.36%
2025-04-30 22:40:17,651 [INFO] -   New best validation accuracy for student: 94.36%
2025-04-30 22:40:17,652 [INFO] - Initialization epoch 2 completed in 1662.07s
2025-04-30 22:40:17,652 [INFO] - Initialization Epoch 3/5
2025-04-30 23:06:29,886 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-04-30 23:08:12,313 [INFO] - Restored num_workers to 4.
2025-04-30 23:08:12,313 [INFO] -   vit: Train Loss=0.0870, Train Acc=97.05%, Val Loss=0.0190, Val Acc=94.78%
2025-04-30 23:08:12,323 [INFO] -   efficientnet: Train Loss=0.1402, Train Acc=95.30%, Val Loss=0.0037, Val Acc=95.72%
2025-04-30 23:08:12,353 [INFO] -   New best validation accuracy for efficientnet: 95.72%
2025-04-30 23:08:12,354 [INFO] -   inception: Train Loss=0.2372, Train Acc=92.23%, Val Loss=0.0235, Val Acc=93.80%
2025-04-30 23:08:12,386 [INFO] -   New best validation accuracy for inception: 93.80%
2025-04-30 23:08:12,388 [INFO] -   mobilenet: Train Loss=0.1634, Train Acc=94.42%, Val Loss=0.0060, Val Acc=93.94%
2025-04-30 23:08:12,434 [INFO] -   New best validation accuracy for mobilenet: 93.94%
2025-04-30 23:08:12,436 [INFO] -   resnet: Train Loss=0.3220, Train Acc=89.09%, Val Loss=0.0134, Val Acc=89.22%
2025-04-30 23:08:12,472 [INFO] -   New best validation accuracy for resnet: 89.22%
2025-04-30 23:08:12,473 [INFO] -   densenet: Train Loss=0.1856, Train Acc=93.78%, Val Loss=0.0069, Val Acc=94.02%
2025-04-30 23:08:12,506 [INFO] -   New best validation accuracy for densenet: 94.02%
2025-04-30 23:08:12,507 [INFO] -   student: Train Loss=0.1780, Train Acc=94.02%, Val Loss=0.0047, Val Acc=94.94%
2025-04-30 23:08:12,539 [INFO] -   New best validation accuracy for student: 94.94%
2025-04-30 23:08:12,540 [INFO] - Initialization epoch 3 completed in 1674.89s
2025-04-30 23:08:12,540 [INFO] - Initialization Epoch 4/5
2025-04-30 23:34:26,555 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-04-30 23:36:07,142 [INFO] - Restored num_workers to 4.
2025-04-30 23:36:07,143 [INFO] -   vit: Train Loss=0.0904, Train Acc=96.98%, Val Loss=0.0195, Val Acc=95.00%
2025-04-30 23:36:07,143 [INFO] -   efficientnet: Train Loss=0.1095, Train Acc=96.36%, Val Loss=0.0040, Val Acc=95.84%
2025-04-30 23:36:07,190 [INFO] -   New best validation accuracy for efficientnet: 95.84%
2025-04-30 23:36:07,190 [INFO] -   inception: Train Loss=0.1949, Train Acc=93.58%, Val Loss=0.0207, Val Acc=94.58%
2025-04-30 23:36:07,220 [INFO] -   New best validation accuracy for inception: 94.58%
2025-04-30 23:36:07,221 [INFO] -   mobilenet: Train Loss=0.1264, Train Acc=95.78%, Val Loss=0.0054, Val Acc=94.40%
2025-04-30 23:36:07,261 [INFO] -   New best validation accuracy for mobilenet: 94.40%
2025-04-30 23:36:07,262 [INFO] -   resnet: Train Loss=0.2637, Train Acc=90.93%, Val Loss=0.0122, Val Acc=89.84%
2025-04-30 23:36:07,294 [INFO] -   New best validation accuracy for resnet: 89.84%
2025-04-30 23:36:07,295 [INFO] -   densenet: Train Loss=0.1552, Train Acc=94.76%, Val Loss=0.0071, Val Acc=94.08%
2025-04-30 23:36:07,326 [INFO] -   New best validation accuracy for densenet: 94.08%
2025-04-30 23:36:07,326 [INFO] -   student: Train Loss=0.1379, Train Acc=95.30%, Val Loss=0.0042, Val Acc=95.40%
2025-04-30 23:36:07,371 [INFO] -   New best validation accuracy for student: 95.40%
2025-04-30 23:36:07,371 [INFO] - Initialization epoch 4 completed in 1674.83s
2025-04-30 23:36:07,372 [INFO] - Initialization Epoch 5/5
2025-05-01 00:01:52,880 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-01 00:03:33,357 [INFO] - Restored num_workers to 4.
2025-05-01 00:03:33,358 [INFO] -   vit: Train Loss=0.0597, Train Acc=97.90%, Val Loss=0.0209, Val Acc=95.00%
2025-05-01 00:03:33,359 [INFO] -   efficientnet: Train Loss=0.0865, Train Acc=97.08%, Val Loss=0.0035, Val Acc=96.16%
2025-05-01 00:03:33,393 [INFO] -   New best validation accuracy for efficientnet: 96.16%
2025-05-01 00:03:33,393 [INFO] -   inception: Train Loss=0.1573, Train Acc=94.88%, Val Loss=0.0222, Val Acc=94.46%
2025-05-01 00:03:33,396 [INFO] -   mobilenet: Train Loss=0.1084, Train Acc=96.26%, Val Loss=0.0058, Val Acc=94.44%
2025-05-01 00:03:33,430 [INFO] -   New best validation accuracy for mobilenet: 94.44%
2025-05-01 00:03:33,431 [INFO] -   resnet: Train Loss=0.2236, Train Acc=92.40%, Val Loss=0.0096, Val Acc=91.98%
2025-05-01 00:03:33,463 [INFO] -   New best validation accuracy for resnet: 91.98%
2025-05-01 00:03:33,463 [INFO] -   densenet: Train Loss=0.1293, Train Acc=95.63%, Val Loss=0.0058, Val Acc=95.44%
2025-05-01 00:03:33,500 [INFO] -   New best validation accuracy for densenet: 95.44%
2025-05-01 00:03:33,500 [INFO] -   student: Train Loss=0.1147, Train Acc=96.01%, Val Loss=0.0047, Val Acc=95.10%
2025-05-01 00:03:33,501 [INFO] - Initialization epoch 5 completed in 1646.13s
2025-05-01 00:03:33,506 [ERROR] - Failed to restore best state for vit after initialization: invalid group reference 1 at position 10
2025-05-01 00:03:33,521 [INFO] - Restored best state for efficientnet from initialization (Val Acc: 96.16%)
2025-05-01 00:03:33,527 [ERROR] - Failed to restore best state for inception after initialization: invalid group reference 1 at position 10
2025-05-01 00:03:33,537 [ERROR] - Failed to restore best state for mobilenet after initialization: invalid group reference 1 at position 10
2025-05-01 00:03:33,541 [ERROR] - Failed to restore best state for resnet after initialization: invalid group reference 1 at position 10
2025-05-01 00:03:33,549 [ERROR] - Failed to restore best state for densenet after initialization: invalid group reference 1 at position 10
2025-05-01 00:03:33,583 [INFO] - Restored best state for student from initialization (Val Acc: 95.40%)
2025-05-01 00:03:33,584 [INFO] - Initialization phase completed
2025-05-01 00:03:33,595 [INFO] - Starting mutual learning phase...
2025-05-01 00:03:33,595 [WARNING] - Synchronous DML ideally uses a single shared train loader. Using student's loader as primary.
2025-05-01 00:03:33,595 [INFO] - Hook registered for encoder.ln
2025-05-01 00:03:33,595 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 00:03:33,752 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 00:03:33,752 [INFO] - Hook registered for features.8
2025-05-01 00:03:33,752 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 00:03:34,045 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 00:03:34,045 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 00:03:34,048 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 00:03:34,328 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 00:03:34,330 [INFO] - Hook registered for features
2025-05-01 00:03:34,330 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 00:03:34,498 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 00:03:34,498 [INFO] - Hook registered for layer4
2025-05-01 00:03:34,498 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 00:03:34,670 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 00:03:34,670 [INFO] - Hook registered for features
2025-05-01 00:03:34,670 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 00:03:34,990 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 00:03:34,990 [INFO] - Hook registered for features.8
2025-05-01 00:03:34,990 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 00:03:34,995 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 00:03:36,200 [INFO] - HFI module initialized with 6 teachers
2025-05-01 00:03:36,200 [INFO] - Target student feature shape: torch.Size([1280, 7, 7])
2025-05-01 00:03:36,200 [INFO] - Heterogeneous Feature Integrator (HFI) initialized.
2025-05-01 00:03:36,454 [INFO] - Using LR warmup for 3 epochs for model vit.
2025-05-01 00:03:36,462 [INFO] - Using LR warmup for 3 epochs for model efficientnet.
2025-05-01 00:03:36,462 [INFO] - Using LR warmup for 3 epochs for model inception.
2025-05-01 00:03:36,462 [INFO] - Using LR warmup for 3 epochs for model mobilenet.
2025-05-01 00:03:36,462 [INFO] - Using LR warmup for 3 epochs for model resnet.
2025-05-01 00:03:36,462 [INFO] - Using LR warmup for 3 epochs for model densenet.
2025-05-01 00:03:36,462 [INFO] - Using LR warmup for 3 epochs for model student.
2025-05-01 00:03:36,462 [INFO] - Added HFI parameters to the student optimizer.
2025-05-01 00:03:36,473 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250501_000336_config.json
2025-05-01 00:03:36,473 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-01 00:03:36,810 [ERROR] - An error occurred: CUDA out of memory. Tried to allocate 12.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 464.00 MiB is free. 4.50 GiB allowed; Of the allocated memory 4.36 GiB is allocated by PyTorch, and 130.62 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-05-01 00:03:36,827 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_25012\2295798498.py", line 2944, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_25012\2295798498.py", line 2145, in mutual_learning_phase
    outputs = model(current_input)
              ^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 343, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 333, in _forward_impl
    x = self.features(x)
        ^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 164, in forward
    result = self.block(input)
             ^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\ops\misc.py", line 260, in forward
    return scale * input
           ~~~~~~^~~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 12.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 464.00 MiB is free. 4.50 GiB allowed; Of the allocated memory 4.36 GiB is allocated by PyTorch, and 130.62 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-05-01 05:26:33,723 [INFO] - Using device: cuda
2025-05-01 05:26:33,738 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 05:26:33,738 [INFO] - GPU Memory: 6.00 GB
2025-05-01 05:26:33,738 [INFO] - CUDA Version: 12.4
2025-05-01 05:26:33,825 [INFO] - cuDNN benchmark mode enabled
2025-05-01 05:26:33,840 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 32,
    "gradient_accumulation_steps": 64,
    "gpu_memory_fraction": 0.7,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 8,
        "inception": 4,
        "mobilenet": 16,
        "resnet": 8,
        "densenet": 8,
        "student": 8
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 05:26:33,908 [INFO] - Random seed set to 42
2025-05-01 05:26:33,908 [INFO] - Preparing data loaders...
2025-05-01 05:26:43,009 [INFO] - Training samples: 45000 per model
2025-05-01 05:26:43,009 [INFO] - Validation samples: 5000 per model
2025-05-01 05:26:43,009 [INFO] - Test samples: 10000 per model
2025-05-01 05:26:43,011 [INFO] - Creating models for mutual learning...
2025-05-01 05:26:43,011 [INFO] - Loading ViT-B16 model...
2025-05-01 05:26:44,018 [INFO] - Loading EfficientNetB0 model...
2025-05-01 05:26:44,152 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 05:26:44,586 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 05:26:44,587 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 05:26:44,719 [INFO] - Loading ResNet50 model...
2025-05-01 05:26:45,138 [INFO] - Loading DenseNet121 model...
2025-05-01 05:26:45,322 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 05:26:45,696 [INFO] - Model vit moved to cuda
2025-05-01 05:26:45,725 [INFO] - Model efficientnet moved to cuda
2025-05-01 05:26:45,770 [INFO] - Model inception moved to cuda
2025-05-01 05:26:45,778 [INFO] - Model mobilenet moved to cuda
2025-05-01 05:26:45,820 [INFO] - Model resnet moved to cuda
2025-05-01 05:26:45,854 [INFO] - Model densenet moved to cuda
2025-05-01 05:26:45,873 [INFO] - Model student moved to cuda
2025-05-01 05:26:45,875 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 05:26:45,877 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 05:26:45,879 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 05:26:45,880 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 05:26:45,881 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 05:26:45,883 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 05:26:45,883 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 05:26:45,883 [INFO] - Starting initialization phase...
2025-05-01 05:26:45,883 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-05-01 05:26:45,889 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-05-01 05:26:45,890 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-05-01 05:26:45,891 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-05-01 05:26:45,892 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-05-01 05:26:45,894 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-05-01 05:26:45,896 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-05-01 05:26:45,896 [INFO] - Initialization Epoch 1/5
2025-05-01 05:37:00,384 [INFO] - Using device: cuda
2025-05-01 05:37:00,390 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 05:37:00,390 [INFO] - GPU Memory: 6.00 GB
2025-05-01 05:37:00,390 [INFO] - CUDA Version: 12.4
2025-05-01 05:37:00,468 [INFO] - cuDNN benchmark mode enabled
2025-05-01 05:37:00,475 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 32,
    "gradient_accumulation_steps": 64,
    "gpu_memory_fraction": 0.7,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 8,
        "inception": 4,
        "mobilenet": 16,
        "resnet": 8,
        "densenet": 8,
        "student": 8
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 05:37:00,551 [INFO] - Random seed set to 42
2025-05-01 05:37:00,551 [INFO] - Preparing data loaders...
2025-05-01 05:37:09,610 [INFO] - Training samples: 45000 per model
2025-05-01 05:37:09,610 [INFO] - Validation samples: 5000 per model
2025-05-01 05:37:09,610 [INFO] - Test samples: 10000 per model
2025-05-01 05:37:09,610 [INFO] - Creating models for mutual learning...
2025-05-01 05:37:09,610 [INFO] - Loading ViT-B16 model...
2025-05-01 05:37:10,667 [INFO] - Loading EfficientNetB0 model...
2025-05-01 05:37:10,792 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 05:37:11,174 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 05:37:11,174 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 05:37:11,284 [INFO] - Loading ResNet50 model...
2025-05-01 05:37:11,696 [INFO] - Loading DenseNet121 model...
2025-05-01 05:37:11,841 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 05:37:12,238 [INFO] - Model vit moved to cuda
2025-05-01 05:37:12,285 [INFO] - Model efficientnet moved to cuda
2025-05-01 05:37:12,330 [INFO] - Model inception moved to cuda
2025-05-01 05:37:12,391 [INFO] - Model mobilenet moved to cuda
2025-05-01 05:37:12,423 [INFO] - Model resnet moved to cuda
2025-05-01 05:37:12,455 [INFO] - Model densenet moved to cuda
2025-05-01 05:37:12,492 [INFO] - Model student moved to cuda
2025-05-01 05:37:12,494 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 05:37:12,496 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 05:37:12,498 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 05:37:12,500 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 05:37:12,500 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 05:37:12,500 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 05:37:12,500 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 05:37:12,500 [INFO] - Starting initialization phase...
2025-05-01 05:37:12,500 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-05-01 05:37:12,509 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-05-01 05:37:12,510 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-05-01 05:37:12,511 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-05-01 05:37:12,511 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-05-01 05:37:12,514 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-05-01 05:37:12,516 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-05-01 05:37:12,517 [INFO] - Initialization Epoch 1/5
2025-05-01 06:25:11,484 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-01 06:28:02,072 [INFO] - Restored num_workers to 4.
2025-05-01 06:28:02,072 [INFO] -   vit: Train Loss=0.5723, Train Acc=79.90%, Val Loss=0.0456, Val Acc=93.46%
2025-05-01 06:28:02,115 [INFO] -   New best validation accuracy for vit: 93.46%
2025-05-01 06:28:02,115 [INFO] -   efficientnet: Train Loss=0.6371, Train Acc=78.83%, Val Loss=0.0230, Val Acc=93.70%
2025-05-01 06:28:02,145 [INFO] -   New best validation accuracy for efficientnet: 93.70%
2025-05-01 06:28:02,146 [INFO] -   inception: Train Loss=0.7438, Train Acc=76.12%, Val Loss=0.0724, Val Acc=90.18%
2025-05-01 06:28:02,180 [INFO] -   New best validation accuracy for inception: 90.18%
2025-05-01 06:28:02,180 [INFO] -   mobilenet: Train Loss=0.5062, Train Acc=82.50%, Val Loss=0.0135, Val Acc=92.08%
2025-05-01 06:28:02,232 [INFO] -   New best validation accuracy for mobilenet: 92.08%
2025-05-01 06:28:02,233 [INFO] -   resnet: Train Loss=0.7628, Train Acc=74.20%, Val Loss=0.0452, Val Acc=87.74%
2025-05-01 06:28:02,269 [INFO] -   New best validation accuracy for resnet: 87.74%
2025-05-01 06:28:02,269 [INFO] -   densenet: Train Loss=0.5932, Train Acc=80.36%, Val Loss=0.0278, Val Acc=92.38%
2025-05-01 06:28:02,306 [INFO] -   New best validation accuracy for densenet: 92.38%
2025-05-01 06:28:02,307 [INFO] -   student: Train Loss=0.6068, Train Acc=79.85%, Val Loss=0.0260, Val Acc=92.56%
2025-05-01 06:28:02,340 [INFO] -   New best validation accuracy for student: 92.56%
2025-05-01 06:28:02,340 [INFO] - Initialization epoch 1 completed in 3049.82s
2025-05-01 06:28:02,346 [INFO] - Initialization Epoch 2/5
2025-05-01 07:14:19,973 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-01 07:17:10,296 [INFO] - Restored num_workers to 4.
2025-05-01 07:17:10,296 [INFO] -   vit: Train Loss=0.1442, Train Acc=95.09%, Val Loss=0.0402, Val Acc=94.44%
2025-05-01 07:17:10,340 [INFO] -   New best validation accuracy for vit: 94.44%
2025-05-01 07:17:10,340 [INFO] -   efficientnet: Train Loss=0.2867, Train Acc=90.42%, Val Loss=0.0178, Val Acc=95.06%
2025-05-01 07:17:10,381 [INFO] -   New best validation accuracy for efficientnet: 95.06%
2025-05-01 07:17:10,381 [INFO] -   inception: Train Loss=0.3895, Train Acc=87.73%, Val Loss=0.0628, Val Acc=91.86%
2025-05-01 07:17:10,431 [INFO] -   New best validation accuracy for inception: 91.86%
2025-05-01 07:17:10,431 [INFO] -   mobilenet: Train Loss=0.2402, Train Acc=91.73%, Val Loss=0.0128, Val Acc=92.68%
2025-05-01 07:17:10,478 [INFO] -   New best validation accuracy for mobilenet: 92.68%
2025-05-01 07:17:10,478 [INFO] -   resnet: Train Loss=0.4471, Train Acc=85.24%, Val Loss=0.0385, Val Acc=89.62%
2025-05-01 07:17:10,515 [INFO] -   New best validation accuracy for resnet: 89.62%
2025-05-01 07:17:10,516 [INFO] -   densenet: Train Loss=0.3028, Train Acc=90.11%, Val Loss=0.0228, Val Acc=93.86%
2025-05-01 07:17:10,545 [INFO] -   New best validation accuracy for densenet: 93.86%
2025-05-01 07:17:10,546 [INFO] -   student: Train Loss=0.3043, Train Acc=89.91%, Val Loss=0.0236, Val Acc=93.88%
2025-05-01 07:17:10,575 [INFO] -   New best validation accuracy for student: 93.88%
2025-05-01 07:17:10,576 [INFO] - Initialization epoch 2 completed in 2948.23s
2025-05-01 07:17:10,577 [INFO] - Initialization Epoch 3/5
2025-05-01 08:03:42,342 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-01 08:06:33,660 [INFO] - Restored num_workers to 4.
2025-05-01 08:06:33,661 [INFO] -   vit: Train Loss=0.0893, Train Acc=97.00%, Val Loss=0.0391, Val Acc=94.84%
2025-05-01 08:06:33,705 [INFO] -   New best validation accuracy for vit: 94.84%
2025-05-01 08:06:33,705 [INFO] -   efficientnet: Train Loss=0.1995, Train Acc=93.18%, Val Loss=0.0174, Val Acc=95.38%
2025-05-01 08:06:33,738 [INFO] -   New best validation accuracy for efficientnet: 95.38%
2025-05-01 08:06:33,738 [INFO] -   inception: Train Loss=0.2924, Train Acc=90.67%, Val Loss=0.0517, Val Acc=93.16%
2025-05-01 08:06:33,778 [INFO] -   New best validation accuracy for inception: 93.16%
2025-05-01 08:06:33,779 [INFO] -   mobilenet: Train Loss=0.1819, Train Acc=93.86%, Val Loss=0.0095, Val Acc=94.68%
2025-05-01 08:06:33,816 [INFO] -   New best validation accuracy for mobilenet: 94.68%
2025-05-01 08:06:33,816 [INFO] -   resnet: Train Loss=0.3463, Train Acc=88.36%, Val Loss=0.0339, Val Acc=90.92%
2025-05-01 08:06:33,851 [INFO] -   New best validation accuracy for resnet: 90.92%
2025-05-01 08:06:33,852 [INFO] -   densenet: Train Loss=0.2298, Train Acc=92.53%, Val Loss=0.0182, Val Acc=95.18%
2025-05-01 08:06:33,895 [INFO] -   New best validation accuracy for densenet: 95.18%
2025-05-01 08:06:33,896 [INFO] -   student: Train Loss=0.2258, Train Acc=92.32%, Val Loss=0.0190, Val Acc=94.76%
2025-05-01 08:06:33,933 [INFO] -   New best validation accuracy for student: 94.76%
2025-05-01 08:06:33,934 [INFO] - Initialization epoch 3 completed in 2963.36s
2025-05-01 08:06:33,935 [INFO] - Initialization Epoch 4/5
2025-05-01 08:53:02,818 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-01 08:55:55,669 [INFO] - Restored num_workers to 4.
2025-05-01 08:55:55,670 [INFO] -   vit: Train Loss=0.0703, Train Acc=97.56%, Val Loss=0.0361, Val Acc=95.08%
2025-05-01 08:55:55,702 [INFO] -   New best validation accuracy for vit: 95.08%
2025-05-01 08:55:55,703 [INFO] -   efficientnet: Train Loss=0.1547, Train Acc=94.79%, Val Loss=0.0135, Val Acc=96.40%
2025-05-01 08:55:55,736 [INFO] -   New best validation accuracy for efficientnet: 96.40%
2025-05-01 08:55:55,737 [INFO] -   inception: Train Loss=0.2404, Train Acc=92.27%, Val Loss=0.0513, Val Acc=93.24%
2025-05-01 08:55:55,781 [INFO] -   New best validation accuracy for inception: 93.24%
2025-05-01 08:55:55,781 [INFO] -   mobilenet: Train Loss=0.1450, Train Acc=95.07%, Val Loss=0.0089, Val Acc=94.90%
2025-05-01 08:55:55,820 [INFO] -   New best validation accuracy for mobilenet: 94.90%
2025-05-01 08:55:55,829 [INFO] -   resnet: Train Loss=0.2792, Train Acc=90.55%, Val Loss=0.0310, Val Acc=91.88%
2025-05-01 08:55:55,858 [INFO] -   New best validation accuracy for resnet: 91.88%
2025-05-01 08:55:55,858 [INFO] -   densenet: Train Loss=0.1849, Train Acc=93.89%, Val Loss=0.0186, Val Acc=94.96%
2025-05-01 08:55:55,859 [INFO] -   student: Train Loss=0.1769, Train Acc=93.96%, Val Loss=0.0180, Val Acc=95.20%
2025-05-01 08:55:55,897 [INFO] -   New best validation accuracy for student: 95.20%
2025-05-01 08:55:55,898 [INFO] - Initialization epoch 4 completed in 2961.96s
2025-05-01 08:55:55,899 [INFO] - Initialization Epoch 5/5
2025-05-01 09:41:26,072 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-01 09:44:13,400 [INFO] - Restored num_workers to 4.
2025-05-01 09:44:13,400 [INFO] -   vit: Train Loss=0.0581, Train Acc=97.98%, Val Loss=0.0323, Val Acc=95.86%
2025-05-01 09:44:13,443 [INFO] -   New best validation accuracy for vit: 95.86%
2025-05-01 09:44:13,444 [INFO] -   efficientnet: Train Loss=0.1252, Train Acc=95.78%, Val Loss=0.0143, Val Acc=96.40%
2025-05-01 09:44:13,446 [INFO] -   inception: Train Loss=0.2012, Train Acc=93.56%, Val Loss=0.0431, Val Acc=94.22%
2025-05-01 09:44:13,488 [INFO] -   New best validation accuracy for inception: 94.22%
2025-05-01 09:44:13,489 [INFO] -   mobilenet: Train Loss=0.1178, Train Acc=95.91%, Val Loss=0.0085, Val Acc=95.62%
2025-05-01 09:44:13,524 [INFO] -   New best validation accuracy for mobilenet: 95.62%
2025-05-01 09:44:13,525 [INFO] -   resnet: Train Loss=0.2409, Train Acc=91.98%, Val Loss=0.0220, Val Acc=93.88%
2025-05-01 09:44:13,554 [INFO] -   New best validation accuracy for resnet: 93.88%
2025-05-01 09:44:13,555 [INFO] -   densenet: Train Loss=0.1527, Train Acc=94.97%, Val Loss=0.0166, Val Acc=95.36%
2025-05-01 09:44:13,583 [INFO] -   New best validation accuracy for densenet: 95.36%
2025-05-01 09:44:13,584 [INFO] -   student: Train Loss=0.1525, Train Acc=94.76%, Val Loss=0.0157, Val Acc=95.76%
2025-05-01 09:44:13,629 [INFO] -   New best validation accuracy for student: 95.76%
2025-05-01 09:44:13,630 [INFO] - Initialization epoch 5 completed in 2897.73s
2025-05-01 09:44:13,633 [ERROR] - Failed to restore best state for vit after initialization: invalid group reference 1 at position 10
2025-05-01 09:44:13,650 [INFO] - Restored best state for efficientnet from initialization (Val Acc: 96.40%)
2025-05-01 09:44:13,656 [ERROR] - Failed to restore best state for inception after initialization: invalid group reference 1 at position 10
2025-05-01 09:44:13,667 [ERROR] - Failed to restore best state for mobilenet after initialization: invalid group reference 1 at position 10
2025-05-01 09:44:13,670 [ERROR] - Failed to restore best state for resnet after initialization: invalid group reference 1 at position 10
2025-05-01 09:44:13,677 [ERROR] - Failed to restore best state for densenet after initialization: invalid group reference 1 at position 10
2025-05-01 09:44:13,692 [INFO] - Restored best state for student from initialization (Val Acc: 95.76%)
2025-05-01 09:44:13,693 [INFO] - Initialization phase completed
2025-05-01 09:44:13,705 [INFO] - Starting mutual learning phase...
2025-05-01 09:44:13,706 [WARNING] - Synchronous DML ideally uses a single shared train loader. Using student's loader as primary.
2025-05-01 09:44:13,707 [INFO] - Hook registered for encoder.ln
2025-05-01 09:44:13,707 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 09:44:13,829 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 09:44:13,829 [INFO] - Hook registered for features.8
2025-05-01 09:44:13,829 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 09:44:14,073 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 09:44:14,074 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 09:44:14,075 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 09:44:14,369 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 09:44:14,369 [INFO] - Hook registered for features
2025-05-01 09:44:14,369 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 09:44:14,498 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 09:44:14,498 [INFO] - Hook registered for layer4
2025-05-01 09:44:14,498 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 09:44:14,657 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 09:44:14,657 [INFO] - Hook registered for features
2025-05-01 09:44:14,657 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 09:44:15,000 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 09:44:15,000 [INFO] - Hook registered for features.8
2025-05-01 09:44:15,000 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 09:44:15,014 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 09:44:16,084 [INFO] - HFI module initialized with 6 teachers
2025-05-01 09:44:16,084 [INFO] - Target student feature shape: torch.Size([1280, 7, 7])
2025-05-01 09:44:16,084 [INFO] - Heterogeneous Feature Integrator (HFI) initialized.
2025-05-01 09:44:16,377 [INFO] - Using LR warmup for 3 epochs for model vit.
2025-05-01 09:44:16,377 [INFO] - Using LR warmup for 3 epochs for model efficientnet.
2025-05-01 09:44:16,377 [INFO] - Using LR warmup for 3 epochs for model inception.
2025-05-01 09:44:16,377 [INFO] - Using LR warmup for 3 epochs for model mobilenet.
2025-05-01 09:44:16,377 [INFO] - Using LR warmup for 3 epochs for model resnet.
2025-05-01 09:44:16,377 [INFO] - Using LR warmup for 3 epochs for model densenet.
2025-05-01 09:44:16,377 [INFO] - Using LR warmup for 3 epochs for model student.
2025-05-01 09:44:16,387 [INFO] - Added HFI parameters to the student optimizer.
2025-05-01 09:44:16,387 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250501_094416_config.json
2025-05-01 09:44:16,387 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-01 09:44:17,205 [ERROR] - An error occurred: The size of tensor a (197) must match the size of tensor b (1280) at non-singleton dimension 2
2025-05-01 09:44:17,208 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_25324\2845347314.py", line 2933, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_25324\2845347314.py", line 2166, in mutual_learning_phase
    fused_hfi_features = hfi(teacher_features_detached)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_25324\2845347314.py", line 1178, in forward
    fused_features = fused_features + weighted
                     ~~~~~~~~~~~~~~~^~~~~~~~~~
RuntimeError: The size of tensor a (197) must match the size of tensor b (1280) at non-singleton dimension 2

2025-05-01 10:13:31,878 [INFO] - Using device: cuda
2025-05-01 10:13:31,878 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 10:13:31,878 [INFO] - GPU Memory: 6.00 GB
2025-05-01 10:13:31,878 [INFO] - CUDA Version: 12.4
2025-05-01 10:13:31,878 [INFO] - cuDNN benchmark mode enabled
2025-05-01 10:13:31,901 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 32,
    "gradient_accumulation_steps": 64,
    "gpu_memory_fraction": 0.7,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 8,
        "inception": 4,
        "mobilenet": 16,
        "resnet": 8,
        "densenet": 8,
        "student": 8
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 0,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 10:13:31,904 [INFO] - Random seed set to 42
2025-05-01 10:13:31,904 [INFO] - Preparing data loaders...
2025-05-01 10:13:40,965 [INFO] - Training samples: 45000 per model
2025-05-01 10:13:40,966 [INFO] - Validation samples: 5000 per model
2025-05-01 10:13:40,966 [INFO] - Test samples: 10000 per model
2025-05-01 10:13:40,967 [INFO] - Creating models for mutual learning...
2025-05-01 10:13:40,968 [INFO] - Loading ViT-B16 model...
2025-05-01 10:13:41,970 [INFO] - Loading EfficientNetB0 model...
2025-05-01 10:13:42,130 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 10:13:42,753 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 10:13:42,755 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 10:13:42,869 [INFO] - Loading ResNet50 model...
2025-05-01 10:13:43,294 [INFO] - Loading DenseNet121 model...
2025-05-01 10:13:43,453 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 10:13:43,811 [INFO] - Model vit moved to cuda
2025-05-01 10:13:43,832 [INFO] - Model efficientnet moved to cuda
2025-05-01 10:13:43,865 [INFO] - Model inception moved to cuda
2025-05-01 10:13:43,881 [INFO] - Model mobilenet moved to cuda
2025-05-01 10:13:43,913 [INFO] - Model resnet moved to cuda
2025-05-01 10:13:43,940 [INFO] - Model densenet moved to cuda
2025-05-01 10:13:43,958 [INFO] - Model student moved to cuda
2025-05-01 10:13:43,971 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 10:13:43,971 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 10:13:43,971 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 10:13:43,971 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 10:13:43,971 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 10:13:43,971 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 10:13:43,971 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 10:13:43,971 [INFO] - Starting initialization phase...
2025-05-01 10:13:43,971 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-05-01 10:13:43,987 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-05-01 10:13:43,989 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-05-01 10:13:43,990 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-05-01 10:13:43,991 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-05-01 10:13:43,993 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-05-01 10:13:43,995 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-05-01 10:13:43,995 [WARNING] - No best state found for vit during initialization.
2025-05-01 10:13:43,996 [WARNING] - No best state found for efficientnet during initialization.
2025-05-01 10:13:43,996 [WARNING] - No best state found for inception during initialization.
2025-05-01 10:13:43,997 [WARNING] - No best state found for mobilenet during initialization.
2025-05-01 10:13:43,998 [WARNING] - No best state found for resnet during initialization.
2025-05-01 10:13:43,998 [WARNING] - No best state found for densenet during initialization.
2025-05-01 10:13:43,998 [WARNING] - No best state found for student during initialization.
2025-05-01 10:13:43,998 [INFO] - Initialization phase completed
2025-05-01 10:13:43,998 [INFO] - Starting mutual learning phase...
2025-05-01 10:13:43,998 [WARNING] - Synchronous DML ideally uses a single shared train loader. Using student's loader as primary.
2025-05-01 10:13:43,998 [INFO] - Hook registered for encoder.ln
2025-05-01 10:13:43,998 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 10:13:44,014 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 10:13:44,014 [INFO] - Hook registered for features.8
2025-05-01 10:13:44,014 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 10:13:44,030 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 10:13:44,030 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 10:13:44,030 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 10:13:44,061 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 10:13:44,061 [INFO] - Hook registered for features
2025-05-01 10:13:44,061 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 10:13:44,077 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 10:13:44,077 [INFO] - Hook registered for layer4
2025-05-01 10:13:44,077 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 10:13:44,099 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 10:13:44,100 [INFO] - Hook registered for features
2025-05-01 10:13:44,101 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 10:13:44,128 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 10:13:44,128 [INFO] - Hook registered for features.8
2025-05-01 10:13:44,128 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 10:13:44,157 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 10:13:44,259 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 10:13:44,259 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 10:13:44,259 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 10:13:44,259 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 10:13:44,273 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 10:13:44,273 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 10:13:44,273 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 10:13:44,273 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 10:13:44,288 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 10:13:44,288 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 10:13:44,288 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 10:13:44,288 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 10:13:44,308 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 10:13:44,309 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 10:13:44,316 [INFO] - Heterogeneous Feature Integrator (HFI) initialized.
2025-05-01 10:13:44,527 [INFO] - Using LR warmup for 3 epochs for model vit.
2025-05-01 10:13:44,529 [INFO] - Using LR warmup for 3 epochs for model efficientnet.
2025-05-01 10:13:44,531 [INFO] - Using LR warmup for 3 epochs for model inception.
2025-05-01 10:13:44,532 [INFO] - Using LR warmup for 3 epochs for model mobilenet.
2025-05-01 10:13:44,534 [INFO] - Using LR warmup for 3 epochs for model resnet.
2025-05-01 10:13:44,535 [INFO] - Using LR warmup for 3 epochs for model densenet.
2025-05-01 10:13:44,536 [INFO] - Using LR warmup for 3 epochs for model student.
2025-05-01 10:13:44,537 [INFO] - Added HFI parameters to the student optimizer.
2025-05-01 10:13:44,539 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250501_101344_config.json
2025-05-01 10:13:44,540 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-01 10:20:21,737 [INFO] - Using device: cuda
2025-05-01 10:20:21,737 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 10:20:21,745 [INFO] - GPU Memory: 6.00 GB
2025-05-01 10:20:21,745 [INFO] - CUDA Version: 12.4
2025-05-01 10:20:21,821 [INFO] - cuDNN benchmark mode enabled
2025-05-01 10:20:21,824 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 32,
    "gradient_accumulation_steps": 64,
    "gpu_memory_fraction": 0.7,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 8,
        "inception": 4,
        "mobilenet": 16,
        "resnet": 8,
        "densenet": 8,
        "student": 8
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 10:20:21,900 [INFO] - Random seed set to 42
2025-05-01 10:20:21,900 [INFO] - Preparing data loaders...
2025-05-01 10:20:30,562 [INFO] - Training samples: 45000 per model
2025-05-01 10:20:30,562 [INFO] - Validation samples: 5000 per model
2025-05-01 10:20:30,562 [INFO] - Test samples: 10000 per model
2025-05-01 10:20:30,562 [INFO] - Creating models for mutual learning...
2025-05-01 10:20:30,562 [INFO] - Loading ViT-B16 model...
2025-05-01 10:20:31,452 [INFO] - Loading EfficientNetB0 model...
2025-05-01 10:20:31,538 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 10:20:31,852 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 10:20:31,853 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 10:20:31,942 [INFO] - Loading ResNet50 model...
2025-05-01 10:20:32,266 [INFO] - Loading DenseNet121 model...
2025-05-01 10:20:32,401 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 10:20:32,703 [INFO] - Model vit moved to cuda
2025-05-01 10:20:32,723 [INFO] - Model efficientnet moved to cuda
2025-05-01 10:20:32,776 [INFO] - Model inception moved to cuda
2025-05-01 10:20:32,809 [INFO] - Model mobilenet moved to cuda
2025-05-01 10:20:32,840 [INFO] - Model resnet moved to cuda
2025-05-01 10:20:32,876 [INFO] - Model densenet moved to cuda
2025-05-01 10:20:32,894 [INFO] - Model student moved to cuda
2025-05-01 10:20:32,897 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 10:20:32,897 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 10:20:32,901 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 10:20:32,903 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 10:20:32,904 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 10:20:32,907 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 10:20:32,908 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 10:20:32,908 [INFO] - Starting initialization phase...
2025-05-01 10:20:32,908 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-05-01 10:20:32,908 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-05-01 10:20:32,914 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-05-01 10:20:32,915 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-05-01 10:20:32,917 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-05-01 10:20:32,918 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-05-01 10:20:32,918 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-05-01 10:20:32,918 [INFO] - Initialization Epoch 1/5
2025-05-01 10:20:33,967 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_1.pth (Epoch 1)
2025-05-01 10:24:39,775 [INFO] - Using device: cuda
2025-05-01 10:24:39,780 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 10:24:39,780 [INFO] - GPU Memory: 6.00 GB
2025-05-01 10:24:39,780 [INFO] - CUDA Version: 12.4
2025-05-01 10:24:39,780 [INFO] - cuDNN benchmark mode enabled
2025-05-01 10:24:39,798 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 32,
    "gradient_accumulation_steps": 64,
    "gpu_memory_fraction": 0.7,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 8,
        "inception": 4,
        "mobilenet": 16,
        "resnet": 8,
        "densenet": 8,
        "student": 8
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 10:24:39,800 [INFO] - Random seed set to 42
2025-05-01 10:24:39,800 [INFO] - Preparing data loaders...
2025-05-01 10:24:49,199 [INFO] - Training samples: 45000 per model
2025-05-01 10:24:49,199 [INFO] - Validation samples: 5000 per model
2025-05-01 10:24:49,199 [INFO] - Test samples: 10000 per model
2025-05-01 10:24:49,199 [INFO] - Creating models for mutual learning...
2025-05-01 10:24:49,199 [INFO] - Loading ViT-B16 model...
2025-05-01 10:24:50,226 [INFO] - Loading EfficientNetB0 model...
2025-05-01 10:24:50,391 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 10:24:50,744 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 10:24:50,746 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 10:24:50,853 [INFO] - Loading ResNet50 model...
2025-05-01 10:24:51,243 [INFO] - Loading DenseNet121 model...
2025-05-01 10:24:51,401 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 10:24:51,747 [INFO] - Model vit moved to cuda
2025-05-01 10:24:51,806 [INFO] - Model efficientnet moved to cuda
2025-05-01 10:24:51,852 [INFO] - Model inception moved to cuda
2025-05-01 10:24:51,863 [INFO] - Model mobilenet moved to cuda
2025-05-01 10:24:51,909 [INFO] - Model resnet moved to cuda
2025-05-01 10:24:51,946 [INFO] - Model densenet moved to cuda
2025-05-01 10:24:51,967 [INFO] - Model student moved to cuda
2025-05-01 10:24:51,970 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 10:24:51,970 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 10:24:51,974 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 10:24:51,975 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 10:24:51,977 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 10:24:51,978 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 10:24:51,981 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 10:24:51,982 [INFO] - Starting initialization phase...
2025-05-01 10:24:51,984 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-05-01 10:24:51,984 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-05-01 10:24:51,984 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-05-01 10:24:51,988 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-05-01 10:24:51,989 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-05-01 10:24:51,991 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-05-01 10:24:51,991 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-05-01 10:24:51,991 [INFO] - Initialization Epoch 1/5
2025-05-01 11:14:20,432 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-01 11:17:08,350 [INFO] - Restored num_workers to 4.
2025-05-01 11:17:08,350 [INFO] -   vit: Train Loss=0.5722, Train Acc=79.92%, Val Loss=0.0463, Val Acc=93.74%
2025-05-01 11:17:08,384 [INFO] -   New best validation accuracy for vit: 93.74%
2025-05-01 11:17:08,385 [INFO] -   efficientnet: Train Loss=0.6372, Train Acc=78.82%, Val Loss=0.0231, Val Acc=93.72%
2025-05-01 11:17:08,433 [INFO] -   New best validation accuracy for efficientnet: 93.72%
2025-05-01 11:17:08,434 [INFO] -   inception: Train Loss=0.7381, Train Acc=76.34%, Val Loss=0.0727, Val Acc=90.06%
2025-05-01 11:17:08,473 [INFO] -   New best validation accuracy for inception: 90.06%
2025-05-01 11:17:08,474 [INFO] -   mobilenet: Train Loss=0.5052, Train Acc=82.61%, Val Loss=0.0143, Val Acc=91.64%
2025-05-01 11:17:08,503 [INFO] -   New best validation accuracy for mobilenet: 91.64%
2025-05-01 11:17:08,504 [INFO] -   resnet: Train Loss=0.7680, Train Acc=74.01%, Val Loss=0.0480, Val Acc=86.88%
2025-05-01 11:17:08,534 [INFO] -   New best validation accuracy for resnet: 86.88%
2025-05-01 11:17:08,535 [INFO] -   densenet: Train Loss=0.5943, Train Acc=80.32%, Val Loss=0.0309, Val Acc=91.62%
2025-05-01 11:17:08,565 [INFO] -   New best validation accuracy for densenet: 91.62%
2025-05-01 11:17:08,565 [INFO] -   student: Train Loss=0.6065, Train Acc=79.88%, Val Loss=0.0260, Val Acc=92.74%
2025-05-01 11:17:08,601 [INFO] -   New best validation accuracy for student: 92.74%
2025-05-01 11:17:08,602 [INFO] - Initialization epoch 1 completed in 3136.61s
2025-05-01 11:17:11,545 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_1.pth (Epoch 1)
2025-05-01 11:17:11,545 [INFO] - Initialization Epoch 2/5
2025-05-01 12:05:12,525 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-01 12:08:03,843 [INFO] - Restored num_workers to 4.
2025-05-01 12:08:03,843 [INFO] -   vit: Train Loss=0.1400, Train Acc=95.32%, Val Loss=0.0430, Val Acc=94.22%
2025-05-01 12:08:03,884 [INFO] -   New best validation accuracy for vit: 94.22%
2025-05-01 12:08:03,885 [INFO] -   efficientnet: Train Loss=0.2868, Train Acc=90.39%, Val Loss=0.0177, Val Acc=95.16%
2025-05-01 12:08:03,914 [INFO] -   New best validation accuracy for efficientnet: 95.16%
2025-05-01 12:08:03,915 [INFO] -   inception: Train Loss=0.3987, Train Acc=87.38%, Val Loss=0.0636, Val Acc=91.68%
2025-05-01 12:08:03,945 [INFO] -   New best validation accuracy for inception: 91.68%
2025-05-01 12:08:03,946 [INFO] -   mobilenet: Train Loss=0.2416, Train Acc=91.70%, Val Loss=0.0117, Val Acc=93.52%
2025-05-01 12:08:03,977 [INFO] -   New best validation accuracy for mobilenet: 93.52%
2025-05-01 12:08:03,978 [INFO] -   resnet: Train Loss=0.4513, Train Acc=84.92%, Val Loss=0.0360, Val Acc=90.20%
2025-05-01 12:08:04,008 [INFO] -   New best validation accuracy for resnet: 90.20%
2025-05-01 12:08:04,009 [INFO] -   densenet: Train Loss=0.3063, Train Acc=90.04%, Val Loss=0.0217, Val Acc=94.08%
2025-05-01 12:08:04,040 [INFO] -   New best validation accuracy for densenet: 94.08%
2025-05-01 12:08:04,040 [INFO] -   student: Train Loss=0.3068, Train Acc=89.97%, Val Loss=0.0222, Val Acc=93.92%
2025-05-01 12:08:04,067 [INFO] -   New best validation accuracy for student: 93.92%
2025-05-01 12:08:04,072 [INFO] - Initialization epoch 2 completed in 3052.52s
2025-05-01 12:08:06,466 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_2.pth (Epoch 2)
2025-05-01 12:08:06,473 [INFO] - Initialization Epoch 3/5
2025-05-01 12:56:12,042 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-01 12:59:07,659 [INFO] - Restored num_workers to 4.
2025-05-01 12:59:07,659 [INFO] -   vit: Train Loss=0.0962, Train Acc=96.70%, Val Loss=0.0390, Val Acc=94.70%
2025-05-01 12:59:07,690 [INFO] -   New best validation accuracy for vit: 94.70%
2025-05-01 12:59:07,691 [INFO] -   efficientnet: Train Loss=0.1997, Train Acc=93.19%, Val Loss=0.0176, Val Acc=95.10%
2025-05-01 12:59:07,692 [INFO] -   inception: Train Loss=0.2934, Train Acc=90.51%, Val Loss=0.0584, Val Acc=92.50%
2025-05-01 12:59:07,721 [INFO] -   New best validation accuracy for inception: 92.50%
2025-05-01 12:59:07,722 [INFO] -   mobilenet: Train Loss=0.1823, Train Acc=93.69%, Val Loss=0.0093, Val Acc=94.82%
2025-05-01 12:59:07,753 [INFO] -   New best validation accuracy for mobilenet: 94.82%
2025-05-01 12:59:07,754 [INFO] -   resnet: Train Loss=0.3568, Train Acc=88.28%, Val Loss=0.0334, Val Acc=90.92%
2025-05-01 12:59:07,786 [INFO] -   New best validation accuracy for resnet: 90.92%
2025-05-01 12:59:07,787 [INFO] -   densenet: Train Loss=0.2283, Train Acc=92.50%, Val Loss=0.0177, Val Acc=95.16%
2025-05-01 12:59:07,833 [INFO] -   New best validation accuracy for densenet: 95.16%
2025-05-01 12:59:07,834 [INFO] -   student: Train Loss=0.2263, Train Acc=92.38%, Val Loss=0.0204, Val Acc=94.42%
2025-05-01 12:59:07,864 [INFO] -   New best validation accuracy for student: 94.42%
2025-05-01 12:59:07,865 [INFO] - Initialization epoch 3 completed in 3061.39s
2025-05-01 12:59:10,234 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_3.pth (Epoch 3)
2025-05-01 12:59:10,234 [INFO] - Initialization Epoch 4/5
2025-05-01 13:47:57,970 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-01 13:50:55,466 [INFO] - Restored num_workers to 4.
2025-05-01 13:50:55,473 [INFO] -   vit: Train Loss=0.0679, Train Acc=97.73%, Val Loss=0.0378, Val Acc=95.42%
2025-05-01 13:50:55,502 [INFO] -   New best validation accuracy for vit: 95.42%
2025-05-01 13:50:55,503 [INFO] -   efficientnet: Train Loss=0.1542, Train Acc=94.84%, Val Loss=0.0135, Val Acc=96.28%
2025-05-01 13:50:55,532 [INFO] -   New best validation accuracy for efficientnet: 96.28%
2025-05-01 13:50:55,532 [INFO] -   inception: Train Loss=0.2489, Train Acc=92.09%, Val Loss=0.0490, Val Acc=93.86%
2025-05-01 13:50:55,565 [INFO] -   New best validation accuracy for inception: 93.86%
2025-05-01 13:50:55,566 [INFO] -   mobilenet: Train Loss=0.1478, Train Acc=94.88%, Val Loss=0.0100, Val Acc=94.68%
2025-05-01 13:50:55,567 [INFO] -   resnet: Train Loss=0.2942, Train Acc=90.15%, Val Loss=0.0328, Val Acc=90.46%
2025-05-01 13:50:55,567 [INFO] -   densenet: Train Loss=0.1833, Train Acc=94.04%, Val Loss=0.0190, Val Acc=95.14%
2025-05-01 13:50:55,568 [INFO] -   student: Train Loss=0.1769, Train Acc=93.96%, Val Loss=0.0191, Val Acc=95.12%
2025-05-01 13:50:55,599 [INFO] -   New best validation accuracy for student: 95.12%
2025-05-01 13:50:55,600 [INFO] - Initialization epoch 4 completed in 3105.37s
2025-05-01 13:50:57,796 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_4.pth (Epoch 4)
2025-05-01 13:50:57,798 [INFO] - Initialization Epoch 5/5
2025-05-01 14:40:07,880 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-01 14:43:07,071 [INFO] - Restored num_workers to 4.
2025-05-01 14:43:07,071 [INFO] -   vit: Train Loss=0.0585, Train Acc=97.99%, Val Loss=0.0381, Val Acc=95.10%
2025-05-01 14:43:07,071 [INFO] -   efficientnet: Train Loss=0.1255, Train Acc=95.72%, Val Loss=0.0148, Val Acc=96.32%
2025-05-01 14:43:07,104 [INFO] -   New best validation accuracy for efficientnet: 96.32%
2025-05-01 14:43:07,105 [INFO] -   inception: Train Loss=0.1931, Train Acc=93.77%, Val Loss=0.0520, Val Acc=93.66%
2025-05-01 14:43:07,105 [INFO] -   mobilenet: Train Loss=0.1160, Train Acc=95.86%, Val Loss=0.0086, Val Acc=95.54%
2025-05-01 14:43:07,136 [INFO] -   New best validation accuracy for mobilenet: 95.54%
2025-05-01 14:43:07,137 [INFO] -   resnet: Train Loss=0.2456, Train Acc=91.76%, Val Loss=0.0252, Val Acc=93.12%
2025-05-01 14:43:07,167 [INFO] -   New best validation accuracy for resnet: 93.12%
2025-05-01 14:43:07,168 [INFO] -   densenet: Train Loss=0.1505, Train Acc=95.00%, Val Loss=0.0183, Val Acc=95.12%
2025-05-01 14:43:07,169 [INFO] -   student: Train Loss=0.1506, Train Acc=94.87%, Val Loss=0.0171, Val Acc=95.28%
2025-05-01 14:43:07,211 [INFO] -   New best validation accuracy for student: 95.28%
2025-05-01 14:43:07,212 [INFO] - Initialization epoch 5 completed in 3129.41s
2025-05-01 14:43:09,459 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5)
2025-05-01 14:43:09,469 [ERROR] - Failed to restore best state for vit after initialization: invalid group reference 1 at position 10
2025-05-01 14:43:09,486 [INFO] - Restored best state for efficientnet from initialization (Val Acc: 96.32%)
2025-05-01 14:43:09,494 [ERROR] - Failed to restore best state for inception after initialization: invalid group reference 1 at position 10
2025-05-01 14:43:09,505 [ERROR] - Failed to restore best state for mobilenet after initialization: invalid group reference 1 at position 10
2025-05-01 14:43:09,506 [ERROR] - Failed to restore best state for resnet after initialization: invalid group reference 1 at position 10
2025-05-01 14:43:09,515 [ERROR] - Failed to restore best state for densenet after initialization: invalid group reference 1 at position 10
2025-05-01 14:43:09,530 [INFO] - Restored best state for student from initialization (Val Acc: 95.28%)
2025-05-01 14:43:09,531 [INFO] - Initialization phase completed
2025-05-01 14:43:09,543 [INFO] - Starting mutual learning phase...
2025-05-01 14:43:09,544 [WARNING] - Synchronous DML ideally uses a single shared train loader. Using student's loader as primary.
2025-05-01 14:43:09,545 [INFO] - Hook registered for encoder.ln
2025-05-01 14:43:09,546 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 14:43:09,694 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 14:43:09,694 [INFO] - Hook registered for features.8
2025-05-01 14:43:09,694 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 14:43:10,050 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 14:43:10,050 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 14:43:10,059 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 14:43:10,544 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 14:43:10,545 [INFO] - Hook registered for features
2025-05-01 14:43:10,545 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 14:43:10,704 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 14:43:10,706 [INFO] - Hook registered for layer4
2025-05-01 14:43:10,706 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 14:43:11,005 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 14:43:11,005 [INFO] - Hook registered for features
2025-05-01 14:43:11,005 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 14:43:11,314 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 14:43:11,314 [INFO] - Hook registered for features.8
2025-05-01 14:43:11,314 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 14:43:11,324 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 14:43:12,520 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 14:43:12,521 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 14:43:12,521 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 14:43:12,521 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 14:43:12,533 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 14:43:12,533 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 14:43:12,545 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 14:43:12,546 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 14:43:12,552 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 14:43:12,553 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 14:43:12,566 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 14:43:12,566 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 14:43:12,574 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 14:43:12,764 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 14:43:13,135 [INFO] - Heterogeneous Feature Integrator (HFI) initialized.
2025-05-01 14:43:13,395 [INFO] - Using LR warmup for 3 epochs for model vit.
2025-05-01 14:43:13,395 [INFO] - Using LR warmup for 3 epochs for model efficientnet.
2025-05-01 14:43:13,395 [INFO] - Using LR warmup for 3 epochs for model inception.
2025-05-01 14:43:13,395 [INFO] - Using LR warmup for 3 epochs for model mobilenet.
2025-05-01 14:43:13,395 [INFO] - Using LR warmup for 3 epochs for model resnet.
2025-05-01 14:43:13,395 [INFO] - Using LR warmup for 3 epochs for model densenet.
2025-05-01 14:43:13,405 [INFO] - Using LR warmup for 3 epochs for model student.
2025-05-01 14:43:13,405 [INFO] - Added HFI parameters to the student optimizer.
2025-05-01 14:43:13,562 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250501_144313_config.json
2025-05-01 14:43:13,562 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-01 14:43:19,268 [ERROR] - An error occurred: CUDA out of memory. Tried to allocate 14.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 455.80 MiB is free. 4.50 GiB allowed; Of the allocated memory 4.48 GiB is allocated by PyTorch, and 14.96 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-05-01 14:43:19,283 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_5148\1284488694.py", line 3112, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_5148\1284488694.py", line 2311, in mutual_learning_phase
    outputs = model(current_input)
              ^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\resnet.py", line 285, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\resnet.py", line 269, in _forward_impl
    x = self.bn1(x)
        ^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\functional.py", line 2812, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 14.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 455.80 MiB is free. 4.50 GiB allowed; Of the allocated memory 4.48 GiB is allocated by PyTorch, and 14.96 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-05-01 16:21:48,697 [INFO] - Using device: cuda
2025-05-01 16:21:48,705 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 16:21:48,705 [INFO] - GPU Memory: 6.00 GB
2025-05-01 16:21:48,706 [INFO] - CUDA Version: 12.4
2025-05-01 16:21:48,788 [INFO] - cuDNN benchmark mode enabled
2025-05-01 16:21:48,806 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 32,
    "gradient_accumulation_steps": 64,
    "gpu_memory_fraction": 0.7,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 8,
        "inception": 4,
        "mobilenet": 16,
        "resnet": 8,
        "densenet": 8,
        "student": 8
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 16:21:48,867 [INFO] - Random seed set to 42
2025-05-01 16:21:48,867 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-01 16:21:48,867 [INFO] - Creating models...
2025-05-01 16:21:48,883 [INFO] - Loading ViT-B16 model...
2025-05-01 16:21:49,807 [INFO] - Loading EfficientNetB0 model...
2025-05-01 16:21:49,942 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 16:21:50,325 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 16:21:50,327 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 16:21:50,432 [INFO] - Loading ResNet50 model...
2025-05-01 16:21:50,854 [INFO] - Loading DenseNet121 model...
2025-05-01 16:21:51,013 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 16:21:51,177 [INFO] - Model vit moved to cuda
2025-05-01 16:21:51,211 [INFO] - Model efficientnet moved to cuda
2025-05-01 16:21:51,263 [INFO] - Model inception moved to cuda
2025-05-01 16:21:51,286 [INFO] - Model mobilenet moved to cuda
2025-05-01 16:21:51,329 [INFO] - Model resnet moved to cuda
2025-05-01 16:21:51,364 [INFO] - Model densenet moved to cuda
2025-05-01 16:21:51,388 [INFO] - Model student moved to cuda
2025-05-01 16:21:51,390 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 16:21:51,392 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 16:21:51,392 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 16:21:51,392 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 16:21:51,392 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 16:21:51,399 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 16:21:51,399 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 16:21:51,408 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-01 16:21:53,226 [INFO] - Loaded model state for vit (Coverage: 100.00%)
2025-05-01 16:21:53,249 [INFO] - Loaded model state for efficientnet (Coverage: 100.00%)
2025-05-01 16:21:53,300 [INFO] - Loaded model state for inception (Coverage: 100.00%)
2025-05-01 16:21:53,302 [ERROR] - Error loading model state for mobilenet: too many values to unpack (expected 2)
2025-05-01 16:21:53,343 [INFO] - Loaded model state for resnet (Coverage: 100.00%)
2025-05-01 16:21:53,348 [ERROR] - Error loading model state for densenet: too many values to unpack (expected 2)
2025-05-01 16:21:53,371 [INFO] - Loaded model state for student (Coverage: 100.00%)
2025-05-01 16:21:53,498 [INFO] - Loaded optimizer state for vit
2025-05-01 16:21:53,527 [INFO] - Loaded optimizer state for efficientnet
2025-05-01 16:21:53,584 [INFO] - Loaded optimizer state for inception
2025-05-01 16:21:53,608 [INFO] - Loaded optimizer state for mobilenet
2025-05-01 16:21:53,642 [INFO] - Loaded optimizer state for resnet
2025-05-01 16:21:53,727 [INFO] - Loaded optimizer state for densenet
2025-05-01 16:21:53,750 [INFO] - Loaded optimizer state for student
2025-05-01 16:21:53,751 [ERROR] - Error loading scheduler state for vit: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:21:53,751 [ERROR] - Error loading scheduler state for efficientnet: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:21:53,752 [ERROR] - Error loading scheduler state for inception: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:21:53,752 [ERROR] - Error loading scheduler state for mobilenet: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:21:53,753 [ERROR] - Error loading scheduler state for resnet: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:21:53,753 [ERROR] - Error loading scheduler state for densenet: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:21:53,754 [ERROR] - Error loading scheduler state for student: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:21:53,755 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Resuming from epoch 5 of phase 'init'.
2025-05-01 16:21:53,760 [INFO] - Resuming initialization phase from epoch 6
2025-05-01 16:21:53,760 [INFO] - Preparing data loaders...
2025-05-01 16:22:03,050 [INFO] - Training samples: 45000 per model
2025-05-01 16:22:03,052 [INFO] - Validation samples: 5000 per model
2025-05-01 16:22:03,052 [INFO] - Test samples: 10000 per model
2025-05-01 16:22:03,053 [INFO] - Initialization phase already completed or skipped.
2025-05-01 16:22:03,053 [INFO] - Starting mutual learning phase...
2025-05-01 16:22:03,054 [WARNING] - Synchronous DML ideally uses a single shared train loader. Using student's loader as primary.
2025-05-01 16:22:03,054 [INFO] - Hook registered for encoder.ln
2025-05-01 16:22:03,055 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 16:22:03,691 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 16:22:03,693 [INFO] - Hook registered for features.8
2025-05-01 16:22:03,694 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 16:22:04,196 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 16:22:04,197 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 16:22:04,197 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 16:22:04,752 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 16:22:04,753 [INFO] - Hook registered for features
2025-05-01 16:22:04,753 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 16:22:04,946 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 16:22:04,946 [INFO] - Hook registered for layer4
2025-05-01 16:22:04,946 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 16:22:05,234 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 16:22:05,234 [INFO] - Hook registered for features
2025-05-01 16:22:05,234 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 16:22:05,546 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 16:22:05,546 [INFO] - Hook registered for features.8
2025-05-01 16:22:05,546 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 16:22:05,556 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 16:22:06,623 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 16:22:06,624 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 16:22:06,629 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 16:22:06,629 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 16:22:06,635 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 16:22:06,636 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 16:22:06,646 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 16:22:06,647 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 16:22:06,652 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 16:22:06,652 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 16:22:06,662 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 16:22:06,663 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 16:22:06,670 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 16:22:06,671 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 16:22:06,796 [INFO] - Heterogeneous Feature Integrator (HFI) initialized.
2025-05-01 16:22:07,039 [INFO] - Using LR warmup for 3 epochs for model vit.
2025-05-01 16:22:07,041 [INFO] - Using LR warmup for 3 epochs for model efficientnet.
2025-05-01 16:22:07,042 [INFO] - Using LR warmup for 3 epochs for model inception.
2025-05-01 16:22:07,044 [INFO] - Using LR warmup for 3 epochs for model mobilenet.
2025-05-01 16:22:07,045 [INFO] - Using LR warmup for 3 epochs for model resnet.
2025-05-01 16:22:07,047 [INFO] - Using LR warmup for 3 epochs for model densenet.
2025-05-01 16:22:07,048 [INFO] - Using LR warmup for 3 epochs for model student.
2025-05-01 16:22:07,049 [INFO] - Added HFI parameters to the student optimizer.
2025-05-01 16:22:07,051 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250501_162207_config.json
2025-05-01 16:22:07,051 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-01 16:22:26,171 [ERROR] - An error occurred in main: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 455.55 MiB is free. 4.50 GiB allowed; Of the allocated memory 4.47 GiB is allocated by PyTorch, and 15.22 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-05-01 16:22:26,177 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\4229182827.py", line 3287, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config, start_epoch=start_epoch_mutual)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\4229182827.py", line 2421, in mutual_learning_phase
    outputs = model(current_input)
              ^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\densenet.py", line 213, in forward
    features = self.features(x)
               ^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1844, in _call_impl
    return inner()
           ^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1790, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\densenet.py", line 122, in forward
    new_features = layer(features)
                   ^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\densenet.py", line 90, in forward
    new_features = self.conv2(self.relu2(self.norm2(bottleneck_output)))
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\functional.py", line 2812, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 455.55 MiB is free. 4.50 GiB allowed; Of the allocated memory 4.47 GiB is allocated by PyTorch, and 15.22 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-05-01 16:25:50,326 [INFO] - Using device: cuda
2025-05-01 16:25:50,327 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 16:25:50,327 [INFO] - GPU Memory: 6.00 GB
2025-05-01 16:25:50,328 [INFO] - CUDA Version: 12.4
2025-05-01 16:25:50,329 [INFO] - cuDNN benchmark mode enabled
2025-05-01 16:25:50,347 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 32,
    "gradient_accumulation_steps": 64,
    "gpu_memory_fraction": 0.85,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 8,
        "inception": 4,
        "mobilenet": 16,
        "resnet": 8,
        "densenet": 8,
        "student": 8
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 16:25:50,349 [INFO] - Random seed set to 42
2025-05-01 16:25:50,351 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-01 16:25:50,351 [INFO] - Creating models...
2025-05-01 16:25:50,352 [INFO] - Loading ViT-B16 model...
2025-05-01 16:25:51,260 [INFO] - Loading EfficientNetB0 model...
2025-05-01 16:25:51,403 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 16:25:51,800 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 16:25:51,801 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 16:25:51,913 [INFO] - Loading ResNet50 model...
2025-05-01 16:25:52,299 [INFO] - Loading DenseNet121 model...
2025-05-01 16:25:52,489 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 16:25:52,849 [INFO] - Model vit moved to cuda
2025-05-01 16:25:52,891 [INFO] - Model efficientnet moved to cuda
2025-05-01 16:25:53,002 [INFO] - Model inception moved to cuda
2025-05-01 16:25:53,028 [INFO] - Model mobilenet moved to cuda
2025-05-01 16:25:53,100 [INFO] - Model resnet moved to cuda
2025-05-01 16:25:53,155 [INFO] - Model densenet moved to cuda
2025-05-01 16:25:53,189 [INFO] - Model student moved to cuda
2025-05-01 16:25:53,189 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 16:25:53,189 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 16:25:53,203 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 16:25:53,203 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 16:25:53,203 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 16:25:53,203 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 16:25:53,203 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 16:25:53,218 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-01 16:25:55,398 [INFO] - Loaded model state for vit (Coverage: 100.00%)
2025-05-01 16:25:55,450 [INFO] - Loaded model state for efficientnet (Coverage: 100.00%)
2025-05-01 16:25:55,550 [INFO] - Loaded model state for inception (Coverage: 100.00%)
2025-05-01 16:25:55,550 [ERROR] - Error loading model state for mobilenet: too many values to unpack (expected 2)
2025-05-01 16:25:55,604 [INFO] - Loaded model state for resnet (Coverage: 100.00%)
2025-05-01 16:25:55,604 [ERROR] - Error loading model state for densenet: too many values to unpack (expected 2)
2025-05-01 16:25:55,643 [INFO] - Loaded model state for student (Coverage: 100.00%)
2025-05-01 16:25:55,793 [INFO] - Loaded optimizer state for vit
2025-05-01 16:25:55,832 [INFO] - Loaded optimizer state for efficientnet
2025-05-01 16:25:55,877 [INFO] - Loaded optimizer state for inception
2025-05-01 16:25:55,898 [INFO] - Loaded optimizer state for mobilenet
2025-05-01 16:25:55,934 [INFO] - Loaded optimizer state for resnet
2025-05-01 16:25:55,973 [INFO] - Loaded optimizer state for densenet
2025-05-01 16:25:55,995 [INFO] - Loaded optimizer state for student
2025-05-01 16:25:55,996 [ERROR] - Error loading scheduler state for vit: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:25:55,997 [ERROR] - Error loading scheduler state for efficientnet: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:25:55,998 [ERROR] - Error loading scheduler state for inception: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:25:55,998 [ERROR] - Error loading scheduler state for mobilenet: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:25:55,999 [ERROR] - Error loading scheduler state for resnet: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:25:55,999 [ERROR] - Error loading scheduler state for densenet: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:25:56,001 [ERROR] - Error loading scheduler state for student: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:25:56,001 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Resuming from epoch 5 of phase 'init'.
2025-05-01 16:25:56,010 [INFO] - Resuming initialization phase from epoch 6
2025-05-01 16:25:56,010 [INFO] - Preparing data loaders...
2025-05-01 16:26:05,657 [INFO] - Training samples: 45000 per model
2025-05-01 16:26:05,658 [INFO] - Validation samples: 5000 per model
2025-05-01 16:26:05,665 [INFO] - Test samples: 10000 per model
2025-05-01 16:26:05,666 [INFO] - Initialization phase already completed or skipped.
2025-05-01 16:26:05,667 [INFO] - Starting mutual learning phase...
2025-05-01 16:26:05,667 [WARNING] - Synchronous DML ideally uses a single shared train loader. Using student's loader as primary.
2025-05-01 16:26:05,668 [INFO] - Hook registered for encoder.ln
2025-05-01 16:26:05,669 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 16:26:05,681 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 16:26:05,682 [INFO] - Hook registered for features.8
2025-05-01 16:26:05,683 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 16:26:05,750 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 16:26:05,751 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 16:26:05,751 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 16:26:05,774 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 16:26:05,774 [INFO] - Hook registered for features
2025-05-01 16:26:05,774 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 16:26:05,788 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 16:26:05,789 [INFO] - Hook registered for layer4
2025-05-01 16:26:05,789 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 16:26:05,802 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 16:26:05,802 [INFO] - Hook registered for features
2025-05-01 16:26:05,802 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 16:26:05,833 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 16:26:05,835 [INFO] - Hook registered for features.8
2025-05-01 16:26:05,835 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 16:26:05,850 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 16:26:05,958 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 16:26:05,959 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 16:26:05,963 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 16:26:05,965 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 16:26:05,972 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 16:26:05,973 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 16:26:05,983 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 16:26:05,986 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 16:26:05,989 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 16:26:05,989 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 16:26:06,002 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 16:26:06,004 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 16:26:06,011 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 16:26:06,011 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 16:26:06,119 [INFO] - Heterogeneous Feature Integrator (HFI) initialized.
2025-05-01 16:26:06,371 [INFO] - Using LR warmup for 3 epochs for model vit.
2025-05-01 16:26:06,376 [INFO] - Using LR warmup for 3 epochs for model efficientnet.
2025-05-01 16:26:06,377 [INFO] - Using LR warmup for 3 epochs for model inception.
2025-05-01 16:26:06,378 [INFO] - Using LR warmup for 3 epochs for model mobilenet.
2025-05-01 16:26:06,378 [INFO] - Using LR warmup for 3 epochs for model resnet.
2025-05-01 16:26:06,378 [INFO] - Using LR warmup for 3 epochs for model densenet.
2025-05-01 16:26:06,383 [INFO] - Using LR warmup for 3 epochs for model student.
2025-05-01 16:26:06,384 [INFO] - Added HFI parameters to the student optimizer.
2025-05-01 16:26:06,385 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250501_162606_config.json
2025-05-01 16:26:06,385 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-01 16:26:24,481 [ERROR] - An error occurred in main: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.06 GiB is allocated by PyTorch, and 23.58 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-05-01 16:26:24,483 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\1839894271.py", line 3287, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config, start_epoch=start_epoch_mutual)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\1839894271.py", line 2421, in mutual_learning_phase
    outputs = model(current_input)
              ^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 343, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 333, in _forward_impl
    x = self.features(x)
        ^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 164, in forward
    result = self.block(input)
             ^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\functional.py", line 2812, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.06 GiB is allocated by PyTorch, and 23.58 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-05-01 16:36:14,902 [INFO] - Using device: cuda
2025-05-01 16:36:14,902 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 16:36:14,902 [INFO] - GPU Memory: 6.00 GB
2025-05-01 16:36:14,902 [INFO] - CUDA Version: 12.4
2025-05-01 16:36:14,909 [INFO] - cuDNN benchmark mode enabled
2025-05-01 16:36:14,927 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 32,
    "gradient_accumulation_steps": 64,
    "gpu_memory_fraction": 0.85,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 8,
        "inception": 4,
        "mobilenet": 16,
        "resnet": 8,
        "densenet": 8,
        "student": 8
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 16:36:14,930 [INFO] - Random seed set to 42
2025-05-01 16:36:14,931 [INFO] - Creating models...
2025-05-01 16:36:14,931 [INFO] - Loading ViT-B16 model...
2025-05-01 16:36:15,812 [INFO] - Loading EfficientNetB0 model...
2025-05-01 16:36:16,187 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 16:36:16,576 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 16:36:16,577 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 16:36:16,689 [INFO] - Loading ResNet50 model...
2025-05-01 16:36:17,114 [INFO] - Loading DenseNet121 model...
2025-05-01 16:36:17,288 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 16:36:17,673 [INFO] - Model vit moved to cuda
2025-05-01 16:36:17,729 [INFO] - Model efficientnet moved to cuda
2025-05-01 16:36:17,792 [INFO] - Model inception moved to cuda
2025-05-01 16:36:17,807 [INFO] - Model mobilenet moved to cuda
2025-05-01 16:36:17,836 [INFO] - Model resnet moved to cuda
2025-05-01 16:36:17,867 [INFO] - Model densenet moved to cuda
2025-05-01 16:36:17,896 [INFO] - Model student moved to cuda
2025-05-01 16:36:17,896 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 16:36:17,896 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 16:36:17,903 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 16:36:17,905 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 16:36:17,906 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 16:36:17,910 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 16:36:17,910 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 16:36:17,922 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-01 16:36:17,922 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-01 16:36:19,773 [INFO] - Loaded model state for vit successfully.
2025-05-01 16:36:19,819 [INFO] - Loaded model state for efficientnet successfully.
2025-05-01 16:36:19,895 [INFO] - Loaded model state for inception successfully.
2025-05-01 16:36:19,920 [INFO] - Loaded model state for mobilenet successfully.
2025-05-01 16:36:19,967 [INFO] - Loaded model state for resnet successfully.
2025-05-01 16:36:20,016 [INFO] - Loaded model state for densenet successfully.
2025-05-01 16:36:20,048 [INFO] - Loaded model state for student successfully.
2025-05-01 16:36:20,278 [INFO] - Loaded optimizer state for vit
2025-05-01 16:36:20,327 [INFO] - Loaded optimizer state for efficientnet
2025-05-01 16:36:20,388 [INFO] - Loaded optimizer state for inception
2025-05-01 16:36:20,407 [INFO] - Loaded optimizer state for mobilenet
2025-05-01 16:36:20,442 [INFO] - Loaded optimizer state for resnet
2025-05-01 16:36:20,479 [INFO] - Loaded optimizer state for densenet
2025-05-01 16:36:20,501 [INFO] - Loaded optimizer state for student
2025-05-01 16:36:20,502 [ERROR] - Error loading scheduler state for vit: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:36:20,502 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\3475338957.py", line 451, in load_checkpoint
    scheduler.load_state_dict(scheduler_state_dict[state_dict_key])
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 951, in load_state_dict
    _schedulers = state_dict.pop("_schedulers")
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: '_schedulers'

2025-05-01 16:36:20,502 [ERROR] - Error loading scheduler state for efficientnet: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:36:20,506 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\3475338957.py", line 451, in load_checkpoint
    scheduler.load_state_dict(scheduler_state_dict[state_dict_key])
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 951, in load_state_dict
    _schedulers = state_dict.pop("_schedulers")
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: '_schedulers'

2025-05-01 16:36:20,506 [ERROR] - Error loading scheduler state for inception: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:36:20,507 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\3475338957.py", line 451, in load_checkpoint
    scheduler.load_state_dict(scheduler_state_dict[state_dict_key])
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 951, in load_state_dict
    _schedulers = state_dict.pop("_schedulers")
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: '_schedulers'

2025-05-01 16:36:20,507 [ERROR] - Error loading scheduler state for mobilenet: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:36:20,509 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\3475338957.py", line 451, in load_checkpoint
    scheduler.load_state_dict(scheduler_state_dict[state_dict_key])
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 951, in load_state_dict
    _schedulers = state_dict.pop("_schedulers")
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: '_schedulers'

2025-05-01 16:36:20,509 [ERROR] - Error loading scheduler state for resnet: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:36:20,509 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\3475338957.py", line 451, in load_checkpoint
    scheduler.load_state_dict(scheduler_state_dict[state_dict_key])
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 951, in load_state_dict
    _schedulers = state_dict.pop("_schedulers")
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: '_schedulers'

2025-05-01 16:36:20,509 [ERROR] - Error loading scheduler state for densenet: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:36:20,509 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\3475338957.py", line 451, in load_checkpoint
    scheduler.load_state_dict(scheduler_state_dict[state_dict_key])
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 951, in load_state_dict
    _schedulers = state_dict.pop("_schedulers")
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: '_schedulers'

2025-05-01 16:36:20,509 [ERROR] - Error loading scheduler state for student: '_schedulers'. Scheduler state might be reset.
2025-05-01 16:36:20,513 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\3475338957.py", line 451, in load_checkpoint
    scheduler.load_state_dict(scheduler_state_dict[state_dict_key])
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 951, in load_state_dict
    _schedulers = state_dict.pop("_schedulers")
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: '_schedulers'

2025-05-01 16:36:20,513 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-01 16:36:20,520 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-01 16:36:20,521 [INFO] - Preparing data loaders...
2025-05-01 16:36:29,709 [INFO] - Training samples: 45000 per model
2025-05-01 16:36:29,709 [INFO] - Validation samples: 5000 per model
2025-05-01 16:36:29,709 [INFO] - Test samples: 10000 per model
2025-05-01 16:36:29,709 [INFO] - Skipping initialization phase as it is already completed.
2025-05-01 16:36:29,709 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-01 16:36:29,985 [INFO] - GPU Memory: Current=1765.85MB, Peak=5180.42MB, Reserved=1788.00MB
2025-05-01 16:36:29,985 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-01 16:36:29,985 [INFO] - Starting mutual learning phase...
2025-05-01 16:36:29,985 [WARNING] - Synchronous DML ideally uses a single shared train loader. Using student's loader as primary.
2025-05-01 16:36:29,985 [INFO] - Hook registered for encoder.ln
2025-05-01 16:36:29,985 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 16:36:30,020 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 16:36:30,020 [INFO] - Hook registered for features.8
2025-05-01 16:36:30,027 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 16:36:30,258 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 16:36:30,262 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 16:36:30,263 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 16:36:30,286 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 16:36:30,287 [INFO] - Hook registered for features
2025-05-01 16:36:30,287 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 16:36:30,362 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 16:36:30,362 [INFO] - Hook registered for layer4
2025-05-01 16:36:30,362 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 16:36:30,376 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 16:36:30,376 [INFO] - Hook registered for features
2025-05-01 16:36:30,376 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 16:36:30,429 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 16:36:30,429 [INFO] - Hook registered for features.8
2025-05-01 16:36:30,429 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 16:36:30,472 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 16:36:30,570 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 16:36:30,570 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 16:36:30,585 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 16:36:30,585 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 16:36:30,585 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 16:36:30,585 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 16:36:30,606 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 16:36:30,607 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 16:36:30,613 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 16:36:30,613 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 16:36:30,624 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 16:36:30,624 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 16:36:30,639 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 16:36:30,640 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 16:36:30,763 [INFO] - Heterogeneous Feature Integrator (HFI) initialized.
2025-05-01 16:36:31,028 [INFO] - Using LR warmup for 3 epochs for model vit.
2025-05-01 16:36:31,029 [INFO] - Using LR warmup for 3 epochs for model efficientnet.
2025-05-01 16:36:31,031 [INFO] - Using LR warmup for 3 epochs for model inception.
2025-05-01 16:36:31,032 [INFO] - Using LR warmup for 3 epochs for model mobilenet.
2025-05-01 16:36:31,033 [INFO] - Using LR warmup for 3 epochs for model resnet.
2025-05-01 16:36:31,035 [INFO] - Using LR warmup for 3 epochs for model densenet.
2025-05-01 16:36:31,037 [INFO] - Using LR warmup for 3 epochs for model student.
2025-05-01 16:36:31,037 [INFO] - Added HFI parameters to the student optimizer.
2025-05-01 16:36:31,039 [INFO] - Configuration saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250501_163631_config.json
2025-05-01 16:36:31,039 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-01 16:36:47,874 [ERROR] - An error occurred in main: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.06 GiB is allocated by PyTorch, and 21.29 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-05-01 16:36:47,874 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\3475338957.py", line 3327, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config, start_epoch=start_epoch_mutual)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\3475338957.py", line 2442, in mutual_learning_phase
    outputs = model(current_input)
              ^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 343, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 333, in _forward_impl
    x = self.features(x)
        ^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 164, in forward
    result = self.block(input)
             ^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\functional.py", line 2812, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.06 GiB is allocated by PyTorch, and 21.29 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-05-01 17:28:59,757 [INFO] - Using device: cuda
2025-05-01 17:28:59,757 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 17:28:59,757 [INFO] - GPU Memory: 6.00 GB
2025-05-01 17:28:59,757 [INFO] - CUDA Version: 12.4
2025-05-01 17:28:59,757 [INFO] - cuDNN benchmark mode enabled
2025-05-01 17:28:59,777 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 32,
    "gradient_accumulation_steps": 64,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 8,
        "inception": 4,
        "mobilenet": 16,
        "resnet": 8,
        "densenet": 8,
        "student": 8
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 17:28:59,789 [INFO] - Random seed set to 42
2025-05-01 17:28:59,789 [INFO] - Creating models...
2025-05-01 17:28:59,790 [INFO] - Loading ViT-B16 model...
2025-05-01 17:29:00,924 [INFO] - Loading EfficientNetB0 model...
2025-05-01 17:29:01,070 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 17:29:01,511 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 17:29:01,511 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 17:29:01,600 [INFO] - Loading ResNet50 model...
2025-05-01 17:29:01,988 [INFO] - Loading DenseNet121 model...
2025-05-01 17:29:02,129 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 17:29:02,455 [INFO] - Model vit moved to cuda
2025-05-01 17:29:02,497 [INFO] - Model efficientnet moved to cuda
2025-05-01 17:29:02,629 [INFO] - Model inception moved to cuda
2025-05-01 17:29:02,670 [INFO] - Model mobilenet moved to cuda
2025-05-01 17:29:02,754 [INFO] - Model resnet moved to cuda
2025-05-01 17:29:02,855 [INFO] - Model densenet moved to cuda
2025-05-01 17:29:02,880 [INFO] - Model student moved to cuda
2025-05-01 17:29:02,882 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 17:29:02,883 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 17:29:02,885 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 17:29:02,887 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 17:29:02,888 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 17:29:02,890 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 17:29:02,892 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 17:29:02,892 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-01 17:29:02,892 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-01 17:29:04,672 [INFO] - Loaded model state for vit successfully.
2025-05-01 17:29:04,733 [INFO] - Loaded model state for efficientnet successfully.
2025-05-01 17:29:04,833 [INFO] - Loaded model state for inception successfully.
2025-05-01 17:29:04,865 [INFO] - Loaded model state for mobilenet successfully.
2025-05-01 17:29:04,935 [INFO] - Loaded model state for resnet successfully.
2025-05-01 17:29:04,985 [INFO] - Loaded model state for densenet successfully.
2025-05-01 17:29:05,013 [INFO] - Loaded model state for student successfully.
2025-05-01 17:29:05,206 [INFO] - Recreated and loaded optimizer state for vit
2025-05-01 17:29:05,226 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-01 17:29:05,269 [INFO] - Recreated and loaded optimizer state for inception
2025-05-01 17:29:05,286 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-01 17:29:05,320 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-01 17:29:05,386 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-01 17:29:05,407 [INFO] - Recreated and loaded optimizer state for student
2025-05-01 17:29:05,407 [WARNING] - No scheduler info found for vit in checkpoint.
2025-05-01 17:29:05,407 [WARNING] - No scheduler info found for efficientnet in checkpoint.
2025-05-01 17:29:05,407 [WARNING] - No scheduler info found for inception in checkpoint.
2025-05-01 17:29:05,407 [WARNING] - No scheduler info found for mobilenet in checkpoint.
2025-05-01 17:29:05,413 [WARNING] - No scheduler info found for resnet in checkpoint.
2025-05-01 17:29:05,414 [WARNING] - No scheduler info found for densenet in checkpoint.
2025-05-01 17:29:05,414 [WARNING] - No scheduler info found for student in checkpoint.
2025-05-01 17:29:05,415 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-01 17:29:05,422 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-01 17:29:05,423 [INFO] - Created new scheduler for vit
2025-05-01 17:29:05,423 [INFO] - Created new scheduler for efficientnet
2025-05-01 17:29:05,424 [INFO] - Created new scheduler for inception
2025-05-01 17:29:05,424 [INFO] - Created new scheduler for mobilenet
2025-05-01 17:29:05,425 [INFO] - Created new scheduler for resnet
2025-05-01 17:29:05,426 [INFO] - Created new scheduler for densenet
2025-05-01 17:29:05,427 [INFO] - Created new scheduler for student
2025-05-01 17:29:05,427 [INFO] - Preparing data loaders...
2025-05-01 17:29:14,412 [INFO] - Training samples: 45000 per model
2025-05-01 17:29:14,412 [INFO] - Validation samples: 5000 per model
2025-05-01 17:29:14,412 [INFO] - Test samples: 10000 per model
2025-05-01 17:29:14,428 [INFO] - Skipping initialization phase.
2025-05-01 17:29:14,428 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-01 17:29:14,661 [INFO] - GPU Memory: Current=1774.52MB, Peak=5182.71MB, Reserved=1788.00MB
2025-05-01 17:29:14,661 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-01 17:29:14,661 [INFO] - Starting mutual learning phase...
2025-05-01 17:29:14,661 [INFO] - Hook registered for encoder.ln
2025-05-01 17:29:14,661 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 17:29:14,676 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 17:29:14,678 [INFO] - Hook registered for features.8
2025-05-01 17:29:14,679 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 17:29:14,869 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 17:29:14,869 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 17:29:14,869 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 17:29:14,909 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 17:29:14,910 [INFO] - Hook registered for features
2025-05-01 17:29:14,910 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 17:29:14,989 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 17:29:14,989 [INFO] - Hook registered for layer4
2025-05-01 17:29:14,989 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 17:29:14,992 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 17:29:15,004 [INFO] - Hook registered for features
2025-05-01 17:29:15,004 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 17:29:15,032 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 17:29:15,032 [INFO] - Hook registered for features.8
2025-05-01 17:29:15,032 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 17:29:15,045 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 17:29:15,143 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 17:29:15,143 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 17:29:15,158 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 17:29:15,158 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 17:29:15,158 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 17:29:15,158 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 17:29:15,177 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 17:29:15,178 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 17:29:15,184 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 17:29:15,184 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 17:29:15,202 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 17:29:15,202 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 17:29:15,210 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 17:29:15,211 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 17:29:15,319 [INFO] - HFI initialized.
2025-05-01 17:29:15,319 [INFO] - Added HFI params to student optimizer.
2025-05-01 17:29:15,567 [INFO] - Using LR warmup for 3 epochs for model vit.
2025-05-01 17:29:15,567 [INFO] - Using LR warmup for 3 epochs for model efficientnet.
2025-05-01 17:29:15,567 [INFO] - Using LR warmup for 3 epochs for model inception.
2025-05-01 17:29:15,567 [INFO] - Using LR warmup for 3 epochs for model mobilenet.
2025-05-01 17:29:15,567 [INFO] - Using LR warmup for 3 epochs for model resnet.
2025-05-01 17:29:15,582 [INFO] - Using LR warmup for 3 epochs for model densenet.
2025-05-01 17:29:15,585 [INFO] - Using LR warmup for 3 epochs for model student.
2025-05-01 17:29:15,586 [INFO] - Added HFI parameters to the student optimizer.
2025-05-01 17:29:15,586 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-01 17:30:05,945 [INFO] - GPU Memory: Current=3120.50MB, Peak=5182.71MB, Reserved=4450.00MB
2025-05-01 17:30:06,135 [ERROR] - An error occurred in main: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.07 GiB is allocated by PyTorch, and 23.00 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-05-01 17:30:06,139 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\3045525661.py", line 3293, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config, optimizers, schedulers, start_epoch=start_epoch_mutual)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\3045525661.py", line 2417, in mutual_learning_phase
    outputs = model(current_input)
              ^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 343, in forward
    return self._forward_impl(x)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 333, in _forward_impl
    x = self.features(x)
        ^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\efficientnet.py", line 164, in forward
    result = self.block(input)
             ^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.07 GiB is allocated by PyTorch, and 23.00 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-05-01 17:45:45,564 [INFO] - Using device: cuda
2025-05-01 17:45:45,564 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 17:45:45,564 [INFO] - GPU Memory: 6.00 GB
2025-05-01 17:45:45,564 [INFO] - CUDA Version: 12.4
2025-05-01 17:45:45,564 [INFO] - cuDNN benchmark mode enabled
2025-05-01 17:45:45,589 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 17:45:45,591 [INFO] - Random seed set to 42
2025-05-01 17:45:45,591 [INFO] - Creating models...
2025-05-01 17:45:45,592 [INFO] - Loading ViT-B16 model...
2025-05-01 17:45:46,543 [INFO] - Loading EfficientNetB0 model...
2025-05-01 17:45:46,869 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 17:45:47,243 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 17:45:47,243 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 17:45:47,358 [INFO] - Loading ResNet50 model...
2025-05-01 17:45:47,745 [INFO] - Loading DenseNet121 model...
2025-05-01 17:45:47,891 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 17:45:48,032 [INFO] - Model vit moved to cuda
2025-05-01 17:45:48,056 [INFO] - Model efficientnet moved to cuda
2025-05-01 17:45:48,099 [INFO] - Model inception moved to cuda
2025-05-01 17:45:48,129 [INFO] - Model mobilenet moved to cuda
2025-05-01 17:45:48,156 [INFO] - Model resnet moved to cuda
2025-05-01 17:45:48,193 [INFO] - Model densenet moved to cuda
2025-05-01 17:45:48,207 [INFO] - Model student moved to cuda
2025-05-01 17:45:48,207 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 17:45:48,207 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 17:45:48,219 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 17:45:48,221 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 17:45:48,222 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 17:45:48,225 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 17:45:48,227 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 17:45:48,228 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-01 17:45:48,228 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-01 17:45:50,118 [INFO] - Loaded model state for vit successfully.
2025-05-01 17:45:50,158 [INFO] - Loaded model state for efficientnet successfully.
2025-05-01 17:45:50,256 [INFO] - Loaded model state for inception successfully.
2025-05-01 17:45:50,279 [INFO] - Loaded model state for mobilenet successfully.
2025-05-01 17:45:50,340 [INFO] - Loaded model state for resnet successfully.
2025-05-01 17:45:50,400 [INFO] - Loaded model state for densenet successfully.
2025-05-01 17:45:50,436 [INFO] - Loaded model state for student successfully.
2025-05-01 17:45:50,549 [INFO] - Recreated and loaded optimizer state for vit
2025-05-01 17:45:50,578 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-01 17:45:50,616 [INFO] - Recreated and loaded optimizer state for inception
2025-05-01 17:45:50,641 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-01 17:45:50,680 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-01 17:45:50,713 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-01 17:45:50,738 [INFO] - Recreated and loaded optimizer state for student
2025-05-01 17:45:50,738 [WARNING] - No scheduler info found for vit in checkpoint.
2025-05-01 17:45:50,741 [WARNING] - No scheduler info found for efficientnet in checkpoint.
2025-05-01 17:45:50,741 [WARNING] - No scheduler info found for inception in checkpoint.
2025-05-01 17:45:50,742 [WARNING] - No scheduler info found for mobilenet in checkpoint.
2025-05-01 17:45:50,743 [WARNING] - No scheduler info found for resnet in checkpoint.
2025-05-01 17:45:50,743 [WARNING] - No scheduler info found for densenet in checkpoint.
2025-05-01 17:45:50,744 [WARNING] - No scheduler info found for student in checkpoint.
2025-05-01 17:45:50,744 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-01 17:45:50,748 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-01 17:45:50,748 [INFO] - Created new scheduler for vit
2025-05-01 17:45:50,748 [INFO] - Created new scheduler for efficientnet
2025-05-01 17:45:50,748 [INFO] - Created new scheduler for inception
2025-05-01 17:45:50,748 [INFO] - Created new scheduler for mobilenet
2025-05-01 17:45:50,755 [INFO] - Created new scheduler for resnet
2025-05-01 17:45:50,755 [INFO] - Created new scheduler for densenet
2025-05-01 17:45:50,755 [INFO] - Created new scheduler for student
2025-05-01 17:45:50,755 [INFO] - Preparing data loaders...
2025-05-01 17:46:00,056 [INFO] - Training samples: 45000 per model
2025-05-01 17:46:00,056 [INFO] - Validation samples: 5000 per model
2025-05-01 17:46:00,057 [INFO] - Test samples: 10000 per model
2025-05-01 17:46:00,058 [INFO] - Skipping initialization phase.
2025-05-01 17:46:00,058 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-01 17:46:00,297 [INFO] - GPU Memory: Current=1788.69MB, Peak=5189.00MB, Reserved=1814.00MB
2025-05-01 17:46:00,297 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-01 17:46:00,297 [INFO] - Starting mutual learning phase...
2025-05-01 17:46:00,304 [INFO] - Hook registered for encoder.ln
2025-05-01 17:46:00,305 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 17:46:00,404 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 17:46:00,404 [INFO] - Hook registered for features.8
2025-05-01 17:46:00,404 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 17:46:00,594 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 17:46:00,595 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 17:46:00,596 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 17:46:00,631 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 17:46:00,632 [INFO] - Hook registered for features
2025-05-01 17:46:00,632 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 17:46:00,707 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 17:46:00,707 [INFO] - Hook registered for layer4
2025-05-01 17:46:00,707 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 17:46:00,724 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 17:46:00,724 [INFO] - Hook registered for features
2025-05-01 17:46:00,727 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 17:46:00,755 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 17:46:00,757 [INFO] - Hook registered for features.8
2025-05-01 17:46:00,757 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 17:46:00,786 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 17:46:00,901 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 17:46:00,901 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 17:46:00,908 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 17:46:00,908 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 17:46:00,917 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 17:46:00,921 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 17:46:00,934 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 17:46:00,935 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 17:46:00,937 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 17:46:00,937 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 17:46:00,952 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 17:46:00,953 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 17:46:00,956 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 17:46:00,956 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 17:46:01,090 [INFO] - HFI initialized.
2025-05-01 17:46:01,091 [INFO] - Added HFI params to student optimizer.
2025-05-01 17:46:01,422 [INFO] - Using LR warmup for 3 epochs for model vit.
2025-05-01 17:46:01,422 [INFO] - Using LR warmup for 3 epochs for model efficientnet.
2025-05-01 17:46:01,422 [INFO] - Using LR warmup for 3 epochs for model inception.
2025-05-01 17:46:01,429 [INFO] - Using LR warmup for 3 epochs for model mobilenet.
2025-05-01 17:46:01,431 [INFO] - Using LR warmup for 3 epochs for model resnet.
2025-05-01 17:46:01,433 [INFO] - Using LR warmup for 3 epochs for model densenet.
2025-05-01 17:46:01,435 [INFO] - Using LR warmup for 3 epochs for model student.
2025-05-01 17:46:01,437 [INFO] - Added HFI parameters to the student optimizer.
2025-05-01 17:46:01,437 [INFO] - Mutual learning phase using effective batch size: 4
2025-05-01 17:46:01,438 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-01 17:46:30,259 [INFO] - GPU Memory: Current=2496.77MB, Peak=5189.00MB, Reserved=3336.00MB
2025-05-01 17:49:11,380 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4234.00MB
2025-05-01 17:51:53,714 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4234.00MB
2025-05-01 17:54:36,000 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4234.00MB
2025-05-01 17:57:21,187 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4232.00MB
2025-05-01 18:00:04,504 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4234.00MB
2025-05-01 18:02:49,307 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4234.00MB
2025-05-01 18:05:34,226 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4234.00MB
2025-05-01 18:08:19,669 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4234.00MB
2025-05-01 18:11:04,383 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4234.00MB
2025-05-01 18:13:49,787 [INFO] - GPU Memory: Current=2496.47MB, Peak=5189.00MB, Reserved=4244.00MB
2025-05-01 18:16:34,217 [INFO] - GPU Memory: Current=2496.52MB, Peak=5189.00MB, Reserved=4230.00MB
2025-05-01 18:19:19,629 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4236.00MB
2025-05-01 18:22:06,210 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4238.00MB
2025-05-01 18:24:52,893 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4236.00MB
2025-05-01 18:27:39,986 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4236.00MB
2025-05-01 18:30:26,359 [INFO] - GPU Memory: Current=2496.77MB, Peak=5189.00MB, Reserved=4244.00MB
2025-05-01 18:33:11,985 [INFO] - GPU Memory: Current=2496.52MB, Peak=5189.00MB, Reserved=4216.00MB
2025-05-01 18:35:58,617 [INFO] - GPU Memory: Current=2496.52MB, Peak=5189.00MB, Reserved=4230.00MB
2025-05-01 18:38:46,446 [INFO] - GPU Memory: Current=2496.52MB, Peak=5189.00MB, Reserved=4230.00MB
2025-05-01 18:41:33,677 [INFO] - GPU Memory: Current=2496.52MB, Peak=5189.00MB, Reserved=4230.00MB
2025-05-01 18:44:21,002 [INFO] - GPU Memory: Current=2496.52MB, Peak=5189.00MB, Reserved=4230.00MB
2025-05-01 18:47:08,323 [INFO] - GPU Memory: Current=2497.52MB, Peak=5189.00MB, Reserved=4226.00MB
2025-05-01 18:49:54,691 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4238.00MB
2025-05-01 18:52:42,175 [INFO] - GPU Memory: Current=2496.77MB, Peak=5189.00MB, Reserved=4244.00MB
2025-05-01 18:55:30,205 [INFO] - GPU Memory: Current=2497.43MB, Peak=5189.00MB, Reserved=4262.00MB
2025-05-01 18:58:17,646 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4238.00MB
2025-05-01 19:01:05,022 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4238.00MB
2025-05-01 19:03:51,723 [INFO] - GPU Memory: Current=2497.48MB, Peak=5189.00MB, Reserved=4238.00MB
2025-05-01 19:04:09,478 [INFO] - --- Mutual Epoch 1 Summary (Time: 4688.04s): Avg Loss=0.2547, Avg Acc=93.30% ---
2025-05-01 19:04:09,478 [INFO] -   vit: Loss=0.1027, Acc=98.15%, CE=0.0556, Mut=2.4059, Cal=0.0137, Feat=0.0000
2025-05-01 19:04:09,478 [INFO] -   efficientnet: Loss=0.2228, Acc=93.77%, CE=0.1854, Mut=2.0414, Cal=0.0414, Feat=0.0000
2025-05-01 19:04:09,478 [INFO] -   inception: Loss=0.2605, Acc=94.16%, CE=0.1806, Mut=4.1657, Cal=0.0396, Feat=0.0000
2025-05-01 19:04:09,478 [INFO] -   mobilenet: Loss=0.3738, Acc=89.46%, CE=0.3252, Mut=2.7347, Cal=0.0671, Feat=0.0000
2025-05-01 19:04:09,478 [INFO] -   resnet: Loss=0.3200, Acc=90.86%, CE=0.2829, Mut=2.1191, Cal=0.0577, Feat=0.0000
2025-05-01 19:04:09,478 [INFO] -   densenet: Loss=0.2651, Acc=93.01%, CE=0.2268, Mut=2.1255, Cal=0.0461, Feat=0.0000
2025-05-01 19:04:09,478 [INFO] -   student: Loss=0.2380, Acc=93.66%, CE=0.1865, Mut=2.5695, Cal=0.0425, Feat=1.0569
2025-05-01 19:04:09,478 [INFO] - --- Starting Validation for Epoch 1 ---
2025-05-01 19:05:03,170 [ERROR] - An error occurred in main: cat(): argument 'tensors' (position 1) must be tuple of Tensors, not Tensor
2025-05-01 19:05:03,170 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\894352416.py", line 3323, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config, optimizers, schedulers, start_epoch=start_epoch_mutual)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\894352416.py", line 2665, in mutual_learning_phase
    model_targets = torch.cat(all_val_targets[name][0]) # Use the stored targets
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: cat(): argument 'tensors' (position 1) must be tuple of Tensors, not Tensor

2025-05-01 19:09:53,048 [INFO] - Using device: cuda
2025-05-01 19:09:53,048 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 19:09:53,048 [INFO] - GPU Memory: 6.00 GB
2025-05-01 19:09:53,048 [INFO] - CUDA Version: 12.4
2025-05-01 19:09:53,048 [INFO] - cuDNN benchmark mode enabled
2025-05-01 19:09:53,080 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 19:09:53,085 [INFO] - Random seed set to 42
2025-05-01 19:09:53,086 [INFO] - Creating models...
2025-05-01 19:09:53,086 [INFO] - Loading ViT-B16 model...
2025-05-01 19:09:53,968 [INFO] - Loading EfficientNetB0 model...
2025-05-01 19:09:54,290 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 19:09:54,671 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 19:09:54,673 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 19:09:54,770 [INFO] - Loading ResNet50 model...
2025-05-01 19:09:55,160 [INFO] - Loading DenseNet121 model...
2025-05-01 19:09:55,305 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 19:09:55,666 [INFO] - Model vit moved to cuda
2025-05-01 19:09:55,713 [INFO] - Model efficientnet moved to cuda
2025-05-01 19:09:55,750 [INFO] - Model inception moved to cuda
2025-05-01 19:09:55,763 [INFO] - Model mobilenet moved to cuda
2025-05-01 19:09:55,790 [INFO] - Model resnet moved to cuda
2025-05-01 19:09:55,822 [INFO] - Model densenet moved to cuda
2025-05-01 19:09:55,840 [INFO] - Model student moved to cuda
2025-05-01 19:09:55,841 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 19:09:55,841 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 19:09:55,846 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 19:09:55,847 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 19:09:55,849 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 19:09:55,851 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 19:09:55,853 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 19:09:55,853 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-01 19:09:55,853 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-01 19:09:57,763 [INFO] - Loaded model state for vit successfully.
2025-05-01 19:09:57,792 [INFO] - Loaded model state for efficientnet successfully.
2025-05-01 19:09:57,851 [INFO] - Loaded model state for inception successfully.
2025-05-01 19:09:57,882 [INFO] - Loaded model state for mobilenet successfully.
2025-05-01 19:09:57,927 [INFO] - Loaded model state for resnet successfully.
2025-05-01 19:09:57,976 [INFO] - Loaded model state for densenet successfully.
2025-05-01 19:09:58,005 [INFO] - Loaded model state for student successfully.
2025-05-01 19:09:58,156 [INFO] - Recreated and loaded optimizer state for vit
2025-05-01 19:09:58,186 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-01 19:09:58,236 [INFO] - Recreated and loaded optimizer state for inception
2025-05-01 19:09:58,258 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-01 19:09:58,298 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-01 19:09:58,340 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-01 19:09:58,368 [INFO] - Recreated and loaded optimizer state for student
2025-05-01 19:09:58,369 [WARNING] - No scheduler info found for vit in checkpoint.
2025-05-01 19:09:58,370 [WARNING] - No scheduler info found for efficientnet in checkpoint.
2025-05-01 19:09:58,371 [WARNING] - No scheduler info found for inception in checkpoint.
2025-05-01 19:09:58,372 [WARNING] - No scheduler info found for mobilenet in checkpoint.
2025-05-01 19:09:58,372 [WARNING] - No scheduler info found for resnet in checkpoint.
2025-05-01 19:09:58,372 [WARNING] - No scheduler info found for densenet in checkpoint.
2025-05-01 19:09:58,372 [WARNING] - No scheduler info found for student in checkpoint.
2025-05-01 19:09:58,372 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-01 19:09:58,379 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-01 19:09:58,379 [INFO] - Created new scheduler for vit
2025-05-01 19:09:58,379 [INFO] - Created new scheduler for efficientnet
2025-05-01 19:09:58,379 [INFO] - Created new scheduler for inception
2025-05-01 19:09:58,379 [INFO] - Created new scheduler for mobilenet
2025-05-01 19:09:58,379 [INFO] - Created new scheduler for resnet
2025-05-01 19:09:58,379 [INFO] - Created new scheduler for densenet
2025-05-01 19:09:58,379 [INFO] - Created new scheduler for student
2025-05-01 19:09:58,379 [INFO] - Preparing data loaders...
2025-05-01 19:10:07,378 [INFO] - Training samples: 45000 per model
2025-05-01 19:10:07,379 [INFO] - Validation samples: 5000 per model
2025-05-01 19:10:07,380 [INFO] - Test samples: 10000 per model
2025-05-01 19:10:07,380 [INFO] - Skipping initialization phase.
2025-05-01 19:10:07,381 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-01 19:10:07,591 [INFO] - GPU Memory: Current=1785.21MB, Peak=5189.00MB, Reserved=1814.00MB
2025-05-01 19:10:07,591 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-01 19:10:07,591 [INFO] - Starting mutual learning phase...
2025-05-01 19:10:07,591 [INFO] - Hook registered for encoder.ln
2025-05-01 19:10:07,591 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 19:10:07,607 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 19:10:07,607 [INFO] - Hook registered for features.8
2025-05-01 19:10:07,607 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 19:10:07,916 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 19:10:07,917 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 19:10:07,918 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 19:10:07,927 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 19:10:07,927 [INFO] - Hook registered for features
2025-05-01 19:10:07,942 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 19:10:07,942 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 19:10:07,942 [INFO] - Hook registered for layer4
2025-05-01 19:10:07,942 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 19:10:07,958 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 19:10:07,958 [INFO] - Hook registered for features
2025-05-01 19:10:07,958 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 19:10:07,990 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 19:10:07,990 [INFO] - Hook registered for features.8
2025-05-01 19:10:07,990 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 19:10:08,005 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 19:10:08,116 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 19:10:08,116 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 19:10:08,116 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 19:10:08,132 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 19:10:08,139 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 19:10:08,139 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 19:10:08,148 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:10:08,149 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 19:10:08,149 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 19:10:08,149 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 19:10:08,149 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:10:08,164 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 19:10:08,164 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 19:10:08,164 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 19:10:08,279 [INFO] - HFI initialized.
2025-05-01 19:10:08,279 [INFO] - Added HFI params to student optimizer.
2025-05-01 19:10:08,501 [INFO] - Using LR warmup for 3 epochs for model vit.
2025-05-01 19:10:08,516 [INFO] - Using LR warmup for 3 epochs for model efficientnet.
2025-05-01 19:10:08,516 [INFO] - Using LR warmup for 3 epochs for model inception.
2025-05-01 19:10:08,516 [INFO] - Using LR warmup for 3 epochs for model mobilenet.
2025-05-01 19:10:08,516 [INFO] - Using LR warmup for 3 epochs for model resnet.
2025-05-01 19:10:08,516 [INFO] - Using LR warmup for 3 epochs for model densenet.
2025-05-01 19:10:08,516 [INFO] - Using LR warmup for 3 epochs for model student.
2025-05-01 19:10:08,516 [INFO] - Added HFI parameters to the student optimizer.
2025-05-01 19:10:08,516 [INFO] - Mutual learning phase using effective batch size: 4
2025-05-01 19:10:08,516 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-01 19:10:29,545 [INFO] - GPU Memory: Current=2497.39MB, Peak=5189.00MB, Reserved=3322.00MB
2025-05-01 19:13:14,383 [INFO] - GPU Memory: Current=2497.96MB, Peak=5189.00MB, Reserved=4234.00MB
2025-05-01 19:21:03,635 [INFO] - Using device: cuda
2025-05-01 19:21:03,642 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 19:21:03,642 [INFO] - GPU Memory: 6.00 GB
2025-05-01 19:21:03,642 [INFO] - CUDA Version: 12.4
2025-05-01 19:21:03,642 [INFO] - cuDNN benchmark mode enabled
2025-05-01 19:21:03,661 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 19:21:03,663 [INFO] - Random seed set to 42
2025-05-01 19:21:03,663 [INFO] - Creating models...
2025-05-01 19:21:03,664 [INFO] - Loading ViT-B16 model...
2025-05-01 19:21:04,590 [INFO] - Loading EfficientNetB0 model...
2025-05-01 19:21:04,721 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 19:21:05,104 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 19:21:05,114 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 19:21:05,212 [INFO] - Loading ResNet50 model...
2025-05-01 19:21:05,863 [INFO] - Loading DenseNet121 model...
2025-05-01 19:21:05,999 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 19:21:06,331 [INFO] - Model vit moved to cuda
2025-05-01 19:21:06,346 [INFO] - Model efficientnet moved to cuda
2025-05-01 19:21:06,388 [INFO] - Model inception moved to cuda
2025-05-01 19:21:06,405 [INFO] - Model mobilenet moved to cuda
2025-05-01 19:21:06,429 [INFO] - Model resnet moved to cuda
2025-05-01 19:21:06,461 [INFO] - Model densenet moved to cuda
2025-05-01 19:21:06,477 [INFO] - Model student moved to cuda
2025-05-01 19:21:06,478 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 19:21:06,480 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 19:21:06,483 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 19:21:06,485 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 19:21:06,485 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 19:21:06,485 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 19:21:06,490 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 19:21:06,491 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-01 19:21:06,491 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-01 19:21:08,799 [INFO] - Loaded model state for vit successfully.
2025-05-01 19:21:08,846 [INFO] - Loaded model state for efficientnet successfully.
2025-05-01 19:21:08,952 [INFO] - Loaded model state for inception successfully.
2025-05-01 19:21:08,991 [INFO] - Loaded model state for mobilenet successfully.
2025-05-01 19:21:09,043 [INFO] - Loaded model state for resnet successfully.
2025-05-01 19:21:09,103 [INFO] - Loaded model state for densenet successfully.
2025-05-01 19:21:09,135 [INFO] - Loaded model state for student successfully.
2025-05-01 19:21:09,379 [INFO] - Recreated and loaded optimizer state for vit
2025-05-01 19:21:09,410 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-01 19:21:09,467 [INFO] - Recreated and loaded optimizer state for inception
2025-05-01 19:21:09,492 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-01 19:21:09,550 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-01 19:21:09,617 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-01 19:21:09,655 [INFO] - Recreated and loaded optimizer state for student
2025-05-01 19:21:09,655 [WARNING] - No scheduler info found for vit in checkpoint.
2025-05-01 19:21:09,655 [WARNING] - No scheduler info found for efficientnet in checkpoint.
2025-05-01 19:21:09,655 [WARNING] - No scheduler info found for inception in checkpoint.
2025-05-01 19:21:09,655 [WARNING] - No scheduler info found for mobilenet in checkpoint.
2025-05-01 19:21:09,655 [WARNING] - No scheduler info found for resnet in checkpoint.
2025-05-01 19:21:09,655 [WARNING] - No scheduler info found for densenet in checkpoint.
2025-05-01 19:21:09,655 [WARNING] - No scheduler info found for student in checkpoint.
2025-05-01 19:21:09,655 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-01 19:21:09,666 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-01 19:21:09,666 [INFO] - Created new scheduler for vit
2025-05-01 19:21:09,666 [INFO] - Created new scheduler for efficientnet
2025-05-01 19:21:09,666 [INFO] - Created new scheduler for inception
2025-05-01 19:21:09,666 [INFO] - Created new scheduler for mobilenet
2025-05-01 19:21:09,672 [INFO] - Created new scheduler for resnet
2025-05-01 19:21:09,672 [INFO] - Created new scheduler for densenet
2025-05-01 19:21:09,673 [INFO] - Created new scheduler for student
2025-05-01 19:21:09,674 [INFO] - Preparing data loaders...
2025-05-01 19:21:18,808 [INFO] - Training samples: 45000 per model
2025-05-01 19:21:18,808 [INFO] - Validation samples: 5000 per model
2025-05-01 19:21:18,808 [INFO] - Test samples: 10000 per model
2025-05-01 19:21:18,808 [INFO] - Skipping initialization phase.
2025-05-01 19:21:18,808 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-01 19:21:19,075 [INFO] - GPU Memory: Current=4843.46MB, Peak=5189.00MB, Reserved=4882.00MB
2025-05-01 19:21:19,075 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-01 19:21:19,075 [INFO] - Starting mutual learning phase...
2025-05-01 19:21:19,091 [INFO] - Hook registered for encoder.ln
2025-05-01 19:21:19,091 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 19:21:19,130 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 19:21:19,139 [INFO] - Hook registered for features.8
2025-05-01 19:21:19,139 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 19:21:19,340 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 19:21:19,341 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 19:21:19,342 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 19:21:19,364 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 19:21:19,364 [INFO] - Hook registered for features
2025-05-01 19:21:19,364 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 19:21:19,391 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 19:21:19,391 [INFO] - Hook registered for layer4
2025-05-01 19:21:19,391 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 19:21:19,405 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 19:21:19,405 [INFO] - Hook registered for features
2025-05-01 19:21:19,405 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 19:21:19,436 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 19:21:19,436 [INFO] - Hook registered for features.8
2025-05-01 19:21:19,436 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 19:21:19,461 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 19:21:19,565 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 19:21:19,565 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 19:21:19,565 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 19:21:19,565 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 19:21:19,581 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 19:21:19,581 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 19:21:19,581 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:21:19,581 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 19:21:19,597 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 19:21:19,597 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 19:21:19,597 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:21:19,612 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 19:21:19,612 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 19:21:19,612 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 19:21:19,753 [INFO] - HFI initialized.
2025-05-01 19:21:19,753 [INFO] - Added HFI params to student optimizer.
2025-05-01 19:21:19,889 [ERROR] - An error occurred in main: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.03 GiB is allocated by PyTorch, and 51.30 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-05-01 19:21:19,889 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\2330940744.py", line 3353, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config, optimizers, schedulers, start_epoch=start_epoch_mutual)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\2330940744.py", line 2270, in mutual_learning_phase
    best_states = {name: copy.deepcopy(model.state_dict()) for name, model in models.items()}
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\copy.py", line 162, in deepcopy
    y = _reconstruct(x, memo, *rv)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\copy.py", line 285, in _reconstruct
    value = deepcopy(value, memo)
            ^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\copy.py", line 143, in deepcopy
    y = copier(memo)
        ^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\_tensor.py", line 121, in __deepcopy__
    new_storage = self._typed_storage()._deepcopy(memo)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\storage.py", line 1118, in _deepcopy
    return self._new_wrapped_storage(copy.deepcopy(self._untyped_storage, memo))
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\copy.py", line 143, in deepcopy
    y = copier(memo)
        ^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\storage.py", line 231, in __deepcopy__
    new_storage = self.clone()
                  ^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\storage.py", line 245, in clone
    return type(self)(self.nbytes(), device=self.device).copy_(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.03 GiB is allocated by PyTorch, and 51.30 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-05-01 19:22:18,238 [INFO] - Using device: cuda
2025-05-01 19:22:18,245 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 19:22:18,245 [INFO] - GPU Memory: 6.00 GB
2025-05-01 19:22:18,245 [INFO] - CUDA Version: 12.4
2025-05-01 19:22:18,245 [INFO] - cuDNN benchmark mode enabled
2025-05-01 19:22:18,264 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 19:22:18,266 [INFO] - Random seed set to 42
2025-05-01 19:22:18,267 [INFO] - Creating models...
2025-05-01 19:22:18,267 [INFO] - Loading ViT-B16 model...
2025-05-01 19:22:19,155 [INFO] - Loading EfficientNetB0 model...
2025-05-01 19:22:19,301 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 19:22:19,662 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 19:22:19,662 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 19:22:19,780 [INFO] - Loading ResNet50 model...
2025-05-01 19:22:20,184 [INFO] - Loading DenseNet121 model...
2025-05-01 19:22:20,343 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 19:22:20,690 [INFO] - Model vit moved to cuda
2025-05-01 19:22:20,710 [INFO] - Model efficientnet moved to cuda
2025-05-01 19:22:20,745 [INFO] - Model inception moved to cuda
2025-05-01 19:22:20,759 [INFO] - Model mobilenet moved to cuda
2025-05-01 19:22:20,787 [INFO] - Model resnet moved to cuda
2025-05-01 19:22:20,821 [INFO] - Model densenet moved to cuda
2025-05-01 19:22:20,838 [INFO] - Model student moved to cuda
2025-05-01 19:22:20,843 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 19:22:20,845 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 19:22:20,847 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 19:22:20,849 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 19:22:20,849 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 19:22:20,849 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 19:22:20,849 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 19:22:20,856 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-01 19:22:20,856 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-01 19:22:22,983 [INFO] - Loaded model state for vit successfully.
2025-05-01 19:22:23,032 [INFO] - Loaded model state for efficientnet successfully.
2025-05-01 19:22:23,078 [INFO] - Loaded model state for inception successfully.
2025-05-01 19:22:23,099 [INFO] - Loaded model state for mobilenet successfully.
2025-05-01 19:22:23,130 [INFO] - Loaded model state for resnet successfully.
2025-05-01 19:22:23,161 [INFO] - Loaded model state for densenet successfully.
2025-05-01 19:22:23,186 [INFO] - Loaded model state for student successfully.
2025-05-01 19:22:23,270 [INFO] - Recreated and loaded optimizer state for vit
2025-05-01 19:22:23,297 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-01 19:22:23,353 [INFO] - Recreated and loaded optimizer state for inception
2025-05-01 19:22:23,363 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-01 19:22:23,406 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-01 19:22:23,439 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-01 19:22:23,481 [INFO] - Recreated and loaded optimizer state for student
2025-05-01 19:22:23,481 [WARNING] - No scheduler info found for vit in checkpoint.
2025-05-01 19:22:23,481 [WARNING] - No scheduler info found for efficientnet in checkpoint.
2025-05-01 19:22:23,481 [WARNING] - No scheduler info found for inception in checkpoint.
2025-05-01 19:22:23,481 [WARNING] - No scheduler info found for mobilenet in checkpoint.
2025-05-01 19:22:23,481 [WARNING] - No scheduler info found for resnet in checkpoint.
2025-05-01 19:22:23,481 [WARNING] - No scheduler info found for densenet in checkpoint.
2025-05-01 19:22:23,481 [WARNING] - No scheduler info found for student in checkpoint.
2025-05-01 19:22:23,481 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-01 19:22:23,496 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-01 19:22:23,496 [INFO] - Created new scheduler for vit
2025-05-01 19:22:23,497 [INFO] - Created new scheduler for efficientnet
2025-05-01 19:22:23,498 [INFO] - Created new scheduler for inception
2025-05-01 19:22:23,498 [INFO] - Created new scheduler for mobilenet
2025-05-01 19:22:23,499 [INFO] - Created new scheduler for resnet
2025-05-01 19:22:23,500 [INFO] - Created new scheduler for densenet
2025-05-01 19:22:23,500 [INFO] - Created new scheduler for student
2025-05-01 19:22:23,501 [INFO] - Preparing data loaders...
2025-05-01 19:22:32,698 [INFO] - Training samples: 45000 per model
2025-05-01 19:22:32,699 [INFO] - Validation samples: 5000 per model
2025-05-01 19:22:32,700 [INFO] - Test samples: 10000 per model
2025-05-01 19:22:32,701 [INFO] - Skipping initialization phase.
2025-05-01 19:22:32,701 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-01 19:22:32,946 [INFO] - GPU Memory: Current=4844.06MB, Peak=5189.00MB, Reserved=4862.00MB
2025-05-01 19:22:32,947 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-01 19:22:32,947 [INFO] - Starting mutual learning phase...
2025-05-01 19:22:32,948 [INFO] - Hook registered for encoder.ln
2025-05-01 19:22:32,949 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 19:22:32,960 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 19:22:32,962 [INFO] - Hook registered for features.8
2025-05-01 19:22:32,963 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 19:22:33,189 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 19:22:33,189 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 19:22:33,189 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 19:22:33,213 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 19:22:33,213 [INFO] - Hook registered for features
2025-05-01 19:22:33,213 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 19:22:33,311 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 19:22:33,312 [INFO] - Hook registered for layer4
2025-05-01 19:22:33,312 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 19:22:33,321 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 19:22:33,325 [INFO] - Hook registered for features
2025-05-01 19:22:33,325 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 19:22:33,351 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 19:22:33,356 [INFO] - Hook registered for features.8
2025-05-01 19:22:33,357 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 19:22:33,374 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 19:22:33,470 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 19:22:33,471 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 19:22:33,475 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 19:22:33,476 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 19:22:33,483 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 19:22:33,484 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 19:22:33,494 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:22:33,495 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 19:22:33,496 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 19:22:33,496 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 19:22:33,511 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:22:33,511 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 19:22:33,517 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 19:22:33,517 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 19:22:33,635 [INFO] - HFI initialized.
2025-05-01 19:22:33,636 [INFO] - Added HFI params to student optimizer.
2025-05-01 19:22:33,670 [ERROR] - An error occurred in main: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.03 GiB is allocated by PyTorch, and 50.59 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-05-01 19:22:33,672 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\1061214217.py", line 3353, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config, optimizers, schedulers, start_epoch=start_epoch_mutual)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\1061214217.py", line 2270, in mutual_learning_phase
    best_states = {name: copy.deepcopy(model.state_dict()) for name, model in models.items()}
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\copy.py", line 162, in deepcopy
    y = _reconstruct(x, memo, *rv)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\copy.py", line 285, in _reconstruct
    value = deepcopy(value, memo)
            ^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\copy.py", line 143, in deepcopy
    y = copier(memo)
        ^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\_tensor.py", line 121, in __deepcopy__
    new_storage = self._typed_storage()._deepcopy(memo)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\storage.py", line 1118, in _deepcopy
    return self._new_wrapped_storage(copy.deepcopy(self._untyped_storage, memo))
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\copy.py", line 143, in deepcopy
    y = copier(memo)
        ^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\storage.py", line 231, in __deepcopy__
    new_storage = self.clone()
                  ^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\storage.py", line 245, in clone
    return type(self)(self.nbytes(), device=self.device).copy_(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.03 GiB is allocated by PyTorch, and 50.59 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-05-01 19:28:09,651 [INFO] - Using device: cuda
2025-05-01 19:28:09,651 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 19:28:09,651 [INFO] - GPU Memory: 6.00 GB
2025-05-01 19:28:09,651 [INFO] - CUDA Version: 12.4
2025-05-01 19:28:09,651 [INFO] - cuDNN benchmark mode enabled
2025-05-01 19:28:09,673 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 19:28:09,675 [INFO] - Random seed set to 42
2025-05-01 19:28:09,676 [INFO] - Creating models...
2025-05-01 19:28:09,676 [INFO] - Loading ViT-B16 model...
2025-05-01 19:28:10,583 [INFO] - Loading EfficientNetB0 model...
2025-05-01 19:28:10,729 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 19:28:11,088 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 19:28:11,088 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 19:28:11,185 [INFO] - Loading ResNet50 model...
2025-05-01 19:28:11,547 [INFO] - Loading DenseNet121 model...
2025-05-01 19:28:11,693 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 19:28:11,993 [INFO] - Model vit moved to cuda
2025-05-01 19:28:12,012 [INFO] - Model efficientnet moved to cuda
2025-05-01 19:28:12,049 [INFO] - Model inception moved to cuda
2025-05-01 19:28:12,063 [INFO] - Model mobilenet moved to cuda
2025-05-01 19:28:12,089 [INFO] - Model resnet moved to cuda
2025-05-01 19:28:12,119 [INFO] - Model densenet moved to cuda
2025-05-01 19:28:12,138 [INFO] - Model student moved to cuda
2025-05-01 19:28:12,139 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 19:28:12,139 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 19:28:12,143 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 19:28:12,146 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 19:28:12,146 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 19:28:12,146 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 19:28:12,151 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 19:28:12,152 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-01 19:28:12,153 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-01 19:28:13,944 [INFO] - Loaded model state for vit successfully.
2025-05-01 19:28:13,969 [INFO] - Loaded model state for efficientnet successfully.
2025-05-01 19:28:14,042 [INFO] - Loaded model state for inception successfully.
2025-05-01 19:28:14,076 [INFO] - Loaded model state for mobilenet successfully.
2025-05-01 19:28:14,126 [INFO] - Loaded model state for resnet successfully.
2025-05-01 19:28:14,178 [INFO] - Loaded model state for densenet successfully.
2025-05-01 19:28:14,202 [INFO] - Loaded model state for student successfully.
2025-05-01 19:28:14,407 [INFO] - Recreated and loaded optimizer state for vit
2025-05-01 19:28:14,432 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-01 19:28:14,472 [INFO] - Recreated and loaded optimizer state for inception
2025-05-01 19:28:14,504 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-01 19:28:14,553 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-01 19:28:14,601 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-01 19:28:14,620 [INFO] - Recreated and loaded optimizer state for student
2025-05-01 19:28:14,624 [WARNING] - No scheduler info found for vit in checkpoint.
2025-05-01 19:28:14,624 [WARNING] - No scheduler info found for efficientnet in checkpoint.
2025-05-01 19:28:14,625 [WARNING] - No scheduler info found for inception in checkpoint.
2025-05-01 19:28:14,625 [WARNING] - No scheduler info found for mobilenet in checkpoint.
2025-05-01 19:28:14,626 [WARNING] - No scheduler info found for resnet in checkpoint.
2025-05-01 19:28:14,626 [WARNING] - No scheduler info found for densenet in checkpoint.
2025-05-01 19:28:14,627 [WARNING] - No scheduler info found for student in checkpoint.
2025-05-01 19:28:14,627 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-01 19:28:14,632 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-01 19:28:14,632 [INFO] - Created new scheduler for vit
2025-05-01 19:28:14,632 [INFO] - Created new scheduler for efficientnet
2025-05-01 19:28:14,636 [INFO] - Created new scheduler for inception
2025-05-01 19:28:14,637 [INFO] - Created new scheduler for mobilenet
2025-05-01 19:28:14,637 [INFO] - Created new scheduler for resnet
2025-05-01 19:28:14,638 [INFO] - Created new scheduler for densenet
2025-05-01 19:28:14,639 [INFO] - Created new scheduler for student
2025-05-01 19:28:14,639 [INFO] - Preparing data loaders...
2025-05-01 19:28:23,769 [INFO] - Training samples: 45000 per model
2025-05-01 19:28:23,785 [INFO] - Validation samples: 5000 per model
2025-05-01 19:28:23,785 [INFO] - Test samples: 10000 per model
2025-05-01 19:28:23,785 [INFO] - Skipping initialization phase.
2025-05-01 19:28:23,785 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-01 19:28:24,043 [INFO] - GPU Memory: Current=4840.48MB, Peak=5189.00MB, Reserved=4882.00MB
2025-05-01 19:28:24,043 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-01 19:28:24,043 [INFO] - Starting mutual learning phase...
2025-05-01 19:28:24,043 [INFO] - Hook registered for encoder.ln
2025-05-01 19:28:24,046 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 19:28:24,063 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 19:28:24,064 [INFO] - Hook registered for features.8
2025-05-01 19:28:24,064 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 19:28:24,408 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 19:28:24,409 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 19:28:24,410 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 19:28:24,431 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 19:28:24,432 [INFO] - Hook registered for features
2025-05-01 19:28:24,432 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 19:28:24,443 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 19:28:24,443 [INFO] - Hook registered for layer4
2025-05-01 19:28:24,443 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 19:28:24,462 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 19:28:24,463 [INFO] - Hook registered for features
2025-05-01 19:28:24,464 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 19:28:24,494 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 19:28:24,494 [INFO] - Hook registered for features.8
2025-05-01 19:28:24,494 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 19:28:24,513 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 19:28:24,629 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 19:28:24,630 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 19:28:24,634 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 19:28:24,635 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 19:28:24,642 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 19:28:24,642 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 19:28:24,654 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:28:24,655 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 19:28:24,660 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 19:28:24,661 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 19:28:24,671 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:28:24,672 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 19:28:24,678 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 19:28:24,679 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 19:28:24,776 [INFO] - HFI initialized.
2025-05-01 19:28:24,776 [INFO] - Added HFI params to student optimizer.
2025-05-01 19:28:24,776 [ERROR] - An error occurred in main: 'collections.OrderedDict' object has no attribute 'cpu'
2025-05-01 19:28:24,792 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\2824662152.py", line 3352, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config, optimizers, schedulers, start_epoch=start_epoch_mutual)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\2824662152.py", line 2270, in mutual_learning_phase
    best_states = {name: copy.deepcopy(model.state_dict().cpu()) for name, model in models.items()}
                                       ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'collections.OrderedDict' object has no attribute 'cpu'

2025-05-01 19:31:12,044 [INFO] - Using device: cuda
2025-05-01 19:31:12,044 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 19:31:12,044 [INFO] - GPU Memory: 6.00 GB
2025-05-01 19:31:12,044 [INFO] - CUDA Version: 12.4
2025-05-01 19:31:12,051 [INFO] - cuDNN benchmark mode enabled
2025-05-01 19:31:12,070 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 19:31:12,072 [INFO] - Random seed set to 42
2025-05-01 19:31:12,073 [INFO] - Creating models...
2025-05-01 19:31:12,073 [INFO] - Loading ViT-B16 model...
2025-05-01 19:31:12,935 [INFO] - Loading EfficientNetB0 model...
2025-05-01 19:31:13,077 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 19:31:13,437 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 19:31:13,437 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 19:31:13,543 [INFO] - Loading ResNet50 model...
2025-05-01 19:31:13,900 [INFO] - Loading DenseNet121 model...
2025-05-01 19:31:14,026 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 19:31:14,339 [INFO] - Model vit moved to cuda
2025-05-01 19:31:14,342 [INFO] - Model efficientnet moved to cuda
2025-05-01 19:31:14,391 [INFO] - Model inception moved to cuda
2025-05-01 19:31:14,398 [INFO] - Model mobilenet moved to cuda
2025-05-01 19:31:14,426 [INFO] - Model resnet moved to cuda
2025-05-01 19:31:14,455 [INFO] - Model densenet moved to cuda
2025-05-01 19:31:14,467 [INFO] - Model student moved to cuda
2025-05-01 19:31:14,467 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 19:31:14,467 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 19:31:14,480 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 19:31:14,481 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 19:31:14,483 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 19:31:14,483 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 19:31:14,483 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 19:31:14,489 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-01 19:31:14,489 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-01 19:31:16,515 [INFO] - Loaded model state for vit successfully.
2025-05-01 19:31:16,559 [INFO] - Loaded model state for efficientnet successfully.
2025-05-01 19:31:16,648 [INFO] - Loaded model state for inception successfully.
2025-05-01 19:31:16,671 [INFO] - Loaded model state for mobilenet successfully.
2025-05-01 19:31:16,723 [INFO] - Loaded model state for resnet successfully.
2025-05-01 19:31:16,769 [INFO] - Loaded model state for densenet successfully.
2025-05-01 19:31:16,801 [INFO] - Loaded model state for student successfully.
2025-05-01 19:31:17,037 [INFO] - Recreated and loaded optimizer state for vit
2025-05-01 19:31:17,072 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-01 19:31:17,142 [INFO] - Recreated and loaded optimizer state for inception
2025-05-01 19:31:17,169 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-01 19:31:17,204 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-01 19:31:17,252 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-01 19:31:17,282 [INFO] - Recreated and loaded optimizer state for student
2025-05-01 19:31:17,282 [WARNING] - No scheduler info found for vit in checkpoint.
2025-05-01 19:31:17,283 [WARNING] - No scheduler info found for efficientnet in checkpoint.
2025-05-01 19:31:17,284 [WARNING] - No scheduler info found for inception in checkpoint.
2025-05-01 19:31:17,284 [WARNING] - No scheduler info found for mobilenet in checkpoint.
2025-05-01 19:31:17,285 [WARNING] - No scheduler info found for resnet in checkpoint.
2025-05-01 19:31:17,285 [WARNING] - No scheduler info found for densenet in checkpoint.
2025-05-01 19:31:17,286 [WARNING] - No scheduler info found for student in checkpoint.
2025-05-01 19:31:17,287 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-01 19:31:17,294 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-01 19:31:17,294 [INFO] - Created new scheduler for vit
2025-05-01 19:31:17,294 [INFO] - Created new scheduler for efficientnet
2025-05-01 19:31:17,294 [INFO] - Created new scheduler for inception
2025-05-01 19:31:17,294 [INFO] - Created new scheduler for mobilenet
2025-05-01 19:31:17,294 [INFO] - Created new scheduler for resnet
2025-05-01 19:31:17,294 [INFO] - Created new scheduler for densenet
2025-05-01 19:31:17,294 [INFO] - Created new scheduler for student
2025-05-01 19:31:17,294 [INFO] - Preparing data loaders...
2025-05-01 19:31:26,127 [INFO] - Training samples: 45000 per model
2025-05-01 19:31:26,128 [INFO] - Validation samples: 5000 per model
2025-05-01 19:31:26,128 [INFO] - Test samples: 10000 per model
2025-05-01 19:31:26,129 [INFO] - Skipping initialization phase.
2025-05-01 19:31:26,129 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-01 19:31:26,365 [INFO] - GPU Memory: Current=4846.99MB, Peak=5189.00MB, Reserved=4882.00MB
2025-05-01 19:31:26,365 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-01 19:31:26,365 [INFO] - Starting mutual learning phase...
2025-05-01 19:31:26,365 [INFO] - Hook registered for encoder.ln
2025-05-01 19:31:26,370 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 19:31:26,380 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 19:31:26,381 [INFO] - Hook registered for features.8
2025-05-01 19:31:26,382 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 19:31:26,575 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 19:31:26,576 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 19:31:26,577 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 19:31:26,602 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 19:31:26,606 [INFO] - Hook registered for features
2025-05-01 19:31:26,606 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 19:31:26,682 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 19:31:26,682 [INFO] - Hook registered for layer4
2025-05-01 19:31:26,682 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 19:31:26,699 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 19:31:26,700 [INFO] - Hook registered for features
2025-05-01 19:31:26,700 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 19:31:26,759 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 19:31:26,759 [INFO] - Hook registered for features.8
2025-05-01 19:31:26,759 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 19:31:26,778 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 19:31:26,884 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 19:31:26,884 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 19:31:26,891 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 19:31:26,891 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 19:31:26,898 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 19:31:26,898 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 19:31:26,906 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:31:26,906 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 19:31:26,913 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 19:31:26,913 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 19:31:26,925 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:31:26,926 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 19:31:26,932 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 19:31:26,933 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 19:31:27,038 [INFO] - HFI initialized.
2025-05-01 19:31:27,039 [INFO] - Added HFI params to student optimizer.
2025-05-01 19:31:27,100 [ERROR] - An error occurred in main: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.04 GiB is allocated by PyTorch, and 47.93 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-05-01 19:31:27,101 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\1061214217.py", line 3353, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config, optimizers, schedulers, start_epoch=start_epoch_mutual)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\1061214217.py", line 2270, in mutual_learning_phase
    best_states = {name: copy.deepcopy(model.state_dict()) for name, model in models.items()}
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\copy.py", line 162, in deepcopy
    y = _reconstruct(x, memo, *rv)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\copy.py", line 285, in _reconstruct
    value = deepcopy(value, memo)
            ^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\copy.py", line 143, in deepcopy
    y = copier(memo)
        ^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\_tensor.py", line 121, in __deepcopy__
    new_storage = self._typed_storage()._deepcopy(memo)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\storage.py", line 1118, in _deepcopy
    return self._new_wrapped_storage(copy.deepcopy(self._untyped_storage, memo))
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\copy.py", line 143, in deepcopy
    y = copier(memo)
        ^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\storage.py", line 231, in __deepcopy__
    new_storage = self.clone()
                  ^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\storage.py", line 245, in clone
    return type(self)(self.nbytes(), device=self.device).copy_(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.04 GiB is allocated by PyTorch, and 47.93 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-05-01 19:33:42,266 [INFO] - Using device: cuda
2025-05-01 19:33:42,267 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 19:33:42,267 [INFO] - GPU Memory: 6.00 GB
2025-05-01 19:33:42,267 [INFO] - CUDA Version: 12.4
2025-05-01 19:33:42,267 [INFO] - cuDNN benchmark mode enabled
2025-05-01 19:33:42,288 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 19:33:42,288 [INFO] - Random seed set to 42
2025-05-01 19:33:42,288 [INFO] - Creating models...
2025-05-01 19:33:42,288 [INFO] - Loading ViT-B16 model...
2025-05-01 19:33:43,154 [INFO] - Loading EfficientNetB0 model...
2025-05-01 19:33:43,278 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 19:33:43,626 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 19:33:43,629 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 19:33:43,723 [INFO] - Loading ResNet50 model...
2025-05-01 19:33:44,098 [INFO] - Loading DenseNet121 model...
2025-05-01 19:33:44,222 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 19:33:44,557 [INFO] - Model vit moved to cuda
2025-05-01 19:33:44,597 [INFO] - Model efficientnet moved to cuda
2025-05-01 19:33:44,702 [INFO] - Model inception moved to cuda
2025-05-01 19:33:44,726 [INFO] - Model mobilenet moved to cuda
2025-05-01 19:33:44,785 [INFO] - Model resnet moved to cuda
2025-05-01 19:33:44,833 [INFO] - Model densenet moved to cuda
2025-05-01 19:33:44,861 [INFO] - Model student moved to cuda
2025-05-01 19:33:44,861 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 19:33:44,861 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 19:33:44,868 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 19:33:44,870 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 19:33:44,870 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 19:33:44,870 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 19:33:44,876 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 19:33:44,876 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-01 19:33:44,876 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-01 19:33:46,702 [INFO] - Loaded model state for vit successfully.
2025-05-01 19:33:46,737 [INFO] - Loaded model state for efficientnet successfully.
2025-05-01 19:33:46,827 [INFO] - Loaded model state for inception successfully.
2025-05-01 19:33:46,857 [INFO] - Loaded model state for mobilenet successfully.
2025-05-01 19:33:46,917 [INFO] - Loaded model state for resnet successfully.
2025-05-01 19:33:46,993 [INFO] - Loaded model state for densenet successfully.
2025-05-01 19:33:47,028 [INFO] - Loaded model state for student successfully.
2025-05-01 19:33:47,153 [INFO] - Recreated and loaded optimizer state for vit
2025-05-01 19:33:47,170 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-01 19:33:47,216 [INFO] - Recreated and loaded optimizer state for inception
2025-05-01 19:33:47,237 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-01 19:33:47,278 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-01 19:33:47,320 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-01 19:33:47,349 [INFO] - Recreated and loaded optimizer state for student
2025-05-01 19:33:47,350 [WARNING] - No scheduler info found for vit in checkpoint.
2025-05-01 19:33:47,350 [WARNING] - No scheduler info found for efficientnet in checkpoint.
2025-05-01 19:33:47,351 [WARNING] - No scheduler info found for inception in checkpoint.
2025-05-01 19:33:47,352 [WARNING] - No scheduler info found for mobilenet in checkpoint.
2025-05-01 19:33:47,352 [WARNING] - No scheduler info found for resnet in checkpoint.
2025-05-01 19:33:47,352 [WARNING] - No scheduler info found for densenet in checkpoint.
2025-05-01 19:33:47,352 [WARNING] - No scheduler info found for student in checkpoint.
2025-05-01 19:33:47,354 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-01 19:33:47,362 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-01 19:33:47,362 [INFO] - Created new scheduler for vit
2025-05-01 19:33:47,366 [INFO] - Created new scheduler for efficientnet
2025-05-01 19:33:47,368 [INFO] - Created new scheduler for inception
2025-05-01 19:33:47,369 [INFO] - Created new scheduler for mobilenet
2025-05-01 19:33:47,369 [INFO] - Created new scheduler for resnet
2025-05-01 19:33:47,371 [INFO] - Created new scheduler for densenet
2025-05-01 19:33:47,372 [INFO] - Created new scheduler for student
2025-05-01 19:33:47,373 [INFO] - Preparing data loaders...
2025-05-01 19:33:56,272 [INFO] - Training samples: 45000 per model
2025-05-01 19:33:56,274 [INFO] - Validation samples: 5000 per model
2025-05-01 19:33:56,274 [INFO] - Test samples: 10000 per model
2025-05-01 19:33:56,274 [INFO] - Skipping initialization phase.
2025-05-01 19:33:56,276 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-01 19:33:56,524 [INFO] - GPU Memory: Current=4841.23MB, Peak=5189.00MB, Reserved=4882.00MB
2025-05-01 19:33:56,524 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-01 19:33:56,524 [INFO] - Starting mutual learning phase...
2025-05-01 19:33:56,524 [INFO] - Hook registered for encoder.ln
2025-05-01 19:33:56,524 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 19:33:56,524 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 19:33:56,540 [INFO] - Hook registered for features.8
2025-05-01 19:33:56,540 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 19:33:57,007 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 19:33:57,007 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 19:33:57,007 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 19:33:57,031 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 19:33:57,032 [INFO] - Hook registered for features
2025-05-01 19:33:57,032 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 19:33:57,043 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 19:33:57,043 [INFO] - Hook registered for layer4
2025-05-01 19:33:57,043 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 19:33:57,080 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 19:33:57,081 [INFO] - Hook registered for features
2025-05-01 19:33:57,081 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 19:33:57,272 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 19:33:57,279 [INFO] - Hook registered for features.8
2025-05-01 19:33:57,279 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 19:33:57,333 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 19:33:57,591 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 19:33:57,591 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 19:33:57,598 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 19:33:57,598 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 19:33:57,605 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 19:33:57,605 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 19:33:57,615 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:33:57,615 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 19:33:57,622 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 19:33:57,622 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 19:33:57,633 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:33:57,634 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 19:33:57,640 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 19:33:57,640 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 19:33:58,098 [INFO] - HFI initialized.
2025-05-01 19:33:58,098 [INFO] - Added HFI params to student optimizer.
2025-05-01 19:33:58,108 [ERROR] - An error occurred in main: 'str' object does not support item assignment
2025-05-01 19:33:58,108 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\3374642274.py", line 3355, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config, optimizers, schedulers, start_epoch=start_epoch_mutual)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\3374642274.py", line 2271, in mutual_learning_phase
    best_states = {name: copy.deepcopy(model.state_dict(destination='cpu'))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 2216, in state_dict
    self._save_to_state_dict(destination, prefix, keep_vars)
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 2118, in _save_to_state_dict
    destination[prefix + name] = param if keep_vars else param.detach()
    ~~~~~~~~~~~^^^^^^^^^^^^^^^
TypeError: 'str' object does not support item assignment

2025-05-01 19:34:56,671 [INFO] - Using device: cuda
2025-05-01 19:34:56,671 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 19:34:56,671 [INFO] - GPU Memory: 6.00 GB
2025-05-01 19:34:56,671 [INFO] - CUDA Version: 12.4
2025-05-01 19:34:56,671 [INFO] - cuDNN benchmark mode enabled
2025-05-01 19:34:56,694 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 19:34:56,696 [INFO] - Random seed set to 42
2025-05-01 19:34:56,697 [INFO] - Creating models...
2025-05-01 19:34:56,697 [INFO] - Loading ViT-B16 model...
2025-05-01 19:34:57,555 [INFO] - Loading EfficientNetB0 model...
2025-05-01 19:34:57,743 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 19:34:58,136 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 19:34:58,138 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 19:34:58,246 [INFO] - Loading ResNet50 model...
2025-05-01 19:34:58,618 [INFO] - Loading DenseNet121 model...
2025-05-01 19:34:58,772 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 19:34:59,070 [INFO] - Model vit moved to cuda
2025-05-01 19:34:59,097 [INFO] - Model efficientnet moved to cuda
2025-05-01 19:34:59,149 [INFO] - Model inception moved to cuda
2025-05-01 19:34:59,159 [INFO] - Model mobilenet moved to cuda
2025-05-01 19:34:59,187 [INFO] - Model resnet moved to cuda
2025-05-01 19:34:59,228 [INFO] - Model densenet moved to cuda
2025-05-01 19:34:59,236 [INFO] - Model student moved to cuda
2025-05-01 19:34:59,236 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 19:34:59,249 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 19:34:59,251 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 19:34:59,253 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 19:34:59,254 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 19:34:59,257 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 19:34:59,259 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 19:34:59,261 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-01 19:34:59,261 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-01 19:35:01,000 [INFO] - Loaded model state for vit successfully.
2025-05-01 19:35:01,028 [INFO] - Loaded model state for efficientnet successfully.
2025-05-01 19:35:01,094 [INFO] - Loaded model state for inception successfully.
2025-05-01 19:35:01,117 [INFO] - Loaded model state for mobilenet successfully.
2025-05-01 19:35:01,159 [INFO] - Loaded model state for resnet successfully.
2025-05-01 19:35:01,229 [INFO] - Loaded model state for densenet successfully.
2025-05-01 19:35:01,255 [INFO] - Loaded model state for student successfully.
2025-05-01 19:35:01,462 [INFO] - Recreated and loaded optimizer state for vit
2025-05-01 19:35:01,496 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-01 19:35:01,558 [INFO] - Recreated and loaded optimizer state for inception
2025-05-01 19:35:01,569 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-01 19:35:01,607 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-01 19:35:01,653 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-01 19:35:01,678 [INFO] - Recreated and loaded optimizer state for student
2025-05-01 19:35:01,679 [WARNING] - No scheduler info found for vit in checkpoint.
2025-05-01 19:35:01,679 [WARNING] - No scheduler info found for efficientnet in checkpoint.
2025-05-01 19:35:01,680 [WARNING] - No scheduler info found for inception in checkpoint.
2025-05-01 19:35:01,681 [WARNING] - No scheduler info found for mobilenet in checkpoint.
2025-05-01 19:35:01,681 [WARNING] - No scheduler info found for resnet in checkpoint.
2025-05-01 19:35:01,682 [WARNING] - No scheduler info found for densenet in checkpoint.
2025-05-01 19:35:01,682 [WARNING] - No scheduler info found for student in checkpoint.
2025-05-01 19:35:01,683 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-01 19:35:01,689 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-01 19:35:01,689 [INFO] - Created new scheduler for vit
2025-05-01 19:35:01,689 [INFO] - Created new scheduler for efficientnet
2025-05-01 19:35:01,689 [INFO] - Created new scheduler for inception
2025-05-01 19:35:01,689 [INFO] - Created new scheduler for mobilenet
2025-05-01 19:35:01,689 [INFO] - Created new scheduler for resnet
2025-05-01 19:35:01,689 [INFO] - Created new scheduler for densenet
2025-05-01 19:35:01,689 [INFO] - Created new scheduler for student
2025-05-01 19:35:01,689 [INFO] - Preparing data loaders...
2025-05-01 19:35:10,569 [INFO] - Training samples: 45000 per model
2025-05-01 19:35:10,569 [INFO] - Validation samples: 5000 per model
2025-05-01 19:35:10,569 [INFO] - Test samples: 10000 per model
2025-05-01 19:35:10,569 [INFO] - Skipping initialization phase.
2025-05-01 19:35:10,569 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-01 19:35:10,819 [INFO] - GPU Memory: Current=4846.68MB, Peak=5189.00MB, Reserved=4862.00MB
2025-05-01 19:35:10,819 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-01 19:35:10,819 [INFO] - Starting mutual learning phase...
2025-05-01 19:35:10,823 [INFO] - Hook registered for encoder.ln
2025-05-01 19:35:10,823 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 19:35:10,847 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 19:35:10,848 [INFO] - Hook registered for features.8
2025-05-01 19:35:10,849 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 19:35:11,076 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 19:35:11,082 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 19:35:11,082 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 19:35:11,105 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 19:35:11,106 [INFO] - Hook registered for features
2025-05-01 19:35:11,106 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 19:35:11,118 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 19:35:11,119 [INFO] - Hook registered for layer4
2025-05-01 19:35:11,120 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 19:35:11,137 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 19:35:11,138 [INFO] - Hook registered for features
2025-05-01 19:35:11,139 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 19:35:11,166 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 19:35:11,167 [INFO] - Hook registered for features.8
2025-05-01 19:35:11,167 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 19:35:11,181 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 19:35:11,281 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 19:35:11,282 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 19:35:11,286 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 19:35:11,287 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 19:35:11,291 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 19:35:11,291 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 19:35:11,302 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:35:11,302 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 19:35:11,308 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 19:35:11,309 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 19:35:11,314 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:35:11,319 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 19:35:11,323 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 19:35:11,324 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 19:35:11,443 [INFO] - HFI initialized.
2025-05-01 19:35:11,444 [INFO] - Added HFI params to student optimizer.
2025-05-01 19:35:13,542 [INFO] - Using LR warmup for 3 epochs for model vit.
2025-05-01 19:35:13,545 [INFO] - Using LR warmup for 3 epochs for model efficientnet.
2025-05-01 19:35:13,548 [INFO] - Using LR warmup for 3 epochs for model inception.
2025-05-01 19:35:13,549 [INFO] - Using LR warmup for 3 epochs for model mobilenet.
2025-05-01 19:35:13,552 [INFO] - Using LR warmup for 3 epochs for model resnet.
2025-05-01 19:35:13,555 [INFO] - Using LR warmup for 3 epochs for model densenet.
2025-05-01 19:35:13,559 [INFO] - Using LR warmup for 3 epochs for model student.
2025-05-01 19:35:13,559 [INFO] - Added HFI parameters to the student optimizer.
2025-05-01 19:35:13,559 [INFO] - Mutual learning phase using effective batch size: 4
2025-05-01 19:35:13,562 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-01 19:35:31,207 [ERROR] - An error occurred in main: CUDA out of memory. Tried to allocate 2.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.09 GiB is allocated by PyTorch, and 7.64 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-05-01 19:35:31,207 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\2687043568.py", line 3366, in main
    models, history = mutual_learning_phase(models, train_loader, val_loader, config, optimizers, schedulers, start_epoch=start_epoch_mutual)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\2687043568.py", line 2458, in mutual_learning_phase
    outputs = model(current_input)
              ^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\densenet.py", line 213, in forward
    features = self.features(x)
               ^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1844, in _call_impl
    return inner()
           ^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1790, in inner
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\densenet.py", line 122, in forward
    new_features = layer(features)
                   ^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\densenet.py", line 88, in forward
    bottleneck_output = self.bn_function(prev_features)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torchvision\models\densenet.py", line 48, in bn_function
    concated_features = torch.cat(inputs, 1)
                        ^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.09 GiB is allocated by PyTorch, and 7.64 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-05-01 19:36:37,804 [INFO] - Using device: cuda
2025-05-01 19:36:37,804 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 19:36:37,804 [INFO] - GPU Memory: 6.00 GB
2025-05-01 19:36:37,804 [INFO] - CUDA Version: 12.4
2025-05-01 19:36:37,804 [INFO] - cuDNN benchmark mode enabled
2025-05-01 19:36:37,825 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 19:36:37,827 [INFO] - Random seed set to 42
2025-05-01 19:36:37,828 [INFO] - Creating models...
2025-05-01 19:36:37,829 [INFO] - Loading ViT-B16 model...
2025-05-01 19:36:38,711 [INFO] - Loading EfficientNetB0 model...
2025-05-01 19:36:38,838 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 19:36:39,200 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 19:36:39,200 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 19:36:39,311 [INFO] - Loading ResNet50 model...
2025-05-01 19:36:39,668 [INFO] - Loading DenseNet121 model...
2025-05-01 19:36:39,806 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 19:36:40,083 [ERROR] - An error occurred in main: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.02 GiB is allocated by PyTorch, and 65.69 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-05-01 19:36:40,083 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\2687043568.py", line 3275, in main
    models = create_models(config)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\AppData\Local\Temp\ipykernel_8008\2687043568.py", line 1891, in create_models
    models[name] = model.to(device)
                   ^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1340, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 900, in _apply
    module._apply(fn)
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 900, in _apply
    module._apply(fn)
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 900, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 927, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "c:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 1326, in convert
    return t.to(
           ^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 6.00 GiB of which 0 bytes is free. 5.10 GiB allowed; Of the allocated memory 5.02 GiB is allocated by PyTorch, and 65.69 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-05-01 19:37:02,368 [INFO] - Using device: cuda
2025-05-01 19:37:02,384 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 19:37:02,384 [INFO] - GPU Memory: 6.00 GB
2025-05-01 19:37:02,384 [INFO] - CUDA Version: 12.4
2025-05-01 19:37:02,384 [INFO] - cuDNN benchmark mode enabled
2025-05-01 19:37:02,409 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 19:37:02,435 [INFO] - Random seed set to 42
2025-05-01 19:37:02,436 [INFO] - Creating models...
2025-05-01 19:37:02,437 [INFO] - Loading ViT-B16 model...
2025-05-01 19:37:03,061 [INFO] - Loading EfficientNetB0 model...
2025-05-01 19:37:03,170 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 19:37:03,346 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 19:37:03,346 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 19:37:03,432 [INFO] - Loading ResNet50 model...
2025-05-01 19:37:03,697 [INFO] - Loading DenseNet121 model...
2025-05-01 19:37:03,970 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 19:37:04,211 [INFO] - Model vit moved to cuda
2025-05-01 19:37:04,231 [INFO] - Model efficientnet moved to cuda
2025-05-01 19:37:04,269 [INFO] - Model inception moved to cuda
2025-05-01 19:37:04,298 [INFO] - Model mobilenet moved to cuda
2025-05-01 19:37:04,329 [INFO] - Model resnet moved to cuda
2025-05-01 19:37:04,366 [INFO] - Model densenet moved to cuda
2025-05-01 19:37:04,373 [INFO] - Model student moved to cuda
2025-05-01 19:37:04,388 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 19:37:04,390 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 19:37:04,392 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 19:37:04,395 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 19:37:04,396 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 19:37:04,398 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 19:37:04,400 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 19:37:04,401 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-01 19:37:04,401 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-01 19:37:06,151 [INFO] - Loaded model state for vit successfully.
2025-05-01 19:37:06,173 [INFO] - Loaded model state for efficientnet successfully.
2025-05-01 19:37:06,211 [INFO] - Loaded model state for inception successfully.
2025-05-01 19:37:06,227 [INFO] - Loaded model state for mobilenet successfully.
2025-05-01 19:37:06,261 [INFO] - Loaded model state for resnet successfully.
2025-05-01 19:37:06,295 [INFO] - Loaded model state for densenet successfully.
2025-05-01 19:37:06,314 [INFO] - Loaded model state for student successfully.
2025-05-01 19:37:06,443 [INFO] - Recreated and loaded optimizer state for vit
2025-05-01 19:37:06,479 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-01 19:37:06,542 [INFO] - Recreated and loaded optimizer state for inception
2025-05-01 19:37:06,571 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-01 19:37:06,616 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-01 19:37:06,671 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-01 19:37:06,698 [INFO] - Recreated and loaded optimizer state for student
2025-05-01 19:37:06,701 [WARNING] - No scheduler info found for vit in checkpoint.
2025-05-01 19:37:06,702 [WARNING] - No scheduler info found for efficientnet in checkpoint.
2025-05-01 19:37:06,703 [WARNING] - No scheduler info found for inception in checkpoint.
2025-05-01 19:37:06,704 [WARNING] - No scheduler info found for mobilenet in checkpoint.
2025-05-01 19:37:06,705 [WARNING] - No scheduler info found for resnet in checkpoint.
2025-05-01 19:37:06,706 [WARNING] - No scheduler info found for densenet in checkpoint.
2025-05-01 19:37:06,706 [WARNING] - No scheduler info found for student in checkpoint.
2025-05-01 19:37:06,707 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-01 19:37:06,718 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-01 19:37:06,720 [INFO] - Created new scheduler for vit
2025-05-01 19:37:06,720 [INFO] - Created new scheduler for efficientnet
2025-05-01 19:37:06,720 [INFO] - Created new scheduler for inception
2025-05-01 19:37:06,720 [INFO] - Created new scheduler for mobilenet
2025-05-01 19:37:06,723 [INFO] - Created new scheduler for resnet
2025-05-01 19:37:06,723 [INFO] - Created new scheduler for densenet
2025-05-01 19:37:06,725 [INFO] - Created new scheduler for student
2025-05-01 19:37:06,726 [INFO] - Preparing data loaders...
2025-05-01 19:37:15,501 [INFO] - Training samples: 45000 per model
2025-05-01 19:37:15,501 [INFO] - Validation samples: 5000 per model
2025-05-01 19:37:15,501 [INFO] - Test samples: 10000 per model
2025-05-01 19:37:15,501 [INFO] - Skipping initialization phase.
2025-05-01 19:37:15,501 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-01 19:37:15,675 [INFO] - GPU Memory: Current=1753.94MB, Peak=1753.94MB, Reserved=1764.00MB
2025-05-01 19:37:15,675 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-01 19:37:15,675 [INFO] - Starting mutual learning phase...
2025-05-01 19:37:15,675 [INFO] - Hook registered for encoder.ln
2025-05-01 19:37:15,675 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 19:37:16,462 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 19:37:16,462 [INFO] - Hook registered for features.8
2025-05-01 19:37:16,462 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 19:37:16,943 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 19:37:16,943 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 19:37:16,943 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 19:37:17,454 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 19:37:17,455 [INFO] - Hook registered for features
2025-05-01 19:37:17,456 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 19:37:17,602 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 19:37:17,602 [INFO] - Hook registered for layer4
2025-05-01 19:37:17,602 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 19:37:17,791 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 19:37:17,791 [INFO] - Hook registered for features
2025-05-01 19:37:17,791 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 19:37:18,146 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 19:37:18,146 [INFO] - Hook registered for features.8
2025-05-01 19:37:18,146 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 19:37:18,165 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 19:37:19,337 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 19:37:19,337 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 19:37:19,337 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 19:37:19,337 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 19:37:19,347 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 19:37:19,347 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 19:37:19,361 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:37:19,361 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 19:37:19,369 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 19:37:19,370 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 19:37:19,379 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:37:19,380 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 19:37:19,386 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 19:37:19,387 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 19:37:19,491 [INFO] - HFI initialized.
2025-05-01 19:37:19,492 [INFO] - Added HFI params to student optimizer.
2025-05-01 19:37:20,986 [INFO] - Using LR warmup for 3 epochs for model vit.
2025-05-01 19:37:20,986 [INFO] - Using LR warmup for 3 epochs for model efficientnet.
2025-05-01 19:37:20,986 [INFO] - Using LR warmup for 3 epochs for model inception.
2025-05-01 19:37:20,996 [INFO] - Using LR warmup for 3 epochs for model mobilenet.
2025-05-01 19:37:20,996 [INFO] - Using LR warmup for 3 epochs for model resnet.
2025-05-01 19:37:21,002 [INFO] - Using LR warmup for 3 epochs for model densenet.
2025-05-01 19:37:21,006 [INFO] - Using LR warmup for 3 epochs for model student.
2025-05-01 19:37:21,007 [INFO] - Added HFI parameters to the student optimizer.
2025-05-01 19:37:21,007 [INFO] - Mutual learning phase using effective batch size: 4
2025-05-01 19:37:21,009 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-01 19:37:48,653 [INFO] - GPU Memory: Current=1893.48MB, Peak=2498.90MB, Reserved=2674.00MB
2025-05-01 19:47:22,354 [INFO] - Using device: cuda
2025-05-01 19:47:22,354 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 19:47:22,354 [INFO] - GPU Memory: 6.00 GB
2025-05-01 19:47:22,354 [INFO] - CUDA Version: 12.4
2025-05-01 19:47:22,354 [INFO] - cuDNN benchmark mode enabled
2025-05-01 19:47:22,354 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.001,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "use_warmup": true,
    "warmup_epochs": 3,
    "alpha": 0.6,
    "feature_loss_weight": 0.1,
    "cal_weight": 0.2,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 30,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-01 19:47:22,370 [INFO] - Random seed set to 42
2025-05-01 19:47:22,370 [INFO] - Creating models...
2025-05-01 19:47:22,370 [INFO] - Loading ViT-B16 model...
2025-05-01 19:47:23,221 [INFO] - Loading EfficientNetB0 model...
2025-05-01 19:47:23,321 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-01 19:47:23,686 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-01 19:47:23,686 [INFO] - Loading MobileNetV3-Large model...
2025-05-01 19:47:23,796 [INFO] - Loading ResNet50 model...
2025-05-01 19:47:24,144 [INFO] - Loading DenseNet121 model...
2025-05-01 19:47:24,281 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-01 19:47:24,492 [INFO] - Model vit moved to cuda
2025-05-01 19:47:24,530 [INFO] - Model efficientnet moved to cuda
2025-05-01 19:47:24,587 [INFO] - Model inception moved to cuda
2025-05-01 19:47:24,587 [INFO] - Model mobilenet moved to cuda
2025-05-01 19:47:24,618 [INFO] - Model resnet moved to cuda
2025-05-01 19:47:24,650 [INFO] - Model densenet moved to cuda
2025-05-01 19:47:24,682 [INFO] - Model student moved to cuda
2025-05-01 19:47:24,682 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-01 19:47:24,682 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-01 19:47:24,682 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-01 19:47:24,682 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-01 19:47:24,682 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-01 19:47:24,682 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-01 19:47:24,682 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-01 19:47:24,682 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-01 19:47:24,682 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-01 19:47:26,565 [INFO] - Loaded model state for vit successfully.
2025-05-01 19:47:26,586 [INFO] - Loaded model state for efficientnet successfully.
2025-05-01 19:47:26,621 [INFO] - Loaded model state for inception successfully.
2025-05-01 19:47:26,638 [INFO] - Loaded model state for mobilenet successfully.
2025-05-01 19:47:26,658 [INFO] - Loaded model state for resnet successfully.
2025-05-01 19:47:26,689 [INFO] - Loaded model state for densenet successfully.
2025-05-01 19:47:26,709 [INFO] - Loaded model state for student successfully.
2025-05-01 19:47:26,832 [INFO] - Recreated and loaded optimizer state for vit
2025-05-01 19:47:26,852 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-01 19:47:26,913 [INFO] - Recreated and loaded optimizer state for inception
2025-05-01 19:47:26,943 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-01 19:47:26,994 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-01 19:47:27,035 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-01 19:47:27,066 [INFO] - Recreated and loaded optimizer state for student
2025-05-01 19:47:27,066 [WARNING] - No scheduler info found for vit in checkpoint.
2025-05-01 19:47:27,066 [WARNING] - No scheduler info found for efficientnet in checkpoint.
2025-05-01 19:47:27,066 [WARNING] - No scheduler info found for inception in checkpoint.
2025-05-01 19:47:27,066 [WARNING] - No scheduler info found for mobilenet in checkpoint.
2025-05-01 19:47:27,066 [WARNING] - No scheduler info found for resnet in checkpoint.
2025-05-01 19:47:27,066 [WARNING] - No scheduler info found for densenet in checkpoint.
2025-05-01 19:47:27,066 [WARNING] - No scheduler info found for student in checkpoint.
2025-05-01 19:47:27,066 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-01 19:47:27,066 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-01 19:47:27,066 [INFO] - Created new scheduler for vit
2025-05-01 19:47:27,066 [INFO] - Created new scheduler for efficientnet
2025-05-01 19:47:27,066 [INFO] - Created new scheduler for inception
2025-05-01 19:47:27,066 [INFO] - Created new scheduler for mobilenet
2025-05-01 19:47:27,066 [INFO] - Created new scheduler for resnet
2025-05-01 19:47:27,066 [INFO] - Created new scheduler for densenet
2025-05-01 19:47:27,066 [INFO] - Created new scheduler for student
2025-05-01 19:47:27,066 [INFO] - Preparing data loaders...
2025-05-01 19:47:35,239 [INFO] - Training samples: 45000 per model
2025-05-01 19:47:35,239 [INFO] - Validation samples: 5000 per model
2025-05-01 19:47:35,239 [INFO] - Test samples: 10000 per model
2025-05-01 19:47:35,239 [INFO] - Skipping initialization phase.
2025-05-01 19:47:35,239 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-01 19:47:35,365 [INFO] - GPU Memory: Current=1753.94MB, Peak=1753.94MB, Reserved=1764.00MB
2025-05-01 19:47:35,365 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-01 19:47:35,365 [INFO] - Starting mutual learning phase...
2025-05-01 19:47:35,365 [INFO] - Hook registered for encoder.ln
2025-05-01 19:47:35,365 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-01 19:47:35,668 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-01 19:47:35,684 [INFO] - Hook registered for features.8
2025-05-01 19:47:35,684 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-01 19:47:35,970 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-01 19:47:35,970 [INFO] - Hook registered for inception.Mixed_7c
2025-05-01 19:47:35,970 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-01 19:47:36,399 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-01 19:47:36,399 [INFO] - Hook registered for features
2025-05-01 19:47:36,399 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-01 19:47:36,510 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-01 19:47:36,510 [INFO] - Hook registered for layer4
2025-05-01 19:47:36,510 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-01 19:47:36,672 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-01 19:47:36,672 [INFO] - Hook registered for features
2025-05-01 19:47:36,672 [INFO] - Feature extractor registered for densenet at layer features
2025-05-01 19:47:36,970 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-01 19:47:36,970 [INFO] - Hook registered for features.8
2025-05-01 19:47:36,970 [INFO] - Feature extractor registered for student at layer features.8
2025-05-01 19:47:36,980 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-01 19:47:38,098 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-01 19:47:38,098 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-01 19:47:38,098 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-01 19:47:38,098 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-01 19:47:38,106 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-01 19:47:38,106 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-01 19:47:38,117 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:47:38,117 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-01 19:47:38,117 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-01 19:47:38,117 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-01 19:47:38,127 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-01 19:47:38,127 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-01 19:47:38,138 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-01 19:47:38,138 [INFO] - HFI module initialized with 6 teachers.
2025-05-01 19:47:38,238 [INFO] - HFI initialized.
2025-05-01 19:47:38,238 [INFO] - Added HFI params to student optimizer.
2025-05-01 19:47:39,469 [INFO] - Using LR warmup for 3 epochs for model vit.
2025-05-01 19:47:39,469 [INFO] - Using LR warmup for 3 epochs for model efficientnet.
2025-05-01 19:47:39,471 [INFO] - Using LR warmup for 3 epochs for model inception.
2025-05-01 19:47:39,473 [INFO] - Using LR warmup for 3 epochs for model mobilenet.
2025-05-01 19:47:39,475 [INFO] - Using LR warmup for 3 epochs for model resnet.
2025-05-01 19:47:39,477 [INFO] - Using LR warmup for 3 epochs for model densenet.
2025-05-01 19:47:39,479 [INFO] - Using LR warmup for 3 epochs for model student.
2025-05-01 19:47:39,479 [INFO] - Added HFI parameters to the student optimizer.
2025-05-01 19:47:39,479 [INFO] - Mutual learning phase using effective batch size: 4
2025-05-01 19:47:39,479 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-01 19:47:44,766 [INFO] - Using device: cuda
2025-05-01 19:47:44,766 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 19:47:44,766 [INFO] - GPU Memory: 6.00 GB
2025-05-01 19:47:44,766 [INFO] - CUDA Version: 12.4
2025-05-01 19:47:44,766 [INFO] - cuDNN benchmark mode enabled
2025-05-01 19:47:50,007 [INFO] - Using device: cuda
2025-05-01 19:47:50,007 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 19:47:50,007 [INFO] - GPU Memory: 6.00 GB
2025-05-01 19:47:50,007 [INFO] - CUDA Version: 12.4
2025-05-01 19:47:50,007 [INFO] - cuDNN benchmark mode enabled
2025-05-01 19:47:55,381 [INFO] - Using device: cuda
2025-05-01 19:47:55,381 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 19:47:55,381 [INFO] - GPU Memory: 6.00 GB
2025-05-01 19:47:55,381 [INFO] - CUDA Version: 12.4
2025-05-01 19:47:55,381 [INFO] - cuDNN benchmark mode enabled
2025-05-01 19:48:00,828 [INFO] - Using device: cuda
2025-05-01 19:48:00,828 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 19:48:00,828 [INFO] - GPU Memory: 6.00 GB
2025-05-01 19:48:00,828 [INFO] - CUDA Version: 12.4
2025-05-01 19:48:00,828 [INFO] - cuDNN benchmark mode enabled
2025-05-01 19:48:10,551 [INFO] - GPU Memory: Current=1893.48MB, Peak=2498.90MB, Reserved=2674.00MB
2025-05-01 19:50:38,006 [INFO] - GPU Memory: Current=1893.17MB, Peak=3533.10MB, Reserved=3598.00MB
2025-05-01 19:53:04,986 [INFO] - GPU Memory: Current=1893.15MB, Peak=3535.10MB, Reserved=3610.00MB
2025-05-01 19:55:32,446 [INFO] - GPU Memory: Current=1892.89MB, Peak=3535.10MB, Reserved=3606.00MB
2025-05-01 19:58:00,133 [INFO] - GPU Memory: Current=1893.14MB, Peak=3535.10MB, Reserved=3634.00MB
2025-05-01 20:00:28,204 [INFO] - GPU Memory: Current=1892.89MB, Peak=3535.10MB, Reserved=3618.00MB
2025-05-01 20:02:55,805 [INFO] - GPU Memory: Current=1893.04MB, Peak=3535.10MB, Reserved=3626.00MB
2025-05-01 20:05:23,213 [INFO] - GPU Memory: Current=1894.22MB, Peak=3535.10MB, Reserved=3622.00MB
2025-05-01 20:07:51,145 [INFO] - GPU Memory: Current=1893.03MB, Peak=3535.10MB, Reserved=3612.00MB
2025-05-01 20:10:19,591 [INFO] - GPU Memory: Current=1894.22MB, Peak=3535.10MB, Reserved=3622.00MB
2025-05-01 20:12:47,889 [INFO] - GPU Memory: Current=1892.99MB, Peak=3535.10MB, Reserved=3614.00MB
2025-05-01 20:15:15,626 [INFO] - GPU Memory: Current=1892.74MB, Peak=3535.10MB, Reserved=3626.00MB
2025-05-01 20:17:43,377 [INFO] - GPU Memory: Current=1892.74MB, Peak=3535.10MB, Reserved=3626.00MB
2025-05-01 20:20:11,087 [INFO] - GPU Memory: Current=1892.74MB, Peak=3535.10MB, Reserved=3626.00MB
2025-05-01 20:22:39,447 [INFO] - GPU Memory: Current=1892.74MB, Peak=3535.10MB, Reserved=3626.00MB
2025-05-01 20:25:07,142 [INFO] - GPU Memory: Current=1892.74MB, Peak=3535.10MB, Reserved=3578.00MB
2025-05-01 20:27:34,280 [INFO] - GPU Memory: Current=1892.53MB, Peak=3535.10MB, Reserved=3626.00MB
2025-05-01 20:30:01,579 [INFO] - GPU Memory: Current=1892.94MB, Peak=3535.10MB, Reserved=3620.00MB
2025-05-01 20:32:28,465 [INFO] - GPU Memory: Current=1892.19MB, Peak=3535.39MB, Reserved=3598.00MB
2025-05-01 20:34:56,239 [INFO] - GPU Memory: Current=1892.87MB, Peak=3535.39MB, Reserved=3618.00MB
2025-05-01 20:37:30,657 [INFO] - GPU Memory: Current=1892.17MB, Peak=3535.39MB, Reserved=3626.00MB
2025-05-01 20:39:57,837 [INFO] - GPU Memory: Current=1892.17MB, Peak=3535.39MB, Reserved=3608.00MB
2025-05-01 20:42:25,402 [INFO] - GPU Memory: Current=1892.17MB, Peak=3535.39MB, Reserved=3600.00MB
2025-05-01 20:44:52,924 [INFO] - GPU Memory: Current=1892.43MB, Peak=3535.39MB, Reserved=3626.00MB
2025-05-01 20:47:12,756 [INFO] - GPU Memory: Current=1892.17MB, Peak=3535.39MB, Reserved=3626.00MB
2025-05-01 20:49:30,668 [INFO] - GPU Memory: Current=1892.42MB, Peak=3535.39MB, Reserved=3596.00MB
2025-05-01 20:51:48,946 [INFO] - GPU Memory: Current=1892.42MB, Peak=3535.39MB, Reserved=3596.00MB
2025-05-01 20:54:06,971 [INFO] - GPU Memory: Current=1892.79MB, Peak=3535.39MB, Reserved=3626.00MB
2025-05-01 20:56:24,836 [INFO] - GPU Memory: Current=1892.86MB, Peak=3535.39MB, Reserved=3626.00MB
2025-05-01 20:56:39,271 [INFO] - --- Mutual Epoch 1 Summary (Time: 4139.79s): Avg Loss=0.2547, Avg Acc=93.30% ---
2025-05-01 20:56:39,271 [INFO] -   vit: Loss=0.1027, Acc=98.15%, CE=0.0556, Mut=2.4060, Cal=0.0137, Feat=0.0000
2025-05-01 20:56:39,271 [INFO] -   efficientnet: Loss=0.2228, Acc=93.78%, CE=0.1854, Mut=2.0415, Cal=0.0415, Feat=0.0000
2025-05-01 20:56:39,271 [INFO] -   inception: Loss=0.2605, Acc=94.16%, CE=0.1806, Mut=4.1657, Cal=0.0397, Feat=0.0000
2025-05-01 20:56:39,271 [INFO] -   mobilenet: Loss=0.3738, Acc=89.46%, CE=0.3252, Mut=2.7347, Cal=0.0671, Feat=0.0000
2025-05-01 20:56:39,271 [INFO] -   resnet: Loss=0.3200, Acc=90.87%, CE=0.2829, Mut=2.1191, Cal=0.0578, Feat=0.0000
2025-05-01 20:56:39,271 [INFO] -   densenet: Loss=0.2651, Acc=93.01%, CE=0.2268, Mut=2.1255, Cal=0.0461, Feat=0.0000
2025-05-01 20:56:39,271 [INFO] -   student: Loss=0.2380, Acc=93.65%, CE=0.1865, Mut=2.5695, Cal=0.0425, Feat=1.0569
2025-05-01 20:56:39,271 [INFO] - --- Starting Validation for Epoch 1 ---
2025-05-01 20:56:39,271 [INFO] - Collecting validation targets...
2025-05-01 20:56:45,802 [INFO] - Using device: cuda
2025-05-01 20:56:45,802 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 20:56:45,802 [INFO] - GPU Memory: 6.00 GB
2025-05-01 20:56:45,802 [INFO] - CUDA Version: 12.4
2025-05-01 20:56:45,802 [INFO] - cuDNN benchmark mode enabled
2025-05-01 20:56:51,345 [INFO] - Using device: cuda
2025-05-01 20:56:51,345 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 20:56:51,345 [INFO] - GPU Memory: 6.00 GB
2025-05-01 20:56:51,345 [INFO] - CUDA Version: 12.4
2025-05-01 20:56:51,345 [INFO] - cuDNN benchmark mode enabled
2025-05-01 20:56:56,721 [INFO] - Using device: cuda
2025-05-01 20:56:56,721 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 20:56:56,721 [INFO] - GPU Memory: 6.00 GB
2025-05-01 20:56:56,721 [INFO] - CUDA Version: 12.4
2025-05-01 20:56:56,721 [INFO] - cuDNN benchmark mode enabled
2025-05-01 20:57:02,242 [INFO] - Using device: cuda
2025-05-01 20:57:02,242 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-01 20:57:02,242 [INFO] - GPU Memory: 6.00 GB
2025-05-01 20:57:02,242 [INFO] - CUDA Version: 12.4
2025-05-01 20:57:02,242 [INFO] - cuDNN benchmark mode enabled
2025-05-01 20:57:04,599 [INFO] - Collected 5000 validation targets.
2025-05-01 20:57:37,104 [INFO] -   Validation vit: Loss=0.1173, Acc=96.24%, ECE=0.0129
2025-05-01 20:57:52,534 [INFO] -   Validation efficientnet: Loss=0.1239, Acc=96.30%, ECE=0.0100
2025-05-01 20:58:12,297 [INFO] -   Validation inception: Loss=0.1867, Acc=94.22%, ECE=0.0189
2025-05-01 20:58:24,503 [INFO] -   Validation mobilenet: Loss=0.1290, Acc=96.00%, ECE=0.0129
2025-05-01 20:58:36,043 [INFO] -   Validation resnet: Loss=0.1755, Acc=93.88%, ECE=0.0154
2025-05-01 20:59:02,663 [INFO] -   Validation densenet: Loss=0.1266, Acc=95.80%, ECE=0.0095
2025-05-01 20:59:17,888 [INFO] -   Validation student: Loss=0.1564, Acc=94.66%, ECE=0.0120
2025-05-01 20:59:18,281 [INFO] - New best accuracy for vit: 96.24%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\vit_mutual_best_acc.pth
2025-05-01 20:59:18,281 [INFO] - New best ECE for vit: 0.0129.
2025-05-01 20:59:18,618 [INFO] - New best accuracy for efficientnet: 96.30%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\efficientnet_mutual_best_acc.pth
2025-05-01 20:59:18,618 [INFO] - New best ECE for efficientnet: 0.0100.
2025-05-01 20:59:18,833 [INFO] - New best accuracy for inception: 94.22%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\inception_mutual_best_acc.pth
2025-05-01 20:59:18,833 [INFO] - New best ECE for inception: 0.0189.
2025-05-01 20:59:19,018 [INFO] - New best accuracy for mobilenet: 96.00%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mobilenet_mutual_best_acc.pth
2025-05-01 20:59:19,018 [INFO] - New best ECE for mobilenet: 0.0129.
2025-05-01 20:59:19,192 [INFO] - New best accuracy for resnet: 93.88%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\resnet_mutual_best_acc.pth
2025-05-01 20:59:19,192 [INFO] - New best ECE for resnet: 0.0154.
2025-05-01 20:59:19,448 [INFO] - New best accuracy for densenet: 95.80%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\densenet_mutual_best_acc.pth
2025-05-01 20:59:19,448 [INFO] - New best ECE for densenet: 0.0095.
2025-05-01 20:59:19,611 [INFO] - New best accuracy for student: 94.66%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\student_mutual_best_acc.pth
2025-05-01 20:59:19,611 [INFO] - New best ECE for student: 0.0120.
2025-05-01 21:00:18,221 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_1.pth (Epoch 0)
2025-05-01 21:00:18,346 [INFO] - GPU Memory: Current=3081.88MB, Peak=3535.39MB, Reserved=3186.00MB
2025-05-01 21:00:18,346 [INFO] - --- Starting Mutual Learning Epoch 2/50 ---
2025-05-01 21:00:21,526 [INFO] - GPU Memory: Current=2488.56MB, Peak=4134.68MB, Reserved=4228.00MB
2025-05-01 21:02:40,630 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.94MB, Reserved=4252.00MB
2025-05-01 21:05:00,008 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.94MB, Reserved=4252.00MB
2025-05-01 21:07:18,983 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.94MB, Reserved=4252.00MB
2025-05-01 21:09:37,731 [INFO] - GPU Memory: Current=2489.13MB, Peak=4138.94MB, Reserved=4228.00MB
2025-05-01 21:11:56,413 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.94MB, Reserved=4252.00MB
2025-05-01 21:14:14,865 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4226.00MB
2025-05-01 21:16:32,810 [INFO] - GPU Memory: Current=2488.30MB, Peak=4138.96MB, Reserved=4228.00MB
2025-05-01 21:18:50,719 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4226.00MB
2025-05-01 21:21:08,714 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4252.00MB
2025-05-01 21:23:26,589 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4232.00MB
2025-05-01 21:25:44,280 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4232.00MB
2025-05-01 21:28:02,169 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4226.00MB
2025-05-01 21:30:19,772 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4226.00MB
2025-05-01 21:32:37,489 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4226.00MB
2025-05-01 21:34:54,935 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4252.00MB
2025-05-01 21:37:12,530 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4252.00MB
2025-05-01 21:39:29,789 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4232.00MB
2025-05-01 21:41:47,425 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4232.00MB
2025-05-01 21:44:05,044 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4252.00MB
2025-05-01 21:46:22,690 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4252.00MB
2025-05-01 21:48:40,077 [INFO] - GPU Memory: Current=2488.30MB, Peak=4138.96MB, Reserved=4228.00MB
2025-05-01 21:50:57,804 [INFO] - GPU Memory: Current=2488.63MB, Peak=4138.96MB, Reserved=4220.00MB
2025-05-01 21:53:15,492 [INFO] - GPU Memory: Current=2489.13MB, Peak=4138.96MB, Reserved=4228.00MB
2025-05-01 21:55:33,437 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4252.00MB
2025-05-01 21:57:51,190 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4252.00MB
2025-05-01 22:00:09,294 [INFO] - GPU Memory: Current=2489.13MB, Peak=4138.96MB, Reserved=4228.00MB
2025-05-01 22:02:27,598 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4226.00MB
2025-05-01 22:04:45,956 [INFO] - GPU Memory: Current=2488.38MB, Peak=4138.96MB, Reserved=4232.00MB
2025-05-01 22:05:00,434 [INFO] - --- Mutual Epoch 2 Summary (Time: 3882.09s): Avg Loss=0.7429, Avg Acc=79.43% ---
2025-05-01 22:05:00,434 [INFO] -   vit: Loss=0.6418, Acc=81.51%, CE=0.5526, Mut=2.7475, Cal=0.1113, Feat=0.0000
2025-05-01 22:05:00,434 [INFO] -   efficientnet: Loss=0.5282, Acc=85.26%, CE=0.4425, Mut=2.5549, Cal=0.0913, Feat=0.0000
2025-05-01 22:05:00,434 [INFO] -   inception: Loss=0.9117, Acc=75.82%, CE=0.7694, Mut=4.2806, Cal=0.1390, Feat=0.0000
2025-05-01 22:05:00,434 [INFO] -   mobilenet: Loss=0.7404, Acc=78.39%, CE=0.6563, Mut=2.7179, Cal=0.1248, Feat=0.0000
2025-05-01 22:05:00,434 [INFO] -   resnet: Loss=1.1396, Acc=65.97%, CE=1.0561, Mut=3.0846, Cal=0.1764, Feat=0.0000
2025-05-01 22:05:00,434 [INFO] -   densenet: Loss=0.8553, Acc=75.17%, CE=0.7768, Mut=2.6942, Cal=0.1366, Feat=0.0000
2025-05-01 22:05:00,434 [INFO] -   student: Loss=0.3834, Acc=93.86%, CE=0.1820, Mut=5.0319, Cal=0.0413, Feat=1.0402
2025-05-01 22:05:00,434 [INFO] - --- Starting Validation for Epoch 2 ---
2025-05-01 22:05:00,444 [INFO] - Collecting validation targets...
2025-05-01 22:05:02,760 [INFO] - Collected 5000 validation targets.
2025-05-01 22:05:35,686 [INFO] -   Validation vit: Loss=0.5172, Acc=82.86%, ECE=0.0420
2025-05-01 22:05:51,101 [INFO] -   Validation efficientnet: Loss=0.3353, Acc=90.28%, ECE=0.0165
2025-05-01 22:06:10,852 [INFO] -   Validation inception: Loss=1.6706, Acc=74.38%, ECE=0.1376
2025-05-01 22:06:22,970 [INFO] -   Validation mobilenet: Loss=0.4258, Acc=87.60%, ECE=0.0439
2025-05-01 22:06:34,326 [INFO] -   Validation resnet: Loss=0.6407, Acc=79.68%, ECE=0.0394
2025-05-01 22:07:00,548 [INFO] -   Validation densenet: Loss=0.4054, Acc=87.06%, ECE=0.0259
2025-05-01 22:07:15,805 [INFO] -   Validation student: Loss=0.1520, Acc=94.78%, ECE=0.0118
2025-05-01 22:07:15,909 [INFO] - New best accuracy for student: 94.78%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\student_mutual_best_acc.pth
2025-05-01 22:07:15,909 [INFO] - New best ECE for student: 0.0118.
2025-05-01 22:07:17,873 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_2.pth (Epoch 1)
2025-05-01 22:07:18,009 [INFO] - GPU Memory: Current=3086.09MB, Peak=4138.96MB, Reserved=3466.00MB
2025-05-01 22:07:18,009 [INFO] - --- Starting Mutual Learning Epoch 3/50 ---
2025-05-01 22:07:20,811 [INFO] - GPU Memory: Current=2488.60MB, Peak=4138.96MB, Reserved=4248.00MB
2025-05-01 22:09:38,868 [INFO] - GPU Memory: Current=2488.67MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:11:56,664 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:14:14,899 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:16:32,658 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:18:50,348 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:21:07,619 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:23:25,827 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:25:43,468 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:28:00,926 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:30:18,452 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:32:35,690 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:34:53,250 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:37:11,024 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:39:28,518 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:41:46,050 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:44:03,554 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:46:21,109 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:48:38,621 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:50:56,290 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:53:13,834 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:55:31,628 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 22:57:49,351 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 23:00:07,412 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 23:02:25,240 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 23:04:43,343 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 23:07:01,322 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 23:09:19,511 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 23:11:37,427 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4232.00MB
2025-05-01 23:11:51,885 [INFO] - --- Mutual Epoch 3 Summary (Time: 3873.88s): Avg Loss=1.0565, Avg Acc=70.14% ---
2025-05-01 23:11:51,885 [INFO] -   vit: Loss=1.0123, Acc=69.58%, CE=0.8979, Mut=2.7491, Cal=0.1625, Feat=0.0000
2025-05-01 23:11:51,885 [INFO] -   efficientnet: Loss=0.8577, Acc=74.93%, CE=0.7520, Mut=2.4666, Cal=0.1401, Feat=0.0000
2025-05-01 23:11:51,885 [INFO] -   inception: Loss=1.3328, Acc=63.09%, CE=1.1435, Mut=4.2371, Cal=0.1840, Feat=0.0000
2025-05-01 23:11:51,885 [INFO] -   mobilenet: Loss=1.1396, Acc=66.18%, CE=1.0398, Mut=2.6439, Cal=0.1752, Feat=0.0000
2025-05-01 23:11:51,885 [INFO] -   resnet: Loss=1.3658, Acc=57.74%, CE=1.2724, Mut=2.7630, Cal=0.1990, Feat=0.0000
2025-05-01 23:11:51,885 [INFO] -   densenet: Loss=1.1611, Acc=65.52%, CE=1.0653, Mut=2.6036, Cal=0.1743, Feat=0.0000
2025-05-01 23:11:51,885 [INFO] -   student: Loss=0.5260, Acc=93.94%, CE=0.1785, Mut=5.7916, Cal=0.0403, Feat=0.9901
2025-05-01 23:11:51,885 [INFO] - --- Starting Validation for Epoch 3 ---
2025-05-01 23:11:51,895 [INFO] - Collecting validation targets...
2025-05-01 23:11:54,216 [INFO] - Collected 5000 validation targets.
2025-05-01 23:12:27,789 [INFO] -   Validation vit: Loss=1.0526, Acc=62.68%, ECE=0.0778
2025-05-01 23:12:43,067 [INFO] -   Validation efficientnet: Loss=0.5253, Acc=83.66%, ECE=0.0395
2025-05-01 23:13:02,584 [INFO] -   Validation inception: Loss=0.8366, Acc=74.36%, ECE=0.0756
2025-05-01 23:13:14,800 [INFO] -   Validation mobilenet: Loss=0.7349, Acc=78.32%, ECE=0.0763
2025-05-01 23:13:26,168 [INFO] -   Validation resnet: Loss=1.1809, Acc=65.84%, ECE=0.0927
2025-05-01 23:13:52,733 [INFO] -   Validation densenet: Loss=0.7594, Acc=76.46%, ECE=0.0636
2025-05-01 23:14:08,044 [INFO] -   Validation student: Loss=0.1541, Acc=94.66%, ECE=0.0102
2025-05-01 23:14:08,055 [INFO] - New best ECE for student: 0.0102.
2025-05-01 23:14:10,068 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_3.pth (Epoch 2)
2025-05-01 23:14:10,202 [INFO] - GPU Memory: Current=3082.90MB, Peak=4140.68MB, Reserved=3514.00MB
2025-05-01 23:14:10,202 [INFO] - --- Starting Mutual Learning Epoch 4/50 ---
2025-05-01 23:14:12,996 [INFO] - GPU Memory: Current=2488.60MB, Peak=4140.68MB, Reserved=4226.00MB
2025-05-01 23:16:30,931 [INFO] - GPU Memory: Current=2488.05MB, Peak=4140.94MB, Reserved=4226.00MB
2025-05-01 23:18:48,872 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4226.00MB
2025-05-01 23:21:06,888 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4226.00MB
2025-05-01 23:23:24,564 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4226.00MB
2025-05-01 23:25:42,647 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4226.00MB
2025-05-01 23:28:00,793 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4226.00MB
2025-05-01 23:30:18,761 [INFO] - GPU Memory: Current=2488.56MB, Peak=4142.68MB, Reserved=4224.00MB
2025-05-01 23:32:36,638 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4226.00MB
2025-05-01 23:34:54,845 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4226.00MB
2025-05-01 23:37:12,796 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4226.00MB
2025-05-01 23:39:30,709 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4212.00MB
2025-05-01 23:41:48,284 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4212.00MB
2025-05-01 23:44:05,943 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-01 23:46:23,486 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-01 23:48:41,074 [INFO] - GPU Memory: Current=2488.31MB, Peak=4142.68MB, Reserved=4234.00MB
2025-05-01 23:50:58,742 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-01 23:53:16,125 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-01 23:55:33,757 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-01 23:57:51,154 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 00:00:08,584 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 00:02:26,163 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 00:04:43,761 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 00:07:01,444 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 00:09:19,008 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 00:11:36,753 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 00:13:54,275 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 00:16:12,738 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 00:18:30,176 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 00:18:44,647 [INFO] - --- Mutual Epoch 4 Summary (Time: 3874.44s): Avg Loss=1.2011, Avg Acc=59.85% ---
2025-05-02 00:18:44,647 [INFO] -   vit: Loss=1.0898, Acc=63.23%, CE=1.0661, Mut=1.3009, Cal=0.1846, Feat=0.0000
2025-05-02 00:18:44,647 [INFO] -   efficientnet: Loss=0.8992, Acc=71.42%, CE=0.8620, Mut=1.2760, Cal=0.1544, Feat=0.0000
2025-05-02 00:18:44,647 [INFO] -   inception: Loss=1.2932, Acc=58.58%, CE=1.2550, Mut=1.6664, Cal=0.1958, Feat=0.0000
2025-05-02 00:18:44,647 [INFO] -   mobilenet: Loss=1.1809, Acc=61.37%, CE=1.1675, Mut=1.2736, Cal=0.1842, Feat=0.0000
2025-05-02 00:18:44,647 [INFO] -   resnet: Loss=1.2078, Acc=58.60%, CE=1.2183, Mut=1.0224, Cal=0.1941, Feat=0.0000
2025-05-02 00:18:44,647 [INFO] -   densenet: Loss=1.1140, Acc=63.74%, CE=1.1054, Mut=1.1530, Cal=0.1771, Feat=0.0000
2025-05-02 00:18:44,647 [INFO] -   student: Loss=1.6227, Acc=42.00%, CE=1.6753, Mut=0.8908, Cal=0.2132, Feat=0.3417
2025-05-02 00:18:44,647 [INFO] - --- Starting Validation for Epoch 4 ---
2025-05-02 00:18:44,657 [INFO] - Collecting validation targets...
2025-05-02 00:18:46,973 [INFO] - Collected 5000 validation targets.
2025-05-02 00:19:19,548 [INFO] -   Validation vit: Loss=1.0054, Acc=64.16%, ECE=0.0248
2025-05-02 00:19:34,812 [INFO] -   Validation efficientnet: Loss=0.6443, Acc=79.68%, ECE=0.0440
2025-05-02 00:19:54,565 [INFO] -   Validation inception: Loss=0.9704, Acc=71.72%, ECE=0.0899
2025-05-02 00:20:06,892 [INFO] -   Validation mobilenet: Loss=0.8339, Acc=75.48%, ECE=0.0637
2025-05-02 00:20:18,265 [INFO] -   Validation resnet: Loss=0.9929, Acc=64.86%, ECE=0.0307
2025-05-02 00:20:44,753 [INFO] -   Validation densenet: Loss=0.7129, Acc=76.16%, ECE=0.0458
2025-05-02 00:21:00,181 [INFO] -   Validation student: Loss=1.1367, Acc=61.36%, ECE=0.0683
2025-05-02 00:21:02,299 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_4.pth (Epoch 3)
2025-05-02 00:21:02,435 [INFO] - GPU Memory: Current=3087.49MB, Peak=4142.68MB, Reserved=3480.00MB
2025-05-02 00:21:02,435 [INFO] - --- Starting Mutual Learning Epoch 5/50 ---
2025-05-02 00:21:05,239 [INFO] - GPU Memory: Current=2488.31MB, Peak=4142.68MB, Reserved=4252.00MB
2025-05-02 00:23:23,110 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 00:25:40,631 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 00:27:57,906 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 00:30:15,625 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 00:32:33,380 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 00:34:51,230 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 00:37:08,828 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 00:39:26,349 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 00:41:43,596 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 00:44:01,287 [INFO] - GPU Memory: Current=2488.31MB, Peak=4142.68MB, Reserved=4234.00MB
2025-05-02 00:46:18,948 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 00:48:36,536 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 00:50:54,766 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 00:53:13,202 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 00:55:31,928 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4220.00MB
2025-05-02 00:57:50,630 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 01:00:10,105 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 01:02:29,852 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 01:04:49,676 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 01:07:09,271 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 01:09:28,946 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 01:11:48,775 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 01:14:08,876 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 01:16:29,376 [INFO] - GPU Memory: Current=2488.31MB, Peak=4142.68MB, Reserved=4234.00MB
2025-05-02 01:18:49,804 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 01:21:10,457 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 01:23:31,270 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 01:25:52,070 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 01:26:06,862 [INFO] - --- Mutual Epoch 5 Summary (Time: 3904.43s): Avg Loss=1.0763, Avg Acc=63.80% ---
2025-05-02 01:26:06,862 [INFO] -   vit: Loss=1.0635, Acc=63.71%, CE=1.0426, Mut=1.1911, Cal=0.1830, Feat=0.0000
2025-05-02 01:26:06,862 [INFO] -   efficientnet: Loss=0.8602, Acc=72.25%, CE=0.8332, Mut=1.0536, Cal=0.1505, Feat=0.0000
2025-05-02 01:26:06,862 [INFO] -   inception: Loss=1.1792, Acc=61.91%, CE=1.1408, Mut=1.4644, Cal=0.1820, Feat=0.0000
2025-05-02 01:26:06,862 [INFO] -   mobilenet: Loss=1.0827, Acc=64.40%, CE=1.0766, Mut=1.0786, Cal=0.1758, Feat=0.0000
2025-05-02 01:26:06,862 [INFO] -   resnet: Loss=1.0684, Acc=62.76%, CE=1.0853, Mut=0.8551, Cal=0.1821, Feat=0.0000
2025-05-02 01:26:06,862 [INFO] -   densenet: Loss=1.0453, Acc=65.45%, CE=1.0448, Mut=0.9932, Cal=0.1705, Feat=0.0000
2025-05-02 01:26:06,862 [INFO] -   student: Loss=1.2347, Acc=56.08%, CE=1.2821, Mut=0.6974, Cal=0.1979, Feat=0.2721
2025-05-02 01:26:06,862 [INFO] - --- Starting Validation for Epoch 5 ---
2025-05-02 01:26:06,862 [INFO] - Collecting validation targets...
2025-05-02 01:26:09,224 [INFO] - Collected 5000 validation targets.
2025-05-02 01:26:46,297 [INFO] -   Validation vit: Loss=1.0553, Acc=61.64%, ECE=0.0351
2025-05-02 01:27:01,770 [INFO] -   Validation efficientnet: Loss=0.6590, Acc=79.06%, ECE=0.0491
2025-05-02 01:27:21,635 [INFO] -   Validation inception: Loss=0.8355, Acc=73.10%, ECE=0.0763
2025-05-02 01:27:34,068 [INFO] -   Validation mobilenet: Loss=0.6790, Acc=77.36%, ECE=0.0535
2025-05-02 01:27:45,552 [INFO] -   Validation resnet: Loss=0.8786, Acc=69.50%, ECE=0.0307
2025-05-02 01:28:12,418 [INFO] -   Validation densenet: Loss=0.6589, Acc=77.84%, ECE=0.0260
2025-05-02 01:28:27,980 [INFO] -   Validation student: Loss=0.9703, Acc=68.00%, ECE=0.0651
2025-05-02 01:28:29,974 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_5.pth (Epoch 4)
2025-05-02 01:28:30,107 [INFO] - GPU Memory: Current=3087.49MB, Peak=4142.68MB, Reserved=3480.00MB
2025-05-02 01:28:30,107 [INFO] - --- Starting Mutual Learning Epoch 6/50 ---
2025-05-02 01:28:32,943 [INFO] - GPU Memory: Current=2488.31MB, Peak=4142.68MB, Reserved=4252.00MB
2025-05-02 01:30:53,479 [INFO] - GPU Memory: Current=2488.31MB, Peak=4142.68MB, Reserved=4234.00MB
2025-05-02 01:33:14,455 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 01:35:35,914 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 01:37:57,452 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 01:40:18,546 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 01:42:40,131 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 01:45:01,254 [INFO] - GPU Memory: Current=2488.30MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 01:47:21,979 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 01:49:42,889 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 01:52:03,883 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 01:54:25,315 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 01:56:46,587 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 01:59:08,430 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4212.00MB
2025-05-02 02:01:29,584 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 02:03:50,996 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 02:06:12,523 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 02:08:33,987 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 02:10:55,429 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 02:13:16,838 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 02:15:38,416 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 02:18:00,065 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 02:20:21,643 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4212.00MB
2025-05-02 02:22:43,305 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 02:25:04,993 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 02:27:26,432 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 02:29:47,700 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 02:32:09,338 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 02:34:31,310 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 02:34:46,133 [INFO] - --- Mutual Epoch 6 Summary (Time: 3976.03s): Avg Loss=1.0044, Avg Acc=66.27% ---
2025-05-02 02:34:46,133 [INFO] -   vit: Loss=1.0572, Acc=63.74%, CE=1.0385, Mut=1.1329, Cal=0.1825, Feat=0.0000
2025-05-02 02:34:46,133 [INFO] -   efficientnet: Loss=0.8073, Acc=74.08%, CE=0.7830, Mut=0.9380, Cal=0.1436, Feat=0.0000
2025-05-02 02:34:46,133 [INFO] -   inception: Loss=1.1025, Acc=64.48%, CE=1.0617, Mut=1.3438, Cal=0.1739, Feat=0.0000
2025-05-02 02:34:46,133 [INFO] -   mobilenet: Loss=1.0137, Acc=66.43%, CE=1.0133, Mut=0.9596, Cal=0.1710, Feat=0.0000
2025-05-02 02:34:46,133 [INFO] -   resnet: Loss=0.9855, Acc=65.88%, CE=1.0053, Mut=0.7825, Cal=0.1734, Feat=0.0000
2025-05-02 02:34:46,133 [INFO] -   densenet: Loss=0.9629, Acc=68.50%, CE=0.9638, Mut=0.9024, Cal=0.1621, Feat=0.0000
2025-05-02 02:34:46,143 [INFO] -   student: Loss=1.1017, Acc=60.76%, CE=1.1510, Mut=0.6384, Cal=0.1863, Feat=0.2374
2025-05-02 02:34:46,143 [INFO] - --- Starting Validation for Epoch 6 ---
2025-05-02 02:34:46,143 [INFO] - Collecting validation targets...
2025-05-02 02:34:48,537 [INFO] - Collected 5000 validation targets.
2025-05-02 02:35:26,841 [INFO] -   Validation vit: Loss=0.8995, Acc=68.30%, ECE=0.0126
2025-05-02 02:35:42,449 [INFO] -   Validation efficientnet: Loss=0.5512, Acc=81.86%, ECE=0.0240
2025-05-02 02:36:02,551 [INFO] -   Validation inception: Loss=0.8224, Acc=73.02%, ECE=0.0451
2025-05-02 02:36:15,006 [INFO] -   Validation mobilenet: Loss=0.7121, Acc=76.70%, ECE=0.0569
2025-05-02 02:36:26,570 [INFO] -   Validation resnet: Loss=0.7768, Acc=74.00%, ECE=0.0248
2025-05-02 02:36:53,652 [INFO] -   Validation densenet: Loss=0.6268, Acc=79.18%, ECE=0.0195
2025-05-02 02:37:09,310 [INFO] -   Validation student: Loss=0.8578, Acc=71.40%, ECE=0.0482
2025-05-02 02:37:09,320 [INFO] - New best ECE for vit: 0.0126.
2025-05-02 02:37:09,602 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 02:37:09,602 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-02 02:37:09,602 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 02:37:09,602 [INFO] - Model resnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 02:37:09,606 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 02:37:11,584 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_6.pth (Epoch 5)
2025-05-02 02:37:11,719 [INFO] - GPU Memory: Current=3085.80MB, Peak=4142.68MB, Reserved=3484.00MB
2025-05-02 02:37:11,719 [INFO] - --- Starting Mutual Learning Epoch 7/50 ---
2025-05-02 02:37:14,564 [INFO] - GPU Memory: Current=2488.31MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 02:39:35,699 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 02:41:57,307 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 02:44:19,195 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 02:46:41,066 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 02:49:02,799 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 02:51:24,452 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 02:53:45,805 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 02:56:07,284 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 02:58:28,992 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:00:50,563 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:03:11,870 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:05:34,132 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:07:55,487 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:10:17,027 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:12:38,457 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:15:00,088 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:17:21,651 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:19:43,435 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:22:05,154 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:24:26,744 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:26:48,199 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:29:09,676 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:31:31,167 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:33:52,883 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:36:14,488 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:38:36,163 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:40:57,761 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:43:19,249 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:43:34,133 [INFO] - --- Mutual Epoch 7 Summary (Time: 3982.41s): Avg Loss=0.9380, Avg Acc=68.73% ---
2025-05-02 03:43:34,133 [INFO] -   vit: Loss=1.0093, Acc=65.75%, CE=0.9845, Mut=1.1029, Cal=0.1771, Feat=0.0000
2025-05-02 03:43:34,133 [INFO] -   efficientnet: Loss=0.7673, Acc=75.58%, CE=0.7409, Mut=0.8829, Cal=0.1385, Feat=0.0000
2025-05-02 03:43:34,133 [INFO] -   inception: Loss=1.0415, Acc=67.00%, CE=0.9880, Mut=1.3148, Cal=0.1669, Feat=0.0000
2025-05-02 03:43:34,133 [INFO] -   mobilenet: Loss=0.9498, Acc=68.63%, CE=0.9450, Mut=0.9254, Cal=0.1627, Feat=0.0000
2025-05-02 03:43:34,133 [INFO] -   resnet: Loss=0.8912, Acc=69.16%, CE=0.9054, Mut=0.7502, Cal=0.1618, Feat=0.0000
2025-05-02 03:43:34,133 [INFO] -   densenet: Loss=0.9145, Acc=70.07%, CE=0.9115, Mut=0.8813, Cal=0.1558, Feat=0.0000
2025-05-02 03:43:34,133 [INFO] -   student: Loss=0.9926, Acc=64.96%, CE=1.0399, Mut=0.6072, Cal=0.1762, Feat=0.2138
2025-05-02 03:43:34,133 [INFO] - --- Starting Validation for Epoch 7 ---
2025-05-02 03:43:34,133 [INFO] - Collecting validation targets...
2025-05-02 03:43:36,539 [INFO] - Collected 5000 validation targets.
2025-05-02 03:44:14,932 [INFO] -   Validation vit: Loss=0.9207, Acc=66.30%, ECE=0.0344
2025-05-02 03:44:30,582 [INFO] -   Validation efficientnet: Loss=0.6218, Acc=79.82%, ECE=0.0514
2025-05-02 03:44:50,586 [INFO] -   Validation inception: Loss=0.7336, Acc=76.36%, ECE=0.0461
2025-05-02 03:45:03,036 [INFO] -   Validation mobilenet: Loss=0.7204, Acc=76.42%, ECE=0.0445
2025-05-02 03:45:14,611 [INFO] -   Validation resnet: Loss=0.8585, Acc=72.12%, ECE=0.0564
2025-05-02 03:45:41,512 [INFO] -   Validation densenet: Loss=0.6521, Acc=78.22%, ECE=0.0217
2025-05-02 03:45:57,081 [INFO] -   Validation student: Loss=0.8156, Acc=72.94%, ECE=0.0258
2025-05-02 03:45:57,094 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 03:45:57,094 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-02 03:45:57,096 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 03:45:57,096 [INFO] - Model resnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 03:45:57,096 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 03:45:59,213 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_7.pth (Epoch 6)
2025-05-02 03:45:59,347 [INFO] - GPU Memory: Current=3087.49MB, Peak=4142.68MB, Reserved=3466.00MB
2025-05-02 03:45:59,347 [INFO] - --- Starting Mutual Learning Epoch 8/50 ---
2025-05-02 03:46:02,237 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 03:48:23,443 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:50:44,942 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:53:06,445 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:55:27,998 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 03:57:49,296 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 04:00:10,916 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 04:02:32,310 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 04:04:54,070 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 04:07:15,910 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 04:09:37,658 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 04:11:59,507 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4212.00MB
2025-05-02 04:14:21,423 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 04:16:43,265 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 04:19:04,928 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4220.00MB
2025-05-02 04:21:26,519 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 04:23:48,315 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4212.00MB
2025-05-02 04:26:09,752 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 04:28:31,690 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 04:30:53,899 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 04:33:18,684 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 04:35:43,896 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 04:38:05,513 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 04:40:27,604 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 04:42:49,846 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 04:45:11,368 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 04:47:33,076 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 04:49:54,867 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 04:52:16,508 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 04:52:31,405 [INFO] - --- Mutual Epoch 8 Summary (Time: 3992.06s): Avg Loss=0.8907, Avg Acc=70.29% ---
2025-05-02 04:52:31,405 [INFO] -   vit: Loss=0.9417, Acc=68.36%, CE=0.9151, Mut=1.0252, Cal=0.1671, Feat=0.0000
2025-05-02 04:52:31,405 [INFO] -   efficientnet: Loss=0.7339, Acc=76.48%, CE=0.7096, Mut=0.8168, Cal=0.1333, Feat=0.0000
2025-05-02 04:52:31,405 [INFO] -   inception: Loss=0.9927, Acc=68.66%, CE=0.9346, Mut=1.2443, Cal=0.1610, Feat=0.0000
2025-05-02 04:52:31,405 [INFO] -   mobilenet: Loss=0.9218, Acc=69.23%, CE=0.9222, Mut=0.8665, Cal=0.1601, Feat=0.0000
2025-05-02 04:52:31,405 [INFO] -   resnet: Loss=0.8394, Acc=71.22%, CE=0.8547, Mut=0.7072, Cal=0.1565, Feat=0.0000
2025-05-02 04:52:31,405 [INFO] -   densenet: Loss=0.8555, Acc=71.94%, CE=0.8534, Mut=0.8164, Cal=0.1500, Feat=0.0000
2025-05-02 04:52:31,405 [INFO] -   student: Loss=0.9497, Acc=66.13%, CE=1.0050, Mut=0.5711, Cal=0.1712, Feat=0.1894
2025-05-02 04:52:31,405 [INFO] - --- Starting Validation for Epoch 8 ---
2025-05-02 04:52:31,405 [INFO] - Collecting validation targets...
2025-05-02 04:52:33,786 [INFO] - Collected 5000 validation targets.
2025-05-02 04:53:12,402 [INFO] -   Validation vit: Loss=0.9701, Acc=66.14%, ECE=0.0138
2025-05-02 04:53:28,006 [INFO] -   Validation efficientnet: Loss=0.5315, Acc=82.48%, ECE=0.0334
2025-05-02 04:53:48,283 [INFO] -   Validation inception: Loss=0.9021, Acc=73.18%, ECE=0.0876
2025-05-02 04:54:00,824 [INFO] -   Validation mobilenet: Loss=0.6787, Acc=76.82%, ECE=0.0364
2025-05-02 04:54:12,475 [INFO] -   Validation resnet: Loss=0.7646, Acc=74.24%, ECE=0.0265
2025-05-02 04:54:39,466 [INFO] -   Validation densenet: Loss=0.6814, Acc=77.36%, ECE=0.0297
2025-05-02 04:54:55,164 [INFO] -   Validation student: Loss=0.7611, Acc=73.20%, ECE=0.0348
2025-05-02 04:54:55,174 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 04:54:55,174 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-02 04:54:55,174 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 04:54:55,174 [INFO] - Model resnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 04:54:55,174 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 04:54:55,174 [INFO] - Model student triggered early stopping based on calibration patience (5 epochs).
2025-05-02 04:54:57,164 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_8.pth (Epoch 7)
2025-05-02 04:54:57,302 [INFO] - GPU Memory: Current=3087.49MB, Peak=4142.68MB, Reserved=3482.00MB
2025-05-02 04:54:57,302 [INFO] - --- Starting Mutual Learning Epoch 9/50 ---
2025-05-02 04:55:00,174 [INFO] - GPU Memory: Current=2488.31MB, Peak=4142.68MB, Reserved=4252.00MB
2025-05-02 04:57:21,722 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 04:59:43,240 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 05:02:05,371 [INFO] - GPU Memory: Current=2488.30MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:04:27,330 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:06:48,944 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:09:10,710 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:11:32,495 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 05:13:54,248 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 05:16:16,127 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:18:37,725 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 05:20:59,693 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 05:23:21,155 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:25:43,359 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 05:28:10,574 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:30:42,798 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:34:12,894 [INFO] - GPU Memory: Current=2488.31MB, Peak=4142.68MB, Reserved=4234.00MB
2025-05-02 05:36:31,470 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:38:50,432 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4220.00MB
2025-05-02 05:41:09,466 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:43:28,129 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:45:46,922 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:48:05,728 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:50:24,057 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:52:42,009 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:55:00,888 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:57:18,837 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 05:59:36,792 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:01:54,297 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:02:08,756 [INFO] - --- Mutual Epoch 9 Summary (Time: 4031.45s): Avg Loss=0.8474, Avg Acc=71.82% ---
2025-05-02 06:02:08,756 [INFO] -   vit: Loss=0.9219, Acc=69.08%, CE=0.8957, Mut=0.9858, Cal=0.1658, Feat=0.0000
2025-05-02 06:02:08,756 [INFO] -   efficientnet: Loss=0.7095, Acc=77.26%, CE=0.6871, Mut=0.7675, Cal=0.1308, Feat=0.0000
2025-05-02 06:02:08,756 [INFO] -   inception: Loss=0.9470, Acc=70.54%, CE=0.8851, Mut=1.1772, Cal=0.1554, Feat=0.0000
2025-05-02 06:02:08,756 [INFO] -   mobilenet: Loss=0.8824, Acc=70.73%, CE=0.8835, Mut=0.8250, Cal=0.1570, Feat=0.0000
2025-05-02 06:02:08,756 [INFO] -   resnet: Loss=0.7990, Acc=72.38%, CE=0.8160, Mut=0.6713, Cal=0.1503, Feat=0.0000
2025-05-02 06:02:08,756 [INFO] -   densenet: Loss=0.7997, Acc=73.78%, CE=0.7965, Mut=0.7672, Cal=0.1415, Feat=0.0000
2025-05-02 06:02:08,756 [INFO] -   student: Loss=0.8726, Acc=68.98%, CE=0.9294, Mut=0.5300, Cal=0.1646, Feat=0.1730
2025-05-02 06:02:08,756 [INFO] - --- Starting Validation for Epoch 9 ---
2025-05-02 06:02:08,756 [INFO] - Collecting validation targets...
2025-05-02 06:02:11,063 [INFO] - Collected 5000 validation targets.
2025-05-02 06:02:44,550 [INFO] -   Validation vit: Loss=0.8671, Acc=69.36%, ECE=0.0247
2025-05-02 06:02:59,807 [INFO] -   Validation efficientnet: Loss=0.5193, Acc=82.84%, ECE=0.0260
2025-05-02 06:03:19,394 [INFO] -   Validation inception: Loss=0.6835, Acc=77.96%, ECE=0.0596
2025-05-02 06:03:31,630 [INFO] -   Validation mobilenet: Loss=0.7160, Acc=75.76%, ECE=0.0527
2025-05-02 06:03:42,962 [INFO] -   Validation resnet: Loss=0.6843, Acc=76.64%, ECE=0.0218
2025-05-02 06:04:09,146 [INFO] -   Validation densenet: Loss=0.6120, Acc=78.90%, ECE=0.0170
2025-05-02 06:04:24,460 [INFO] -   Validation student: Loss=0.8194, Acc=72.64%, ECE=0.0286
2025-05-02 06:04:24,468 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 06:04:24,468 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-02 06:04:24,468 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 06:04:24,468 [INFO] - Model resnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 06:04:24,468 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 06:04:24,468 [INFO] - Model student triggered early stopping based on calibration patience (5 epochs).
2025-05-02 06:04:26,391 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_9.pth (Epoch 8)
2025-05-02 06:04:26,525 [INFO] - GPU Memory: Current=3085.80MB, Peak=4142.68MB, Reserved=3492.00MB
2025-05-02 06:04:26,525 [INFO] - --- Starting Mutual Learning Epoch 10/50 ---
2025-05-02 06:04:29,340 [INFO] - GPU Memory: Current=2488.31MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:06:47,072 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:09:04,885 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:11:22,665 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:13:40,271 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:15:58,179 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:18:16,052 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:20:33,676 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:22:51,388 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:25:08,944 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:27:26,616 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:29:44,157 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:32:01,753 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:34:19,335 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:36:36,951 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:38:54,201 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:41:11,477 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:43:29,015 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 06:45:46,366 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 06:48:03,902 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 06:50:21,551 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:52:38,993 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:54:56,148 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:57:13,278 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 06:59:30,349 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:01:47,883 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 07:04:05,145 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 07:06:22,242 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 07:08:39,490 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 07:08:53,870 [INFO] - --- Mutual Epoch 10 Summary (Time: 3867.35s): Avg Loss=0.8035, Avg Acc=73.28% ---
2025-05-02 07:08:53,870 [INFO] -   vit: Loss=0.8858, Acc=70.50%, CE=0.8592, Mut=0.9389, Cal=0.1599, Feat=0.0000
2025-05-02 07:08:53,870 [INFO] -   efficientnet: Loss=0.6774, Acc=78.14%, CE=0.6587, Mut=0.7098, Cal=0.1261, Feat=0.0000
2025-05-02 07:08:53,870 [INFO] -   inception: Loss=0.8867, Acc=72.47%, CE=0.8212, Mut=1.0998, Cal=0.1460, Feat=0.0000
2025-05-02 07:08:53,870 [INFO] -   mobilenet: Loss=0.8220, Acc=72.63%, CE=0.8256, Mut=0.7578, Cal=0.1495, Feat=0.0000
2025-05-02 07:08:53,870 [INFO] -   resnet: Loss=0.7508, Acc=74.19%, CE=0.7684, Mut=0.6329, Cal=0.1439, Feat=0.0000
2025-05-02 07:08:53,870 [INFO] -   densenet: Loss=0.7612, Acc=75.13%, CE=0.7597, Mut=0.7210, Cal=0.1375, Feat=0.0000
2025-05-02 07:08:53,870 [INFO] -   student: Loss=0.8407, Acc=69.91%, CE=0.9052, Mut=0.5018, Cal=0.1598, Feat=0.1639
2025-05-02 07:08:53,870 [INFO] - --- Starting Validation for Epoch 10 ---
2025-05-02 07:08:53,870 [INFO] - Collecting validation targets...
2025-05-02 07:08:56,155 [INFO] - Collected 5000 validation targets.
2025-05-02 07:09:28,745 [INFO] -   Validation vit: Loss=0.6786, Acc=76.96%, ECE=0.0594
2025-05-02 07:09:44,050 [INFO] -   Validation efficientnet: Loss=0.5491, Acc=82.86%, ECE=0.0366
2025-05-02 07:10:03,594 [INFO] -   Validation inception: Loss=0.6051, Acc=79.78%, ECE=0.0396
2025-05-02 07:10:15,754 [INFO] -   Validation mobilenet: Loss=0.6637, Acc=78.28%, ECE=0.0252
2025-05-02 07:10:27,132 [INFO] -   Validation resnet: Loss=0.6448, Acc=77.20%, ECE=0.0124
2025-05-02 07:10:53,096 [INFO] -   Validation densenet: Loss=0.5392, Acc=81.94%, ECE=0.0145
2025-05-02 07:11:08,421 [INFO] -   Validation student: Loss=0.7153, Acc=76.18%, ECE=0.0349
2025-05-02 07:11:08,433 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 07:11:08,435 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-02 07:11:08,435 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 07:11:08,437 [INFO] - New best ECE for resnet: 0.0124.
2025-05-02 07:11:08,533 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 07:11:08,533 [INFO] - Model student triggered early stopping based on calibration patience (5 epochs).
2025-05-02 07:11:10,536 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_10.pth (Epoch 9)
2025-05-02 07:11:10,669 [INFO] - GPU Memory: Current=3087.49MB, Peak=4142.68MB, Reserved=3480.00MB
2025-05-02 07:11:10,669 [INFO] - --- Starting Mutual Learning Epoch 11/50 ---
2025-05-02 07:11:13,466 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:13:30,786 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:15:48,329 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:18:05,722 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:20:23,245 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:22:40,582 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:24:58,256 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:27:15,663 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 07:29:32,930 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 07:31:50,326 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 07:34:07,818 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 07:36:25,127 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:38:42,531 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:40:59,764 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:43:17,133 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:45:34,507 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:47:51,765 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:50:09,161 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:52:26,546 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:54:43,883 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 07:57:01,210 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 07:59:18,458 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 08:01:35,504 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 08:03:52,896 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 08:06:10,337 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 08:08:27,406 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 08:10:44,752 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 08:13:02,048 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4232.00MB
2025-05-02 08:15:19,073 [INFO] - GPU Memory: Current=2488.05MB, Peak=4142.68MB, Reserved=4218.00MB
2025-05-02 08:15:33,454 [INFO] - --- Mutual Epoch 11 Summary (Time: 3862.78s): Avg Loss=0.7574, Avg Acc=74.97% ---
2025-05-02 08:15:33,454 [INFO] -   vit: Loss=0.8467, Acc=71.66%, CE=0.8185, Mut=0.8953, Cal=0.1544, Feat=0.0000
2025-05-02 08:15:33,454 [INFO] -   efficientnet: Loss=0.6393, Acc=79.49%, CE=0.6215, Mut=0.6624, Cal=0.1209, Feat=0.0000
2025-05-02 08:15:33,454 [INFO] -   inception: Loss=0.8359, Acc=74.36%, CE=0.7641, Mut=1.0441, Cal=0.1386, Feat=0.0000
2025-05-02 08:15:33,454 [INFO] -   mobilenet: Loss=0.7875, Acc=73.95%, CE=0.7888, Mut=0.7343, Cal=0.1465, Feat=0.0000
2025-05-02 08:15:33,454 [INFO] -   resnet: Loss=0.7004, Acc=76.28%, CE=0.7155, Mut=0.6013, Cal=0.1373, Feat=0.0000
2025-05-02 08:15:33,454 [INFO] -   densenet: Loss=0.7146, Acc=76.60%, CE=0.7114, Mut=0.6826, Cal=0.1300, Feat=0.0000
2025-05-02 08:15:33,454 [INFO] -   student: Loss=0.7770, Acc=72.46%, CE=0.8428, Mut=0.4662, Cal=0.1535, Feat=0.1570
2025-05-02 08:15:33,454 [INFO] - --- Starting Validation for Epoch 11 ---
2025-05-02 08:15:33,454 [INFO] - Collecting validation targets...
2025-05-02 08:15:35,751 [INFO] - Collected 5000 validation targets.
2025-05-02 08:16:08,215 [INFO] -   Validation vit: Loss=0.9078, Acc=68.60%, ECE=0.0233
2025-05-02 08:16:23,553 [INFO] -   Validation efficientnet: Loss=0.5497, Acc=82.64%, ECE=0.0351
2025-05-02 08:16:43,189 [INFO] -   Validation inception: Loss=0.6786, Acc=78.50%, ECE=0.0556
2025-05-02 08:16:55,351 [INFO] -   Validation mobilenet: Loss=0.6233, Acc=79.38%, ECE=0.0375
2025-05-02 08:17:06,667 [INFO] -   Validation resnet: Loss=0.6385, Acc=78.24%, ECE=0.0181
2025-05-02 08:17:32,617 [INFO] -   Validation densenet: Loss=0.4825, Acc=83.46%, ECE=0.0107
2025-05-02 08:17:47,841 [INFO] -   Validation student: Loss=0.6554, Acc=78.36%, ECE=0.0208
2025-05-02 08:17:47,851 [INFO] - Model vit triggered early stopping based on accuracy patience (10 epochs).
2025-05-02 08:17:47,851 [INFO] - Model vit triggered early stopping based on calibration patience (5 epochs).
2025-05-02 08:17:47,851 [INFO] - Model efficientnet triggered early stopping based on accuracy patience (10 epochs).
2025-05-02 08:17:47,851 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 08:17:47,851 [INFO] - Model inception triggered early stopping based on accuracy patience (10 epochs).
2025-05-02 08:17:47,851 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-02 08:17:47,851 [INFO] - Model mobilenet triggered early stopping based on accuracy patience (10 epochs).
2025-05-02 08:17:47,851 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 08:17:47,851 [INFO] - Model resnet triggered early stopping based on accuracy patience (10 epochs).
2025-05-02 08:17:47,851 [INFO] - Model densenet triggered early stopping based on accuracy patience (10 epochs).
2025-05-02 08:17:47,851 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 08:17:47,851 [INFO] - Model student triggered early stopping based on calibration patience (5 epochs).
2025-05-02 08:17:49,736 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_11.pth (Epoch 10)
2025-05-02 08:17:49,738 [INFO] - All models met early stopping criteria at epoch 11. Stopping training.
2025-05-02 08:17:49,738 [INFO] - Restoring best model states based on validation accuracy...
2025-05-02 08:17:49,741 [INFO] - Restored best state for vit from epoch 1 (Acc: 96.24%)
2025-05-02 08:17:49,751 [INFO] - Restored best state for efficientnet from epoch 1 (Acc: 96.30%)
2025-05-02 08:17:49,771 [INFO] - Restored best state for inception from epoch 1 (Acc: 94.22%)
2025-05-02 08:17:49,781 [INFO] - Restored best state for mobilenet from epoch 1 (Acc: 96.00%)
2025-05-02 08:17:49,792 [INFO] - Restored best state for resnet from epoch 1 (Acc: 93.88%)
2025-05-02 08:17:49,812 [INFO] - Restored best state for densenet from epoch 1 (Acc: 95.80%)
2025-05-02 08:17:49,822 [INFO] - Restored best state for student from epoch 2 (Acc: 94.78%)
2025-05-02 08:17:49,832 [INFO] - Saving final (best) model states...
2025-05-02 08:17:50,117 [INFO] - Final best model for vit saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\vit_mutual_final_best.pth
2025-05-02 08:17:50,159 [INFO] - Final best model for efficientnet saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\efficientnet_mutual_final_best.pth
2025-05-02 08:17:50,293 [INFO] - Final best model for inception saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\inception_mutual_final_best.pth
2025-05-02 08:17:50,337 [INFO] - Final best model for mobilenet saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mobilenet_mutual_final_best.pth
2025-05-02 08:17:52,140 [INFO] - Final best model for resnet saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\resnet_mutual_final_best.pth
2025-05-02 08:17:53,032 [INFO] - Final best model for densenet saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\densenet_mutual_final_best.pth
2025-05-02 08:18:16,660 [INFO] - Final best model for student saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\student_mutual_final_best.pth
2025-05-02 08:18:16,664 [INFO] - Training history saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250501_194739_history.json
2025-05-02 08:18:16,664 [INFO] - Mutual learning phase completed
2025-05-02 08:18:27,292 [ERROR] - An error occurred in main: 'list' object has no attribute 'keys'
2025-05-02 08:18:27,292 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 3367, in main
    if 'history' in locals() and history: plot_mutual_learning_history(history, config)
                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 2983, in plot_mutual_learning_history
    teacher_names = list(history['hfi_attention'][0].keys())
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'keys'

2025-05-02 09:45:56,100 [INFO] - Using device: cuda
2025-05-02 09:45:56,106 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 09:45:56,106 [INFO] - GPU Memory: 6.00 GB
2025-05-02 09:45:56,106 [INFO] - CUDA Version: 12.4
2025-05-02 09:45:56,106 [INFO] - cuDNN benchmark mode enabled
2025-05-02 09:45:56,106 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.0005,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "alpha": 0.5,
    "feature_loss_weight": 0.01,
    "cal_weight": 0.1,
    "use_warmup": true,
    "warmup_epochs": 5,
    "curriculum_start_epoch": 5,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 45,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-02 09:45:56,106 [INFO] - Random seed set to 42
2025-05-02 09:45:56,106 [INFO] - Creating models...
2025-05-02 09:45:56,106 [INFO] - Loading ViT-B16 model...
2025-05-02 09:45:57,028 [INFO] - Loading EfficientNetB0 model...
2025-05-02 09:45:57,136 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-02 09:45:57,479 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-02 09:45:57,479 [INFO] - Loading MobileNetV3-Large model...
2025-05-02 09:45:57,588 [INFO] - Loading ResNet50 model...
2025-05-02 09:45:57,933 [INFO] - Loading DenseNet121 model...
2025-05-02 09:45:58,063 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-02 09:45:58,279 [INFO] - Model vit moved to cuda
2025-05-02 09:45:58,310 [INFO] - Model efficientnet moved to cuda
2025-05-02 09:45:58,375 [INFO] - Model inception moved to cuda
2025-05-02 09:45:58,393 [INFO] - Model mobilenet moved to cuda
2025-05-02 09:45:58,423 [INFO] - Model resnet moved to cuda
2025-05-02 09:45:58,470 [INFO] - Model densenet moved to cuda
2025-05-02 09:45:58,502 [INFO] - Model student moved to cuda
2025-05-02 09:45:58,502 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-02 09:45:58,502 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-02 09:45:58,502 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-02 09:45:58,502 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-02 09:45:58,502 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-02 09:45:58,502 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-02 09:45:58,502 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-02 09:45:58,502 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_11.pth (Epoch 11, Phase: mutual)
2025-05-02 09:45:58,502 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_11.pth
2025-05-02 09:46:00,452 [INFO] - Loaded model state for vit successfully.
2025-05-02 09:46:00,472 [INFO] - Loaded model state for efficientnet successfully.
2025-05-02 09:46:00,513 [INFO] - Loaded model state for inception successfully.
2025-05-02 09:46:00,523 [INFO] - Loaded model state for mobilenet successfully.
2025-05-02 09:46:00,553 [INFO] - Loaded model state for resnet successfully.
2025-05-02 09:46:00,584 [INFO] - Loaded model state for densenet successfully.
2025-05-02 09:46:00,605 [INFO] - Loaded model state for student successfully.
2025-05-02 09:46:00,729 [INFO] - Recreated and loaded optimizer state for vit
2025-05-02 09:46:00,749 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-02 09:46:00,821 [INFO] - Recreated and loaded optimizer state for inception
2025-05-02 09:46:00,851 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-02 09:46:00,908 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-02 09:46:00,943 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-02 09:46:00,953 [ERROR] - Error loading optimizer state for student: loaded state dict has a different number of parameter groups. Optimizer state might be reset.
Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 473, in load_checkpoint
    optimizer.load_state_dict(optimizer_state_dict[state_dict_key])
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\_dynamo\eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\optimizer.py", line 853, in load_state_dict
    raise ValueError(
ValueError: loaded state dict has a different number of parameter groups

2025-05-02 09:46:00,953 [INFO] - Recreated and loaded scheduler state for vit (Type: SequentialLR)
2025-05-02 09:46:00,953 [INFO] - Recreated and loaded scheduler state for efficientnet (Type: SequentialLR)
2025-05-02 09:46:00,953 [INFO] - Recreated and loaded scheduler state for inception (Type: SequentialLR)
2025-05-02 09:46:00,953 [INFO] - Recreated and loaded scheduler state for mobilenet (Type: SequentialLR)
2025-05-02 09:46:00,953 [INFO] - Recreated and loaded scheduler state for resnet (Type: SequentialLR)
2025-05-02 09:46:00,953 [INFO] - Recreated and loaded scheduler state for densenet (Type: SequentialLR)
2025-05-02 09:46:00,953 [INFO] - Recreated and loaded scheduler state for student (Type: SequentialLR)
2025-05-02 09:46:01,014 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_11.pth. Checkpoint epoch: 11, Phase: 'mutual'.
2025-05-02 09:46:01,025 [INFO] - Resuming mutual learning phase from epoch 12
2025-05-02 09:46:01,025 [INFO] - Preparing data loaders...
2025-05-02 09:46:09,542 [INFO] - Training samples: 45000 per model
2025-05-02 09:46:09,542 [INFO] - Validation samples: 5000 per model
2025-05-02 09:46:09,542 [INFO] - Test samples: 10000 per model
2025-05-02 09:46:09,542 [INFO] - Skipping initialization phase.
2025-05-02 09:46:09,542 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-02 09:46:09,669 [INFO] - GPU Memory: Current=1721.29MB, Peak=1721.29MB, Reserved=1740.00MB
2025-05-02 09:46:09,669 [INFO] - Starting mutual learning phase from epoch 12...
2025-05-02 09:46:09,669 [INFO] - Starting mutual learning phase...
2025-05-02 09:46:09,669 [INFO] - Hook registered for encoder.ln
2025-05-02 09:46:09,669 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-02 09:46:10,239 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-02 09:46:10,239 [INFO] - Hook registered for features.8
2025-05-02 09:46:10,239 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-02 09:46:10,683 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-02 09:46:10,683 [INFO] - Hook registered for inception.Mixed_7c
2025-05-02 09:46:10,683 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-02 09:46:11,190 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-02 09:46:11,190 [INFO] - Hook registered for features
2025-05-02 09:46:11,190 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-02 09:46:11,331 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-02 09:46:11,331 [INFO] - Hook registered for layer4
2025-05-02 09:46:11,331 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-02 09:46:11,593 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-02 09:46:11,593 [INFO] - Hook registered for features
2025-05-02 09:46:11,593 [INFO] - Feature extractor registered for densenet at layer features
2025-05-02 09:46:11,857 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-02 09:46:11,873 [INFO] - Hook registered for features.8
2025-05-02 09:46:11,873 [INFO] - Feature extractor registered for student at layer features.8
2025-05-02 09:46:11,889 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-02 09:46:12,886 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-02 09:46:12,886 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-02 09:46:12,893 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-02 09:46:12,893 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-02 09:46:12,903 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-02 09:46:12,903 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-02 09:46:12,903 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-02 09:46:12,903 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-02 09:46:12,913 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-02 09:46:12,913 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-02 09:46:12,924 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-02 09:46:12,924 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-02 09:46:12,924 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-02 09:46:12,924 [INFO] - HFI module initialized with 6 teachers.
2025-05-02 09:46:13,026 [INFO] - HFI initialized.
2025-05-02 09:46:13,026 [INFO] - Added HFI params to student optimizer.
2025-05-02 09:46:14,245 [INFO] - Using 3-stage scheduler for vit: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:46:14,247 [INFO] - Using 3-stage scheduler for efficientnet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:46:14,249 [INFO] - Using 3-stage scheduler for inception: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:46:14,249 [INFO] - Using 3-stage scheduler for mobilenet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:46:14,249 [INFO] - Using 3-stage scheduler for resnet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:46:14,251 [INFO] - Using 3-stage scheduler for densenet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:46:14,251 [INFO] - Using 3-stage scheduler for student: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:46:14,251 [INFO] - Added HFI parameters to the student optimizer.
2025-05-02 09:46:14,251 [INFO] - Mutual learning phase using effective batch size: 4
2025-05-02 09:46:14,251 [INFO] - --- Starting Mutual Learning Epoch 12/50 ---
2025-05-02 09:46:19,607 [INFO] - Using device: cuda
2025-05-02 09:46:19,607 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 09:46:19,607 [INFO] - GPU Memory: 6.00 GB
2025-05-02 09:46:19,607 [INFO] - CUDA Version: 12.4
2025-05-02 09:46:19,607 [INFO] - cuDNN benchmark mode enabled
2025-05-02 09:46:51,015 [INFO] - Using device: cuda
2025-05-02 09:46:51,015 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 09:46:51,015 [INFO] - GPU Memory: 6.00 GB
2025-05-02 09:46:51,015 [INFO] - CUDA Version: 12.4
2025-05-02 09:46:51,015 [INFO] - cuDNN benchmark mode enabled
2025-05-02 09:46:51,015 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.0005,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "alpha": 0.5,
    "feature_loss_weight": 0.01,
    "cal_weight": 0.1,
    "use_warmup": true,
    "warmup_epochs": 5,
    "curriculum_start_epoch": 5,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 45,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-02 09:46:51,015 [INFO] - Random seed set to 42
2025-05-02 09:46:51,015 [INFO] - Creating models...
2025-05-02 09:46:51,015 [INFO] - Loading ViT-B16 model...
2025-05-02 09:46:51,633 [INFO] - Loading EfficientNetB0 model...
2025-05-02 09:46:51,729 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-02 09:46:51,889 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-02 09:46:51,889 [INFO] - Loading MobileNetV3-Large model...
2025-05-02 09:46:51,980 [INFO] - Loading ResNet50 model...
2025-05-02 09:46:52,223 [INFO] - Loading DenseNet121 model...
2025-05-02 09:46:52,336 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-02 09:46:52,535 [INFO] - Model vit moved to cuda
2025-05-02 09:46:52,551 [INFO] - Model efficientnet moved to cuda
2025-05-02 09:46:52,614 [INFO] - Model inception moved to cuda
2025-05-02 09:46:52,614 [INFO] - Model mobilenet moved to cuda
2025-05-02 09:46:52,662 [INFO] - Model resnet moved to cuda
2025-05-02 09:46:52,694 [INFO] - Model densenet moved to cuda
2025-05-02 09:46:52,725 [INFO] - Model student moved to cuda
2025-05-02 09:46:52,725 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-02 09:46:52,725 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-02 09:46:52,725 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-02 09:46:52,725 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-02 09:46:52,725 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-02 09:46:52,725 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-02 09:46:52,725 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-02 09:46:52,725 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_11.pth (Epoch 11, Phase: mutual)
2025-05-02 09:46:52,725 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_11.pth
2025-05-02 09:46:53,583 [INFO] - Loaded model state for vit successfully.
2025-05-02 09:46:53,614 [INFO] - Loaded model state for efficientnet successfully.
2025-05-02 09:46:53,644 [INFO] - Loaded model state for inception successfully.
2025-05-02 09:46:53,665 [INFO] - Loaded model state for mobilenet successfully.
2025-05-02 09:46:53,685 [INFO] - Loaded model state for resnet successfully.
2025-05-02 09:46:53,726 [INFO] - Loaded model state for densenet successfully.
2025-05-02 09:46:53,736 [INFO] - Loaded model state for student successfully.
2025-05-02 09:46:53,859 [INFO] - Recreated and loaded optimizer state for vit
2025-05-02 09:46:53,890 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-02 09:46:53,951 [INFO] - Recreated and loaded optimizer state for inception
2025-05-02 09:46:53,972 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-02 09:46:54,013 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-02 09:46:54,074 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-02 09:46:54,074 [ERROR] - Error loading optimizer state for student: loaded state dict has a different number of parameter groups. Optimizer state might be reset.
Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 473, in load_checkpoint
    optimizer.load_state_dict(optimizer_state_dict[state_dict_key])
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\_dynamo\eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\optimizer.py", line 853, in load_state_dict
    raise ValueError(
ValueError: loaded state dict has a different number of parameter groups

2025-05-02 09:46:54,074 [INFO] - Recreated and loaded scheduler state for vit (Type: SequentialLR)
2025-05-02 09:46:54,074 [INFO] - Recreated and loaded scheduler state for efficientnet (Type: SequentialLR)
2025-05-02 09:46:54,074 [INFO] - Recreated and loaded scheduler state for inception (Type: SequentialLR)
2025-05-02 09:46:54,074 [INFO] - Recreated and loaded scheduler state for mobilenet (Type: SequentialLR)
2025-05-02 09:46:54,074 [INFO] - Recreated and loaded scheduler state for resnet (Type: SequentialLR)
2025-05-02 09:46:54,074 [INFO] - Recreated and loaded scheduler state for densenet (Type: SequentialLR)
2025-05-02 09:46:54,074 [INFO] - Recreated and loaded scheduler state for student (Type: SequentialLR)
2025-05-02 09:46:54,095 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_11.pth. Checkpoint epoch: 11, Phase: 'mutual'.
2025-05-02 09:46:54,095 [INFO] - Resuming mutual learning phase from epoch 12
2025-05-02 09:46:54,095 [INFO] - Preparing data loaders...
2025-05-02 09:47:02,328 [INFO] - Training samples: 45000 per model
2025-05-02 09:47:02,328 [INFO] - Validation samples: 5000 per model
2025-05-02 09:47:02,328 [INFO] - Test samples: 10000 per model
2025-05-02 09:47:02,328 [INFO] - Skipping initialization phase.
2025-05-02 09:47:02,328 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-02 09:47:02,458 [INFO] - GPU Memory: Current=1721.29MB, Peak=1721.29MB, Reserved=1740.00MB
2025-05-02 09:47:02,458 [INFO] - Starting mutual learning phase from epoch 12...
2025-05-02 09:47:02,458 [INFO] - Starting mutual learning phase...
2025-05-02 09:47:02,458 [INFO] - Hook registered for encoder.ln
2025-05-02 09:47:02,458 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-02 09:47:02,729 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-02 09:47:02,729 [INFO] - Hook registered for features.8
2025-05-02 09:47:02,729 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-02 09:47:03,000 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-02 09:47:03,000 [INFO] - Hook registered for inception.Mixed_7c
2025-05-02 09:47:03,000 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-02 09:47:03,447 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-02 09:47:03,447 [INFO] - Hook registered for features
2025-05-02 09:47:03,447 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-02 09:47:03,581 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-02 09:47:03,581 [INFO] - Hook registered for layer4
2025-05-02 09:47:03,581 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-02 09:47:03,805 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-02 09:47:03,805 [INFO] - Hook registered for features
2025-05-02 09:47:03,805 [INFO] - Feature extractor registered for densenet at layer features
2025-05-02 09:47:04,072 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-02 09:47:04,072 [INFO] - Hook registered for features.8
2025-05-02 09:47:04,072 [INFO] - Feature extractor registered for student at layer features.8
2025-05-02 09:47:04,093 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-02 09:47:05,034 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-02 09:47:05,034 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-02 09:47:05,044 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-02 09:47:05,044 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-02 09:47:05,044 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-02 09:47:05,044 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-02 09:47:05,054 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-02 09:47:05,054 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-02 09:47:05,064 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-02 09:47:05,064 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-02 09:47:05,074 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-02 09:47:05,074 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-02 09:47:05,074 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-02 09:47:05,074 [INFO] - HFI module initialized with 6 teachers.
2025-05-02 09:47:05,178 [INFO] - HFI initialized.
2025-05-02 09:47:05,178 [INFO] - Added HFI params to student optimizer.
2025-05-02 09:47:06,396 [INFO] - Using 3-stage scheduler for vit: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:47:06,396 [INFO] - Using 3-stage scheduler for efficientnet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:47:06,396 [INFO] - Using 3-stage scheduler for inception: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:47:06,396 [INFO] - Using 3-stage scheduler for mobilenet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:47:06,400 [INFO] - Using 3-stage scheduler for resnet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:47:06,402 [INFO] - Using 3-stage scheduler for densenet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:47:06,402 [INFO] - Using 3-stage scheduler for student: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:47:06,402 [INFO] - Added HFI parameters to the student optimizer.
2025-05-02 09:47:06,404 [INFO] - Mutual learning phase using effective batch size: 4
2025-05-02 09:47:06,404 [INFO] - --- Starting Mutual Learning Epoch 12/50 ---
2025-05-02 09:47:11,707 [INFO] - Using device: cuda
2025-05-02 09:47:11,707 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 09:47:11,707 [INFO] - GPU Memory: 6.00 GB
2025-05-02 09:47:11,707 [INFO] - CUDA Version: 12.4
2025-05-02 09:47:11,707 [INFO] - cuDNN benchmark mode enabled
2025-05-02 09:47:17,069 [INFO] - Using device: cuda
2025-05-02 09:47:17,069 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 09:47:17,085 [INFO] - GPU Memory: 6.00 GB
2025-05-02 09:47:17,085 [INFO] - CUDA Version: 12.4
2025-05-02 09:47:17,085 [INFO] - cuDNN benchmark mode enabled
2025-05-02 09:47:22,418 [INFO] - Using device: cuda
2025-05-02 09:47:22,429 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 09:47:22,429 [INFO] - GPU Memory: 6.00 GB
2025-05-02 09:47:22,429 [INFO] - CUDA Version: 12.4
2025-05-02 09:47:22,429 [INFO] - cuDNN benchmark mode enabled
2025-05-02 09:47:27,764 [INFO] - Using device: cuda
2025-05-02 09:47:27,764 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 09:47:27,764 [INFO] - GPU Memory: 6.00 GB
2025-05-02 09:47:27,764 [INFO] - CUDA Version: 12.4
2025-05-02 09:47:27,764 [INFO] - cuDNN benchmark mode enabled
2025-05-02 09:47:38,295 [INFO] - GPU Memory: Current=2995.12MB, Peak=3597.20MB, Reserved=3786.00MB
2025-05-02 09:50:10,692 [INFO] - GPU Memory: Current=2994.27MB, Peak=4641.02MB, Reserved=4700.00MB
2025-05-02 09:56:54,894 [INFO] - Using device: cuda
2025-05-02 09:56:54,894 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 09:56:54,894 [INFO] - GPU Memory: 6.00 GB
2025-05-02 09:56:54,894 [INFO] - CUDA Version: 12.4
2025-05-02 09:56:54,894 [INFO] - cuDNN benchmark mode enabled
2025-05-02 09:56:54,894 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.0005,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "alpha": 0.5,
    "feature_loss_weight": 0.01,
    "cal_weight": 0.1,
    "use_warmup": true,
    "warmup_epochs": 5,
    "curriculum_start_epoch": 5,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 45,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-02 09:56:54,910 [INFO] - Random seed set to 42
2025-05-02 09:56:54,910 [INFO] - Creating models...
2025-05-02 09:56:54,910 [INFO] - Loading ViT-B16 model...
2025-05-02 09:56:55,750 [INFO] - Loading EfficientNetB0 model...
2025-05-02 09:56:55,861 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-02 09:56:56,192 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-02 09:56:56,192 [INFO] - Loading MobileNetV3-Large model...
2025-05-02 09:56:56,296 [INFO] - Loading ResNet50 model...
2025-05-02 09:56:56,647 [INFO] - Loading DenseNet121 model...
2025-05-02 09:56:56,761 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-02 09:56:56,985 [INFO] - Model vit moved to cuda
2025-05-02 09:56:57,003 [INFO] - Model efficientnet moved to cuda
2025-05-02 09:56:57,046 [INFO] - Model inception moved to cuda
2025-05-02 09:56:57,065 [INFO] - Model mobilenet moved to cuda
2025-05-02 09:56:57,089 [INFO] - Model resnet moved to cuda
2025-05-02 09:56:57,125 [INFO] - Model densenet moved to cuda
2025-05-02 09:56:57,142 [INFO] - Model student moved to cuda
2025-05-02 09:56:57,142 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-02 09:56:57,142 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-02 09:56:57,142 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-02 09:56:57,142 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-02 09:56:57,142 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-02 09:56:57,142 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-02 09:56:57,152 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-02 09:56:57,152 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-02 09:56:57,152 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-02 09:56:59,013 [INFO] - Loaded model state for vit successfully.
2025-05-02 09:56:59,023 [INFO] - Loaded model state for efficientnet successfully.
2025-05-02 09:56:59,074 [INFO] - Loaded model state for inception successfully.
2025-05-02 09:56:59,094 [INFO] - Loaded model state for mobilenet successfully.
2025-05-02 09:56:59,115 [INFO] - Loaded model state for resnet successfully.
2025-05-02 09:56:59,156 [INFO] - Loaded model state for densenet successfully.
2025-05-02 09:56:59,186 [INFO] - Loaded model state for student successfully.
2025-05-02 09:56:59,298 [INFO] - Recreated and loaded optimizer state for vit
2025-05-02 09:56:59,328 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-02 09:56:59,392 [INFO] - Recreated and loaded optimizer state for inception
2025-05-02 09:56:59,421 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-02 09:56:59,471 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-02 09:56:59,523 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-02 09:56:59,544 [INFO] - Recreated and loaded optimizer state for student
2025-05-02 09:56:59,544 [WARNING] - No scheduler info found for vit in checkpoint.
2025-05-02 09:56:59,544 [WARNING] - No scheduler info found for efficientnet in checkpoint.
2025-05-02 09:56:59,544 [WARNING] - No scheduler info found for inception in checkpoint.
2025-05-02 09:56:59,544 [WARNING] - No scheduler info found for mobilenet in checkpoint.
2025-05-02 09:56:59,544 [WARNING] - No scheduler info found for resnet in checkpoint.
2025-05-02 09:56:59,544 [WARNING] - No scheduler info found for densenet in checkpoint.
2025-05-02 09:56:59,544 [WARNING] - No scheduler info found for student in checkpoint.
2025-05-02 09:56:59,544 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-02 09:56:59,554 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-02 09:56:59,554 [INFO] - Created new scheduler for vit
2025-05-02 09:56:59,554 [INFO] - Created new scheduler for efficientnet
2025-05-02 09:56:59,554 [INFO] - Created new scheduler for inception
2025-05-02 09:56:59,554 [INFO] - Created new scheduler for mobilenet
2025-05-02 09:56:59,554 [INFO] - Created new scheduler for resnet
2025-05-02 09:56:59,554 [INFO] - Created new scheduler for densenet
2025-05-02 09:56:59,554 [INFO] - Created new scheduler for student
2025-05-02 09:56:59,554 [INFO] - Preparing data loaders...
2025-05-02 09:57:07,648 [INFO] - Training samples: 45000 per model
2025-05-02 09:57:07,648 [INFO] - Validation samples: 5000 per model
2025-05-02 09:57:07,648 [INFO] - Test samples: 10000 per model
2025-05-02 09:57:07,648 [INFO] - Skipping initialization phase.
2025-05-02 09:57:07,648 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-02 09:57:07,790 [INFO] - GPU Memory: Current=1753.94MB, Peak=1753.94MB, Reserved=1764.00MB
2025-05-02 09:57:07,790 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-02 09:57:07,790 [INFO] - Starting mutual learning phase...
2025-05-02 09:57:07,790 [INFO] - Hook registered for encoder.ln
2025-05-02 09:57:07,790 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-02 09:57:08,074 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-02 09:57:08,090 [INFO] - Hook registered for features.8
2025-05-02 09:57:08,090 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-02 09:57:08,343 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-02 09:57:08,343 [INFO] - Hook registered for inception.Mixed_7c
2025-05-02 09:57:08,359 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-02 09:57:08,802 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-02 09:57:08,809 [INFO] - Hook registered for features
2025-05-02 09:57:08,809 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-02 09:57:08,913 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-02 09:57:08,913 [INFO] - Hook registered for layer4
2025-05-02 09:57:08,913 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-02 09:57:09,070 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-02 09:57:09,070 [INFO] - Hook registered for features
2025-05-02 09:57:09,070 [INFO] - Feature extractor registered for densenet at layer features
2025-05-02 09:57:09,338 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-02 09:57:09,338 [INFO] - Hook registered for features.8
2025-05-02 09:57:09,338 [INFO] - Feature extractor registered for student at layer features.8
2025-05-02 09:57:09,354 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-02 09:57:10,364 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-02 09:57:10,364 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-02 09:57:10,371 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-02 09:57:10,371 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-02 09:57:10,375 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-02 09:57:10,375 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-02 09:57:10,385 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-02 09:57:10,388 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-02 09:57:10,388 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-02 09:57:10,388 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-02 09:57:10,395 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-02 09:57:10,395 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-02 09:57:10,405 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-02 09:57:10,405 [INFO] - HFI module initialized with 6 teachers.
2025-05-02 09:57:10,497 [INFO] - HFI initialized.
2025-05-02 09:57:10,497 [INFO] - Added HFI params to student optimizer.
2025-05-02 09:57:11,724 [INFO] - Using 3-stage scheduler for vit: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:57:11,724 [INFO] - Using 3-stage scheduler for efficientnet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:57:11,727 [INFO] - Using 3-stage scheduler for inception: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:57:11,729 [INFO] - Using 3-stage scheduler for mobilenet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:57:11,729 [INFO] - Using 3-stage scheduler for resnet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:57:11,731 [INFO] - Using 3-stage scheduler for densenet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:57:11,733 [INFO] - Using 3-stage scheduler for student: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-02 09:57:11,733 [INFO] - Added HFI parameters to the student optimizer.
2025-05-02 09:57:11,733 [INFO] - Mutual learning phase using effective batch size: 4
2025-05-02 09:57:11,733 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-02 09:57:17,007 [INFO] - Using device: cuda
2025-05-02 09:57:17,007 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 09:57:17,007 [INFO] - GPU Memory: 6.00 GB
2025-05-02 09:57:17,007 [INFO] - CUDA Version: 12.4
2025-05-02 09:57:17,007 [INFO] - cuDNN benchmark mode enabled
2025-05-02 09:57:22,243 [INFO] - Using device: cuda
2025-05-02 09:57:22,243 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 09:57:22,243 [INFO] - GPU Memory: 6.00 GB
2025-05-02 09:57:22,243 [INFO] - CUDA Version: 12.4
2025-05-02 09:57:22,243 [INFO] - cuDNN benchmark mode enabled
2025-05-02 09:57:27,494 [INFO] - Using device: cuda
2025-05-02 09:57:27,510 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 09:57:27,510 [INFO] - GPU Memory: 6.00 GB
2025-05-02 09:57:27,510 [INFO] - CUDA Version: 12.4
2025-05-02 09:57:27,510 [INFO] - cuDNN benchmark mode enabled
2025-05-02 09:57:32,822 [INFO] - Using device: cuda
2025-05-02 09:57:32,826 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 09:57:32,826 [INFO] - GPU Memory: 6.00 GB
2025-05-02 09:57:32,826 [INFO] - CUDA Version: 12.4
2025-05-02 09:57:32,826 [INFO] - cuDNN benchmark mode enabled
2025-05-02 09:57:43,100 [INFO] - GPU Memory: Current=3026.12MB, Peak=3626.35MB, Reserved=3846.00MB
2025-05-02 10:00:09,867 [INFO] - GPU Memory: Current=3026.82MB, Peak=4665.07MB, Reserved=4728.00MB
2025-05-02 10:02:37,738 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:05:05,494 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4728.00MB
2025-05-02 10:07:33,921 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:10:02,782 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4728.00MB
2025-05-02 10:12:31,629 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:15:01,385 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4728.00MB
2025-05-02 10:17:30,644 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:20:00,375 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4728.00MB
2025-05-02 10:22:30,192 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4728.00MB
2025-05-02 10:25:00,110 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:27:29,543 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:29:59,157 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:32:28,821 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4728.00MB
2025-05-02 10:34:58,039 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:37:27,788 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:39:57,446 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:42:27,834 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:44:57,348 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:47:26,499 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:49:55,862 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:52:25,170 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:54:54,678 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 10:57:23,635 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4728.00MB
2025-05-02 10:59:52,304 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 11:02:22,098 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 11:04:51,737 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4726.00MB
2025-05-02 11:07:22,302 [INFO] - GPU Memory: Current=3026.25MB, Peak=4668.08MB, Reserved=4728.00MB
2025-05-02 11:07:38,013 [INFO] - --- Mutual Epoch 1 Summary (Time: 4226.28s): Avg Loss=0.2067, Avg Acc=93.29% ---
2025-05-02 11:07:38,013 [INFO] -   vit: Loss=0.0557, Acc=98.16%, CE=0.0557, Mut=2.4313, Cal=0.0138, Feat=0.0000
2025-05-02 11:07:38,013 [INFO] -   efficientnet: Loss=0.1858, Acc=93.76%, CE=0.1858, Mut=2.0571, Cal=0.0415, Feat=0.0000
2025-05-02 11:07:38,013 [INFO] -   inception: Loss=0.1817, Acc=94.12%, CE=0.1817, Mut=4.2344, Cal=0.0399, Feat=0.0000
2025-05-02 11:07:38,013 [INFO] -   mobilenet: Loss=0.3262, Acc=89.45%, CE=0.3262, Mut=2.7791, Cal=0.0672, Feat=0.0000
2025-05-02 11:07:38,013 [INFO] -   resnet: Loss=0.2836, Acc=90.86%, CE=0.2836, Mut=2.1373, Cal=0.0579, Feat=0.0000
2025-05-02 11:07:38,013 [INFO] -   densenet: Loss=0.2274, Acc=92.99%, CE=0.2274, Mut=2.1425, Cal=0.0462, Feat=0.0000
2025-05-02 11:07:38,013 [INFO] -   student: Loss=0.1865, Acc=93.66%, CE=0.1865, Mut=2.5748, Cal=0.0425, Feat=1.0569
2025-05-02 11:07:38,013 [INFO] - --- Starting Validation for Epoch 1 ---
2025-05-02 11:07:38,013 [INFO] - Collecting validation targets...
2025-05-02 11:07:43,749 [INFO] - Using device: cuda
2025-05-02 11:07:43,749 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 11:07:43,749 [INFO] - GPU Memory: 6.00 GB
2025-05-02 11:07:43,749 [INFO] - CUDA Version: 12.4
2025-05-02 11:07:43,749 [INFO] - cuDNN benchmark mode enabled
2025-05-02 11:07:49,281 [INFO] - Using device: cuda
2025-05-02 11:07:49,281 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 11:07:49,281 [INFO] - GPU Memory: 6.00 GB
2025-05-02 11:07:49,281 [INFO] - CUDA Version: 12.4
2025-05-02 11:07:49,281 [INFO] - cuDNN benchmark mode enabled
2025-05-02 11:07:54,792 [INFO] - Using device: cuda
2025-05-02 11:07:54,792 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 11:07:54,792 [INFO] - GPU Memory: 6.00 GB
2025-05-02 11:07:54,792 [INFO] - CUDA Version: 12.4
2025-05-02 11:07:54,792 [INFO] - cuDNN benchmark mode enabled
2025-05-02 11:08:00,278 [INFO] - Using device: cuda
2025-05-02 11:08:00,294 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 11:08:00,294 [INFO] - GPU Memory: 6.00 GB
2025-05-02 11:08:00,294 [INFO] - CUDA Version: 12.4
2025-05-02 11:08:00,294 [INFO] - cuDNN benchmark mode enabled
2025-05-02 11:08:02,640 [INFO] - Collected 5000 validation targets.
2025-05-02 11:08:38,495 [INFO] -   Validation vit: Loss=0.1180, Acc=96.28%, ECE=0.0121
2025-05-02 11:08:54,478 [INFO] -   Validation efficientnet: Loss=0.1242, Acc=96.30%, ECE=0.0098
2025-05-02 11:09:15,398 [INFO] -   Validation inception: Loss=0.1881, Acc=94.18%, ECE=0.0187
2025-05-02 11:09:27,997 [INFO] -   Validation mobilenet: Loss=0.1295, Acc=96.00%, ECE=0.0139
2025-05-02 11:09:40,270 [INFO] -   Validation resnet: Loss=0.1759, Acc=93.80%, ECE=0.0149
2025-05-02 11:10:08,545 [INFO] -   Validation densenet: Loss=0.1272, Acc=95.76%, ECE=0.0087
2025-05-02 11:10:24,397 [INFO] -   Validation student: Loss=0.1564, Acc=94.66%, ECE=0.0119
2025-05-02 11:10:24,786 [INFO] - New best accuracy for vit: 96.28%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\vit_mutual_best_acc.pth
2025-05-02 11:10:24,794 [INFO] - New best ECE for vit: 0.0121.
2025-05-02 11:10:25,215 [INFO] - New best accuracy for efficientnet: 96.30%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\efficientnet_mutual_best_acc.pth
2025-05-02 11:10:25,217 [INFO] - New best ECE for efficientnet: 0.0098.
2025-05-02 11:10:25,458 [INFO] - New best accuracy for inception: 94.18%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\inception_mutual_best_acc.pth
2025-05-02 11:10:25,458 [INFO] - New best ECE for inception: 0.0187.
2025-05-02 11:10:25,662 [INFO] - New best accuracy for mobilenet: 96.00%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mobilenet_mutual_best_acc.pth
2025-05-02 11:10:25,662 [INFO] - New best ECE for mobilenet: 0.0139.
2025-05-02 11:10:25,834 [INFO] - New best accuracy for resnet: 93.80%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\resnet_mutual_best_acc.pth
2025-05-02 11:10:25,834 [INFO] - New best ECE for resnet: 0.0149.
2025-05-02 11:10:26,093 [INFO] - New best accuracy for densenet: 95.76%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\densenet_mutual_best_acc.pth
2025-05-02 11:10:26,093 [INFO] - New best ECE for densenet: 0.0087.
2025-05-02 11:10:26,267 [INFO] - New best accuracy for student: 94.66%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\student_mutual_best_acc.pth
2025-05-02 11:10:26,267 [INFO] - New best ECE for student: 0.0119.
2025-05-02 11:10:28,807 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_1.pth (Epoch 0)
2025-05-02 11:10:28,952 [INFO] - GPU Memory: Current=4213.47MB, Peak=4668.08MB, Reserved=4294.00MB
2025-05-02 11:10:28,952 [INFO] - --- Starting Mutual Learning Epoch 2/50 ---
2025-05-02 11:10:32,582 [INFO] - GPU Memory: Current=3620.49MB, Peak=5262.69MB, Reserved=5380.00MB
2025-05-02 11:13:28,828 [INFO] - GPU Memory: Current=3620.49MB, Peak=5265.40MB, Reserved=5352.00MB
2025-05-02 11:16:20,501 [INFO] - GPU Memory: Current=3620.06MB, Peak=5265.40MB, Reserved=5332.00MB
2025-05-02 11:19:03,550 [INFO] - GPU Memory: Current=3620.06MB, Peak=5265.40MB, Reserved=5352.00MB
2025-05-02 11:21:48,615 [INFO] - GPU Memory: Current=3620.06MB, Peak=5265.40MB, Reserved=5352.00MB
2025-05-02 11:24:43,752 [INFO] - GPU Memory: Current=3620.06MB, Peak=5265.40MB, Reserved=5352.00MB
2025-05-02 11:27:23,718 [INFO] - GPU Memory: Current=3620.06MB, Peak=5265.40MB, Reserved=5352.00MB
2025-05-02 11:30:07,781 [INFO] - GPU Memory: Current=3620.06MB, Peak=5265.40MB, Reserved=5352.00MB
2025-05-02 11:33:05,863 [INFO] - GPU Memory: Current=3620.06MB, Peak=5265.40MB, Reserved=5332.00MB
2025-05-02 11:35:54,029 [INFO] - GPU Memory: Current=3620.06MB, Peak=5266.01MB, Reserved=5352.00MB
2025-05-02 11:38:45,699 [INFO] - GPU Memory: Current=3620.06MB, Peak=5266.01MB, Reserved=5352.00MB
2025-05-02 11:41:29,543 [INFO] - GPU Memory: Current=3620.06MB, Peak=5266.01MB, Reserved=5352.00MB
2025-05-02 11:44:20,472 [INFO] - GPU Memory: Current=3620.33MB, Peak=5266.01MB, Reserved=5356.00MB
2025-05-02 11:47:00,144 [INFO] - GPU Memory: Current=3620.07MB, Peak=5266.01MB, Reserved=5352.00MB
2025-05-02 11:49:51,640 [INFO] - GPU Memory: Current=3620.32MB, Peak=5266.01MB, Reserved=5356.00MB
2025-05-02 11:52:40,668 [INFO] - GPU Memory: Current=3620.19MB, Peak=5266.01MB, Reserved=5352.00MB
2025-05-02 11:55:25,413 [INFO] - GPU Memory: Current=3620.32MB, Peak=5266.01MB, Reserved=5356.00MB
2025-05-02 11:58:12,317 [INFO] - GPU Memory: Current=3620.32MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 12:01:00,492 [INFO] - GPU Memory: Current=3620.32MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 12:03:49,990 [INFO] - GPU Memory: Current=3620.13MB, Peak=5269.40MB, Reserved=5372.00MB
2025-05-02 12:06:37,580 [INFO] - GPU Memory: Current=3620.06MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 12:09:28,294 [INFO] - GPU Memory: Current=3620.32MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 12:12:12,424 [INFO] - GPU Memory: Current=3620.13MB, Peak=5269.40MB, Reserved=5372.00MB
2025-05-02 12:15:09,098 [INFO] - GPU Memory: Current=3620.06MB, Peak=5269.40MB, Reserved=5348.00MB
2025-05-02 12:17:58,296 [INFO] - GPU Memory: Current=3620.13MB, Peak=5269.40MB, Reserved=5332.00MB
2025-05-02 12:20:50,722 [INFO] - GPU Memory: Current=3620.50MB, Peak=5269.40MB, Reserved=5344.00MB
2025-05-02 12:23:35,794 [INFO] - GPU Memory: Current=3620.32MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 12:26:21,244 [INFO] - GPU Memory: Current=3620.32MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 12:29:16,204 [INFO] - GPU Memory: Current=3620.90MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 12:29:32,755 [INFO] - --- Mutual Epoch 2 Summary (Time: 4743.80s): Avg Loss=0.4241, Avg Acc=86.20% ---
2025-05-02 12:29:32,755 [INFO] -   vit: Loss=0.3107, Acc=89.78%, CE=0.3107, Mut=2.7066, Cal=0.0674, Feat=0.0000
2025-05-02 12:29:32,755 [INFO] -   efficientnet: Loss=0.3093, Acc=89.53%, CE=0.3093, Mut=2.6301, Cal=0.0662, Feat=0.0000
2025-05-02 12:29:32,755 [INFO] -   inception: Loss=0.4546, Acc=85.50%, CE=0.4546, Mut=4.3276, Cal=0.0900, Feat=0.0000
2025-05-02 12:29:32,755 [INFO] -   mobilenet: Loss=0.4877, Acc=84.03%, CE=0.4877, Mut=2.7519, Cal=0.0966, Feat=0.0000
2025-05-02 12:29:32,755 [INFO] -   resnet: Loss=0.7091, Acc=77.01%, CE=0.7091, Mut=2.9044, Cal=0.1289, Feat=0.0000
2025-05-02 12:29:32,755 [INFO] -   densenet: Loss=0.5140, Acc=83.75%, CE=0.5140, Mut=2.6297, Cal=0.0968, Feat=0.0000
2025-05-02 12:29:32,755 [INFO] -   student: Loss=0.1830, Acc=93.81%, CE=0.1830, Mut=3.9910, Cal=0.0415, Feat=1.0532
2025-05-02 12:29:32,755 [INFO] - --- Starting Validation for Epoch 2 ---
2025-05-02 12:29:32,755 [INFO] - Collecting validation targets...
2025-05-02 12:29:35,104 [INFO] - Collected 5000 validation targets.
2025-05-02 12:30:12,657 [INFO] -   Validation vit: Loss=0.3124, Acc=89.40%, ECE=0.0084
2025-05-02 12:30:28,345 [INFO] -   Validation efficientnet: Loss=0.2105, Acc=93.74%, ECE=0.0183
2025-05-02 12:30:48,605 [INFO] -   Validation inception: Loss=0.4076, Acc=87.66%, ECE=0.0395
2025-05-02 12:31:00,987 [INFO] -   Validation mobilenet: Loss=0.3065, Acc=90.70%, ECE=0.0322
2025-05-02 12:31:12,895 [INFO] -   Validation resnet: Loss=0.5171, Acc=83.18%, ECE=0.0403
2025-05-02 12:31:40,412 [INFO] -   Validation densenet: Loss=0.3177, Acc=89.72%, ECE=0.0276
2025-05-02 12:31:55,996 [INFO] -   Validation student: Loss=0.1521, Acc=94.90%, ECE=0.0119
2025-05-02 12:31:56,004 [INFO] - New best ECE for vit: 0.0084.
2025-05-02 12:31:56,400 [INFO] - New best accuracy for student: 94.90%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\student_mutual_best_acc.pth
2025-05-02 12:31:56,400 [INFO] - New best ECE for student: 0.0119.
2025-05-02 12:31:58,547 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_2.pth (Epoch 1)
2025-05-02 12:31:58,681 [INFO] - GPU Memory: Current=4214.21MB, Peak=5269.40MB, Reserved=4572.00MB
2025-05-02 12:31:58,681 [INFO] - --- Starting Mutual Learning Epoch 3/50 ---
2025-05-02 12:32:01,752 [INFO] - GPU Memory: Current=3620.20MB, Peak=5269.40MB, Reserved=5338.00MB
2025-05-02 12:34:48,990 [INFO] - GPU Memory: Current=3620.20MB, Peak=5269.40MB, Reserved=5358.00MB
2025-05-02 12:37:27,681 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 12:40:06,843 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 12:42:46,276 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5338.00MB
2025-05-02 12:45:26,445 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 12:48:10,528 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 12:51:04,883 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 12:53:50,434 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 12:56:25,976 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 12:59:03,338 [INFO] - GPU Memory: Current=3620.45MB, Peak=5269.40MB, Reserved=5334.00MB
2025-05-02 13:01:36,475 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 13:04:14,975 [INFO] - GPU Memory: Current=3620.45MB, Peak=5269.40MB, Reserved=5334.00MB
2025-05-02 13:06:51,268 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5338.00MB
2025-05-02 13:09:39,365 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5338.00MB
2025-05-02 13:12:24,362 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 13:15:07,418 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 13:17:52,451 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 13:20:51,251 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 13:23:23,111 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 13:26:03,156 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 13:28:44,183 [INFO] - GPU Memory: Current=3620.45MB, Peak=5269.40MB, Reserved=5334.00MB
2025-05-02 13:31:37,927 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5338.00MB
2025-05-02 13:34:12,503 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5338.00MB
2025-05-02 13:36:47,710 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 13:39:34,553 [INFO] - GPU Memory: Current=3620.45MB, Peak=5269.40MB, Reserved=5334.00MB
2025-05-02 13:42:07,213 [INFO] - GPU Memory: Current=3620.45MB, Peak=5269.40MB, Reserved=5334.00MB
2025-05-02 13:44:43,127 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 13:47:20,572 [INFO] - GPU Memory: Current=3619.95MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 13:47:36,754 [INFO] - --- Mutual Epoch 3 Summary (Time: 4538.07s): Avg Loss=0.6954, Avg Acc=77.34% ---
2025-05-02 13:47:36,758 [INFO] -   vit: Loss=0.5959, Acc=79.99%, CE=0.5959, Mut=2.8989, Cal=0.1183, Feat=0.0000
2025-05-02 13:47:36,758 [INFO] -   efficientnet: Loss=0.5575, Acc=81.60%, CE=0.5575, Mut=2.9640, Cal=0.1099, Feat=0.0000
2025-05-02 13:47:36,758 [INFO] -   inception: Loss=0.8243, Acc=73.88%, CE=0.8243, Mut=4.8633, Cal=0.1460, Feat=0.0000
2025-05-02 13:47:36,758 [INFO] -   mobilenet: Loss=0.7972, Acc=74.18%, CE=0.7972, Mut=3.0506, Cal=0.1450, Feat=0.0000
2025-05-02 13:47:36,758 [INFO] -   resnet: Loss=1.0528, Acc=65.06%, CE=1.0528, Mut=3.1165, Cal=0.1756, Feat=0.0000
2025-05-02 13:47:36,758 [INFO] -   densenet: Loss=0.8590, Acc=72.86%, CE=0.8590, Mut=2.9106, Cal=0.1487, Feat=0.0000
2025-05-02 13:47:36,758 [INFO] -   student: Loss=0.1809, Acc=93.82%, CE=0.1809, Mut=5.3926, Cal=0.0410, Feat=1.0457
2025-05-02 13:47:36,758 [INFO] - --- Starting Validation for Epoch 3 ---
2025-05-02 13:47:36,764 [INFO] - Collecting validation targets...
2025-05-02 13:47:39,083 [INFO] - Collected 5000 validation targets.
2025-05-02 13:48:17,301 [INFO] -   Validation vit: Loss=0.7554, Acc=74.78%, ECE=0.0331
2025-05-02 13:48:32,868 [INFO] -   Validation efficientnet: Loss=0.3629, Acc=88.78%, ECE=0.0272
2025-05-02 13:48:53,434 [INFO] -   Validation inception: Loss=0.6526, Acc=79.80%, ECE=0.0443
2025-05-02 13:49:05,889 [INFO] -   Validation mobilenet: Loss=0.5495, Acc=83.82%, ECE=0.0554
2025-05-02 13:49:17,755 [INFO] -   Validation resnet: Loss=1.3550, Acc=73.88%, ECE=0.0701
2025-05-02 13:49:45,298 [INFO] -   Validation densenet: Loss=0.4835, Acc=84.08%, ECE=0.0348
2025-05-02 13:50:00,806 [INFO] -   Validation student: Loss=0.1543, Acc=94.60%, ECE=0.0133
2025-05-02 13:50:02,880 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_3.pth (Epoch 2)
2025-05-02 13:50:03,028 [INFO] - GPU Memory: Current=4212.78MB, Peak=5269.40MB, Reserved=4614.00MB
2025-05-02 13:50:03,028 [INFO] - --- Starting Mutual Learning Epoch 4/50 ---
2025-05-02 13:50:06,238 [INFO] - GPU Memory: Current=3619.83MB, Peak=5269.40MB, Reserved=5358.00MB
2025-05-02 13:52:43,611 [INFO] - GPU Memory: Current=3620.26MB, Peak=5269.40MB, Reserved=5334.00MB
2025-05-02 13:55:25,254 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5372.00MB
2025-05-02 13:58:15,533 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 14:01:10,520 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 14:03:53,621 [INFO] - GPU Memory: Current=3620.26MB, Peak=5269.40MB, Reserved=5334.00MB
2025-05-02 14:06:36,677 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 14:09:18,417 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 14:12:04,804 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 14:14:45,706 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 14:17:30,399 [INFO] - GPU Memory: Current=3620.26MB, Peak=5269.40MB, Reserved=5334.00MB
2025-05-02 14:20:11,698 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 14:22:55,642 [INFO] - GPU Memory: Current=3620.26MB, Peak=5269.40MB, Reserved=5334.00MB
2025-05-02 14:25:35,593 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5338.00MB
2025-05-02 14:28:18,242 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 14:30:59,543 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 14:33:40,582 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 14:36:28,028 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 14:39:12,889 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 14:41:59,010 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 14:44:52,999 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5338.00MB
2025-05-02 14:47:39,817 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5338.00MB
2025-05-02 14:50:25,392 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5374.00MB
2025-05-02 14:53:18,641 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 14:55:56,950 [INFO] - GPU Memory: Current=3620.26MB, Peak=5269.40MB, Reserved=5334.00MB
2025-05-02 14:58:43,278 [INFO] - GPU Memory: Current=3620.26MB, Peak=5269.40MB, Reserved=5370.00MB
2025-05-02 15:01:22,268 [INFO] - GPU Memory: Current=3620.01MB, Peak=5269.40MB, Reserved=5338.00MB
2025-05-02 15:04:05,513 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5338.00MB
2025-05-02 15:06:46,991 [INFO] - GPU Memory: Current=3619.76MB, Peak=5269.40MB, Reserved=5338.00MB
2025-05-02 15:07:03,539 [INFO] - --- Mutual Epoch 4 Summary (Time: 4620.51s): Avg Loss=0.8299, Avg Acc=72.84% ---
2025-05-02 15:07:03,539 [INFO] -   vit: Loss=0.7957, Acc=73.33%, CE=0.7957, Mut=2.9728, Cal=0.1500, Feat=0.0000
2025-05-02 15:07:03,539 [INFO] -   efficientnet: Loss=0.7084, Acc=76.82%, CE=0.7084, Mut=2.8992, Cal=0.1330, Feat=0.0000
2025-05-02 15:07:03,539 [INFO] -   inception: Loss=1.0178, Acc=67.21%, CE=1.0178, Mut=4.8758, Cal=0.1697, Feat=0.0000
2025-05-02 15:07:03,539 [INFO] -   mobilenet: Loss=0.9897, Acc=68.10%, CE=0.9897, Mut=3.0843, Cal=0.1678, Feat=0.0000
2025-05-02 15:07:03,539 [INFO] -   resnet: Loss=1.1580, Acc=61.39%, CE=1.1580, Mut=3.0344, Cal=0.1882, Feat=0.0000
2025-05-02 15:07:03,539 [INFO] -   densenet: Loss=0.9663, Acc=68.92%, CE=0.9663, Mut=2.8431, Cal=0.1620, Feat=0.0000
2025-05-02 15:07:03,539 [INFO] -   student: Loss=0.1734, Acc=94.14%, CE=0.1734, Mut=6.0447, Cal=0.0393, Feat=1.0385
2025-05-02 15:07:03,539 [INFO] - --- Starting Validation for Epoch 4 ---
2025-05-02 15:07:03,539 [INFO] - Collecting validation targets...
2025-05-02 15:07:05,861 [INFO] - Collected 5000 validation targets.
2025-05-02 15:07:43,860 [INFO] -   Validation vit: Loss=0.8780, Acc=69.70%, ECE=0.0385
2025-05-02 15:07:59,344 [INFO] -   Validation efficientnet: Loss=0.5907, Acc=82.02%, ECE=0.0663
2025-05-02 15:08:19,382 [INFO] -   Validation inception: Loss=0.8153, Acc=75.14%, ECE=0.0605
2025-05-02 15:08:31,471 [INFO] -   Validation mobilenet: Loss=0.6694, Acc=77.86%, ECE=0.0563
2025-05-02 15:08:43,170 [INFO] -   Validation resnet: Loss=0.8571, Acc=70.94%, ECE=0.0435
2025-05-02 15:09:09,984 [INFO] -   Validation densenet: Loss=0.8003, Acc=74.80%, ECE=0.0731
2025-05-02 15:09:25,708 [INFO] -   Validation student: Loss=0.1467, Acc=94.96%, ECE=0.0116
2025-05-02 15:09:25,802 [INFO] - New best accuracy for student: 94.96%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\student_mutual_best_acc.pth
2025-05-02 15:09:25,802 [INFO] - New best ECE for student: 0.0116.
2025-05-02 15:09:27,969 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_4.pth (Epoch 3)
2025-05-02 15:09:28,121 [INFO] - GPU Memory: Current=4214.37MB, Peak=5269.40MB, Reserved=4568.00MB
2025-05-02 15:09:28,122 [INFO] - --- Starting Mutual Learning Epoch 5/50 ---
2025-05-02 15:09:31,873 [INFO] - GPU Memory: Current=3619.54MB, Peak=5269.40MB, Reserved=5358.00MB
2025-05-02 15:12:17,575 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 15:15:11,134 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:17:51,502 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:20:27,868 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:23:02,405 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:25:37,912 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:28:15,157 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:30:50,909 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:33:25,929 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:36:02,173 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:38:38,463 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:41:14,067 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:43:50,960 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:46:27,287 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:49:01,886 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:51:38,648 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:54:19,431 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:56:57,503 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 15:59:33,417 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 16:02:15,125 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 16:04:55,928 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 16:07:32,825 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 16:10:17,317 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 16:12:53,958 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 16:15:30,916 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 16:18:09,211 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 16:20:45,901 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 16:23:21,753 [INFO] - GPU Memory: Current=3619.67MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 16:23:38,460 [INFO] - --- Mutual Epoch 5 Summary (Time: 4450.34s): Avg Loss=0.9226, Avg Acc=69.37% ---
2025-05-02 16:23:38,460 [INFO] -   vit: Loss=0.9947, Acc=66.10%, CE=0.9947, Mut=3.0634, Cal=0.1759, Feat=0.0000
2025-05-02 16:23:38,460 [INFO] -   efficientnet: Loss=0.7921, Acc=73.69%, CE=0.7921, Mut=2.8466, Cal=0.1459, Feat=0.0000
2025-05-02 16:23:38,460 [INFO] -   inception: Loss=1.1385, Acc=62.55%, CE=1.1385, Mut=4.8523, Cal=0.1826, Feat=0.0000
2025-05-02 16:23:38,460 [INFO] -   mobilenet: Loss=1.1325, Acc=63.50%, CE=1.1325, Mut=3.1080, Cal=0.1833, Feat=0.0000
2025-05-02 16:23:38,460 [INFO] -   resnet: Loss=1.1563, Acc=60.60%, CE=1.1563, Mut=2.8550, Cal=0.1885, Feat=0.0000
2025-05-02 16:23:38,460 [INFO] -   densenet: Loss=1.0760, Acc=64.86%, CE=1.0760, Mut=2.8453, Cal=0.1753, Feat=0.0000
2025-05-02 16:23:38,471 [INFO] -   student: Loss=0.1684, Acc=94.32%, CE=0.1684, Mut=6.4362, Cal=0.0384, Feat=1.0302
2025-05-02 16:23:38,471 [INFO] - --- Starting Validation for Epoch 5 ---
2025-05-02 16:23:38,471 [INFO] - Collecting validation targets...
2025-05-02 16:23:40,798 [INFO] - Collected 5000 validation targets.
2025-05-02 16:24:22,211 [INFO] -   Validation vit: Loss=0.8472, Acc=71.76%, ECE=0.0193
2025-05-02 16:24:38,072 [INFO] -   Validation efficientnet: Loss=0.6222, Acc=82.28%, ECE=0.0653
2025-05-02 16:24:58,753 [INFO] -   Validation inception: Loss=0.7755, Acc=76.58%, ECE=0.0632
2025-05-02 16:25:11,307 [INFO] -   Validation mobilenet: Loss=0.7483, Acc=77.86%, ECE=0.0785
2025-05-02 16:25:23,302 [INFO] -   Validation resnet: Loss=0.8108, Acc=73.10%, ECE=0.0263
2025-05-02 16:25:50,731 [INFO] -   Validation densenet: Loss=0.6037, Acc=80.44%, ECE=0.0347
2025-05-02 16:26:06,423 [INFO] -   Validation student: Loss=0.1400, Acc=94.98%, ECE=0.0117
2025-05-02 16:26:06,528 [INFO] - New best accuracy for student: 94.98%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\student_mutual_best_acc.pth
2025-05-02 16:26:08,645 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_5.pth (Epoch 4)
2025-05-02 16:26:08,787 [INFO] - GPU Memory: Current=4213.55MB, Peak=5269.40MB, Reserved=4634.00MB
2025-05-02 16:26:08,787 [INFO] - --- Starting Mutual Learning Epoch 6/50 ---
2025-05-02 16:26:12,240 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5364.00MB
2025-05-02 16:28:50,643 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 16:31:36,281 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 16:34:19,045 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5332.00MB
2025-05-02 16:37:07,488 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5358.00MB
2025-05-02 16:39:47,195 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 16:42:20,962 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 16:44:58,464 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 16:47:39,441 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 16:50:25,338 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 16:53:14,580 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 16:55:59,891 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5358.00MB
2025-05-02 16:58:44,651 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 17:01:27,246 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5358.00MB
2025-05-02 17:04:04,614 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 17:06:43,823 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 17:09:24,164 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 17:12:03,700 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 17:14:37,880 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 17:17:12,981 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 17:19:49,834 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 17:22:25,938 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 17:25:04,394 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 17:27:43,196 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 17:30:29,459 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 17:33:11,913 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 17:35:55,005 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 17:38:34,928 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 17:41:19,890 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 17:41:37,505 [INFO] - --- Mutual Epoch 6 Summary (Time: 4528.72s): Avg Loss=1.2371, Avg Acc=58.21% ---
2025-05-02 17:41:37,505 [INFO] -   vit: Loss=1.1019, Acc=61.84%, CE=1.0956, Mut=1.6271, Cal=0.1863, Feat=0.0000
2025-05-02 17:41:37,508 [INFO] -   efficientnet: Loss=0.8728, Acc=71.18%, CE=0.8606, Mut=1.9239, Cal=0.1549, Feat=0.0000
2025-05-02 17:41:37,508 [INFO] -   inception: Loss=1.1985, Acc=60.93%, CE=1.1882, Mut=2.0750, Cal=0.1882, Feat=0.0000
2025-05-02 17:41:37,508 [INFO] -   mobilenet: Loss=1.1861, Acc=61.81%, CE=1.1784, Mut=1.8311, Cal=0.1872, Feat=0.0000
2025-05-02 17:41:37,508 [INFO] -   resnet: Loss=1.1156, Acc=61.94%, CE=1.1131, Mut=1.3040, Cal=0.1843, Feat=0.0000
2025-05-02 17:41:37,508 [INFO] -   densenet: Loss=1.1307, Acc=63.36%, CE=1.1251, Mut=1.5887, Cal=0.1802, Feat=0.0000
2025-05-02 17:41:37,508 [INFO] -   student: Loss=2.0539, Acc=26.36%, CE=2.0609, Mut=1.3747, Cal=0.1924, Feat=0.7745
2025-05-02 17:41:37,508 [INFO] - --- Starting Validation for Epoch 6 ---
2025-05-02 17:41:37,508 [INFO] - Collecting validation targets...
2025-05-02 17:41:39,853 [INFO] - Collected 5000 validation targets.
2025-05-02 17:42:22,734 [INFO] -   Validation vit: Loss=0.9380, Acc=67.48%, ECE=0.0195
2025-05-02 17:42:38,625 [INFO] -   Validation efficientnet: Loss=0.5568, Acc=81.82%, ECE=0.0431
2025-05-02 17:42:59,437 [INFO] -   Validation inception: Loss=0.8160, Acc=72.34%, ECE=0.0423
2025-05-02 17:43:11,968 [INFO] -   Validation mobilenet: Loss=0.8184, Acc=75.88%, ECE=0.0968
2025-05-02 17:43:23,989 [INFO] -   Validation resnet: Loss=0.9601, Acc=68.04%, ECE=0.0683
2025-05-02 17:43:51,825 [INFO] -   Validation densenet: Loss=0.7780, Acc=75.50%, ECE=0.0578
2025-05-02 17:44:07,614 [INFO] -   Validation student: Loss=1.7026, Acc=42.04%, ECE=0.0523
2025-05-02 17:44:07,619 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 17:44:07,619 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-02 17:44:07,630 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 17:44:07,630 [INFO] - Model resnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 17:44:07,630 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 17:44:09,788 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_6.pth (Epoch 5)
2025-05-02 17:44:09,923 [INFO] - GPU Memory: Current=4217.98MB, Peak=5269.40MB, Reserved=4576.00MB
2025-05-02 17:44:09,923 [INFO] - --- Starting Mutual Learning Epoch 7/50 ---
2025-05-02 17:44:13,150 [INFO] - GPU Memory: Current=3620.04MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 17:47:00,923 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 17:49:43,161 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 17:52:25,268 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 17:55:09,627 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 17:57:51,494 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:00:39,048 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:03:21,983 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:05:56,247 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:08:36,031 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:11:15,473 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:13:50,503 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:16:24,800 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:18:56,707 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:21:33,316 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:24:11,028 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:26:52,443 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:29:39,998 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:32:22,691 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:34:58,118 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 18:37:30,942 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:40:03,112 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:42:36,928 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:45:10,019 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:47:43,110 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:50:17,603 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:52:53,736 [INFO] - GPU Memory: Current=3620.04MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 18:55:24,884 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:57:54,432 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 18:58:12,288 [INFO] - --- Mutual Epoch 7 Summary (Time: 4442.37s): Avg Loss=1.1142, Avg Acc=62.38% ---
2025-05-02 18:58:12,288 [INFO] -   vit: Loss=1.0456, Acc=63.81%, CE=1.0341, Mut=1.5175, Cal=0.1826, Feat=0.0000
2025-05-02 18:58:12,288 [INFO] -   efficientnet: Loss=0.8361, Acc=72.83%, CE=0.8176, Mut=1.6199, Cal=0.1475, Feat=0.0000
2025-05-02 18:58:12,288 [INFO] -   inception: Loss=1.1051, Acc=64.10%, CE=1.0864, Mut=1.8919, Cal=0.1780, Feat=0.0000
2025-05-02 18:58:12,288 [INFO] -   mobilenet: Loss=1.0882, Acc=64.77%, CE=1.0769, Mut=1.5517, Cal=0.1776, Feat=0.0000
2025-05-02 18:58:12,288 [INFO] -   resnet: Loss=1.0174, Acc=65.36%, CE=1.0132, Mut=1.1704, Cal=0.1722, Feat=0.0000
2025-05-02 18:58:12,288 [INFO] -   densenet: Loss=1.0083, Acc=67.42%, CE=0.9992, Mut=1.3795, Cal=0.1648, Feat=0.0000
2025-05-02 18:58:12,288 [INFO] -   student: Loss=1.6984, Acc=38.36%, CE=1.7119, Mut=1.0430, Cal=0.2114, Feat=0.9424
2025-05-02 18:58:12,288 [INFO] - --- Starting Validation for Epoch 7 ---
2025-05-02 18:58:12,298 [INFO] - Collecting validation targets...
2025-05-02 18:58:14,537 [INFO] - Collected 5000 validation targets.
2025-05-02 18:58:52,605 [INFO] -   Validation vit: Loss=0.8822, Acc=68.76%, ECE=0.0187
2025-05-02 18:59:08,078 [INFO] -   Validation efficientnet: Loss=0.6143, Acc=79.74%, ECE=0.0551
2025-05-02 18:59:28,588 [INFO] -   Validation inception: Loss=0.8322, Acc=73.28%, ECE=0.0534
2025-05-02 18:59:40,924 [INFO] -   Validation mobilenet: Loss=0.7658, Acc=75.68%, ECE=0.0677
2025-05-02 18:59:52,758 [INFO] -   Validation resnet: Loss=0.9759, Acc=68.92%, ECE=0.0890
2025-05-02 19:00:19,845 [INFO] -   Validation densenet: Loss=0.7010, Acc=76.70%, ECE=0.0523
2025-05-02 19:00:35,125 [INFO] -   Validation student: Loss=1.3389, Acc=50.56%, ECE=0.0561
2025-05-02 19:00:35,139 [INFO] - Model vit triggered early stopping based on calibration patience (5 epochs).
2025-05-02 19:00:35,139 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 19:00:35,141 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-02 19:00:35,141 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 19:00:35,141 [INFO] - Model resnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 19:00:35,141 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 19:00:37,423 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_7.pth (Epoch 6)
2025-05-02 19:00:37,566 [INFO] - GPU Memory: Current=4214.57MB, Peak=5269.40MB, Reserved=4584.00MB
2025-05-02 19:00:37,577 [INFO] - --- Starting Mutual Learning Epoch 8/50 ---
2025-05-02 19:00:41,317 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5384.00MB
2025-05-02 19:03:20,339 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:06:01,916 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:08:40,359 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:11:18,779 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 19:14:00,044 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:16:32,462 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:19:05,866 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:21:40,360 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:24:11,491 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:26:43,559 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 19:29:15,584 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:31:52,064 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:34:21,759 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:36:50,976 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:39:24,234 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 19:41:55,136 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:44:26,241 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:47:05,904 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:49:36,273 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:52:08,266 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:54:40,173 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:57:13,288 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 19:59:45,926 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:02:19,544 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 20:04:50,888 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:07:24,987 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:09:56,956 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:12:28,047 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:12:43,576 [INFO] - --- Mutual Epoch 8 Summary (Time: 4326.00s): Avg Loss=1.0587, Avg Acc=64.21% ---
2025-05-02 20:12:43,586 [INFO] -   vit: Loss=1.0278, Acc=64.67%, CE=1.0124, Mut=1.4380, Cal=0.1788, Feat=0.0000
2025-05-02 20:12:43,586 [INFO] -   efficientnet: Loss=0.8037, Acc=73.76%, CE=0.7804, Mut=1.4495, Cal=0.1433, Feat=0.0000
2025-05-02 20:12:43,586 [INFO] -   inception: Loss=1.0742, Acc=64.98%, CE=1.0484, Mut=1.7873, Cal=0.1735, Feat=0.0000
2025-05-02 20:12:43,586 [INFO] -   mobilenet: Loss=1.0421, Acc=65.96%, CE=1.0277, Mut=1.4260, Cal=0.1728, Feat=0.0000
2025-05-02 20:12:43,586 [INFO] -   resnet: Loss=0.9498, Acc=67.87%, CE=0.9443, Mut=1.0758, Cal=0.1672, Feat=0.0000
2025-05-02 20:12:43,586 [INFO] -   densenet: Loss=0.9719, Acc=68.29%, CE=0.9598, Mut=1.2898, Cal=0.1615, Feat=0.0000
2025-05-02 20:12:43,586 [INFO] -   student: Loss=1.5417, Acc=43.95%, CE=1.5603, Mut=0.9402, Cal=0.2078, Feat=1.0205
2025-05-02 20:12:43,586 [INFO] - --- Starting Validation for Epoch 8 ---
2025-05-02 20:12:43,586 [INFO] - Collecting validation targets...
2025-05-02 20:12:45,816 [INFO] - Collected 5000 validation targets.
2025-05-02 20:13:22,820 [INFO] -   Validation vit: Loss=0.9106, Acc=68.60%, ECE=0.0340
2025-05-02 20:13:38,236 [INFO] -   Validation efficientnet: Loss=0.5561, Acc=82.20%, ECE=0.0508
2025-05-02 20:13:58,512 [INFO] -   Validation inception: Loss=1.0098, Acc=68.36%, ECE=0.1009
2025-05-02 20:14:10,749 [INFO] -   Validation mobilenet: Loss=0.9284, Acc=71.04%, ECE=0.0779
2025-05-02 20:14:22,529 [INFO] -   Validation resnet: Loss=0.7796, Acc=73.32%, ECE=0.0418
2025-05-02 20:14:49,624 [INFO] -   Validation densenet: Loss=0.8166, Acc=72.86%, ECE=0.0656
2025-05-02 20:15:04,928 [INFO] -   Validation student: Loss=1.2634, Acc=53.32%, ECE=0.0646
2025-05-02 20:15:04,938 [INFO] - Model vit triggered early stopping based on calibration patience (5 epochs).
2025-05-02 20:15:04,938 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 20:15:04,938 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-02 20:15:04,938 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 20:15:04,938 [INFO] - Model resnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 20:15:04,938 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 20:15:07,449 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_8.pth (Epoch 7)
2025-05-02 20:15:07,594 [INFO] - GPU Memory: Current=4214.57MB, Peak=5269.40MB, Reserved=4572.00MB
2025-05-02 20:15:07,594 [INFO] - --- Starting Mutual Learning Epoch 9/50 ---
2025-05-02 20:15:11,021 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5386.00MB
2025-05-02 20:17:49,476 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:20:24,437 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:23:00,036 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:25:48,677 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:28:20,918 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:30:51,704 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:33:21,103 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:35:50,433 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:38:26,380 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:40:57,552 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:43:33,724 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:46:05,056 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:48:38,841 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 20:51:11,844 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5354.00MB
2025-05-02 20:53:44,779 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:56:21,433 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 20:59:01,781 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 21:01:36,155 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 21:04:10,383 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 21:06:46,238 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 21:09:19,499 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 21:11:51,935 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 21:14:26,516 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 21:16:59,095 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5352.00MB
2025-05-02 21:19:32,905 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 21:22:05,209 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 21:24:36,356 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 21:27:06,645 [INFO] - GPU Memory: Current=3619.97MB, Peak=5269.40MB, Reserved=5356.00MB
2025-05-02 21:27:22,433 [INFO] - --- Mutual Epoch 9 Summary (Time: 4334.84s): Avg Loss=1.0007, Avg Acc=66.36% ---
2025-05-02 21:27:22,433 [INFO] -   vit: Loss=0.9974, Acc=65.66%, CE=0.9773, Mut=1.3925, Cal=0.1761, Feat=0.0000
2025-05-02 21:27:22,433 [INFO] -   efficientnet: Loss=0.7599, Acc=75.60%, CE=0.7313, Mut=1.3481, Cal=0.1365, Feat=0.0000
2025-05-02 21:27:22,433 [INFO] -   inception: Loss=1.0161, Acc=67.22%, CE=0.9822, Mut=1.7114, Cal=0.1667, Feat=0.0000
2025-05-02 21:27:22,433 [INFO] -   mobilenet: Loss=1.0028, Acc=67.47%, CE=0.9862, Mut=1.3251, Cal=0.1675, Feat=0.0000
2025-05-02 21:27:22,433 [INFO] -   resnet: Loss=0.9046, Acc=69.13%, CE=0.8973, Mut=1.0305, Cal=0.1602, Feat=0.0000
2025-05-02 21:27:22,433 [INFO] -   densenet: Loss=0.9146, Acc=70.30%, CE=0.8989, Mut=1.2210, Cal=0.1540, Feat=0.0000
2025-05-02 21:27:22,433 [INFO] -   student: Loss=1.4097, Acc=49.17%, CE=1.4308, Mut=0.8943, Cal=0.2061, Feat=1.0393
2025-05-02 21:27:22,433 [INFO] - --- Starting Validation for Epoch 9 ---
2025-05-02 21:27:22,433 [INFO] - Collecting validation targets...
2025-05-02 21:27:24,694 [INFO] - Collected 5000 validation targets.
2025-05-02 21:28:01,960 [INFO] -   Validation vit: Loss=0.8448, Acc=70.70%, ECE=0.0223
2025-05-02 21:28:17,567 [INFO] -   Validation efficientnet: Loss=0.5558, Acc=81.82%, ECE=0.0255
2025-05-02 21:28:37,838 [INFO] -   Validation inception: Loss=0.7390, Acc=75.36%, ECE=0.0393
2025-05-02 21:28:50,004 [INFO] -   Validation mobilenet: Loss=0.7885, Acc=74.32%, ECE=0.0664
2025-05-02 21:29:01,848 [INFO] -   Validation resnet: Loss=0.7597, Acc=74.32%, ECE=0.0406
2025-05-02 21:29:28,690 [INFO] -   Validation densenet: Loss=0.7177, Acc=76.32%, ECE=0.0680
2025-05-02 21:29:44,124 [INFO] -   Validation student: Loss=1.1186, Acc=59.54%, ECE=0.0212
2025-05-02 21:29:44,134 [INFO] - Model vit triggered early stopping based on calibration patience (5 epochs).
2025-05-02 21:29:44,134 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 21:29:44,134 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-02 21:29:44,134 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 21:29:44,144 [INFO] - Model resnet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 21:29:44,144 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-02 21:29:44,144 [INFO] - Model student triggered early stopping based on calibration patience (5 epochs).
2025-05-02 21:29:46,274 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_9.pth (Epoch 8)
2025-05-02 21:29:46,274 [INFO] - All models met early stopping criteria at epoch 9. Stopping training.
2025-05-02 21:29:46,274 [INFO] - Restoring best model states based on validation accuracy...
2025-05-02 21:29:46,285 [INFO] - Restored best state for vit from epoch 1 (Acc: 96.28%)
2025-05-02 21:29:46,295 [INFO] - Restored best state for efficientnet from epoch 1 (Acc: 96.30%)
2025-05-02 21:29:46,318 [INFO] - Restored best state for inception from epoch 1 (Acc: 94.18%)
2025-05-02 21:29:46,325 [INFO] - Restored best state for mobilenet from epoch 1 (Acc: 96.00%)
2025-05-02 21:29:46,336 [INFO] - Restored best state for resnet from epoch 1 (Acc: 93.80%)
2025-05-02 21:29:46,356 [INFO] - Restored best state for densenet from epoch 1 (Acc: 95.76%)
2025-05-02 21:29:46,377 [INFO] - Restored best state for student from epoch 5 (Acc: 94.98%)
2025-05-02 21:29:46,377 [INFO] - Saving final (best) model states...
2025-05-02 21:30:24,267 [INFO] - Final best model for vit saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\vit_mutual_final_best.pth
2025-05-02 21:30:24,494 [INFO] - Final best model for efficientnet saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\efficientnet_mutual_final_best.pth
2025-05-02 21:30:24,694 [INFO] - Final best model for inception saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\inception_mutual_final_best.pth
2025-05-02 21:30:24,742 [INFO] - Final best model for mobilenet saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mobilenet_mutual_final_best.pth
2025-05-02 21:30:24,886 [INFO] - Final best model for resnet saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\resnet_mutual_final_best.pth
2025-05-02 21:30:25,013 [INFO] - Final best model for densenet saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\densenet_mutual_final_best.pth
2025-05-02 21:30:25,060 [INFO] - Final best model for student saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\student_mutual_final_best.pth
2025-05-02 21:30:25,060 [INFO] - Training history saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250502_095711_history.json
2025-05-02 21:30:25,076 [INFO] - Mutual learning phase completed
2025-05-02 21:30:27,950 [INFO] - Training history plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\mutual_learning_history.png
2025-05-02 21:30:27,950 [INFO] - Starting final evaluation and export...
2025-05-02 21:30:27,950 [INFO] - Plotting calibration curves...
2025-05-02 21:30:34,501 [INFO] - Using device: cuda
2025-05-02 21:30:34,507 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 21:30:34,507 [INFO] - GPU Memory: 6.00 GB
2025-05-02 21:30:34,507 [INFO] - CUDA Version: 12.4
2025-05-02 21:30:34,507 [INFO] - cuDNN benchmark mode enabled
2025-05-02 21:30:39,195 [INFO] - Using device: cuda
2025-05-02 21:30:39,195 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 21:30:39,195 [INFO] - GPU Memory: 6.00 GB
2025-05-02 21:30:39,195 [INFO] - CUDA Version: 12.4
2025-05-02 21:30:39,195 [INFO] - cuDNN benchmark mode enabled
2025-05-02 21:30:43,912 [INFO] - Using device: cuda
2025-05-02 21:30:43,928 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 21:30:43,928 [INFO] - GPU Memory: 6.00 GB
2025-05-02 21:30:43,928 [INFO] - CUDA Version: 12.4
2025-05-02 21:30:43,928 [INFO] - cuDNN benchmark mode enabled
2025-05-02 21:30:48,631 [INFO] - Using device: cuda
2025-05-02 21:30:48,631 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-02 21:30:48,631 [INFO] - GPU Memory: 6.00 GB
2025-05-02 21:30:48,631 [INFO] - CUDA Version: 12.4
2025-05-02 21:30:48,631 [INFO] - cuDNN benchmark mode enabled
2025-05-02 21:36:22,902 [INFO] - Teacher calibration curves saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\teacher_calibration_curves.png
2025-05-02 21:36:22,902 [INFO] - Evaluating final student model...
2025-05-02 21:36:22,905 [INFO] - Evaluating student model...
2025-05-02 21:37:01,985 [INFO] - Test Results:
2025-05-02 21:37:01,985 [INFO] - Loss: 0.1735
2025-05-02 21:37:01,985 [INFO] - Accuracy: 94.77%
2025-05-02 21:37:01,985 [INFO] - F1 Score: 0.9476
2025-05-02 21:37:01,985 [INFO] - Precision: 0.9479
2025-05-02 21:37:01,985 [INFO] - Recall: 0.9477
2025-05-02 21:37:01,985 [INFO] - ECE: 0.0138
2025-05-02 21:37:01,985 [INFO] - Exporting final student model...
2025-05-02 21:37:02,034 [INFO] - Final student model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\mutual_learning_20250502_213701_final_student.pth
2025-05-02 21:37:02,034 [INFO] - Mutual learning script finished.
2025-05-03 00:33:32,814 [INFO] - Using device: cuda
2025-05-03 00:33:32,823 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 00:33:32,823 [INFO] - GPU Memory: 6.00 GB
2025-05-03 00:33:32,823 [INFO] - CUDA Version: 11.8
2025-05-03 00:33:32,823 [INFO] - cuDNN benchmark mode enabled
2025-05-03 00:33:33,342 [INFO] - Flash Attention library not found or import failed. Standard attention will be used.
2025-05-03 00:33:33,342 [INFO] - Configuration loaded:
2025-05-03 00:33:33,344 [INFO] - Random seed set to 42
2025-05-03 00:33:33,344 [INFO] - cuDNN benchmark/autotuner enabled via config.
2025-05-03 00:33:33,344 [INFO] - Using channels_last memory format via config.
2025-05-03 00:33:33,344 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "use_checkpoint_activation": true,
    "mixed_precision_dtype": "float16",
    "optimize_transformer_attention": true,
    "optimize_memory_footprint": true,
    "cache_clearing_frequency": 25,
    "dataloader_prefetch": 2,
    "use_channels_last_memory_format": true,
    "num_workers": 2,
    "enable_cudnn_autotuner": true,
    "input_size": 32,
    "model_input_size": 224,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.0005,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "alpha": 0.35,
    "feature_loss_weight": 0.008,
    "cal_weight": 0.06,
    "use_warmup": true,
    "warmup_epochs": 8,
    "curriculum_start_epoch": 8,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 60,
    "use_loss_clipping": true,
    "loss_clip_threshold": 5.0,
    "use_gradient_skip": true,
    "gradient_skip_threshold": 10.0,
    "temperature_min": 2.0,
    "temperature_max": 5.0,
    "anneal_temperature": true,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-03 00:33:33,344 [INFO] - Random seed set to 42
2025-05-03 00:33:33,344 [INFO] - Creating models...
2025-05-03 00:33:33,344 [INFO] - Loading ViT-B16 model...
2025-05-03 00:33:34,262 [INFO] - Loading EfficientNetB0 model...
2025-05-03 00:33:34,373 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-03 00:33:34,705 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-03 00:33:34,705 [INFO] - Loading MobileNetV3-Large model...
2025-05-03 00:33:34,817 [INFO] - Loading ResNet50 model...
2025-05-03 00:33:35,146 [INFO] - Loading DenseNet121 model...
2025-05-03 00:33:35,288 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-03 00:33:35,746 [INFO] - Model vit converted to channels_last format.
2025-05-03 00:33:35,759 [INFO] - Model efficientnet converted to channels_last format.
2025-05-03 00:33:35,759 [INFO] - Model inception converted to channels_last format.
2025-05-03 00:33:35,774 [INFO] - Model mobilenet converted to channels_last format.
2025-05-03 00:33:35,775 [INFO] - Model resnet converted to channels_last format.
2025-05-03 00:33:35,791 [INFO] - Model densenet converted to channels_last format.
2025-05-03 00:33:35,794 [INFO] - Model student converted to channels_last format.
2025-05-03 00:33:35,794 [INFO] - Gradient checkpointing enabled for vit.
2025-05-03 00:33:35,794 [INFO] - Gradient checkpointing enabled for efficientnet.
2025-05-03 00:33:35,794 [INFO] - Gradient checkpointing enabled for inception.
2025-05-03 00:33:35,794 [INFO] - Gradient checkpointing enabled for mobilenet.
2025-05-03 00:33:35,794 [INFO] - Gradient checkpointing enabled for resnet.
2025-05-03 00:33:35,794 [INFO] - Gradient checkpointing enabled for densenet.
2025-05-03 00:33:35,794 [INFO] - Gradient checkpointing enabled for student.
2025-05-03 00:33:35,794 [INFO] - Models created and moved to device.
2025-05-03 00:33:35,794 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_9.pth (Epoch 9, Phase: mutual)
2025-05-03 00:33:35,794 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_9.pth
2025-05-03 00:33:37,799 [INFO] - Loaded model state for vit successfully.
2025-05-03 00:33:37,820 [INFO] - Loaded model state for efficientnet successfully.
2025-05-03 00:33:37,861 [INFO] - Loaded model state for inception successfully.
2025-05-03 00:33:37,871 [INFO] - Loaded model state for mobilenet successfully.
2025-05-03 00:33:37,901 [INFO] - Loaded model state for resnet successfully.
2025-05-03 00:33:37,942 [INFO] - Loaded model state for densenet successfully.
2025-05-03 00:33:37,963 [INFO] - Loaded model state for student successfully.
2025-05-03 00:33:38,076 [INFO] - Recreated and loaded optimizer state for vit
2025-05-03 00:33:38,115 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-03 00:33:38,186 [INFO] - Recreated and loaded optimizer state for inception
2025-05-03 00:33:38,216 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-03 00:33:38,268 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-03 00:33:38,312 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-03 00:33:38,319 [ERROR] - Error loading optimizer state for student: loaded state dict has a different number of parameter groups. Optimizer state might be reset.
Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 598, in load_checkpoint
    optimizer.load_state_dict(optimizer_state_dict[state_dict_key])
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\_dynamo\eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\optimizer.py", line 853, in load_state_dict
    raise ValueError(
ValueError: loaded state dict has a different number of parameter groups

2025-05-03 00:33:38,321 [ERROR] - Error recreating/loading scheduler state for vit: list index out of range. Scheduler might be reset.
Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 639, in load_checkpoint
    scheduler.load_state_dict(sched_state)
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 958, in load_state_dict
    self._schedulers[idx].load_state_dict(s)
    ~~~~~~~~~~~~~~~~^^^^^
IndexError: list index out of range

2025-05-03 00:33:38,321 [ERROR] - Error recreating/loading scheduler state for efficientnet: list index out of range. Scheduler might be reset.
Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 639, in load_checkpoint
    scheduler.load_state_dict(sched_state)
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 958, in load_state_dict
    self._schedulers[idx].load_state_dict(s)
    ~~~~~~~~~~~~~~~~^^^^^
IndexError: list index out of range

2025-05-03 00:33:38,321 [ERROR] - Error recreating/loading scheduler state for inception: list index out of range. Scheduler might be reset.
Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 639, in load_checkpoint
    scheduler.load_state_dict(sched_state)
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 958, in load_state_dict
    self._schedulers[idx].load_state_dict(s)
    ~~~~~~~~~~~~~~~~^^^^^
IndexError: list index out of range

2025-05-03 00:33:38,323 [ERROR] - Error recreating/loading scheduler state for mobilenet: list index out of range. Scheduler might be reset.
Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 639, in load_checkpoint
    scheduler.load_state_dict(sched_state)
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 958, in load_state_dict
    self._schedulers[idx].load_state_dict(s)
    ~~~~~~~~~~~~~~~~^^^^^
IndexError: list index out of range

2025-05-03 00:33:38,323 [ERROR] - Error recreating/loading scheduler state for resnet: list index out of range. Scheduler might be reset.
Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 639, in load_checkpoint
    scheduler.load_state_dict(sched_state)
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 958, in load_state_dict
    self._schedulers[idx].load_state_dict(s)
    ~~~~~~~~~~~~~~~~^^^^^
IndexError: list index out of range

2025-05-03 00:33:38,323 [ERROR] - Error recreating/loading scheduler state for densenet: list index out of range. Scheduler might be reset.
Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 639, in load_checkpoint
    scheduler.load_state_dict(sched_state)
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 958, in load_state_dict
    self._schedulers[idx].load_state_dict(s)
    ~~~~~~~~~~~~~~~~^^^^^
IndexError: list index out of range

2025-05-03 00:33:38,323 [ERROR] - Error recreating/loading scheduler state for student: list index out of range. Scheduler might be reset.
Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 639, in load_checkpoint
    scheduler.load_state_dict(sched_state)
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 958, in load_state_dict
    self._schedulers[idx].load_state_dict(s)
    ~~~~~~~~~~~~~~~~^^^^^
IndexError: list index out of range

2025-05-03 00:33:38,325 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_9.pth. Checkpoint epoch: 9, Phase: 'mutual'.
2025-05-03 00:33:38,333 [INFO] - Resuming mutual learning phase from epoch 10
2025-05-03 00:33:38,333 [INFO] - Created new scheduler for vit
2025-05-03 00:33:38,333 [INFO] - Created new scheduler for efficientnet
2025-05-03 00:33:38,333 [INFO] - Created new scheduler for inception
2025-05-03 00:33:38,333 [INFO] - Created new scheduler for mobilenet
2025-05-03 00:33:38,333 [INFO] - Created new scheduler for resnet
2025-05-03 00:33:38,333 [INFO] - Created new scheduler for densenet
2025-05-03 00:33:38,335 [INFO] - Created new scheduler for student
2025-05-03 00:33:38,335 [INFO] - Preparing data loaders...
2025-05-03 00:33:46,378 [INFO] - Training samples: 45000 per model
2025-05-03 00:33:46,378 [INFO] - Validation samples: 5000 per model
2025-05-03 00:33:46,378 [INFO] - Test samples: 10000 per model
2025-05-03 00:33:46,378 [INFO] - Skipping initialization phase.
2025-05-03 00:33:46,378 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-03 00:33:46,521 [INFO] - GPU Memory: Current=1720.42MB, Peak=1720.42MB, Reserved=1760.00MB
2025-05-03 00:33:46,521 [INFO] - Mutual learning script finished.
2025-05-03 00:38:06,564 [INFO] - Using device: cuda
2025-05-03 00:38:06,569 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 00:38:06,569 [INFO] - GPU Memory: 6.00 GB
2025-05-03 00:38:06,569 [INFO] - CUDA Version: 11.8
2025-05-03 00:38:06,569 [INFO] - cuDNN benchmark mode enabled
2025-05-03 00:38:07,115 [INFO] - Flash Attention library not found or import failed. Standard attention will be used.
2025-05-03 00:38:07,115 [INFO] - Configuration loaded:
2025-05-03 00:38:07,119 [INFO] - Random seed set to 42
2025-05-03 00:38:07,119 [INFO] - cuDNN benchmark/autotuner enabled via config.
2025-05-03 00:38:07,119 [INFO] - Using channels_last memory format via config.
2025-05-03 00:38:07,119 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "use_checkpoint_activation": true,
    "mixed_precision_dtype": "float16",
    "optimize_transformer_attention": true,
    "optimize_memory_footprint": true,
    "cache_clearing_frequency": 25,
    "dataloader_prefetch": 2,
    "use_channels_last_memory_format": true,
    "num_workers": 2,
    "enable_cudnn_autotuner": true,
    "input_size": 32,
    "model_input_size": 224,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.0005,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "alpha": 0.35,
    "feature_loss_weight": 0.008,
    "cal_weight": 0.06,
    "use_warmup": true,
    "warmup_epochs": 8,
    "curriculum_start_epoch": 8,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 60,
    "use_loss_clipping": true,
    "loss_clip_threshold": 5.0,
    "use_gradient_skip": true,
    "gradient_skip_threshold": 10.0,
    "temperature_min": 2.0,
    "temperature_max": 5.0,
    "anneal_temperature": true,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-03 00:38:07,120 [INFO] - Random seed set to 42
2025-05-03 00:38:07,120 [INFO] - Creating models...
2025-05-03 00:38:07,120 [INFO] - Loading ViT-B16 model...
2025-05-03 00:38:08,032 [INFO] - Loading EfficientNetB0 model...
2025-05-03 00:38:08,143 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-03 00:38:08,476 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-03 00:38:08,476 [INFO] - Loading MobileNetV3-Large model...
2025-05-03 00:38:08,566 [INFO] - Loading ResNet50 model...
2025-05-03 00:38:08,900 [INFO] - Loading DenseNet121 model...
2025-05-03 00:38:09,023 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-03 00:38:09,478 [INFO] - Model vit converted to channels_last format.
2025-05-03 00:38:09,486 [INFO] - Model efficientnet converted to channels_last format.
2025-05-03 00:38:09,494 [INFO] - Model inception converted to channels_last format.
2025-05-03 00:38:09,501 [INFO] - Model mobilenet converted to channels_last format.
2025-05-03 00:38:09,505 [INFO] - Model resnet converted to channels_last format.
2025-05-03 00:38:09,517 [INFO] - Model densenet converted to channels_last format.
2025-05-03 00:38:09,522 [INFO] - Model student converted to channels_last format.
2025-05-03 00:38:09,523 [INFO] - Gradient checkpointing enabled for vit.
2025-05-03 00:38:09,523 [INFO] - Gradient checkpointing enabled for efficientnet.
2025-05-03 00:38:09,524 [INFO] - Gradient checkpointing enabled for inception.
2025-05-03 00:38:09,524 [INFO] - Gradient checkpointing enabled for mobilenet.
2025-05-03 00:38:09,524 [INFO] - Gradient checkpointing enabled for resnet.
2025-05-03 00:38:09,525 [INFO] - Gradient checkpointing enabled for densenet.
2025-05-03 00:38:09,525 [INFO] - Gradient checkpointing enabled for student.
2025-05-03 00:38:09,525 [INFO] - Models created and moved to device.
2025-05-03 00:38:09,527 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_9.pth (Epoch 9, Phase: mutual)
2025-05-03 00:38:09,527 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_9.pth
2025-05-03 00:38:11,431 [INFO] - Loaded model state for vit successfully.
2025-05-03 00:38:11,449 [INFO] - Loaded model state for efficientnet successfully.
2025-05-03 00:38:11,489 [INFO] - Loaded model state for inception successfully.
2025-05-03 00:38:11,504 [INFO] - Loaded model state for mobilenet successfully.
2025-05-03 00:38:11,540 [INFO] - Loaded model state for resnet successfully.
2025-05-03 00:38:11,577 [INFO] - Loaded model state for densenet successfully.
2025-05-03 00:38:11,595 [INFO] - Loaded model state for student successfully.
2025-05-03 00:38:11,721 [INFO] - Recreated and loaded optimizer state for vit
2025-05-03 00:38:11,748 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-03 00:38:11,821 [INFO] - Recreated and loaded optimizer state for inception
2025-05-03 00:38:11,842 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-03 00:38:11,904 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-03 00:38:11,950 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-03 00:38:11,952 [ERROR] - Error loading optimizer state for student: loaded state dict has a different number of parameter groups. Optimizer state might be reset. Check if model structure changed.
2025-05-03 00:38:11,956 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 598, in load_checkpoint
    optimizer.load_state_dict(optimizer_state_dict[state_dict_key])
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\_dynamo\eval_frame.py", line 632, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\optimizer.py", line 853, in load_state_dict
    raise ValueError(
ValueError: loaded state dict has a different number of parameter groups

2025-05-03 00:38:11,956 [ERROR] - Error loading scheduler state dict for vit (Type: SequentialLR): list index out of range. Scheduler state might be reset.
2025-05-03 00:38:11,958 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 667, in load_checkpoint
    scheduler.load_state_dict(sched_state)
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 958, in load_state_dict
    self._schedulers[idx].load_state_dict(s)
    ~~~~~~~~~~~~~~~~^^^^^
IndexError: list index out of range

2025-05-03 00:38:11,958 [ERROR] - Error loading scheduler state dict for efficientnet (Type: SequentialLR): list index out of range. Scheduler state might be reset.
2025-05-03 00:38:11,958 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 667, in load_checkpoint
    scheduler.load_state_dict(sched_state)
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 958, in load_state_dict
    self._schedulers[idx].load_state_dict(s)
    ~~~~~~~~~~~~~~~~^^^^^
IndexError: list index out of range

2025-05-03 00:38:11,959 [ERROR] - Error loading scheduler state dict for inception (Type: SequentialLR): list index out of range. Scheduler state might be reset.
2025-05-03 00:38:11,959 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 667, in load_checkpoint
    scheduler.load_state_dict(sched_state)
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 958, in load_state_dict
    self._schedulers[idx].load_state_dict(s)
    ~~~~~~~~~~~~~~~~^^^^^
IndexError: list index out of range

2025-05-03 00:38:11,959 [ERROR] - Error loading scheduler state dict for mobilenet (Type: SequentialLR): list index out of range. Scheduler state might be reset.
2025-05-03 00:38:11,960 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 667, in load_checkpoint
    scheduler.load_state_dict(sched_state)
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 958, in load_state_dict
    self._schedulers[idx].load_state_dict(s)
    ~~~~~~~~~~~~~~~~^^^^^
IndexError: list index out of range

2025-05-03 00:38:11,960 [ERROR] - Error loading scheduler state dict for resnet (Type: SequentialLR): list index out of range. Scheduler state might be reset.
2025-05-03 00:38:11,961 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 667, in load_checkpoint
    scheduler.load_state_dict(sched_state)
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 958, in load_state_dict
    self._schedulers[idx].load_state_dict(s)
    ~~~~~~~~~~~~~~~~^^^^^
IndexError: list index out of range

2025-05-03 00:38:11,961 [ERROR] - Error loading scheduler state dict for densenet (Type: SequentialLR): list index out of range. Scheduler state might be reset.
2025-05-03 00:38:11,961 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 667, in load_checkpoint
    scheduler.load_state_dict(sched_state)
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 958, in load_state_dict
    self._schedulers[idx].load_state_dict(s)
    ~~~~~~~~~~~~~~~~^^^^^
IndexError: list index out of range

2025-05-03 00:38:11,962 [ERROR] - Error loading scheduler state dict for student (Type: SequentialLR): list index out of range. Scheduler state might be reset.
2025-05-03 00:38:11,962 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 667, in load_checkpoint
    scheduler.load_state_dict(sched_state)
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\optim\lr_scheduler.py", line 958, in load_state_dict
    self._schedulers[idx].load_state_dict(s)
    ~~~~~~~~~~~~~~~~^^^^^
IndexError: list index out of range

2025-05-03 00:38:11,964 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_9.pth. Checkpoint epoch: 9, Phase: 'mutual'.
2025-05-03 00:38:11,971 [INFO] - Resuming mutual learning phase from epoch 10
2025-05-03 00:38:11,971 [INFO] - Preparing data loaders...
2025-05-03 00:38:19,906 [INFO] - Training samples: 45000 per model
2025-05-03 00:38:19,906 [INFO] - Validation samples: 5000 per model
2025-05-03 00:38:19,906 [INFO] - Test samples: 10000 per model
2025-05-03 00:38:19,907 [INFO] - Skipping initialization phase.
2025-05-03 00:38:19,907 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-03 00:38:20,054 [INFO] - GPU Memory: Current=1720.42MB, Peak=1720.42MB, Reserved=1760.00MB
2025-05-03 00:38:20,054 [INFO] - Mutual learning script finished.
2025-05-03 00:40:02,740 [INFO] - Using device: cuda
2025-05-03 00:40:02,743 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 00:40:02,743 [INFO] - GPU Memory: 6.00 GB
2025-05-03 00:40:02,743 [INFO] - CUDA Version: 11.8
2025-05-03 00:40:02,743 [INFO] - cuDNN benchmark mode enabled
2025-05-03 00:40:03,257 [INFO] - Flash Attention library not found or import failed. Standard attention will be used.
2025-05-03 00:40:03,258 [INFO] - Configuration loaded:
2025-05-03 00:40:03,260 [INFO] - Random seed set to 42
2025-05-03 00:40:03,260 [INFO] - cuDNN benchmark/autotuner enabled via config.
2025-05-03 00:40:03,260 [INFO] - Using channels_last memory format via config.
2025-05-03 00:40:03,261 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "use_checkpoint_activation": true,
    "mixed_precision_dtype": "float16",
    "optimize_transformer_attention": true,
    "optimize_memory_footprint": true,
    "cache_clearing_frequency": 25,
    "dataloader_prefetch": 2,
    "use_channels_last_memory_format": true,
    "num_workers": 2,
    "enable_cudnn_autotuner": true,
    "input_size": 32,
    "model_input_size": 224,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.0005,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "alpha": 0.35,
    "feature_loss_weight": 0.008,
    "cal_weight": 0.06,
    "use_warmup": true,
    "warmup_epochs": 8,
    "curriculum_start_epoch": 8,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 60,
    "use_loss_clipping": true,
    "loss_clip_threshold": 5.0,
    "use_gradient_skip": true,
    "gradient_skip_threshold": 10.0,
    "temperature_min": 2.0,
    "temperature_max": 5.0,
    "anneal_temperature": true,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-03 00:40:03,262 [INFO] - Random seed set to 42
2025-05-03 00:40:03,262 [INFO] - Creating models...
2025-05-03 00:40:03,262 [INFO] - Loading ViT-B16 model...
2025-05-03 00:40:03,881 [INFO] - Loading EfficientNetB0 model...
2025-05-03 00:40:03,964 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-03 00:40:04,133 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-03 00:40:04,134 [INFO] - Loading MobileNetV3-Large model...
2025-05-03 00:40:04,211 [INFO] - Loading ResNet50 model...
2025-05-03 00:40:04,456 [INFO] - Loading DenseNet121 model...
2025-05-03 00:40:04,570 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-03 00:40:04,957 [INFO] - Model vit converted to channels_last format.
2025-05-03 00:40:04,965 [INFO] - Model efficientnet converted to channels_last format.
2025-05-03 00:40:04,973 [INFO] - Model inception converted to channels_last format.
2025-05-03 00:40:04,979 [INFO] - Model mobilenet converted to channels_last format.
2025-05-03 00:40:04,983 [INFO] - Model resnet converted to channels_last format.
2025-05-03 00:40:04,996 [INFO] - Model densenet converted to channels_last format.
2025-05-03 00:40:05,001 [INFO] - Model student converted to channels_last format.
2025-05-03 00:40:05,001 [INFO] - Gradient checkpointing enabled for vit.
2025-05-03 00:40:05,002 [INFO] - Gradient checkpointing enabled for efficientnet.
2025-05-03 00:40:05,002 [INFO] - Gradient checkpointing enabled for inception.
2025-05-03 00:40:05,003 [INFO] - Gradient checkpointing enabled for mobilenet.
2025-05-03 00:40:05,003 [INFO] - Gradient checkpointing enabled for resnet.
2025-05-03 00:40:05,004 [INFO] - Gradient checkpointing enabled for densenet.
2025-05-03 00:40:05,004 [INFO] - Gradient checkpointing enabled for student.
2025-05-03 00:40:05,005 [INFO] - Models created and moved to device.
2025-05-03 00:40:05,005 [INFO] - No checkpoint found.
2025-05-03 00:40:05,005 [INFO] - No checkpoint found. Starting training from scratch.
2025-05-03 00:40:05,006 [INFO] - Created new optimizer for vit
2025-05-03 00:40:05,006 [INFO] - Created new scheduler for vit
2025-05-03 00:40:05,007 [INFO] - Created new optimizer for efficientnet
2025-05-03 00:40:05,007 [INFO] - Created new scheduler for efficientnet
2025-05-03 00:40:05,008 [INFO] - Created new optimizer for inception
2025-05-03 00:40:05,008 [INFO] - Created new scheduler for inception
2025-05-03 00:40:05,009 [INFO] - Created new optimizer for mobilenet
2025-05-03 00:40:05,009 [INFO] - Created new scheduler for mobilenet
2025-05-03 00:40:05,010 [INFO] - Created new optimizer for resnet
2025-05-03 00:40:05,010 [INFO] - Created new scheduler for resnet
2025-05-03 00:40:05,011 [INFO] - Created new optimizer for densenet
2025-05-03 00:40:05,011 [INFO] - Created new scheduler for densenet
2025-05-03 00:40:05,012 [INFO] - Created new optimizer for student
2025-05-03 00:40:05,012 [INFO] - Created new scheduler for student
2025-05-03 00:40:05,013 [INFO] - Preparing data loaders...
2025-05-03 00:40:12,698 [INFO] - Training samples: 45000 per model
2025-05-03 00:40:12,698 [INFO] - Validation samples: 5000 per model
2025-05-03 00:40:12,699 [INFO] - Test samples: 10000 per model
2025-05-03 00:40:12,699 [INFO] - Starting initialization phase from epoch 1...
2025-05-03 00:40:12,699 [INFO] - Starting initialization phase...
2025-05-03 00:40:12,700 [INFO] - Optimizer and Scheduler set for vit with LR=0.0003
2025-05-03 00:40:12,701 [INFO] - Optimizer and Scheduler set for efficientnet with LR=0.001
2025-05-03 00:40:12,702 [INFO] - Optimizer and Scheduler set for inception with LR=0.0007
2025-05-03 00:40:12,703 [INFO] - Optimizer and Scheduler set for mobilenet with LR=0.0015
2025-05-03 00:40:12,704 [INFO] - Optimizer and Scheduler set for resnet with LR=0.001
2025-05-03 00:40:12,705 [INFO] - Optimizer and Scheduler set for densenet with LR=0.0008
2025-05-03 00:40:12,706 [INFO] - Optimizer and Scheduler set for student with LR=0.002
2025-05-03 00:40:12,706 [INFO] - Initialization Epoch 1/5
2025-05-03 00:40:17,743 [INFO] - Using device: cuda
2025-05-03 00:40:17,746 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 00:40:17,746 [INFO] - GPU Memory: 6.00 GB
2025-05-03 00:40:17,746 [INFO] - CUDA Version: 11.8
2025-05-03 00:40:17,746 [INFO] - cuDNN benchmark mode enabled
2025-05-03 00:40:22,781 [INFO] - Using device: cuda
2025-05-03 00:40:22,783 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 00:40:22,784 [INFO] - GPU Memory: 6.00 GB
2025-05-03 00:40:22,784 [INFO] - CUDA Version: 11.8
2025-05-03 00:40:22,784 [INFO] - cuDNN benchmark mode enabled
2025-05-03 00:50:54,072 [INFO] - Using device: cuda
2025-05-03 00:50:54,075 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 00:50:54,075 [INFO] - GPU Memory: 6.00 GB
2025-05-03 00:50:54,075 [INFO] - CUDA Version: 11.8
2025-05-03 00:50:54,076 [INFO] - cuDNN benchmark mode enabled
2025-05-03 00:50:59,452 [INFO] - Using device: cuda
2025-05-03 00:50:59,455 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 00:50:59,455 [INFO] - GPU Memory: 6.00 GB
2025-05-03 00:50:59,456 [INFO] - CUDA Version: 11.8
2025-05-03 00:50:59,456 [INFO] - cuDNN benchmark mode enabled
2025-05-03 01:04:08,047 [INFO] - Using device: cuda
2025-05-03 01:04:08,050 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 01:04:08,051 [INFO] - GPU Memory: 6.00 GB
2025-05-03 01:04:08,051 [INFO] - CUDA Version: 11.8
2025-05-03 01:04:08,051 [INFO] - cuDNN benchmark mode enabled
2025-05-03 01:04:13,290 [INFO] - Using device: cuda
2025-05-03 01:04:13,293 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 01:04:13,293 [INFO] - GPU Memory: 6.00 GB
2025-05-03 01:04:13,293 [INFO] - CUDA Version: 11.8
2025-05-03 01:04:13,293 [INFO] - cuDNN benchmark mode enabled
2025-05-03 01:19:44,251 [INFO] - Using device: cuda
2025-05-03 01:19:44,254 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 01:19:44,254 [INFO] - GPU Memory: 6.00 GB
2025-05-03 01:19:44,254 [INFO] - CUDA Version: 11.8
2025-05-03 01:19:44,255 [INFO] - cuDNN benchmark mode enabled
2025-05-03 01:19:49,454 [INFO] - Using device: cuda
2025-05-03 01:19:49,457 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 01:19:49,457 [INFO] - GPU Memory: 6.00 GB
2025-05-03 01:19:49,457 [INFO] - CUDA Version: 11.8
2025-05-03 01:19:49,457 [INFO] - cuDNN benchmark mode enabled
2025-05-03 01:25:59,326 [INFO] - Using device: cuda
2025-05-03 01:25:59,329 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 01:25:59,329 [INFO] - GPU Memory: 6.00 GB
2025-05-03 01:25:59,329 [INFO] - CUDA Version: 11.8
2025-05-03 01:25:59,329 [INFO] - cuDNN benchmark mode enabled
2025-05-03 01:26:04,593 [INFO] - Using device: cuda
2025-05-03 01:26:04,596 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 01:26:04,596 [INFO] - GPU Memory: 6.00 GB
2025-05-03 01:26:04,596 [INFO] - CUDA Version: 11.8
2025-05-03 01:26:04,596 [INFO] - cuDNN benchmark mode enabled
2025-05-03 01:41:20,622 [INFO] - Using device: cuda
2025-05-03 01:41:20,625 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 01:41:20,625 [INFO] - GPU Memory: 6.00 GB
2025-05-03 01:41:20,626 [INFO] - CUDA Version: 11.8
2025-05-03 01:41:20,626 [INFO] - cuDNN benchmark mode enabled
2025-05-03 01:41:25,872 [INFO] - Using device: cuda
2025-05-03 01:41:25,876 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 01:41:25,876 [INFO] - GPU Memory: 6.00 GB
2025-05-03 01:41:25,876 [INFO] - CUDA Version: 11.8
2025-05-03 01:41:25,876 [INFO] - cuDNN benchmark mode enabled
2025-05-03 02:03:04,478 [INFO] - Using device: cuda
2025-05-03 02:03:04,481 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 02:03:04,481 [INFO] - GPU Memory: 6.00 GB
2025-05-03 02:03:04,481 [INFO] - CUDA Version: 11.8
2025-05-03 02:03:04,481 [INFO] - cuDNN benchmark mode enabled
2025-05-03 02:03:09,794 [INFO] - Using device: cuda
2025-05-03 02:03:09,797 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 02:03:09,798 [INFO] - GPU Memory: 6.00 GB
2025-05-03 02:03:09,798 [INFO] - CUDA Version: 11.8
2025-05-03 02:03:09,798 [INFO] - cuDNN benchmark mode enabled
2025-05-03 02:16:01,106 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-03 02:19:20,122 [INFO] - Restored num_workers to 2.
2025-05-03 02:19:20,122 [INFO] -   vit: Train Loss=0.6224, Train Acc=78.39%, Val Loss=0.0442, Val Acc=93.82%
2025-05-03 02:19:20,155 [INFO] -   New best validation accuracy for vit: 93.82%
2025-05-03 02:19:20,155 [INFO] -   efficientnet: Train Loss=0.6919, Train Acc=76.89%, Val Loss=0.0719, Val Acc=90.54%
2025-05-03 02:19:20,196 [INFO] -   New best validation accuracy for efficientnet: 90.54%
2025-05-03 02:19:20,196 [INFO] -   inception: Train Loss=0.7478, Train Acc=76.05%, Val Loss=0.0704, Val Acc=90.36%
2025-05-03 02:19:20,240 [INFO] -   New best validation accuracy for inception: 90.36%
2025-05-03 02:19:20,240 [INFO] -   mobilenet: Train Loss=0.5788, Train Acc=80.34%, Val Loss=0.0314, Val Acc=91.50%
2025-05-03 02:19:20,269 [INFO] -   New best validation accuracy for mobilenet: 91.50%
2025-05-03 02:19:20,269 [INFO] -   resnet: Train Loss=0.9577, Train Acc=68.18%, Val Loss=0.1193, Val Acc=84.46%
2025-05-03 02:19:20,306 [INFO] -   New best validation accuracy for resnet: 84.46%
2025-05-03 02:19:20,306 [INFO] -   densenet: Train Loss=0.7280, Train Acc=76.55%, Val Loss=0.0701, Val Acc=90.20%
2025-05-03 02:19:20,338 [INFO] -   New best validation accuracy for densenet: 90.20%
2025-05-03 02:19:20,338 [INFO] -   student: Train Loss=0.6961, Train Acc=76.56%, Val Loss=0.0772, Val Acc=90.04%
2025-05-03 02:19:20,365 [INFO] -   New best validation accuracy for student: 90.04%
2025-05-03 02:19:20,366 [INFO] - Initialization epoch 1 completed in 5947.66s
2025-05-03 02:19:23,024 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_1.pth (Epoch 0)
2025-05-03 02:19:23,026 [INFO] - Initialization Epoch 2/5
2025-05-03 03:53:44,739 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-03 03:57:01,863 [INFO] - Restored num_workers to 2.
2025-05-03 03:57:01,863 [INFO] -   vit: Train Loss=0.1382, Train Acc=95.44%, Val Loss=0.0405, Val Acc=94.42%
2025-05-03 03:57:01,900 [INFO] -   New best validation accuracy for vit: 94.42%
2025-05-03 03:57:01,901 [INFO] -   efficientnet: Train Loss=0.3249, Train Acc=89.13%, Val Loss=0.0513, Val Acc=93.40%
2025-05-03 03:57:01,938 [INFO] -   New best validation accuracy for efficientnet: 93.40%
2025-05-03 03:57:01,938 [INFO] -   inception: Train Loss=0.4054, Train Acc=87.17%, Val Loss=0.0625, Val Acc=91.84%
2025-05-03 03:57:01,966 [INFO] -   New best validation accuracy for inception: 91.84%
2025-05-03 03:57:01,966 [INFO] -   mobilenet: Train Loss=0.3161, Train Acc=89.19%, Val Loss=0.0281, Val Acc=92.42%
2025-05-03 03:57:01,996 [INFO] -   New best validation accuracy for mobilenet: 92.42%
2025-05-03 03:57:01,996 [INFO] -   resnet: Train Loss=0.5735, Train Acc=81.29%, Val Loss=0.0944, Val Acc=87.90%
2025-05-03 03:57:02,023 [INFO] -   New best validation accuracy for resnet: 87.90%
2025-05-03 03:57:02,024 [INFO] -   densenet: Train Loss=0.4316, Train Acc=86.31%, Val Loss=0.0618, Val Acc=91.74%
2025-05-03 03:57:02,051 [INFO] -   New best validation accuracy for densenet: 91.74%
2025-05-03 03:57:02,051 [INFO] -   student: Train Loss=0.3815, Train Acc=87.08%, Val Loss=0.0631, Val Acc=92.08%
2025-05-03 03:57:02,080 [INFO] -   New best validation accuracy for student: 92.08%
2025-05-03 03:57:02,080 [INFO] - Initialization epoch 2 completed in 5859.05s
2025-05-03 03:57:04,411 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_2.pth (Epoch 1)
2025-05-03 03:57:04,413 [INFO] - Initialization Epoch 3/5
2025-05-03 05:31:25,607 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-03 05:34:43,102 [INFO] - Restored num_workers to 2.
2025-05-03 05:34:43,102 [INFO] -   vit: Train Loss=0.0940, Train Acc=96.77%, Val Loss=0.0402, Val Acc=94.44%
2025-05-03 05:34:43,132 [INFO] -   New best validation accuracy for vit: 94.44%
2025-05-03 05:34:43,132 [INFO] -   efficientnet: Train Loss=0.2516, Train Acc=91.59%, Val Loss=0.0464, Val Acc=93.58%
2025-05-03 05:34:43,173 [INFO] -   New best validation accuracy for efficientnet: 93.58%
2025-05-03 05:34:43,174 [INFO] -   inception: Train Loss=0.2990, Train Acc=90.49%, Val Loss=0.0563, Val Acc=92.66%
2025-05-03 05:34:43,202 [INFO] -   New best validation accuracy for inception: 92.66%
2025-05-03 05:34:43,203 [INFO] -   mobilenet: Train Loss=0.2485, Train Acc=91.46%, Val Loss=0.0257, Val Acc=93.06%
2025-05-03 05:34:43,231 [INFO] -   New best validation accuracy for mobilenet: 93.06%
2025-05-03 05:34:43,231 [INFO] -   resnet: Train Loss=0.4445, Train Acc=85.55%, Val Loss=0.0945, Val Acc=87.54%
2025-05-03 05:34:43,232 [INFO] -   densenet: Train Loss=0.3285, Train Acc=89.72%, Val Loss=0.0449, Val Acc=94.22%
2025-05-03 05:34:43,258 [INFO] -   New best validation accuracy for densenet: 94.22%
2025-05-03 05:34:43,258 [INFO] -   student: Train Loss=0.3054, Train Acc=89.62%, Val Loss=0.0631, Val Acc=92.30%
2025-05-03 05:34:43,285 [INFO] -   New best validation accuracy for student: 92.30%
2025-05-03 05:34:43,285 [INFO] - Initialization epoch 3 completed in 5858.87s
2025-05-03 05:34:58,237 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_3.pth (Epoch 2)
2025-05-03 05:34:58,239 [INFO] - Initialization Epoch 4/5
2025-05-03 07:09:06,733 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-03 07:12:25,365 [INFO] - Restored num_workers to 2.
2025-05-03 07:12:25,365 [INFO] -   vit: Train Loss=0.0750, Train Acc=97.46%, Val Loss=0.0288, Val Acc=96.06%
2025-05-03 07:12:25,394 [INFO] -   New best validation accuracy for vit: 96.06%
2025-05-03 07:12:25,395 [INFO] -   efficientnet: Train Loss=0.2034, Train Acc=93.19%, Val Loss=0.0593, Val Acc=94.38%
2025-05-03 07:12:25,427 [INFO] -   New best validation accuracy for efficientnet: 94.38%
2025-05-03 07:12:25,427 [INFO] -   inception: Train Loss=0.2496, Train Acc=91.95%, Val Loss=0.0489, Val Acc=93.74%
2025-05-03 07:12:25,454 [INFO] -   New best validation accuracy for inception: 93.74%
2025-05-03 07:12:25,454 [INFO] -   mobilenet: Train Loss=0.2022, Train Acc=93.12%, Val Loss=0.0213, Val Acc=93.98%
2025-05-03 07:12:25,481 [INFO] -   New best validation accuracy for mobilenet: 93.98%
2025-05-03 07:12:25,482 [INFO] -   resnet: Train Loss=0.3684, Train Acc=87.89%, Val Loss=0.0789, Val Acc=89.66%
2025-05-03 07:12:25,520 [INFO] -   New best validation accuracy for resnet: 89.66%
2025-05-03 07:12:25,520 [INFO] -   densenet: Train Loss=0.2667, Train Acc=91.56%, Val Loss=0.0498, Val Acc=93.12%
2025-05-03 07:12:25,521 [INFO] -   student: Train Loss=0.2535, Train Acc=91.43%, Val Loss=0.0560, Val Acc=93.68%
2025-05-03 07:12:25,547 [INFO] -   New best validation accuracy for student: 93.68%
2025-05-03 07:12:25,548 [INFO] - Initialization epoch 4 completed in 5847.31s
2025-05-03 07:12:27,872 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_4.pth (Epoch 3)
2025-05-03 07:12:27,874 [INFO] - Initialization Epoch 5/5
2025-05-03 08:46:47,452 [INFO] - Temporarily setting num_workers=0 for validation to reduce RAM usage.
2025-05-03 08:50:08,192 [INFO] - Restored num_workers to 2.
2025-05-03 08:50:08,192 [INFO] -   vit: Train Loss=0.0580, Train Acc=97.94%, Val Loss=0.0305, Val Acc=95.44%
2025-05-03 08:50:08,192 [INFO] -   efficientnet: Train Loss=0.1760, Train Acc=94.07%, Val Loss=0.0452, Val Acc=94.96%
2025-05-03 08:50:08,225 [INFO] -   New best validation accuracy for efficientnet: 94.96%
2025-05-03 08:50:08,226 [INFO] -   inception: Train Loss=0.2022, Train Acc=93.52%, Val Loss=0.0425, Val Acc=94.46%
2025-05-03 08:50:08,258 [INFO] -   New best validation accuracy for inception: 94.46%
2025-05-03 08:50:08,259 [INFO] -   mobilenet: Train Loss=0.1674, Train Acc=94.42%, Val Loss=0.0215, Val Acc=94.32%
2025-05-03 08:50:08,286 [INFO] -   New best validation accuracy for mobilenet: 94.32%
2025-05-03 08:50:08,286 [INFO] -   resnet: Train Loss=0.3020, Train Acc=89.89%, Val Loss=0.0711, Val Acc=90.24%
2025-05-03 08:50:08,314 [INFO] -   New best validation accuracy for resnet: 90.24%
2025-05-03 08:50:08,314 [INFO] -   densenet: Train Loss=0.2235, Train Acc=92.90%, Val Loss=0.0476, Val Acc=93.24%
2025-05-03 08:50:08,314 [INFO] -   student: Train Loss=0.2125, Train Acc=92.69%, Val Loss=0.0521, Val Acc=93.18%
2025-05-03 08:50:08,314 [INFO] - Initialization epoch 5 completed in 5860.44s
2025-05-03 08:50:10,674 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 4)
2025-05-03 08:50:10,677 [WARNING] - Missing keys when restoring best state for vit: ['class_token', 'conv_proj.weight', 'conv_proj.bias', 'encoder.pos_embedding', 'encoder.layers.encoder_layer_0.ln_1.weight', 'encoder.layers.encoder_layer_0.ln_1.bias', 'encoder.layers.encoder_layer_0.self_attention.in_proj_weight', 'encoder.layers.encoder_layer_0.self_attention.in_proj_bias', 'encoder.layers.encoder_layer_0.self_attention.out_proj.weight', 'encoder.layers.encoder_layer_0.self_attention.out_proj.bias', 'encoder.layers.encoder_layer_0.ln_2.weight', 'encoder.layers.encoder_layer_0.ln_2.bias', 'encoder.layers.encoder_layer_0.mlp.0.weight', 'encoder.layers.encoder_layer_0.mlp.0.bias', 'encoder.layers.encoder_layer_0.mlp.3.weight', 'encoder.layers.encoder_layer_0.mlp.3.bias', 'encoder.layers.encoder_layer_1.ln_1.weight', 'encoder.layers.encoder_layer_1.ln_1.bias', 'encoder.layers.encoder_layer_1.self_attention.in_proj_weight', 'encoder.layers.encoder_layer_1.self_attention.in_proj_bias', 'encoder.layers.encoder_layer_1.self_attention.out_proj.weight', 'encoder.layers.encoder_layer_1.self_attention.out_proj.bias', 'encoder.layers.encoder_layer_1.ln_2.weight', 'encoder.layers.encoder_layer_1.ln_2.bias', 'encoder.layers.encoder_layer_1.mlp.0.weight', 'encoder.layers.encoder_layer_1.mlp.0.bias', 'encoder.layers.encoder_layer_1.mlp.3.weight', 'encoder.layers.encoder_layer_1.mlp.3.bias', 'encoder.layers.encoder_layer_2.ln_1.weight', 'encoder.layers.encoder_layer_2.ln_1.bias', 'encoder.layers.encoder_layer_2.self_attention.in_proj_weight', 'encoder.layers.encoder_layer_2.self_attention.in_proj_bias', 'encoder.layers.encoder_layer_2.self_attention.out_proj.weight', 'encoder.layers.encoder_layer_2.self_attention.out_proj.bias', 'encoder.layers.encoder_layer_2.ln_2.weight', 'encoder.layers.encoder_layer_2.ln_2.bias', 'encoder.layers.encoder_layer_2.mlp.0.weight', 'encoder.layers.encoder_layer_2.mlp.0.bias', 'encoder.layers.encoder_layer_2.mlp.3.weight', 'encoder.layers.encoder_layer_2.mlp.3.bias', 'encoder.layers.encoder_layer_3.ln_1.weight', 'encoder.layers.encoder_layer_3.ln_1.bias', 'encoder.layers.encoder_layer_3.self_attention.in_proj_weight', 'encoder.layers.encoder_layer_3.self_attention.in_proj_bias', 'encoder.layers.encoder_layer_3.self_attention.out_proj.weight', 'encoder.layers.encoder_layer_3.self_attention.out_proj.bias', 'encoder.layers.encoder_layer_3.ln_2.weight', 'encoder.layers.encoder_layer_3.ln_2.bias', 'encoder.layers.encoder_layer_3.mlp.0.weight', 'encoder.layers.encoder_layer_3.mlp.0.bias', 'encoder.layers.encoder_layer_3.mlp.3.weight', 'encoder.layers.encoder_layer_3.mlp.3.bias', 'encoder.layers.encoder_layer_4.ln_1.weight', 'encoder.layers.encoder_layer_4.ln_1.bias', 'encoder.layers.encoder_layer_4.self_attention.in_proj_weight', 'encoder.layers.encoder_layer_4.self_attention.in_proj_bias', 'encoder.layers.encoder_layer_4.self_attention.out_proj.weight', 'encoder.layers.encoder_layer_4.self_attention.out_proj.bias', 'encoder.layers.encoder_layer_4.ln_2.weight', 'encoder.layers.encoder_layer_4.ln_2.bias', 'encoder.layers.encoder_layer_4.mlp.0.weight', 'encoder.layers.encoder_layer_4.mlp.0.bias', 'encoder.layers.encoder_layer_4.mlp.3.weight', 'encoder.layers.encoder_layer_4.mlp.3.bias', 'encoder.layers.encoder_layer_5.ln_1.weight', 'encoder.layers.encoder_layer_5.ln_1.bias', 'encoder.layers.encoder_layer_5.self_attention.in_proj_weight', 'encoder.layers.encoder_layer_5.self_attention.in_proj_bias', 'encoder.layers.encoder_layer_5.self_attention.out_proj.weight', 'encoder.layers.encoder_layer_5.self_attention.out_proj.bias', 'encoder.layers.encoder_layer_5.ln_2.weight', 'encoder.layers.encoder_layer_5.ln_2.bias', 'encoder.layers.encoder_layer_5.mlp.0.weight', 'encoder.layers.encoder_layer_5.mlp.0.bias', 'encoder.layers.encoder_layer_5.mlp.3.weight', 'encoder.layers.encoder_layer_5.mlp.3.bias', 'encoder.layers.encoder_layer_6.ln_1.weight', 'encoder.layers.encoder_layer_6.ln_1.bias', 'encoder.layers.encoder_layer_6.self_attention.in_proj_weight', 'encoder.layers.encoder_layer_6.self_attention.in_proj_bias', 'encoder.layers.encoder_layer_6.self_attention.out_proj.weight', 'encoder.layers.encoder_layer_6.self_attention.out_proj.bias', 'encoder.layers.encoder_layer_6.ln_2.weight', 'encoder.layers.encoder_layer_6.ln_2.bias', 'encoder.layers.encoder_layer_6.mlp.0.weight', 'encoder.layers.encoder_layer_6.mlp.0.bias', 'encoder.layers.encoder_layer_6.mlp.3.weight', 'encoder.layers.encoder_layer_6.mlp.3.bias', 'encoder.layers.encoder_layer_7.ln_1.weight', 'encoder.layers.encoder_layer_7.ln_1.bias', 'encoder.layers.encoder_layer_7.self_attention.in_proj_weight', 'encoder.layers.encoder_layer_7.self_attention.in_proj_bias', 'encoder.layers.encoder_layer_7.self_attention.out_proj.weight', 'encoder.layers.encoder_layer_7.self_attention.out_proj.bias', 'encoder.layers.encoder_layer_7.ln_2.weight', 'encoder.layers.encoder_layer_7.ln_2.bias', 'encoder.layers.encoder_layer_7.mlp.0.weight', 'encoder.layers.encoder_layer_7.mlp.0.bias', 'encoder.layers.encoder_layer_7.mlp.3.weight', 'encoder.layers.encoder_layer_7.mlp.3.bias', 'encoder.layers.encoder_layer_8.ln_1.weight', 'encoder.layers.encoder_layer_8.ln_1.bias', 'encoder.layers.encoder_layer_8.self_attention.in_proj_weight', 'encoder.layers.encoder_layer_8.self_attention.in_proj_bias', 'encoder.layers.encoder_layer_8.self_attention.out_proj.weight', 'encoder.layers.encoder_layer_8.self_attention.out_proj.bias', 'encoder.layers.encoder_layer_8.ln_2.weight', 'encoder.layers.encoder_layer_8.ln_2.bias', 'encoder.layers.encoder_layer_8.mlp.0.weight', 'encoder.layers.encoder_layer_8.mlp.0.bias', 'encoder.layers.encoder_layer_8.mlp.3.weight', 'encoder.layers.encoder_layer_8.mlp.3.bias', 'encoder.layers.encoder_layer_9.ln_1.weight', 'encoder.layers.encoder_layer_9.ln_1.bias', 'encoder.layers.encoder_layer_9.self_attention.in_proj_weight', 'encoder.layers.encoder_layer_9.self_attention.in_proj_bias', 'encoder.layers.encoder_layer_9.self_attention.out_proj.weight', 'encoder.layers.encoder_layer_9.self_attention.out_proj.bias', 'encoder.layers.encoder_layer_9.ln_2.weight', 'encoder.layers.encoder_layer_9.ln_2.bias', 'encoder.layers.encoder_layer_9.mlp.0.weight', 'encoder.layers.encoder_layer_9.mlp.0.bias', 'encoder.layers.encoder_layer_9.mlp.3.weight', 'encoder.layers.encoder_layer_9.mlp.3.bias', 'encoder.layers.encoder_layer_10.ln_1.weight', 'encoder.layers.encoder_layer_10.ln_1.bias', 'encoder.layers.encoder_layer_10.self_attention.in_proj_weight', 'encoder.layers.encoder_layer_10.self_attention.in_proj_bias', 'encoder.layers.encoder_layer_10.self_attention.out_proj.weight', 'encoder.layers.encoder_layer_10.self_attention.out_proj.bias', 'encoder.layers.encoder_layer_10.ln_2.weight', 'encoder.layers.encoder_layer_10.ln_2.bias', 'encoder.layers.encoder_layer_10.mlp.0.weight', 'encoder.layers.encoder_layer_10.mlp.0.bias', 'encoder.layers.encoder_layer_10.mlp.3.weight', 'encoder.layers.encoder_layer_10.mlp.3.bias', 'encoder.layers.encoder_layer_11.ln_1.weight', 'encoder.layers.encoder_layer_11.ln_1.bias', 'encoder.layers.encoder_layer_11.self_attention.in_proj_weight', 'encoder.layers.encoder_layer_11.self_attention.in_proj_bias', 'encoder.layers.encoder_layer_11.self_attention.out_proj.weight', 'encoder.layers.encoder_layer_11.self_attention.out_proj.bias', 'encoder.layers.encoder_layer_11.ln_2.weight', 'encoder.layers.encoder_layer_11.ln_2.bias', 'encoder.layers.encoder_layer_11.mlp.0.weight', 'encoder.layers.encoder_layer_11.mlp.0.bias', 'encoder.layers.encoder_layer_11.mlp.3.weight', 'encoder.layers.encoder_layer_11.mlp.3.bias', 'encoder.ln.weight', 'encoder.ln.bias', 'heads.head.weight', 'heads.head.bias']
2025-05-03 08:50:10,677 [WARNING] - Unexpected keys when restoring best state for vit: ['features.0.0.weight', 'features.0.1.weight', 'features.0.1.bias', 'features.0.1.running_mean', 'features.0.1.running_var', 'features.0.1.num_batches_tracked', 'features.1.0.block.0.0.weight', 'features.1.0.block.0.1.weight', 'features.1.0.block.0.1.bias', 'features.1.0.block.0.1.running_mean', 'features.1.0.block.0.1.running_var', 'features.1.0.block.0.1.num_batches_tracked', 'features.1.0.block.1.fc1.weight', 'features.1.0.block.1.fc1.bias', 'features.1.0.block.1.fc2.weight', 'features.1.0.block.1.fc2.bias', 'features.1.0.block.2.0.weight', 'features.1.0.block.2.1.weight', 'features.1.0.block.2.1.bias', 'features.1.0.block.2.1.running_mean', 'features.1.0.block.2.1.running_var', 'features.1.0.block.2.1.num_batches_tracked', 'features.2.0.block.0.0.weight', 'features.2.0.block.0.1.weight', 'features.2.0.block.0.1.bias', 'features.2.0.block.0.1.running_mean', 'features.2.0.block.0.1.running_var', 'features.2.0.block.0.1.num_batches_tracked', 'features.2.0.block.1.0.weight', 'features.2.0.block.1.1.weight', 'features.2.0.block.1.1.bias', 'features.2.0.block.1.1.running_mean', 'features.2.0.block.1.1.running_var', 'features.2.0.block.1.1.num_batches_tracked', 'features.2.0.block.2.fc1.weight', 'features.2.0.block.2.fc1.bias', 'features.2.0.block.2.fc2.weight', 'features.2.0.block.2.fc2.bias', 'features.2.0.block.3.0.weight', 'features.2.0.block.3.1.weight', 'features.2.0.block.3.1.bias', 'features.2.0.block.3.1.running_mean', 'features.2.0.block.3.1.running_var', 'features.2.0.block.3.1.num_batches_tracked', 'features.2.1.block.0.0.weight', 'features.2.1.block.0.1.weight', 'features.2.1.block.0.1.bias', 'features.2.1.block.0.1.running_mean', 'features.2.1.block.0.1.running_var', 'features.2.1.block.0.1.num_batches_tracked', 'features.2.1.block.1.0.weight', 'features.2.1.block.1.1.weight', 'features.2.1.block.1.1.bias', 'features.2.1.block.1.1.running_mean', 'features.2.1.block.1.1.running_var', 'features.2.1.block.1.1.num_batches_tracked', 'features.2.1.block.2.fc1.weight', 'features.2.1.block.2.fc1.bias', 'features.2.1.block.2.fc2.weight', 'features.2.1.block.2.fc2.bias', 'features.2.1.block.3.0.weight', 'features.2.1.block.3.1.weight', 'features.2.1.block.3.1.bias', 'features.2.1.block.3.1.running_mean', 'features.2.1.block.3.1.running_var', 'features.2.1.block.3.1.num_batches_tracked', 'features.3.0.block.0.0.weight', 'features.3.0.block.0.1.weight', 'features.3.0.block.0.1.bias', 'features.3.0.block.0.1.running_mean', 'features.3.0.block.0.1.running_var', 'features.3.0.block.0.1.num_batches_tracked', 'features.3.0.block.1.0.weight', 'features.3.0.block.1.1.weight', 'features.3.0.block.1.1.bias', 'features.3.0.block.1.1.running_mean', 'features.3.0.block.1.1.running_var', 'features.3.0.block.1.1.num_batches_tracked', 'features.3.0.block.2.fc1.weight', 'features.3.0.block.2.fc1.bias', 'features.3.0.block.2.fc2.weight', 'features.3.0.block.2.fc2.bias', 'features.3.0.block.3.0.weight', 'features.3.0.block.3.1.weight', 'features.3.0.block.3.1.bias', 'features.3.0.block.3.1.running_mean', 'features.3.0.block.3.1.running_var', 'features.3.0.block.3.1.num_batches_tracked', 'features.3.1.block.0.0.weight', 'features.3.1.block.0.1.weight', 'features.3.1.block.0.1.bias', 'features.3.1.block.0.1.running_mean', 'features.3.1.block.0.1.running_var', 'features.3.1.block.0.1.num_batches_tracked', 'features.3.1.block.1.0.weight', 'features.3.1.block.1.1.weight', 'features.3.1.block.1.1.bias', 'features.3.1.block.1.1.running_mean', 'features.3.1.block.1.1.running_var', 'features.3.1.block.1.1.num_batches_tracked', 'features.3.1.block.2.fc1.weight', 'features.3.1.block.2.fc1.bias', 'features.3.1.block.2.fc2.weight', 'features.3.1.block.2.fc2.bias', 'features.3.1.block.3.0.weight', 'features.3.1.block.3.1.weight', 'features.3.1.block.3.1.bias', 'features.3.1.block.3.1.running_mean', 'features.3.1.block.3.1.running_var', 'features.3.1.block.3.1.num_batches_tracked', 'features.4.0.block.0.0.weight', 'features.4.0.block.0.1.weight', 'features.4.0.block.0.1.bias', 'features.4.0.block.0.1.running_mean', 'features.4.0.block.0.1.running_var', 'features.4.0.block.0.1.num_batches_tracked', 'features.4.0.block.1.0.weight', 'features.4.0.block.1.1.weight', 'features.4.0.block.1.1.bias', 'features.4.0.block.1.1.running_mean', 'features.4.0.block.1.1.running_var', 'features.4.0.block.1.1.num_batches_tracked', 'features.4.0.block.2.fc1.weight', 'features.4.0.block.2.fc1.bias', 'features.4.0.block.2.fc2.weight', 'features.4.0.block.2.fc2.bias', 'features.4.0.block.3.0.weight', 'features.4.0.block.3.1.weight', 'features.4.0.block.3.1.bias', 'features.4.0.block.3.1.running_mean', 'features.4.0.block.3.1.running_var', 'features.4.0.block.3.1.num_batches_tracked', 'features.4.1.block.0.0.weight', 'features.4.1.block.0.1.weight', 'features.4.1.block.0.1.bias', 'features.4.1.block.0.1.running_mean', 'features.4.1.block.0.1.running_var', 'features.4.1.block.0.1.num_batches_tracked', 'features.4.1.block.1.0.weight', 'features.4.1.block.1.1.weight', 'features.4.1.block.1.1.bias', 'features.4.1.block.1.1.running_mean', 'features.4.1.block.1.1.running_var', 'features.4.1.block.1.1.num_batches_tracked', 'features.4.1.block.2.fc1.weight', 'features.4.1.block.2.fc1.bias', 'features.4.1.block.2.fc2.weight', 'features.4.1.block.2.fc2.bias', 'features.4.1.block.3.0.weight', 'features.4.1.block.3.1.weight', 'features.4.1.block.3.1.bias', 'features.4.1.block.3.1.running_mean', 'features.4.1.block.3.1.running_var', 'features.4.1.block.3.1.num_batches_tracked', 'features.4.2.block.0.0.weight', 'features.4.2.block.0.1.weight', 'features.4.2.block.0.1.bias', 'features.4.2.block.0.1.running_mean', 'features.4.2.block.0.1.running_var', 'features.4.2.block.0.1.num_batches_tracked', 'features.4.2.block.1.0.weight', 'features.4.2.block.1.1.weight', 'features.4.2.block.1.1.bias', 'features.4.2.block.1.1.running_mean', 'features.4.2.block.1.1.running_var', 'features.4.2.block.1.1.num_batches_tracked', 'features.4.2.block.2.fc1.weight', 'features.4.2.block.2.fc1.bias', 'features.4.2.block.2.fc2.weight', 'features.4.2.block.2.fc2.bias', 'features.4.2.block.3.0.weight', 'features.4.2.block.3.1.weight', 'features.4.2.block.3.1.bias', 'features.4.2.block.3.1.running_mean', 'features.4.2.block.3.1.running_var', 'features.4.2.block.3.1.num_batches_tracked', 'features.5.0.block.0.0.weight', 'features.5.0.block.0.1.weight', 'features.5.0.block.0.1.bias', 'features.5.0.block.0.1.running_mean', 'features.5.0.block.0.1.running_var', 'features.5.0.block.0.1.num_batches_tracked', 'features.5.0.block.1.0.weight', 'features.5.0.block.1.1.weight', 'features.5.0.block.1.1.bias', 'features.5.0.block.1.1.running_mean', 'features.5.0.block.1.1.running_var', 'features.5.0.block.1.1.num_batches_tracked', 'features.5.0.block.2.fc1.weight', 'features.5.0.block.2.fc1.bias', 'features.5.0.block.2.fc2.weight', 'features.5.0.block.2.fc2.bias', 'features.5.0.block.3.0.weight', 'features.5.0.block.3.1.weight', 'features.5.0.block.3.1.bias', 'features.5.0.block.3.1.running_mean', 'features.5.0.block.3.1.running_var', 'features.5.0.block.3.1.num_batches_tracked', 'features.5.1.block.0.0.weight', 'features.5.1.block.0.1.weight', 'features.5.1.block.0.1.bias', 'features.5.1.block.0.1.running_mean', 'features.5.1.block.0.1.running_var', 'features.5.1.block.0.1.num_batches_tracked', 'features.5.1.block.1.0.weight', 'features.5.1.block.1.1.weight', 'features.5.1.block.1.1.bias', 'features.5.1.block.1.1.running_mean', 'features.5.1.block.1.1.running_var', 'features.5.1.block.1.1.num_batches_tracked', 'features.5.1.block.2.fc1.weight', 'features.5.1.block.2.fc1.bias', 'features.5.1.block.2.fc2.weight', 'features.5.1.block.2.fc2.bias', 'features.5.1.block.3.0.weight', 'features.5.1.block.3.1.weight', 'features.5.1.block.3.1.bias', 'features.5.1.block.3.1.running_mean', 'features.5.1.block.3.1.running_var', 'features.5.1.block.3.1.num_batches_tracked', 'features.5.2.block.0.0.weight', 'features.5.2.block.0.1.weight', 'features.5.2.block.0.1.bias', 'features.5.2.block.0.1.running_mean', 'features.5.2.block.0.1.running_var', 'features.5.2.block.0.1.num_batches_tracked', 'features.5.2.block.1.0.weight', 'features.5.2.block.1.1.weight', 'features.5.2.block.1.1.bias', 'features.5.2.block.1.1.running_mean', 'features.5.2.block.1.1.running_var', 'features.5.2.block.1.1.num_batches_tracked', 'features.5.2.block.2.fc1.weight', 'features.5.2.block.2.fc1.bias', 'features.5.2.block.2.fc2.weight', 'features.5.2.block.2.fc2.bias', 'features.5.2.block.3.0.weight', 'features.5.2.block.3.1.weight', 'features.5.2.block.3.1.bias', 'features.5.2.block.3.1.running_mean', 'features.5.2.block.3.1.running_var', 'features.5.2.block.3.1.num_batches_tracked', 'features.6.0.block.0.0.weight', 'features.6.0.block.0.1.weight', 'features.6.0.block.0.1.bias', 'features.6.0.block.0.1.running_mean', 'features.6.0.block.0.1.running_var', 'features.6.0.block.0.1.num_batches_tracked', 'features.6.0.block.1.0.weight', 'features.6.0.block.1.1.weight', 'features.6.0.block.1.1.bias', 'features.6.0.block.1.1.running_mean', 'features.6.0.block.1.1.running_var', 'features.6.0.block.1.1.num_batches_tracked', 'features.6.0.block.2.fc1.weight', 'features.6.0.block.2.fc1.bias', 'features.6.0.block.2.fc2.weight', 'features.6.0.block.2.fc2.bias', 'features.6.0.block.3.0.weight', 'features.6.0.block.3.1.weight', 'features.6.0.block.3.1.bias', 'features.6.0.block.3.1.running_mean', 'features.6.0.block.3.1.running_var', 'features.6.0.block.3.1.num_batches_tracked', 'features.6.1.block.0.0.weight', 'features.6.1.block.0.1.weight', 'features.6.1.block.0.1.bias', 'features.6.1.block.0.1.running_mean', 'features.6.1.block.0.1.running_var', 'features.6.1.block.0.1.num_batches_tracked', 'features.6.1.block.1.0.weight', 'features.6.1.block.1.1.weight', 'features.6.1.block.1.1.bias', 'features.6.1.block.1.1.running_mean', 'features.6.1.block.1.1.running_var', 'features.6.1.block.1.1.num_batches_tracked', 'features.6.1.block.2.fc1.weight', 'features.6.1.block.2.fc1.bias', 'features.6.1.block.2.fc2.weight', 'features.6.1.block.2.fc2.bias', 'features.6.1.block.3.0.weight', 'features.6.1.block.3.1.weight', 'features.6.1.block.3.1.bias', 'features.6.1.block.3.1.running_mean', 'features.6.1.block.3.1.running_var', 'features.6.1.block.3.1.num_batches_tracked', 'features.6.2.block.0.0.weight', 'features.6.2.block.0.1.weight', 'features.6.2.block.0.1.bias', 'features.6.2.block.0.1.running_mean', 'features.6.2.block.0.1.running_var', 'features.6.2.block.0.1.num_batches_tracked', 'features.6.2.block.1.0.weight', 'features.6.2.block.1.1.weight', 'features.6.2.block.1.1.bias', 'features.6.2.block.1.1.running_mean', 'features.6.2.block.1.1.running_var', 'features.6.2.block.1.1.num_batches_tracked', 'features.6.2.block.2.fc1.weight', 'features.6.2.block.2.fc1.bias', 'features.6.2.block.2.fc2.weight', 'features.6.2.block.2.fc2.bias', 'features.6.2.block.3.0.weight', 'features.6.2.block.3.1.weight', 'features.6.2.block.3.1.bias', 'features.6.2.block.3.1.running_mean', 'features.6.2.block.3.1.running_var', 'features.6.2.block.3.1.num_batches_tracked', 'features.6.3.block.0.0.weight', 'features.6.3.block.0.1.weight', 'features.6.3.block.0.1.bias', 'features.6.3.block.0.1.running_mean', 'features.6.3.block.0.1.running_var', 'features.6.3.block.0.1.num_batches_tracked', 'features.6.3.block.1.0.weight', 'features.6.3.block.1.1.weight', 'features.6.3.block.1.1.bias', 'features.6.3.block.1.1.running_mean', 'features.6.3.block.1.1.running_var', 'features.6.3.block.1.1.num_batches_tracked', 'features.6.3.block.2.fc1.weight', 'features.6.3.block.2.fc1.bias', 'features.6.3.block.2.fc2.weight', 'features.6.3.block.2.fc2.bias', 'features.6.3.block.3.0.weight', 'features.6.3.block.3.1.weight', 'features.6.3.block.3.1.bias', 'features.6.3.block.3.1.running_mean', 'features.6.3.block.3.1.running_var', 'features.6.3.block.3.1.num_batches_tracked', 'features.7.0.block.0.0.weight', 'features.7.0.block.0.1.weight', 'features.7.0.block.0.1.bias', 'features.7.0.block.0.1.running_mean', 'features.7.0.block.0.1.running_var', 'features.7.0.block.0.1.num_batches_tracked', 'features.7.0.block.1.0.weight', 'features.7.0.block.1.1.weight', 'features.7.0.block.1.1.bias', 'features.7.0.block.1.1.running_mean', 'features.7.0.block.1.1.running_var', 'features.7.0.block.1.1.num_batches_tracked', 'features.7.0.block.2.fc1.weight', 'features.7.0.block.2.fc1.bias', 'features.7.0.block.2.fc2.weight', 'features.7.0.block.2.fc2.bias', 'features.7.0.block.3.0.weight', 'features.7.0.block.3.1.weight', 'features.7.0.block.3.1.bias', 'features.7.0.block.3.1.running_mean', 'features.7.0.block.3.1.running_var', 'features.7.0.block.3.1.num_batches_tracked', 'features.8.0.weight', 'features.8.1.weight', 'features.8.1.bias', 'features.8.1.running_mean', 'features.8.1.running_var', 'features.8.1.num_batches_tracked', 'classifier.1.weight', 'classifier.1.bias']
2025-05-03 08:50:10,678 [INFO] - Restored best state for vit from initialization (Val Acc: 96.06%)
2025-05-03 08:50:10,690 [INFO] - Restored best state for efficientnet from initialization (Val Acc: 94.96%)
2025-05-03 08:50:10,693 [WARNING] - Missing keys when restoring best state for inception: ['Conv2d_1a_3x3.conv.weight', 'Conv2d_1a_3x3.bn.weight', 'Conv2d_1a_3x3.bn.bias', 'Conv2d_1a_3x3.bn.running_mean', 'Conv2d_1a_3x3.bn.running_var', 'Conv2d_2a_3x3.conv.weight', 'Conv2d_2a_3x3.bn.weight', 'Conv2d_2a_3x3.bn.bias', 'Conv2d_2a_3x3.bn.running_mean', 'Conv2d_2a_3x3.bn.running_var', 'Conv2d_2b_3x3.conv.weight', 'Conv2d_2b_3x3.bn.weight', 'Conv2d_2b_3x3.bn.bias', 'Conv2d_2b_3x3.bn.running_mean', 'Conv2d_2b_3x3.bn.running_var', 'Conv2d_3b_1x1.conv.weight', 'Conv2d_3b_1x1.bn.weight', 'Conv2d_3b_1x1.bn.bias', 'Conv2d_3b_1x1.bn.running_mean', 'Conv2d_3b_1x1.bn.running_var', 'Conv2d_4a_3x3.conv.weight', 'Conv2d_4a_3x3.bn.weight', 'Conv2d_4a_3x3.bn.bias', 'Conv2d_4a_3x3.bn.running_mean', 'Conv2d_4a_3x3.bn.running_var', 'Mixed_5b.branch1x1.conv.weight', 'Mixed_5b.branch1x1.bn.weight', 'Mixed_5b.branch1x1.bn.bias', 'Mixed_5b.branch1x1.bn.running_mean', 'Mixed_5b.branch1x1.bn.running_var', 'Mixed_5b.branch5x5_1.conv.weight', 'Mixed_5b.branch5x5_1.bn.weight', 'Mixed_5b.branch5x5_1.bn.bias', 'Mixed_5b.branch5x5_1.bn.running_mean', 'Mixed_5b.branch5x5_1.bn.running_var', 'Mixed_5b.branch5x5_2.conv.weight', 'Mixed_5b.branch5x5_2.bn.weight', 'Mixed_5b.branch5x5_2.bn.bias', 'Mixed_5b.branch5x5_2.bn.running_mean', 'Mixed_5b.branch5x5_2.bn.running_var', 'Mixed_5b.branch3x3dbl_1.conv.weight', 'Mixed_5b.branch3x3dbl_1.bn.weight', 'Mixed_5b.branch3x3dbl_1.bn.bias', 'Mixed_5b.branch3x3dbl_1.bn.running_mean', 'Mixed_5b.branch3x3dbl_1.bn.running_var', 'Mixed_5b.branch3x3dbl_2.conv.weight', 'Mixed_5b.branch3x3dbl_2.bn.weight', 'Mixed_5b.branch3x3dbl_2.bn.bias', 'Mixed_5b.branch3x3dbl_2.bn.running_mean', 'Mixed_5b.branch3x3dbl_2.bn.running_var', 'Mixed_5b.branch3x3dbl_3.conv.weight', 'Mixed_5b.branch3x3dbl_3.bn.weight', 'Mixed_5b.branch3x3dbl_3.bn.bias', 'Mixed_5b.branch3x3dbl_3.bn.running_mean', 'Mixed_5b.branch3x3dbl_3.bn.running_var', 'Mixed_5b.branch_pool.conv.weight', 'Mixed_5b.branch_pool.bn.weight', 'Mixed_5b.branch_pool.bn.bias', 'Mixed_5b.branch_pool.bn.running_mean', 'Mixed_5b.branch_pool.bn.running_var', 'Mixed_5c.branch1x1.conv.weight', 'Mixed_5c.branch1x1.bn.weight', 'Mixed_5c.branch1x1.bn.bias', 'Mixed_5c.branch1x1.bn.running_mean', 'Mixed_5c.branch1x1.bn.running_var', 'Mixed_5c.branch5x5_1.conv.weight', 'Mixed_5c.branch5x5_1.bn.weight', 'Mixed_5c.branch5x5_1.bn.bias', 'Mixed_5c.branch5x5_1.bn.running_mean', 'Mixed_5c.branch5x5_1.bn.running_var', 'Mixed_5c.branch5x5_2.conv.weight', 'Mixed_5c.branch5x5_2.bn.weight', 'Mixed_5c.branch5x5_2.bn.bias', 'Mixed_5c.branch5x5_2.bn.running_mean', 'Mixed_5c.branch5x5_2.bn.running_var', 'Mixed_5c.branch3x3dbl_1.conv.weight', 'Mixed_5c.branch3x3dbl_1.bn.weight', 'Mixed_5c.branch3x3dbl_1.bn.bias', 'Mixed_5c.branch3x3dbl_1.bn.running_mean', 'Mixed_5c.branch3x3dbl_1.bn.running_var', 'Mixed_5c.branch3x3dbl_2.conv.weight', 'Mixed_5c.branch3x3dbl_2.bn.weight', 'Mixed_5c.branch3x3dbl_2.bn.bias', 'Mixed_5c.branch3x3dbl_2.bn.running_mean', 'Mixed_5c.branch3x3dbl_2.bn.running_var', 'Mixed_5c.branch3x3dbl_3.conv.weight', 'Mixed_5c.branch3x3dbl_3.bn.weight', 'Mixed_5c.branch3x3dbl_3.bn.bias', 'Mixed_5c.branch3x3dbl_3.bn.running_mean', 'Mixed_5c.branch3x3dbl_3.bn.running_var', 'Mixed_5c.branch_pool.conv.weight', 'Mixed_5c.branch_pool.bn.weight', 'Mixed_5c.branch_pool.bn.bias', 'Mixed_5c.branch_pool.bn.running_mean', 'Mixed_5c.branch_pool.bn.running_var', 'Mixed_5d.branch1x1.conv.weight', 'Mixed_5d.branch1x1.bn.weight', 'Mixed_5d.branch1x1.bn.bias', 'Mixed_5d.branch1x1.bn.running_mean', 'Mixed_5d.branch1x1.bn.running_var', 'Mixed_5d.branch5x5_1.conv.weight', 'Mixed_5d.branch5x5_1.bn.weight', 'Mixed_5d.branch5x5_1.bn.bias', 'Mixed_5d.branch5x5_1.bn.running_mean', 'Mixed_5d.branch5x5_1.bn.running_var', 'Mixed_5d.branch5x5_2.conv.weight', 'Mixed_5d.branch5x5_2.bn.weight', 'Mixed_5d.branch5x5_2.bn.bias', 'Mixed_5d.branch5x5_2.bn.running_mean', 'Mixed_5d.branch5x5_2.bn.running_var', 'Mixed_5d.branch3x3dbl_1.conv.weight', 'Mixed_5d.branch3x3dbl_1.bn.weight', 'Mixed_5d.branch3x3dbl_1.bn.bias', 'Mixed_5d.branch3x3dbl_1.bn.running_mean', 'Mixed_5d.branch3x3dbl_1.bn.running_var', 'Mixed_5d.branch3x3dbl_2.conv.weight', 'Mixed_5d.branch3x3dbl_2.bn.weight', 'Mixed_5d.branch3x3dbl_2.bn.bias', 'Mixed_5d.branch3x3dbl_2.bn.running_mean', 'Mixed_5d.branch3x3dbl_2.bn.running_var', 'Mixed_5d.branch3x3dbl_3.conv.weight', 'Mixed_5d.branch3x3dbl_3.bn.weight', 'Mixed_5d.branch3x3dbl_3.bn.bias', 'Mixed_5d.branch3x3dbl_3.bn.running_mean', 'Mixed_5d.branch3x3dbl_3.bn.running_var', 'Mixed_5d.branch_pool.conv.weight', 'Mixed_5d.branch_pool.bn.weight', 'Mixed_5d.branch_pool.bn.bias', 'Mixed_5d.branch_pool.bn.running_mean', 'Mixed_5d.branch_pool.bn.running_var', 'Mixed_6a.branch3x3.conv.weight', 'Mixed_6a.branch3x3.bn.weight', 'Mixed_6a.branch3x3.bn.bias', 'Mixed_6a.branch3x3.bn.running_mean', 'Mixed_6a.branch3x3.bn.running_var', 'Mixed_6a.branch3x3dbl_1.conv.weight', 'Mixed_6a.branch3x3dbl_1.bn.weight', 'Mixed_6a.branch3x3dbl_1.bn.bias', 'Mixed_6a.branch3x3dbl_1.bn.running_mean', 'Mixed_6a.branch3x3dbl_1.bn.running_var', 'Mixed_6a.branch3x3dbl_2.conv.weight', 'Mixed_6a.branch3x3dbl_2.bn.weight', 'Mixed_6a.branch3x3dbl_2.bn.bias', 'Mixed_6a.branch3x3dbl_2.bn.running_mean', 'Mixed_6a.branch3x3dbl_2.bn.running_var', 'Mixed_6a.branch3x3dbl_3.conv.weight', 'Mixed_6a.branch3x3dbl_3.bn.weight', 'Mixed_6a.branch3x3dbl_3.bn.bias', 'Mixed_6a.branch3x3dbl_3.bn.running_mean', 'Mixed_6a.branch3x3dbl_3.bn.running_var', 'Mixed_6b.branch1x1.conv.weight', 'Mixed_6b.branch1x1.bn.weight', 'Mixed_6b.branch1x1.bn.bias', 'Mixed_6b.branch1x1.bn.running_mean', 'Mixed_6b.branch1x1.bn.running_var', 'Mixed_6b.branch7x7_1.conv.weight', 'Mixed_6b.branch7x7_1.bn.weight', 'Mixed_6b.branch7x7_1.bn.bias', 'Mixed_6b.branch7x7_1.bn.running_mean', 'Mixed_6b.branch7x7_1.bn.running_var', 'Mixed_6b.branch7x7_2.conv.weight', 'Mixed_6b.branch7x7_2.bn.weight', 'Mixed_6b.branch7x7_2.bn.bias', 'Mixed_6b.branch7x7_2.bn.running_mean', 'Mixed_6b.branch7x7_2.bn.running_var', 'Mixed_6b.branch7x7_3.conv.weight', 'Mixed_6b.branch7x7_3.bn.weight', 'Mixed_6b.branch7x7_3.bn.bias', 'Mixed_6b.branch7x7_3.bn.running_mean', 'Mixed_6b.branch7x7_3.bn.running_var', 'Mixed_6b.branch7x7dbl_1.conv.weight', 'Mixed_6b.branch7x7dbl_1.bn.weight', 'Mixed_6b.branch7x7dbl_1.bn.bias', 'Mixed_6b.branch7x7dbl_1.bn.running_mean', 'Mixed_6b.branch7x7dbl_1.bn.running_var', 'Mixed_6b.branch7x7dbl_2.conv.weight', 'Mixed_6b.branch7x7dbl_2.bn.weight', 'Mixed_6b.branch7x7dbl_2.bn.bias', 'Mixed_6b.branch7x7dbl_2.bn.running_mean', 'Mixed_6b.branch7x7dbl_2.bn.running_var', 'Mixed_6b.branch7x7dbl_3.conv.weight', 'Mixed_6b.branch7x7dbl_3.bn.weight', 'Mixed_6b.branch7x7dbl_3.bn.bias', 'Mixed_6b.branch7x7dbl_3.bn.running_mean', 'Mixed_6b.branch7x7dbl_3.bn.running_var', 'Mixed_6b.branch7x7dbl_4.conv.weight', 'Mixed_6b.branch7x7dbl_4.bn.weight', 'Mixed_6b.branch7x7dbl_4.bn.bias', 'Mixed_6b.branch7x7dbl_4.bn.running_mean', 'Mixed_6b.branch7x7dbl_4.bn.running_var', 'Mixed_6b.branch7x7dbl_5.conv.weight', 'Mixed_6b.branch7x7dbl_5.bn.weight', 'Mixed_6b.branch7x7dbl_5.bn.bias', 'Mixed_6b.branch7x7dbl_5.bn.running_mean', 'Mixed_6b.branch7x7dbl_5.bn.running_var', 'Mixed_6b.branch_pool.conv.weight', 'Mixed_6b.branch_pool.bn.weight', 'Mixed_6b.branch_pool.bn.bias', 'Mixed_6b.branch_pool.bn.running_mean', 'Mixed_6b.branch_pool.bn.running_var', 'Mixed_6c.branch1x1.conv.weight', 'Mixed_6c.branch1x1.bn.weight', 'Mixed_6c.branch1x1.bn.bias', 'Mixed_6c.branch1x1.bn.running_mean', 'Mixed_6c.branch1x1.bn.running_var', 'Mixed_6c.branch7x7_1.conv.weight', 'Mixed_6c.branch7x7_1.bn.weight', 'Mixed_6c.branch7x7_1.bn.bias', 'Mixed_6c.branch7x7_1.bn.running_mean', 'Mixed_6c.branch7x7_1.bn.running_var', 'Mixed_6c.branch7x7_2.conv.weight', 'Mixed_6c.branch7x7_2.bn.weight', 'Mixed_6c.branch7x7_2.bn.bias', 'Mixed_6c.branch7x7_2.bn.running_mean', 'Mixed_6c.branch7x7_2.bn.running_var', 'Mixed_6c.branch7x7_3.conv.weight', 'Mixed_6c.branch7x7_3.bn.weight', 'Mixed_6c.branch7x7_3.bn.bias', 'Mixed_6c.branch7x7_3.bn.running_mean', 'Mixed_6c.branch7x7_3.bn.running_var', 'Mixed_6c.branch7x7dbl_1.conv.weight', 'Mixed_6c.branch7x7dbl_1.bn.weight', 'Mixed_6c.branch7x7dbl_1.bn.bias', 'Mixed_6c.branch7x7dbl_1.bn.running_mean', 'Mixed_6c.branch7x7dbl_1.bn.running_var', 'Mixed_6c.branch7x7dbl_2.conv.weight', 'Mixed_6c.branch7x7dbl_2.bn.weight', 'Mixed_6c.branch7x7dbl_2.bn.bias', 'Mixed_6c.branch7x7dbl_2.bn.running_mean', 'Mixed_6c.branch7x7dbl_2.bn.running_var', 'Mixed_6c.branch7x7dbl_3.conv.weight', 'Mixed_6c.branch7x7dbl_3.bn.weight', 'Mixed_6c.branch7x7dbl_3.bn.bias', 'Mixed_6c.branch7x7dbl_3.bn.running_mean', 'Mixed_6c.branch7x7dbl_3.bn.running_var', 'Mixed_6c.branch7x7dbl_4.conv.weight', 'Mixed_6c.branch7x7dbl_4.bn.weight', 'Mixed_6c.branch7x7dbl_4.bn.bias', 'Mixed_6c.branch7x7dbl_4.bn.running_mean', 'Mixed_6c.branch7x7dbl_4.bn.running_var', 'Mixed_6c.branch7x7dbl_5.conv.weight', 'Mixed_6c.branch7x7dbl_5.bn.weight', 'Mixed_6c.branch7x7dbl_5.bn.bias', 'Mixed_6c.branch7x7dbl_5.bn.running_mean', 'Mixed_6c.branch7x7dbl_5.bn.running_var', 'Mixed_6c.branch_pool.conv.weight', 'Mixed_6c.branch_pool.bn.weight', 'Mixed_6c.branch_pool.bn.bias', 'Mixed_6c.branch_pool.bn.running_mean', 'Mixed_6c.branch_pool.bn.running_var', 'Mixed_6d.branch1x1.conv.weight', 'Mixed_6d.branch1x1.bn.weight', 'Mixed_6d.branch1x1.bn.bias', 'Mixed_6d.branch1x1.bn.running_mean', 'Mixed_6d.branch1x1.bn.running_var', 'Mixed_6d.branch7x7_1.conv.weight', 'Mixed_6d.branch7x7_1.bn.weight', 'Mixed_6d.branch7x7_1.bn.bias', 'Mixed_6d.branch7x7_1.bn.running_mean', 'Mixed_6d.branch7x7_1.bn.running_var', 'Mixed_6d.branch7x7_2.conv.weight', 'Mixed_6d.branch7x7_2.bn.weight', 'Mixed_6d.branch7x7_2.bn.bias', 'Mixed_6d.branch7x7_2.bn.running_mean', 'Mixed_6d.branch7x7_2.bn.running_var', 'Mixed_6d.branch7x7_3.conv.weight', 'Mixed_6d.branch7x7_3.bn.weight', 'Mixed_6d.branch7x7_3.bn.bias', 'Mixed_6d.branch7x7_3.bn.running_mean', 'Mixed_6d.branch7x7_3.bn.running_var', 'Mixed_6d.branch7x7dbl_1.conv.weight', 'Mixed_6d.branch7x7dbl_1.bn.weight', 'Mixed_6d.branch7x7dbl_1.bn.bias', 'Mixed_6d.branch7x7dbl_1.bn.running_mean', 'Mixed_6d.branch7x7dbl_1.bn.running_var', 'Mixed_6d.branch7x7dbl_2.conv.weight', 'Mixed_6d.branch7x7dbl_2.bn.weight', 'Mixed_6d.branch7x7dbl_2.bn.bias', 'Mixed_6d.branch7x7dbl_2.bn.running_mean', 'Mixed_6d.branch7x7dbl_2.bn.running_var', 'Mixed_6d.branch7x7dbl_3.conv.weight', 'Mixed_6d.branch7x7dbl_3.bn.weight', 'Mixed_6d.branch7x7dbl_3.bn.bias', 'Mixed_6d.branch7x7dbl_3.bn.running_mean', 'Mixed_6d.branch7x7dbl_3.bn.running_var', 'Mixed_6d.branch7x7dbl_4.conv.weight', 'Mixed_6d.branch7x7dbl_4.bn.weight', 'Mixed_6d.branch7x7dbl_4.bn.bias', 'Mixed_6d.branch7x7dbl_4.bn.running_mean', 'Mixed_6d.branch7x7dbl_4.bn.running_var', 'Mixed_6d.branch7x7dbl_5.conv.weight', 'Mixed_6d.branch7x7dbl_5.bn.weight', 'Mixed_6d.branch7x7dbl_5.bn.bias', 'Mixed_6d.branch7x7dbl_5.bn.running_mean', 'Mixed_6d.branch7x7dbl_5.bn.running_var', 'Mixed_6d.branch_pool.conv.weight', 'Mixed_6d.branch_pool.bn.weight', 'Mixed_6d.branch_pool.bn.bias', 'Mixed_6d.branch_pool.bn.running_mean', 'Mixed_6d.branch_pool.bn.running_var', 'Mixed_6e.branch1x1.conv.weight', 'Mixed_6e.branch1x1.bn.weight', 'Mixed_6e.branch1x1.bn.bias', 'Mixed_6e.branch1x1.bn.running_mean', 'Mixed_6e.branch1x1.bn.running_var', 'Mixed_6e.branch7x7_1.conv.weight', 'Mixed_6e.branch7x7_1.bn.weight', 'Mixed_6e.branch7x7_1.bn.bias', 'Mixed_6e.branch7x7_1.bn.running_mean', 'Mixed_6e.branch7x7_1.bn.running_var', 'Mixed_6e.branch7x7_2.conv.weight', 'Mixed_6e.branch7x7_2.bn.weight', 'Mixed_6e.branch7x7_2.bn.bias', 'Mixed_6e.branch7x7_2.bn.running_mean', 'Mixed_6e.branch7x7_2.bn.running_var', 'Mixed_6e.branch7x7_3.conv.weight', 'Mixed_6e.branch7x7_3.bn.weight', 'Mixed_6e.branch7x7_3.bn.bias', 'Mixed_6e.branch7x7_3.bn.running_mean', 'Mixed_6e.branch7x7_3.bn.running_var', 'Mixed_6e.branch7x7dbl_1.conv.weight', 'Mixed_6e.branch7x7dbl_1.bn.weight', 'Mixed_6e.branch7x7dbl_1.bn.bias', 'Mixed_6e.branch7x7dbl_1.bn.running_mean', 'Mixed_6e.branch7x7dbl_1.bn.running_var', 'Mixed_6e.branch7x7dbl_2.conv.weight', 'Mixed_6e.branch7x7dbl_2.bn.weight', 'Mixed_6e.branch7x7dbl_2.bn.bias', 'Mixed_6e.branch7x7dbl_2.bn.running_mean', 'Mixed_6e.branch7x7dbl_2.bn.running_var', 'Mixed_6e.branch7x7dbl_3.conv.weight', 'Mixed_6e.branch7x7dbl_3.bn.weight', 'Mixed_6e.branch7x7dbl_3.bn.bias', 'Mixed_6e.branch7x7dbl_3.bn.running_mean', 'Mixed_6e.branch7x7dbl_3.bn.running_var', 'Mixed_6e.branch7x7dbl_4.conv.weight', 'Mixed_6e.branch7x7dbl_4.bn.weight', 'Mixed_6e.branch7x7dbl_4.bn.bias', 'Mixed_6e.branch7x7dbl_4.bn.running_mean', 'Mixed_6e.branch7x7dbl_4.bn.running_var', 'Mixed_6e.branch7x7dbl_5.conv.weight', 'Mixed_6e.branch7x7dbl_5.bn.weight', 'Mixed_6e.branch7x7dbl_5.bn.bias', 'Mixed_6e.branch7x7dbl_5.bn.running_mean', 'Mixed_6e.branch7x7dbl_5.bn.running_var', 'Mixed_6e.branch_pool.conv.weight', 'Mixed_6e.branch_pool.bn.weight', 'Mixed_6e.branch_pool.bn.bias', 'Mixed_6e.branch_pool.bn.running_mean', 'Mixed_6e.branch_pool.bn.running_var', 'AuxLogits.conv0.conv.weight', 'AuxLogits.conv0.bn.weight', 'AuxLogits.conv0.bn.bias', 'AuxLogits.conv0.bn.running_mean', 'AuxLogits.conv0.bn.running_var', 'AuxLogits.conv1.conv.weight', 'AuxLogits.conv1.bn.weight', 'AuxLogits.conv1.bn.bias', 'AuxLogits.conv1.bn.running_mean', 'AuxLogits.conv1.bn.running_var', 'AuxLogits.fc.weight', 'AuxLogits.fc.bias', 'Mixed_7a.branch3x3_1.conv.weight', 'Mixed_7a.branch3x3_1.bn.weight', 'Mixed_7a.branch3x3_1.bn.bias', 'Mixed_7a.branch3x3_1.bn.running_mean', 'Mixed_7a.branch3x3_1.bn.running_var', 'Mixed_7a.branch3x3_2.conv.weight', 'Mixed_7a.branch3x3_2.bn.weight', 'Mixed_7a.branch3x3_2.bn.bias', 'Mixed_7a.branch3x3_2.bn.running_mean', 'Mixed_7a.branch3x3_2.bn.running_var', 'Mixed_7a.branch7x7x3_1.conv.weight', 'Mixed_7a.branch7x7x3_1.bn.weight', 'Mixed_7a.branch7x7x3_1.bn.bias', 'Mixed_7a.branch7x7x3_1.bn.running_mean', 'Mixed_7a.branch7x7x3_1.bn.running_var', 'Mixed_7a.branch7x7x3_2.conv.weight', 'Mixed_7a.branch7x7x3_2.bn.weight', 'Mixed_7a.branch7x7x3_2.bn.bias', 'Mixed_7a.branch7x7x3_2.bn.running_mean', 'Mixed_7a.branch7x7x3_2.bn.running_var', 'Mixed_7a.branch7x7x3_3.conv.weight', 'Mixed_7a.branch7x7x3_3.bn.weight', 'Mixed_7a.branch7x7x3_3.bn.bias', 'Mixed_7a.branch7x7x3_3.bn.running_mean', 'Mixed_7a.branch7x7x3_3.bn.running_var', 'Mixed_7a.branch7x7x3_4.conv.weight', 'Mixed_7a.branch7x7x3_4.bn.weight', 'Mixed_7a.branch7x7x3_4.bn.bias', 'Mixed_7a.branch7x7x3_4.bn.running_mean', 'Mixed_7a.branch7x7x3_4.bn.running_var', 'Mixed_7b.branch1x1.conv.weight', 'Mixed_7b.branch1x1.bn.weight', 'Mixed_7b.branch1x1.bn.bias', 'Mixed_7b.branch1x1.bn.running_mean', 'Mixed_7b.branch1x1.bn.running_var', 'Mixed_7b.branch3x3_1.conv.weight', 'Mixed_7b.branch3x3_1.bn.weight', 'Mixed_7b.branch3x3_1.bn.bias', 'Mixed_7b.branch3x3_1.bn.running_mean', 'Mixed_7b.branch3x3_1.bn.running_var', 'Mixed_7b.branch3x3_2a.conv.weight', 'Mixed_7b.branch3x3_2a.bn.weight', 'Mixed_7b.branch3x3_2a.bn.bias', 'Mixed_7b.branch3x3_2a.bn.running_mean', 'Mixed_7b.branch3x3_2a.bn.running_var', 'Mixed_7b.branch3x3_2b.conv.weight', 'Mixed_7b.branch3x3_2b.bn.weight', 'Mixed_7b.branch3x3_2b.bn.bias', 'Mixed_7b.branch3x3_2b.bn.running_mean', 'Mixed_7b.branch3x3_2b.bn.running_var', 'Mixed_7b.branch3x3dbl_1.conv.weight', 'Mixed_7b.branch3x3dbl_1.bn.weight', 'Mixed_7b.branch3x3dbl_1.bn.bias', 'Mixed_7b.branch3x3dbl_1.bn.running_mean', 'Mixed_7b.branch3x3dbl_1.bn.running_var', 'Mixed_7b.branch3x3dbl_2.conv.weight', 'Mixed_7b.branch3x3dbl_2.bn.weight', 'Mixed_7b.branch3x3dbl_2.bn.bias', 'Mixed_7b.branch3x3dbl_2.bn.running_mean', 'Mixed_7b.branch3x3dbl_2.bn.running_var', 'Mixed_7b.branch3x3dbl_3a.conv.weight', 'Mixed_7b.branch3x3dbl_3a.bn.weight', 'Mixed_7b.branch3x3dbl_3a.bn.bias', 'Mixed_7b.branch3x3dbl_3a.bn.running_mean', 'Mixed_7b.branch3x3dbl_3a.bn.running_var', 'Mixed_7b.branch3x3dbl_3b.conv.weight', 'Mixed_7b.branch3x3dbl_3b.bn.weight', 'Mixed_7b.branch3x3dbl_3b.bn.bias', 'Mixed_7b.branch3x3dbl_3b.bn.running_mean', 'Mixed_7b.branch3x3dbl_3b.bn.running_var', 'Mixed_7b.branch_pool.conv.weight', 'Mixed_7b.branch_pool.bn.weight', 'Mixed_7b.branch_pool.bn.bias', 'Mixed_7b.branch_pool.bn.running_mean', 'Mixed_7b.branch_pool.bn.running_var', 'Mixed_7c.branch1x1.conv.weight', 'Mixed_7c.branch1x1.bn.weight', 'Mixed_7c.branch1x1.bn.bias', 'Mixed_7c.branch1x1.bn.running_mean', 'Mixed_7c.branch1x1.bn.running_var', 'Mixed_7c.branch3x3_1.conv.weight', 'Mixed_7c.branch3x3_1.bn.weight', 'Mixed_7c.branch3x3_1.bn.bias', 'Mixed_7c.branch3x3_1.bn.running_mean', 'Mixed_7c.branch3x3_1.bn.running_var', 'Mixed_7c.branch3x3_2a.conv.weight', 'Mixed_7c.branch3x3_2a.bn.weight', 'Mixed_7c.branch3x3_2a.bn.bias', 'Mixed_7c.branch3x3_2a.bn.running_mean', 'Mixed_7c.branch3x3_2a.bn.running_var', 'Mixed_7c.branch3x3_2b.conv.weight', 'Mixed_7c.branch3x3_2b.bn.weight', 'Mixed_7c.branch3x3_2b.bn.bias', 'Mixed_7c.branch3x3_2b.bn.running_mean', 'Mixed_7c.branch3x3_2b.bn.running_var', 'Mixed_7c.branch3x3dbl_1.conv.weight', 'Mixed_7c.branch3x3dbl_1.bn.weight', 'Mixed_7c.branch3x3dbl_1.bn.bias', 'Mixed_7c.branch3x3dbl_1.bn.running_mean', 'Mixed_7c.branch3x3dbl_1.bn.running_var', 'Mixed_7c.branch3x3dbl_2.conv.weight', 'Mixed_7c.branch3x3dbl_2.bn.weight', 'Mixed_7c.branch3x3dbl_2.bn.bias', 'Mixed_7c.branch3x3dbl_2.bn.running_mean', 'Mixed_7c.branch3x3dbl_2.bn.running_var', 'Mixed_7c.branch3x3dbl_3a.conv.weight', 'Mixed_7c.branch3x3dbl_3a.bn.weight', 'Mixed_7c.branch3x3dbl_3a.bn.bias', 'Mixed_7c.branch3x3dbl_3a.bn.running_mean', 'Mixed_7c.branch3x3dbl_3a.bn.running_var', 'Mixed_7c.branch3x3dbl_3b.conv.weight', 'Mixed_7c.branch3x3dbl_3b.bn.weight', 'Mixed_7c.branch3x3dbl_3b.bn.bias', 'Mixed_7c.branch3x3dbl_3b.bn.running_mean', 'Mixed_7c.branch3x3dbl_3b.bn.running_var', 'Mixed_7c.branch_pool.conv.weight', 'Mixed_7c.branch_pool.bn.weight', 'Mixed_7c.branch_pool.bn.bias', 'Mixed_7c.branch_pool.bn.running_mean', 'Mixed_7c.branch_pool.bn.running_var', 'fc.weight', 'fc.bias']
2025-05-03 08:50:10,694 [WARNING] - Unexpected keys when restoring best state for inception: ['features.0.0.weight', 'features.0.1.weight', 'features.0.1.bias', 'features.0.1.running_mean', 'features.0.1.running_var', 'features.0.1.num_batches_tracked', 'features.1.0.block.0.0.weight', 'features.1.0.block.0.1.weight', 'features.1.0.block.0.1.bias', 'features.1.0.block.0.1.running_mean', 'features.1.0.block.0.1.running_var', 'features.1.0.block.0.1.num_batches_tracked', 'features.1.0.block.1.fc1.weight', 'features.1.0.block.1.fc1.bias', 'features.1.0.block.1.fc2.weight', 'features.1.0.block.1.fc2.bias', 'features.1.0.block.2.0.weight', 'features.1.0.block.2.1.weight', 'features.1.0.block.2.1.bias', 'features.1.0.block.2.1.running_mean', 'features.1.0.block.2.1.running_var', 'features.1.0.block.2.1.num_batches_tracked', 'features.2.0.block.0.0.weight', 'features.2.0.block.0.1.weight', 'features.2.0.block.0.1.bias', 'features.2.0.block.0.1.running_mean', 'features.2.0.block.0.1.running_var', 'features.2.0.block.0.1.num_batches_tracked', 'features.2.0.block.1.0.weight', 'features.2.0.block.1.1.weight', 'features.2.0.block.1.1.bias', 'features.2.0.block.1.1.running_mean', 'features.2.0.block.1.1.running_var', 'features.2.0.block.1.1.num_batches_tracked', 'features.2.0.block.2.fc1.weight', 'features.2.0.block.2.fc1.bias', 'features.2.0.block.2.fc2.weight', 'features.2.0.block.2.fc2.bias', 'features.2.0.block.3.0.weight', 'features.2.0.block.3.1.weight', 'features.2.0.block.3.1.bias', 'features.2.0.block.3.1.running_mean', 'features.2.0.block.3.1.running_var', 'features.2.0.block.3.1.num_batches_tracked', 'features.2.1.block.0.0.weight', 'features.2.1.block.0.1.weight', 'features.2.1.block.0.1.bias', 'features.2.1.block.0.1.running_mean', 'features.2.1.block.0.1.running_var', 'features.2.1.block.0.1.num_batches_tracked', 'features.2.1.block.1.0.weight', 'features.2.1.block.1.1.weight', 'features.2.1.block.1.1.bias', 'features.2.1.block.1.1.running_mean', 'features.2.1.block.1.1.running_var', 'features.2.1.block.1.1.num_batches_tracked', 'features.2.1.block.2.fc1.weight', 'features.2.1.block.2.fc1.bias', 'features.2.1.block.2.fc2.weight', 'features.2.1.block.2.fc2.bias', 'features.2.1.block.3.0.weight', 'features.2.1.block.3.1.weight', 'features.2.1.block.3.1.bias', 'features.2.1.block.3.1.running_mean', 'features.2.1.block.3.1.running_var', 'features.2.1.block.3.1.num_batches_tracked', 'features.3.0.block.0.0.weight', 'features.3.0.block.0.1.weight', 'features.3.0.block.0.1.bias', 'features.3.0.block.0.1.running_mean', 'features.3.0.block.0.1.running_var', 'features.3.0.block.0.1.num_batches_tracked', 'features.3.0.block.1.0.weight', 'features.3.0.block.1.1.weight', 'features.3.0.block.1.1.bias', 'features.3.0.block.1.1.running_mean', 'features.3.0.block.1.1.running_var', 'features.3.0.block.1.1.num_batches_tracked', 'features.3.0.block.2.fc1.weight', 'features.3.0.block.2.fc1.bias', 'features.3.0.block.2.fc2.weight', 'features.3.0.block.2.fc2.bias', 'features.3.0.block.3.0.weight', 'features.3.0.block.3.1.weight', 'features.3.0.block.3.1.bias', 'features.3.0.block.3.1.running_mean', 'features.3.0.block.3.1.running_var', 'features.3.0.block.3.1.num_batches_tracked', 'features.3.1.block.0.0.weight', 'features.3.1.block.0.1.weight', 'features.3.1.block.0.1.bias', 'features.3.1.block.0.1.running_mean', 'features.3.1.block.0.1.running_var', 'features.3.1.block.0.1.num_batches_tracked', 'features.3.1.block.1.0.weight', 'features.3.1.block.1.1.weight', 'features.3.1.block.1.1.bias', 'features.3.1.block.1.1.running_mean', 'features.3.1.block.1.1.running_var', 'features.3.1.block.1.1.num_batches_tracked', 'features.3.1.block.2.fc1.weight', 'features.3.1.block.2.fc1.bias', 'features.3.1.block.2.fc2.weight', 'features.3.1.block.2.fc2.bias', 'features.3.1.block.3.0.weight', 'features.3.1.block.3.1.weight', 'features.3.1.block.3.1.bias', 'features.3.1.block.3.1.running_mean', 'features.3.1.block.3.1.running_var', 'features.3.1.block.3.1.num_batches_tracked', 'features.4.0.block.0.0.weight', 'features.4.0.block.0.1.weight', 'features.4.0.block.0.1.bias', 'features.4.0.block.0.1.running_mean', 'features.4.0.block.0.1.running_var', 'features.4.0.block.0.1.num_batches_tracked', 'features.4.0.block.1.0.weight', 'features.4.0.block.1.1.weight', 'features.4.0.block.1.1.bias', 'features.4.0.block.1.1.running_mean', 'features.4.0.block.1.1.running_var', 'features.4.0.block.1.1.num_batches_tracked', 'features.4.0.block.2.fc1.weight', 'features.4.0.block.2.fc1.bias', 'features.4.0.block.2.fc2.weight', 'features.4.0.block.2.fc2.bias', 'features.4.0.block.3.0.weight', 'features.4.0.block.3.1.weight', 'features.4.0.block.3.1.bias', 'features.4.0.block.3.1.running_mean', 'features.4.0.block.3.1.running_var', 'features.4.0.block.3.1.num_batches_tracked', 'features.4.1.block.0.0.weight', 'features.4.1.block.0.1.weight', 'features.4.1.block.0.1.bias', 'features.4.1.block.0.1.running_mean', 'features.4.1.block.0.1.running_var', 'features.4.1.block.0.1.num_batches_tracked', 'features.4.1.block.1.0.weight', 'features.4.1.block.1.1.weight', 'features.4.1.block.1.1.bias', 'features.4.1.block.1.1.running_mean', 'features.4.1.block.1.1.running_var', 'features.4.1.block.1.1.num_batches_tracked', 'features.4.1.block.2.fc1.weight', 'features.4.1.block.2.fc1.bias', 'features.4.1.block.2.fc2.weight', 'features.4.1.block.2.fc2.bias', 'features.4.1.block.3.0.weight', 'features.4.1.block.3.1.weight', 'features.4.1.block.3.1.bias', 'features.4.1.block.3.1.running_mean', 'features.4.1.block.3.1.running_var', 'features.4.1.block.3.1.num_batches_tracked', 'features.4.2.block.0.0.weight', 'features.4.2.block.0.1.weight', 'features.4.2.block.0.1.bias', 'features.4.2.block.0.1.running_mean', 'features.4.2.block.0.1.running_var', 'features.4.2.block.0.1.num_batches_tracked', 'features.4.2.block.1.0.weight', 'features.4.2.block.1.1.weight', 'features.4.2.block.1.1.bias', 'features.4.2.block.1.1.running_mean', 'features.4.2.block.1.1.running_var', 'features.4.2.block.1.1.num_batches_tracked', 'features.4.2.block.2.fc1.weight', 'features.4.2.block.2.fc1.bias', 'features.4.2.block.2.fc2.weight', 'features.4.2.block.2.fc2.bias', 'features.4.2.block.3.0.weight', 'features.4.2.block.3.1.weight', 'features.4.2.block.3.1.bias', 'features.4.2.block.3.1.running_mean', 'features.4.2.block.3.1.running_var', 'features.4.2.block.3.1.num_batches_tracked', 'features.5.0.block.0.0.weight', 'features.5.0.block.0.1.weight', 'features.5.0.block.0.1.bias', 'features.5.0.block.0.1.running_mean', 'features.5.0.block.0.1.running_var', 'features.5.0.block.0.1.num_batches_tracked', 'features.5.0.block.1.0.weight', 'features.5.0.block.1.1.weight', 'features.5.0.block.1.1.bias', 'features.5.0.block.1.1.running_mean', 'features.5.0.block.1.1.running_var', 'features.5.0.block.1.1.num_batches_tracked', 'features.5.0.block.2.fc1.weight', 'features.5.0.block.2.fc1.bias', 'features.5.0.block.2.fc2.weight', 'features.5.0.block.2.fc2.bias', 'features.5.0.block.3.0.weight', 'features.5.0.block.3.1.weight', 'features.5.0.block.3.1.bias', 'features.5.0.block.3.1.running_mean', 'features.5.0.block.3.1.running_var', 'features.5.0.block.3.1.num_batches_tracked', 'features.5.1.block.0.0.weight', 'features.5.1.block.0.1.weight', 'features.5.1.block.0.1.bias', 'features.5.1.block.0.1.running_mean', 'features.5.1.block.0.1.running_var', 'features.5.1.block.0.1.num_batches_tracked', 'features.5.1.block.1.0.weight', 'features.5.1.block.1.1.weight', 'features.5.1.block.1.1.bias', 'features.5.1.block.1.1.running_mean', 'features.5.1.block.1.1.running_var', 'features.5.1.block.1.1.num_batches_tracked', 'features.5.1.block.2.fc1.weight', 'features.5.1.block.2.fc1.bias', 'features.5.1.block.2.fc2.weight', 'features.5.1.block.2.fc2.bias', 'features.5.1.block.3.0.weight', 'features.5.1.block.3.1.weight', 'features.5.1.block.3.1.bias', 'features.5.1.block.3.1.running_mean', 'features.5.1.block.3.1.running_var', 'features.5.1.block.3.1.num_batches_tracked', 'features.5.2.block.0.0.weight', 'features.5.2.block.0.1.weight', 'features.5.2.block.0.1.bias', 'features.5.2.block.0.1.running_mean', 'features.5.2.block.0.1.running_var', 'features.5.2.block.0.1.num_batches_tracked', 'features.5.2.block.1.0.weight', 'features.5.2.block.1.1.weight', 'features.5.2.block.1.1.bias', 'features.5.2.block.1.1.running_mean', 'features.5.2.block.1.1.running_var', 'features.5.2.block.1.1.num_batches_tracked', 'features.5.2.block.2.fc1.weight', 'features.5.2.block.2.fc1.bias', 'features.5.2.block.2.fc2.weight', 'features.5.2.block.2.fc2.bias', 'features.5.2.block.3.0.weight', 'features.5.2.block.3.1.weight', 'features.5.2.block.3.1.bias', 'features.5.2.block.3.1.running_mean', 'features.5.2.block.3.1.running_var', 'features.5.2.block.3.1.num_batches_tracked', 'features.6.0.block.0.0.weight', 'features.6.0.block.0.1.weight', 'features.6.0.block.0.1.bias', 'features.6.0.block.0.1.running_mean', 'features.6.0.block.0.1.running_var', 'features.6.0.block.0.1.num_batches_tracked', 'features.6.0.block.1.0.weight', 'features.6.0.block.1.1.weight', 'features.6.0.block.1.1.bias', 'features.6.0.block.1.1.running_mean', 'features.6.0.block.1.1.running_var', 'features.6.0.block.1.1.num_batches_tracked', 'features.6.0.block.2.fc1.weight', 'features.6.0.block.2.fc1.bias', 'features.6.0.block.2.fc2.weight', 'features.6.0.block.2.fc2.bias', 'features.6.0.block.3.0.weight', 'features.6.0.block.3.1.weight', 'features.6.0.block.3.1.bias', 'features.6.0.block.3.1.running_mean', 'features.6.0.block.3.1.running_var', 'features.6.0.block.3.1.num_batches_tracked', 'features.6.1.block.0.0.weight', 'features.6.1.block.0.1.weight', 'features.6.1.block.0.1.bias', 'features.6.1.block.0.1.running_mean', 'features.6.1.block.0.1.running_var', 'features.6.1.block.0.1.num_batches_tracked', 'features.6.1.block.1.0.weight', 'features.6.1.block.1.1.weight', 'features.6.1.block.1.1.bias', 'features.6.1.block.1.1.running_mean', 'features.6.1.block.1.1.running_var', 'features.6.1.block.1.1.num_batches_tracked', 'features.6.1.block.2.fc1.weight', 'features.6.1.block.2.fc1.bias', 'features.6.1.block.2.fc2.weight', 'features.6.1.block.2.fc2.bias', 'features.6.1.block.3.0.weight', 'features.6.1.block.3.1.weight', 'features.6.1.block.3.1.bias', 'features.6.1.block.3.1.running_mean', 'features.6.1.block.3.1.running_var', 'features.6.1.block.3.1.num_batches_tracked', 'features.6.2.block.0.0.weight', 'features.6.2.block.0.1.weight', 'features.6.2.block.0.1.bias', 'features.6.2.block.0.1.running_mean', 'features.6.2.block.0.1.running_var', 'features.6.2.block.0.1.num_batches_tracked', 'features.6.2.block.1.0.weight', 'features.6.2.block.1.1.weight', 'features.6.2.block.1.1.bias', 'features.6.2.block.1.1.running_mean', 'features.6.2.block.1.1.running_var', 'features.6.2.block.1.1.num_batches_tracked', 'features.6.2.block.2.fc1.weight', 'features.6.2.block.2.fc1.bias', 'features.6.2.block.2.fc2.weight', 'features.6.2.block.2.fc2.bias', 'features.6.2.block.3.0.weight', 'features.6.2.block.3.1.weight', 'features.6.2.block.3.1.bias', 'features.6.2.block.3.1.running_mean', 'features.6.2.block.3.1.running_var', 'features.6.2.block.3.1.num_batches_tracked', 'features.6.3.block.0.0.weight', 'features.6.3.block.0.1.weight', 'features.6.3.block.0.1.bias', 'features.6.3.block.0.1.running_mean', 'features.6.3.block.0.1.running_var', 'features.6.3.block.0.1.num_batches_tracked', 'features.6.3.block.1.0.weight', 'features.6.3.block.1.1.weight', 'features.6.3.block.1.1.bias', 'features.6.3.block.1.1.running_mean', 'features.6.3.block.1.1.running_var', 'features.6.3.block.1.1.num_batches_tracked', 'features.6.3.block.2.fc1.weight', 'features.6.3.block.2.fc1.bias', 'features.6.3.block.2.fc2.weight', 'features.6.3.block.2.fc2.bias', 'features.6.3.block.3.0.weight', 'features.6.3.block.3.1.weight', 'features.6.3.block.3.1.bias', 'features.6.3.block.3.1.running_mean', 'features.6.3.block.3.1.running_var', 'features.6.3.block.3.1.num_batches_tracked', 'features.7.0.block.0.0.weight', 'features.7.0.block.0.1.weight', 'features.7.0.block.0.1.bias', 'features.7.0.block.0.1.running_mean', 'features.7.0.block.0.1.running_var', 'features.7.0.block.0.1.num_batches_tracked', 'features.7.0.block.1.0.weight', 'features.7.0.block.1.1.weight', 'features.7.0.block.1.1.bias', 'features.7.0.block.1.1.running_mean', 'features.7.0.block.1.1.running_var', 'features.7.0.block.1.1.num_batches_tracked', 'features.7.0.block.2.fc1.weight', 'features.7.0.block.2.fc1.bias', 'features.7.0.block.2.fc2.weight', 'features.7.0.block.2.fc2.bias', 'features.7.0.block.3.0.weight', 'features.7.0.block.3.1.weight', 'features.7.0.block.3.1.bias', 'features.7.0.block.3.1.running_mean', 'features.7.0.block.3.1.running_var', 'features.7.0.block.3.1.num_batches_tracked', 'features.8.0.weight', 'features.8.1.weight', 'features.8.1.bias', 'features.8.1.running_mean', 'features.8.1.running_var', 'features.8.1.num_batches_tracked', 'classifier.1.weight', 'classifier.1.bias']
2025-05-03 08:50:10,694 [INFO] - Restored best state for inception from initialization (Val Acc: 94.46%)
2025-05-03 08:50:10,698 [ERROR] - Failed to restore best state for mobilenet after initialization: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
2025-05-03 08:50:10,742 [ERROR] - Traceback (most recent call last):
  File "C:\Users\Gading\Downloads\Research\Scripts\Mutual Learning\mutualLearning.py", line 2465, in initialization_phase
    missing_keys, unexpected_keys = model.load_state_dict(best_states[name], strict=False)
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\torch\nn\modules\module.py", line 2584, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for MobileNetV3:
	size mismatch for features.0.0.weight: copying a param with shape torch.Size([32, 3, 3, 3]) from checkpoint, the shape in current model is torch.Size([16, 3, 3, 3]).
	size mismatch for features.0.1.weight: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_mean: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).
	size mismatch for features.0.1.running_var: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([16]).

2025-05-03 08:50:10,744 [WARNING] - Missing keys when restoring best state for resnet: ['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.conv3.weight', 'layer1.0.bn3.weight', 'layer1.0.bn3.bias', 'layer1.0.bn3.running_mean', 'layer1.0.bn3.running_var', 'layer1.0.downsample.0.weight', 'layer1.0.downsample.1.weight', 'layer1.0.downsample.1.bias', 'layer1.0.downsample.1.running_mean', 'layer1.0.downsample.1.running_var', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.conv3.weight', 'layer1.1.bn3.weight', 'layer1.1.bn3.bias', 'layer1.1.bn3.running_mean', 'layer1.1.bn3.running_var', 'layer1.2.conv1.weight', 'layer1.2.bn1.weight', 'layer1.2.bn1.bias', 'layer1.2.bn1.running_mean', 'layer1.2.bn1.running_var', 'layer1.2.conv2.weight', 'layer1.2.bn2.weight', 'layer1.2.bn2.bias', 'layer1.2.bn2.running_mean', 'layer1.2.bn2.running_var', 'layer1.2.conv3.weight', 'layer1.2.bn3.weight', 'layer1.2.bn3.bias', 'layer1.2.bn3.running_mean', 'layer1.2.bn3.running_var', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.conv3.weight', 'layer2.0.bn3.weight', 'layer2.0.bn3.bias', 'layer2.0.bn3.running_mean', 'layer2.0.bn3.running_var', 'layer2.0.downsample.0.weight', 'layer2.0.downsample.1.weight', 'layer2.0.downsample.1.bias', 'layer2.0.downsample.1.running_mean', 'layer2.0.downsample.1.running_var', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.conv3.weight', 'layer2.1.bn3.weight', 'layer2.1.bn3.bias', 'layer2.1.bn3.running_mean', 'layer2.1.bn3.running_var', 'layer2.2.conv1.weight', 'layer2.2.bn1.weight', 'layer2.2.bn1.bias', 'layer2.2.bn1.running_mean', 'layer2.2.bn1.running_var', 'layer2.2.conv2.weight', 'layer2.2.bn2.weight', 'layer2.2.bn2.bias', 'layer2.2.bn2.running_mean', 'layer2.2.bn2.running_var', 'layer2.2.conv3.weight', 'layer2.2.bn3.weight', 'layer2.2.bn3.bias', 'layer2.2.bn3.running_mean', 'layer2.2.bn3.running_var', 'layer2.3.conv1.weight', 'layer2.3.bn1.weight', 'layer2.3.bn1.bias', 'layer2.3.bn1.running_mean', 'layer2.3.bn1.running_var', 'layer2.3.conv2.weight', 'layer2.3.bn2.weight', 'layer2.3.bn2.bias', 'layer2.3.bn2.running_mean', 'layer2.3.bn2.running_var', 'layer2.3.conv3.weight', 'layer2.3.bn3.weight', 'layer2.3.bn3.bias', 'layer2.3.bn3.running_mean', 'layer2.3.bn3.running_var', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.conv3.weight', 'layer3.0.bn3.weight', 'layer3.0.bn3.bias', 'layer3.0.bn3.running_mean', 'layer3.0.bn3.running_var', 'layer3.0.downsample.0.weight', 'layer3.0.downsample.1.weight', 'layer3.0.downsample.1.bias', 'layer3.0.downsample.1.running_mean', 'layer3.0.downsample.1.running_var', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.conv3.weight', 'layer3.1.bn3.weight', 'layer3.1.bn3.bias', 'layer3.1.bn3.running_mean', 'layer3.1.bn3.running_var', 'layer3.2.conv1.weight', 'layer3.2.bn1.weight', 'layer3.2.bn1.bias', 'layer3.2.bn1.running_mean', 'layer3.2.bn1.running_var', 'layer3.2.conv2.weight', 'layer3.2.bn2.weight', 'layer3.2.bn2.bias', 'layer3.2.bn2.running_mean', 'layer3.2.bn2.running_var', 'layer3.2.conv3.weight', 'layer3.2.bn3.weight', 'layer3.2.bn3.bias', 'layer3.2.bn3.running_mean', 'layer3.2.bn3.running_var', 'layer3.3.conv1.weight', 'layer3.3.bn1.weight', 'layer3.3.bn1.bias', 'layer3.3.bn1.running_mean', 'layer3.3.bn1.running_var', 'layer3.3.conv2.weight', 'layer3.3.bn2.weight', 'layer3.3.bn2.bias', 'layer3.3.bn2.running_mean', 'layer3.3.bn2.running_var', 'layer3.3.conv3.weight', 'layer3.3.bn3.weight', 'layer3.3.bn3.bias', 'layer3.3.bn3.running_mean', 'layer3.3.bn3.running_var', 'layer3.4.conv1.weight', 'layer3.4.bn1.weight', 'layer3.4.bn1.bias', 'layer3.4.bn1.running_mean', 'layer3.4.bn1.running_var', 'layer3.4.conv2.weight', 'layer3.4.bn2.weight', 'layer3.4.bn2.bias', 'layer3.4.bn2.running_mean', 'layer3.4.bn2.running_var', 'layer3.4.conv3.weight', 'layer3.4.bn3.weight', 'layer3.4.bn3.bias', 'layer3.4.bn3.running_mean', 'layer3.4.bn3.running_var', 'layer3.5.conv1.weight', 'layer3.5.bn1.weight', 'layer3.5.bn1.bias', 'layer3.5.bn1.running_mean', 'layer3.5.bn1.running_var', 'layer3.5.conv2.weight', 'layer3.5.bn2.weight', 'layer3.5.bn2.bias', 'layer3.5.bn2.running_mean', 'layer3.5.bn2.running_var', 'layer3.5.conv3.weight', 'layer3.5.bn3.weight', 'layer3.5.bn3.bias', 'layer3.5.bn3.running_mean', 'layer3.5.bn3.running_var', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.conv3.weight', 'layer4.0.bn3.weight', 'layer4.0.bn3.bias', 'layer4.0.bn3.running_mean', 'layer4.0.bn3.running_var', 'layer4.0.downsample.0.weight', 'layer4.0.downsample.1.weight', 'layer4.0.downsample.1.bias', 'layer4.0.downsample.1.running_mean', 'layer4.0.downsample.1.running_var', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.conv3.weight', 'layer4.1.bn3.weight', 'layer4.1.bn3.bias', 'layer4.1.bn3.running_mean', 'layer4.1.bn3.running_var', 'layer4.2.conv1.weight', 'layer4.2.bn1.weight', 'layer4.2.bn1.bias', 'layer4.2.bn1.running_mean', 'layer4.2.bn1.running_var', 'layer4.2.conv2.weight', 'layer4.2.bn2.weight', 'layer4.2.bn2.bias', 'layer4.2.bn2.running_mean', 'layer4.2.bn2.running_var', 'layer4.2.conv3.weight', 'layer4.2.bn3.weight', 'layer4.2.bn3.bias', 'layer4.2.bn3.running_mean', 'layer4.2.bn3.running_var', 'fc.weight', 'fc.bias']
2025-05-03 08:50:10,745 [WARNING] - Unexpected keys when restoring best state for resnet: ['features.0.0.weight', 'features.0.1.weight', 'features.0.1.bias', 'features.0.1.running_mean', 'features.0.1.running_var', 'features.0.1.num_batches_tracked', 'features.1.0.block.0.0.weight', 'features.1.0.block.0.1.weight', 'features.1.0.block.0.1.bias', 'features.1.0.block.0.1.running_mean', 'features.1.0.block.0.1.running_var', 'features.1.0.block.0.1.num_batches_tracked', 'features.1.0.block.1.fc1.weight', 'features.1.0.block.1.fc1.bias', 'features.1.0.block.1.fc2.weight', 'features.1.0.block.1.fc2.bias', 'features.1.0.block.2.0.weight', 'features.1.0.block.2.1.weight', 'features.1.0.block.2.1.bias', 'features.1.0.block.2.1.running_mean', 'features.1.0.block.2.1.running_var', 'features.1.0.block.2.1.num_batches_tracked', 'features.2.0.block.0.0.weight', 'features.2.0.block.0.1.weight', 'features.2.0.block.0.1.bias', 'features.2.0.block.0.1.running_mean', 'features.2.0.block.0.1.running_var', 'features.2.0.block.0.1.num_batches_tracked', 'features.2.0.block.1.0.weight', 'features.2.0.block.1.1.weight', 'features.2.0.block.1.1.bias', 'features.2.0.block.1.1.running_mean', 'features.2.0.block.1.1.running_var', 'features.2.0.block.1.1.num_batches_tracked', 'features.2.0.block.2.fc1.weight', 'features.2.0.block.2.fc1.bias', 'features.2.0.block.2.fc2.weight', 'features.2.0.block.2.fc2.bias', 'features.2.0.block.3.0.weight', 'features.2.0.block.3.1.weight', 'features.2.0.block.3.1.bias', 'features.2.0.block.3.1.running_mean', 'features.2.0.block.3.1.running_var', 'features.2.0.block.3.1.num_batches_tracked', 'features.2.1.block.0.0.weight', 'features.2.1.block.0.1.weight', 'features.2.1.block.0.1.bias', 'features.2.1.block.0.1.running_mean', 'features.2.1.block.0.1.running_var', 'features.2.1.block.0.1.num_batches_tracked', 'features.2.1.block.1.0.weight', 'features.2.1.block.1.1.weight', 'features.2.1.block.1.1.bias', 'features.2.1.block.1.1.running_mean', 'features.2.1.block.1.1.running_var', 'features.2.1.block.1.1.num_batches_tracked', 'features.2.1.block.2.fc1.weight', 'features.2.1.block.2.fc1.bias', 'features.2.1.block.2.fc2.weight', 'features.2.1.block.2.fc2.bias', 'features.2.1.block.3.0.weight', 'features.2.1.block.3.1.weight', 'features.2.1.block.3.1.bias', 'features.2.1.block.3.1.running_mean', 'features.2.1.block.3.1.running_var', 'features.2.1.block.3.1.num_batches_tracked', 'features.3.0.block.0.0.weight', 'features.3.0.block.0.1.weight', 'features.3.0.block.0.1.bias', 'features.3.0.block.0.1.running_mean', 'features.3.0.block.0.1.running_var', 'features.3.0.block.0.1.num_batches_tracked', 'features.3.0.block.1.0.weight', 'features.3.0.block.1.1.weight', 'features.3.0.block.1.1.bias', 'features.3.0.block.1.1.running_mean', 'features.3.0.block.1.1.running_var', 'features.3.0.block.1.1.num_batches_tracked', 'features.3.0.block.2.fc1.weight', 'features.3.0.block.2.fc1.bias', 'features.3.0.block.2.fc2.weight', 'features.3.0.block.2.fc2.bias', 'features.3.0.block.3.0.weight', 'features.3.0.block.3.1.weight', 'features.3.0.block.3.1.bias', 'features.3.0.block.3.1.running_mean', 'features.3.0.block.3.1.running_var', 'features.3.0.block.3.1.num_batches_tracked', 'features.3.1.block.0.0.weight', 'features.3.1.block.0.1.weight', 'features.3.1.block.0.1.bias', 'features.3.1.block.0.1.running_mean', 'features.3.1.block.0.1.running_var', 'features.3.1.block.0.1.num_batches_tracked', 'features.3.1.block.1.0.weight', 'features.3.1.block.1.1.weight', 'features.3.1.block.1.1.bias', 'features.3.1.block.1.1.running_mean', 'features.3.1.block.1.1.running_var', 'features.3.1.block.1.1.num_batches_tracked', 'features.3.1.block.2.fc1.weight', 'features.3.1.block.2.fc1.bias', 'features.3.1.block.2.fc2.weight', 'features.3.1.block.2.fc2.bias', 'features.3.1.block.3.0.weight', 'features.3.1.block.3.1.weight', 'features.3.1.block.3.1.bias', 'features.3.1.block.3.1.running_mean', 'features.3.1.block.3.1.running_var', 'features.3.1.block.3.1.num_batches_tracked', 'features.4.0.block.0.0.weight', 'features.4.0.block.0.1.weight', 'features.4.0.block.0.1.bias', 'features.4.0.block.0.1.running_mean', 'features.4.0.block.0.1.running_var', 'features.4.0.block.0.1.num_batches_tracked', 'features.4.0.block.1.0.weight', 'features.4.0.block.1.1.weight', 'features.4.0.block.1.1.bias', 'features.4.0.block.1.1.running_mean', 'features.4.0.block.1.1.running_var', 'features.4.0.block.1.1.num_batches_tracked', 'features.4.0.block.2.fc1.weight', 'features.4.0.block.2.fc1.bias', 'features.4.0.block.2.fc2.weight', 'features.4.0.block.2.fc2.bias', 'features.4.0.block.3.0.weight', 'features.4.0.block.3.1.weight', 'features.4.0.block.3.1.bias', 'features.4.0.block.3.1.running_mean', 'features.4.0.block.3.1.running_var', 'features.4.0.block.3.1.num_batches_tracked', 'features.4.1.block.0.0.weight', 'features.4.1.block.0.1.weight', 'features.4.1.block.0.1.bias', 'features.4.1.block.0.1.running_mean', 'features.4.1.block.0.1.running_var', 'features.4.1.block.0.1.num_batches_tracked', 'features.4.1.block.1.0.weight', 'features.4.1.block.1.1.weight', 'features.4.1.block.1.1.bias', 'features.4.1.block.1.1.running_mean', 'features.4.1.block.1.1.running_var', 'features.4.1.block.1.1.num_batches_tracked', 'features.4.1.block.2.fc1.weight', 'features.4.1.block.2.fc1.bias', 'features.4.1.block.2.fc2.weight', 'features.4.1.block.2.fc2.bias', 'features.4.1.block.3.0.weight', 'features.4.1.block.3.1.weight', 'features.4.1.block.3.1.bias', 'features.4.1.block.3.1.running_mean', 'features.4.1.block.3.1.running_var', 'features.4.1.block.3.1.num_batches_tracked', 'features.4.2.block.0.0.weight', 'features.4.2.block.0.1.weight', 'features.4.2.block.0.1.bias', 'features.4.2.block.0.1.running_mean', 'features.4.2.block.0.1.running_var', 'features.4.2.block.0.1.num_batches_tracked', 'features.4.2.block.1.0.weight', 'features.4.2.block.1.1.weight', 'features.4.2.block.1.1.bias', 'features.4.2.block.1.1.running_mean', 'features.4.2.block.1.1.running_var', 'features.4.2.block.1.1.num_batches_tracked', 'features.4.2.block.2.fc1.weight', 'features.4.2.block.2.fc1.bias', 'features.4.2.block.2.fc2.weight', 'features.4.2.block.2.fc2.bias', 'features.4.2.block.3.0.weight', 'features.4.2.block.3.1.weight', 'features.4.2.block.3.1.bias', 'features.4.2.block.3.1.running_mean', 'features.4.2.block.3.1.running_var', 'features.4.2.block.3.1.num_batches_tracked', 'features.5.0.block.0.0.weight', 'features.5.0.block.0.1.weight', 'features.5.0.block.0.1.bias', 'features.5.0.block.0.1.running_mean', 'features.5.0.block.0.1.running_var', 'features.5.0.block.0.1.num_batches_tracked', 'features.5.0.block.1.0.weight', 'features.5.0.block.1.1.weight', 'features.5.0.block.1.1.bias', 'features.5.0.block.1.1.running_mean', 'features.5.0.block.1.1.running_var', 'features.5.0.block.1.1.num_batches_tracked', 'features.5.0.block.2.fc1.weight', 'features.5.0.block.2.fc1.bias', 'features.5.0.block.2.fc2.weight', 'features.5.0.block.2.fc2.bias', 'features.5.0.block.3.0.weight', 'features.5.0.block.3.1.weight', 'features.5.0.block.3.1.bias', 'features.5.0.block.3.1.running_mean', 'features.5.0.block.3.1.running_var', 'features.5.0.block.3.1.num_batches_tracked', 'features.5.1.block.0.0.weight', 'features.5.1.block.0.1.weight', 'features.5.1.block.0.1.bias', 'features.5.1.block.0.1.running_mean', 'features.5.1.block.0.1.running_var', 'features.5.1.block.0.1.num_batches_tracked', 'features.5.1.block.1.0.weight', 'features.5.1.block.1.1.weight', 'features.5.1.block.1.1.bias', 'features.5.1.block.1.1.running_mean', 'features.5.1.block.1.1.running_var', 'features.5.1.block.1.1.num_batches_tracked', 'features.5.1.block.2.fc1.weight', 'features.5.1.block.2.fc1.bias', 'features.5.1.block.2.fc2.weight', 'features.5.1.block.2.fc2.bias', 'features.5.1.block.3.0.weight', 'features.5.1.block.3.1.weight', 'features.5.1.block.3.1.bias', 'features.5.1.block.3.1.running_mean', 'features.5.1.block.3.1.running_var', 'features.5.1.block.3.1.num_batches_tracked', 'features.5.2.block.0.0.weight', 'features.5.2.block.0.1.weight', 'features.5.2.block.0.1.bias', 'features.5.2.block.0.1.running_mean', 'features.5.2.block.0.1.running_var', 'features.5.2.block.0.1.num_batches_tracked', 'features.5.2.block.1.0.weight', 'features.5.2.block.1.1.weight', 'features.5.2.block.1.1.bias', 'features.5.2.block.1.1.running_mean', 'features.5.2.block.1.1.running_var', 'features.5.2.block.1.1.num_batches_tracked', 'features.5.2.block.2.fc1.weight', 'features.5.2.block.2.fc1.bias', 'features.5.2.block.2.fc2.weight', 'features.5.2.block.2.fc2.bias', 'features.5.2.block.3.0.weight', 'features.5.2.block.3.1.weight', 'features.5.2.block.3.1.bias', 'features.5.2.block.3.1.running_mean', 'features.5.2.block.3.1.running_var', 'features.5.2.block.3.1.num_batches_tracked', 'features.6.0.block.0.0.weight', 'features.6.0.block.0.1.weight', 'features.6.0.block.0.1.bias', 'features.6.0.block.0.1.running_mean', 'features.6.0.block.0.1.running_var', 'features.6.0.block.0.1.num_batches_tracked', 'features.6.0.block.1.0.weight', 'features.6.0.block.1.1.weight', 'features.6.0.block.1.1.bias', 'features.6.0.block.1.1.running_mean', 'features.6.0.block.1.1.running_var', 'features.6.0.block.1.1.num_batches_tracked', 'features.6.0.block.2.fc1.weight', 'features.6.0.block.2.fc1.bias', 'features.6.0.block.2.fc2.weight', 'features.6.0.block.2.fc2.bias', 'features.6.0.block.3.0.weight', 'features.6.0.block.3.1.weight', 'features.6.0.block.3.1.bias', 'features.6.0.block.3.1.running_mean', 'features.6.0.block.3.1.running_var', 'features.6.0.block.3.1.num_batches_tracked', 'features.6.1.block.0.0.weight', 'features.6.1.block.0.1.weight', 'features.6.1.block.0.1.bias', 'features.6.1.block.0.1.running_mean', 'features.6.1.block.0.1.running_var', 'features.6.1.block.0.1.num_batches_tracked', 'features.6.1.block.1.0.weight', 'features.6.1.block.1.1.weight', 'features.6.1.block.1.1.bias', 'features.6.1.block.1.1.running_mean', 'features.6.1.block.1.1.running_var', 'features.6.1.block.1.1.num_batches_tracked', 'features.6.1.block.2.fc1.weight', 'features.6.1.block.2.fc1.bias', 'features.6.1.block.2.fc2.weight', 'features.6.1.block.2.fc2.bias', 'features.6.1.block.3.0.weight', 'features.6.1.block.3.1.weight', 'features.6.1.block.3.1.bias', 'features.6.1.block.3.1.running_mean', 'features.6.1.block.3.1.running_var', 'features.6.1.block.3.1.num_batches_tracked', 'features.6.2.block.0.0.weight', 'features.6.2.block.0.1.weight', 'features.6.2.block.0.1.bias', 'features.6.2.block.0.1.running_mean', 'features.6.2.block.0.1.running_var', 'features.6.2.block.0.1.num_batches_tracked', 'features.6.2.block.1.0.weight', 'features.6.2.block.1.1.weight', 'features.6.2.block.1.1.bias', 'features.6.2.block.1.1.running_mean', 'features.6.2.block.1.1.running_var', 'features.6.2.block.1.1.num_batches_tracked', 'features.6.2.block.2.fc1.weight', 'features.6.2.block.2.fc1.bias', 'features.6.2.block.2.fc2.weight', 'features.6.2.block.2.fc2.bias', 'features.6.2.block.3.0.weight', 'features.6.2.block.3.1.weight', 'features.6.2.block.3.1.bias', 'features.6.2.block.3.1.running_mean', 'features.6.2.block.3.1.running_var', 'features.6.2.block.3.1.num_batches_tracked', 'features.6.3.block.0.0.weight', 'features.6.3.block.0.1.weight', 'features.6.3.block.0.1.bias', 'features.6.3.block.0.1.running_mean', 'features.6.3.block.0.1.running_var', 'features.6.3.block.0.1.num_batches_tracked', 'features.6.3.block.1.0.weight', 'features.6.3.block.1.1.weight', 'features.6.3.block.1.1.bias', 'features.6.3.block.1.1.running_mean', 'features.6.3.block.1.1.running_var', 'features.6.3.block.1.1.num_batches_tracked', 'features.6.3.block.2.fc1.weight', 'features.6.3.block.2.fc1.bias', 'features.6.3.block.2.fc2.weight', 'features.6.3.block.2.fc2.bias', 'features.6.3.block.3.0.weight', 'features.6.3.block.3.1.weight', 'features.6.3.block.3.1.bias', 'features.6.3.block.3.1.running_mean', 'features.6.3.block.3.1.running_var', 'features.6.3.block.3.1.num_batches_tracked', 'features.7.0.block.0.0.weight', 'features.7.0.block.0.1.weight', 'features.7.0.block.0.1.bias', 'features.7.0.block.0.1.running_mean', 'features.7.0.block.0.1.running_var', 'features.7.0.block.0.1.num_batches_tracked', 'features.7.0.block.1.0.weight', 'features.7.0.block.1.1.weight', 'features.7.0.block.1.1.bias', 'features.7.0.block.1.1.running_mean', 'features.7.0.block.1.1.running_var', 'features.7.0.block.1.1.num_batches_tracked', 'features.7.0.block.2.fc1.weight', 'features.7.0.block.2.fc1.bias', 'features.7.0.block.2.fc2.weight', 'features.7.0.block.2.fc2.bias', 'features.7.0.block.3.0.weight', 'features.7.0.block.3.1.weight', 'features.7.0.block.3.1.bias', 'features.7.0.block.3.1.running_mean', 'features.7.0.block.3.1.running_var', 'features.7.0.block.3.1.num_batches_tracked', 'features.8.0.weight', 'features.8.1.weight', 'features.8.1.bias', 'features.8.1.running_mean', 'features.8.1.running_var', 'features.8.1.num_batches_tracked', 'classifier.1.weight', 'classifier.1.bias']
2025-05-03 08:50:10,745 [INFO] - Restored best state for resnet from initialization (Val Acc: 90.24%)
2025-05-03 08:50:10,749 [WARNING] - Missing keys when restoring best state for densenet: ['features.conv0.weight', 'features.norm0.weight', 'features.norm0.bias', 'features.norm0.running_mean', 'features.norm0.running_var', 'features.denseblock1.denselayer1.norm1.weight', 'features.denseblock1.denselayer1.norm1.bias', 'features.denseblock1.denselayer1.norm1.running_mean', 'features.denseblock1.denselayer1.norm1.running_var', 'features.denseblock1.denselayer1.conv1.weight', 'features.denseblock1.denselayer1.norm2.weight', 'features.denseblock1.denselayer1.norm2.bias', 'features.denseblock1.denselayer1.norm2.running_mean', 'features.denseblock1.denselayer1.norm2.running_var', 'features.denseblock1.denselayer1.conv2.weight', 'features.denseblock1.denselayer2.norm1.weight', 'features.denseblock1.denselayer2.norm1.bias', 'features.denseblock1.denselayer2.norm1.running_mean', 'features.denseblock1.denselayer2.norm1.running_var', 'features.denseblock1.denselayer2.conv1.weight', 'features.denseblock1.denselayer2.norm2.weight', 'features.denseblock1.denselayer2.norm2.bias', 'features.denseblock1.denselayer2.norm2.running_mean', 'features.denseblock1.denselayer2.norm2.running_var', 'features.denseblock1.denselayer2.conv2.weight', 'features.denseblock1.denselayer3.norm1.weight', 'features.denseblock1.denselayer3.norm1.bias', 'features.denseblock1.denselayer3.norm1.running_mean', 'features.denseblock1.denselayer3.norm1.running_var', 'features.denseblock1.denselayer3.conv1.weight', 'features.denseblock1.denselayer3.norm2.weight', 'features.denseblock1.denselayer3.norm2.bias', 'features.denseblock1.denselayer3.norm2.running_mean', 'features.denseblock1.denselayer3.norm2.running_var', 'features.denseblock1.denselayer3.conv2.weight', 'features.denseblock1.denselayer4.norm1.weight', 'features.denseblock1.denselayer4.norm1.bias', 'features.denseblock1.denselayer4.norm1.running_mean', 'features.denseblock1.denselayer4.norm1.running_var', 'features.denseblock1.denselayer4.conv1.weight', 'features.denseblock1.denselayer4.norm2.weight', 'features.denseblock1.denselayer4.norm2.bias', 'features.denseblock1.denselayer4.norm2.running_mean', 'features.denseblock1.denselayer4.norm2.running_var', 'features.denseblock1.denselayer4.conv2.weight', 'features.denseblock1.denselayer5.norm1.weight', 'features.denseblock1.denselayer5.norm1.bias', 'features.denseblock1.denselayer5.norm1.running_mean', 'features.denseblock1.denselayer5.norm1.running_var', 'features.denseblock1.denselayer5.conv1.weight', 'features.denseblock1.denselayer5.norm2.weight', 'features.denseblock1.denselayer5.norm2.bias', 'features.denseblock1.denselayer5.norm2.running_mean', 'features.denseblock1.denselayer5.norm2.running_var', 'features.denseblock1.denselayer5.conv2.weight', 'features.denseblock1.denselayer6.norm1.weight', 'features.denseblock1.denselayer6.norm1.bias', 'features.denseblock1.denselayer6.norm1.running_mean', 'features.denseblock1.denselayer6.norm1.running_var', 'features.denseblock1.denselayer6.conv1.weight', 'features.denseblock1.denselayer6.norm2.weight', 'features.denseblock1.denselayer6.norm2.bias', 'features.denseblock1.denselayer6.norm2.running_mean', 'features.denseblock1.denselayer6.norm2.running_var', 'features.denseblock1.denselayer6.conv2.weight', 'features.transition1.norm.weight', 'features.transition1.norm.bias', 'features.transition1.norm.running_mean', 'features.transition1.norm.running_var', 'features.transition1.conv.weight', 'features.denseblock2.denselayer1.norm1.weight', 'features.denseblock2.denselayer1.norm1.bias', 'features.denseblock2.denselayer1.norm1.running_mean', 'features.denseblock2.denselayer1.norm1.running_var', 'features.denseblock2.denselayer1.conv1.weight', 'features.denseblock2.denselayer1.norm2.weight', 'features.denseblock2.denselayer1.norm2.bias', 'features.denseblock2.denselayer1.norm2.running_mean', 'features.denseblock2.denselayer1.norm2.running_var', 'features.denseblock2.denselayer1.conv2.weight', 'features.denseblock2.denselayer2.norm1.weight', 'features.denseblock2.denselayer2.norm1.bias', 'features.denseblock2.denselayer2.norm1.running_mean', 'features.denseblock2.denselayer2.norm1.running_var', 'features.denseblock2.denselayer2.conv1.weight', 'features.denseblock2.denselayer2.norm2.weight', 'features.denseblock2.denselayer2.norm2.bias', 'features.denseblock2.denselayer2.norm2.running_mean', 'features.denseblock2.denselayer2.norm2.running_var', 'features.denseblock2.denselayer2.conv2.weight', 'features.denseblock2.denselayer3.norm1.weight', 'features.denseblock2.denselayer3.norm1.bias', 'features.denseblock2.denselayer3.norm1.running_mean', 'features.denseblock2.denselayer3.norm1.running_var', 'features.denseblock2.denselayer3.conv1.weight', 'features.denseblock2.denselayer3.norm2.weight', 'features.denseblock2.denselayer3.norm2.bias', 'features.denseblock2.denselayer3.norm2.running_mean', 'features.denseblock2.denselayer3.norm2.running_var', 'features.denseblock2.denselayer3.conv2.weight', 'features.denseblock2.denselayer4.norm1.weight', 'features.denseblock2.denselayer4.norm1.bias', 'features.denseblock2.denselayer4.norm1.running_mean', 'features.denseblock2.denselayer4.norm1.running_var', 'features.denseblock2.denselayer4.conv1.weight', 'features.denseblock2.denselayer4.norm2.weight', 'features.denseblock2.denselayer4.norm2.bias', 'features.denseblock2.denselayer4.norm2.running_mean', 'features.denseblock2.denselayer4.norm2.running_var', 'features.denseblock2.denselayer4.conv2.weight', 'features.denseblock2.denselayer5.norm1.weight', 'features.denseblock2.denselayer5.norm1.bias', 'features.denseblock2.denselayer5.norm1.running_mean', 'features.denseblock2.denselayer5.norm1.running_var', 'features.denseblock2.denselayer5.conv1.weight', 'features.denseblock2.denselayer5.norm2.weight', 'features.denseblock2.denselayer5.norm2.bias', 'features.denseblock2.denselayer5.norm2.running_mean', 'features.denseblock2.denselayer5.norm2.running_var', 'features.denseblock2.denselayer5.conv2.weight', 'features.denseblock2.denselayer6.norm1.weight', 'features.denseblock2.denselayer6.norm1.bias', 'features.denseblock2.denselayer6.norm1.running_mean', 'features.denseblock2.denselayer6.norm1.running_var', 'features.denseblock2.denselayer6.conv1.weight', 'features.denseblock2.denselayer6.norm2.weight', 'features.denseblock2.denselayer6.norm2.bias', 'features.denseblock2.denselayer6.norm2.running_mean', 'features.denseblock2.denselayer6.norm2.running_var', 'features.denseblock2.denselayer6.conv2.weight', 'features.denseblock2.denselayer7.norm1.weight', 'features.denseblock2.denselayer7.norm1.bias', 'features.denseblock2.denselayer7.norm1.running_mean', 'features.denseblock2.denselayer7.norm1.running_var', 'features.denseblock2.denselayer7.conv1.weight', 'features.denseblock2.denselayer7.norm2.weight', 'features.denseblock2.denselayer7.norm2.bias', 'features.denseblock2.denselayer7.norm2.running_mean', 'features.denseblock2.denselayer7.norm2.running_var', 'features.denseblock2.denselayer7.conv2.weight', 'features.denseblock2.denselayer8.norm1.weight', 'features.denseblock2.denselayer8.norm1.bias', 'features.denseblock2.denselayer8.norm1.running_mean', 'features.denseblock2.denselayer8.norm1.running_var', 'features.denseblock2.denselayer8.conv1.weight', 'features.denseblock2.denselayer8.norm2.weight', 'features.denseblock2.denselayer8.norm2.bias', 'features.denseblock2.denselayer8.norm2.running_mean', 'features.denseblock2.denselayer8.norm2.running_var', 'features.denseblock2.denselayer8.conv2.weight', 'features.denseblock2.denselayer9.norm1.weight', 'features.denseblock2.denselayer9.norm1.bias', 'features.denseblock2.denselayer9.norm1.running_mean', 'features.denseblock2.denselayer9.norm1.running_var', 'features.denseblock2.denselayer9.conv1.weight', 'features.denseblock2.denselayer9.norm2.weight', 'features.denseblock2.denselayer9.norm2.bias', 'features.denseblock2.denselayer9.norm2.running_mean', 'features.denseblock2.denselayer9.norm2.running_var', 'features.denseblock2.denselayer9.conv2.weight', 'features.denseblock2.denselayer10.norm1.weight', 'features.denseblock2.denselayer10.norm1.bias', 'features.denseblock2.denselayer10.norm1.running_mean', 'features.denseblock2.denselayer10.norm1.running_var', 'features.denseblock2.denselayer10.conv1.weight', 'features.denseblock2.denselayer10.norm2.weight', 'features.denseblock2.denselayer10.norm2.bias', 'features.denseblock2.denselayer10.norm2.running_mean', 'features.denseblock2.denselayer10.norm2.running_var', 'features.denseblock2.denselayer10.conv2.weight', 'features.denseblock2.denselayer11.norm1.weight', 'features.denseblock2.denselayer11.norm1.bias', 'features.denseblock2.denselayer11.norm1.running_mean', 'features.denseblock2.denselayer11.norm1.running_var', 'features.denseblock2.denselayer11.conv1.weight', 'features.denseblock2.denselayer11.norm2.weight', 'features.denseblock2.denselayer11.norm2.bias', 'features.denseblock2.denselayer11.norm2.running_mean', 'features.denseblock2.denselayer11.norm2.running_var', 'features.denseblock2.denselayer11.conv2.weight', 'features.denseblock2.denselayer12.norm1.weight', 'features.denseblock2.denselayer12.norm1.bias', 'features.denseblock2.denselayer12.norm1.running_mean', 'features.denseblock2.denselayer12.norm1.running_var', 'features.denseblock2.denselayer12.conv1.weight', 'features.denseblock2.denselayer12.norm2.weight', 'features.denseblock2.denselayer12.norm2.bias', 'features.denseblock2.denselayer12.norm2.running_mean', 'features.denseblock2.denselayer12.norm2.running_var', 'features.denseblock2.denselayer12.conv2.weight', 'features.transition2.norm.weight', 'features.transition2.norm.bias', 'features.transition2.norm.running_mean', 'features.transition2.norm.running_var', 'features.transition2.conv.weight', 'features.denseblock3.denselayer1.norm1.weight', 'features.denseblock3.denselayer1.norm1.bias', 'features.denseblock3.denselayer1.norm1.running_mean', 'features.denseblock3.denselayer1.norm1.running_var', 'features.denseblock3.denselayer1.conv1.weight', 'features.denseblock3.denselayer1.norm2.weight', 'features.denseblock3.denselayer1.norm2.bias', 'features.denseblock3.denselayer1.norm2.running_mean', 'features.denseblock3.denselayer1.norm2.running_var', 'features.denseblock3.denselayer1.conv2.weight', 'features.denseblock3.denselayer2.norm1.weight', 'features.denseblock3.denselayer2.norm1.bias', 'features.denseblock3.denselayer2.norm1.running_mean', 'features.denseblock3.denselayer2.norm1.running_var', 'features.denseblock3.denselayer2.conv1.weight', 'features.denseblock3.denselayer2.norm2.weight', 'features.denseblock3.denselayer2.norm2.bias', 'features.denseblock3.denselayer2.norm2.running_mean', 'features.denseblock3.denselayer2.norm2.running_var', 'features.denseblock3.denselayer2.conv2.weight', 'features.denseblock3.denselayer3.norm1.weight', 'features.denseblock3.denselayer3.norm1.bias', 'features.denseblock3.denselayer3.norm1.running_mean', 'features.denseblock3.denselayer3.norm1.running_var', 'features.denseblock3.denselayer3.conv1.weight', 'features.denseblock3.denselayer3.norm2.weight', 'features.denseblock3.denselayer3.norm2.bias', 'features.denseblock3.denselayer3.norm2.running_mean', 'features.denseblock3.denselayer3.norm2.running_var', 'features.denseblock3.denselayer3.conv2.weight', 'features.denseblock3.denselayer4.norm1.weight', 'features.denseblock3.denselayer4.norm1.bias', 'features.denseblock3.denselayer4.norm1.running_mean', 'features.denseblock3.denselayer4.norm1.running_var', 'features.denseblock3.denselayer4.conv1.weight', 'features.denseblock3.denselayer4.norm2.weight', 'features.denseblock3.denselayer4.norm2.bias', 'features.denseblock3.denselayer4.norm2.running_mean', 'features.denseblock3.denselayer4.norm2.running_var', 'features.denseblock3.denselayer4.conv2.weight', 'features.denseblock3.denselayer5.norm1.weight', 'features.denseblock3.denselayer5.norm1.bias', 'features.denseblock3.denselayer5.norm1.running_mean', 'features.denseblock3.denselayer5.norm1.running_var', 'features.denseblock3.denselayer5.conv1.weight', 'features.denseblock3.denselayer5.norm2.weight', 'features.denseblock3.denselayer5.norm2.bias', 'features.denseblock3.denselayer5.norm2.running_mean', 'features.denseblock3.denselayer5.norm2.running_var', 'features.denseblock3.denselayer5.conv2.weight', 'features.denseblock3.denselayer6.norm1.weight', 'features.denseblock3.denselayer6.norm1.bias', 'features.denseblock3.denselayer6.norm1.running_mean', 'features.denseblock3.denselayer6.norm1.running_var', 'features.denseblock3.denselayer6.conv1.weight', 'features.denseblock3.denselayer6.norm2.weight', 'features.denseblock3.denselayer6.norm2.bias', 'features.denseblock3.denselayer6.norm2.running_mean', 'features.denseblock3.denselayer6.norm2.running_var', 'features.denseblock3.denselayer6.conv2.weight', 'features.denseblock3.denselayer7.norm1.weight', 'features.denseblock3.denselayer7.norm1.bias', 'features.denseblock3.denselayer7.norm1.running_mean', 'features.denseblock3.denselayer7.norm1.running_var', 'features.denseblock3.denselayer7.conv1.weight', 'features.denseblock3.denselayer7.norm2.weight', 'features.denseblock3.denselayer7.norm2.bias', 'features.denseblock3.denselayer7.norm2.running_mean', 'features.denseblock3.denselayer7.norm2.running_var', 'features.denseblock3.denselayer7.conv2.weight', 'features.denseblock3.denselayer8.norm1.weight', 'features.denseblock3.denselayer8.norm1.bias', 'features.denseblock3.denselayer8.norm1.running_mean', 'features.denseblock3.denselayer8.norm1.running_var', 'features.denseblock3.denselayer8.conv1.weight', 'features.denseblock3.denselayer8.norm2.weight', 'features.denseblock3.denselayer8.norm2.bias', 'features.denseblock3.denselayer8.norm2.running_mean', 'features.denseblock3.denselayer8.norm2.running_var', 'features.denseblock3.denselayer8.conv2.weight', 'features.denseblock3.denselayer9.norm1.weight', 'features.denseblock3.denselayer9.norm1.bias', 'features.denseblock3.denselayer9.norm1.running_mean', 'features.denseblock3.denselayer9.norm1.running_var', 'features.denseblock3.denselayer9.conv1.weight', 'features.denseblock3.denselayer9.norm2.weight', 'features.denseblock3.denselayer9.norm2.bias', 'features.denseblock3.denselayer9.norm2.running_mean', 'features.denseblock3.denselayer9.norm2.running_var', 'features.denseblock3.denselayer9.conv2.weight', 'features.denseblock3.denselayer10.norm1.weight', 'features.denseblock3.denselayer10.norm1.bias', 'features.denseblock3.denselayer10.norm1.running_mean', 'features.denseblock3.denselayer10.norm1.running_var', 'features.denseblock3.denselayer10.conv1.weight', 'features.denseblock3.denselayer10.norm2.weight', 'features.denseblock3.denselayer10.norm2.bias', 'features.denseblock3.denselayer10.norm2.running_mean', 'features.denseblock3.denselayer10.norm2.running_var', 'features.denseblock3.denselayer10.conv2.weight', 'features.denseblock3.denselayer11.norm1.weight', 'features.denseblock3.denselayer11.norm1.bias', 'features.denseblock3.denselayer11.norm1.running_mean', 'features.denseblock3.denselayer11.norm1.running_var', 'features.denseblock3.denselayer11.conv1.weight', 'features.denseblock3.denselayer11.norm2.weight', 'features.denseblock3.denselayer11.norm2.bias', 'features.denseblock3.denselayer11.norm2.running_mean', 'features.denseblock3.denselayer11.norm2.running_var', 'features.denseblock3.denselayer11.conv2.weight', 'features.denseblock3.denselayer12.norm1.weight', 'features.denseblock3.denselayer12.norm1.bias', 'features.denseblock3.denselayer12.norm1.running_mean', 'features.denseblock3.denselayer12.norm1.running_var', 'features.denseblock3.denselayer12.conv1.weight', 'features.denseblock3.denselayer12.norm2.weight', 'features.denseblock3.denselayer12.norm2.bias', 'features.denseblock3.denselayer12.norm2.running_mean', 'features.denseblock3.denselayer12.norm2.running_var', 'features.denseblock3.denselayer12.conv2.weight', 'features.denseblock3.denselayer13.norm1.weight', 'features.denseblock3.denselayer13.norm1.bias', 'features.denseblock3.denselayer13.norm1.running_mean', 'features.denseblock3.denselayer13.norm1.running_var', 'features.denseblock3.denselayer13.conv1.weight', 'features.denseblock3.denselayer13.norm2.weight', 'features.denseblock3.denselayer13.norm2.bias', 'features.denseblock3.denselayer13.norm2.running_mean', 'features.denseblock3.denselayer13.norm2.running_var', 'features.denseblock3.denselayer13.conv2.weight', 'features.denseblock3.denselayer14.norm1.weight', 'features.denseblock3.denselayer14.norm1.bias', 'features.denseblock3.denselayer14.norm1.running_mean', 'features.denseblock3.denselayer14.norm1.running_var', 'features.denseblock3.denselayer14.conv1.weight', 'features.denseblock3.denselayer14.norm2.weight', 'features.denseblock3.denselayer14.norm2.bias', 'features.denseblock3.denselayer14.norm2.running_mean', 'features.denseblock3.denselayer14.norm2.running_var', 'features.denseblock3.denselayer14.conv2.weight', 'features.denseblock3.denselayer15.norm1.weight', 'features.denseblock3.denselayer15.norm1.bias', 'features.denseblock3.denselayer15.norm1.running_mean', 'features.denseblock3.denselayer15.norm1.running_var', 'features.denseblock3.denselayer15.conv1.weight', 'features.denseblock3.denselayer15.norm2.weight', 'features.denseblock3.denselayer15.norm2.bias', 'features.denseblock3.denselayer15.norm2.running_mean', 'features.denseblock3.denselayer15.norm2.running_var', 'features.denseblock3.denselayer15.conv2.weight', 'features.denseblock3.denselayer16.norm1.weight', 'features.denseblock3.denselayer16.norm1.bias', 'features.denseblock3.denselayer16.norm1.running_mean', 'features.denseblock3.denselayer16.norm1.running_var', 'features.denseblock3.denselayer16.conv1.weight', 'features.denseblock3.denselayer16.norm2.weight', 'features.denseblock3.denselayer16.norm2.bias', 'features.denseblock3.denselayer16.norm2.running_mean', 'features.denseblock3.denselayer16.norm2.running_var', 'features.denseblock3.denselayer16.conv2.weight', 'features.denseblock3.denselayer17.norm1.weight', 'features.denseblock3.denselayer17.norm1.bias', 'features.denseblock3.denselayer17.norm1.running_mean', 'features.denseblock3.denselayer17.norm1.running_var', 'features.denseblock3.denselayer17.conv1.weight', 'features.denseblock3.denselayer17.norm2.weight', 'features.denseblock3.denselayer17.norm2.bias', 'features.denseblock3.denselayer17.norm2.running_mean', 'features.denseblock3.denselayer17.norm2.running_var', 'features.denseblock3.denselayer17.conv2.weight', 'features.denseblock3.denselayer18.norm1.weight', 'features.denseblock3.denselayer18.norm1.bias', 'features.denseblock3.denselayer18.norm1.running_mean', 'features.denseblock3.denselayer18.norm1.running_var', 'features.denseblock3.denselayer18.conv1.weight', 'features.denseblock3.denselayer18.norm2.weight', 'features.denseblock3.denselayer18.norm2.bias', 'features.denseblock3.denselayer18.norm2.running_mean', 'features.denseblock3.denselayer18.norm2.running_var', 'features.denseblock3.denselayer18.conv2.weight', 'features.denseblock3.denselayer19.norm1.weight', 'features.denseblock3.denselayer19.norm1.bias', 'features.denseblock3.denselayer19.norm1.running_mean', 'features.denseblock3.denselayer19.norm1.running_var', 'features.denseblock3.denselayer19.conv1.weight', 'features.denseblock3.denselayer19.norm2.weight', 'features.denseblock3.denselayer19.norm2.bias', 'features.denseblock3.denselayer19.norm2.running_mean', 'features.denseblock3.denselayer19.norm2.running_var', 'features.denseblock3.denselayer19.conv2.weight', 'features.denseblock3.denselayer20.norm1.weight', 'features.denseblock3.denselayer20.norm1.bias', 'features.denseblock3.denselayer20.norm1.running_mean', 'features.denseblock3.denselayer20.norm1.running_var', 'features.denseblock3.denselayer20.conv1.weight', 'features.denseblock3.denselayer20.norm2.weight', 'features.denseblock3.denselayer20.norm2.bias', 'features.denseblock3.denselayer20.norm2.running_mean', 'features.denseblock3.denselayer20.norm2.running_var', 'features.denseblock3.denselayer20.conv2.weight', 'features.denseblock3.denselayer21.norm1.weight', 'features.denseblock3.denselayer21.norm1.bias', 'features.denseblock3.denselayer21.norm1.running_mean', 'features.denseblock3.denselayer21.norm1.running_var', 'features.denseblock3.denselayer21.conv1.weight', 'features.denseblock3.denselayer21.norm2.weight', 'features.denseblock3.denselayer21.norm2.bias', 'features.denseblock3.denselayer21.norm2.running_mean', 'features.denseblock3.denselayer21.norm2.running_var', 'features.denseblock3.denselayer21.conv2.weight', 'features.denseblock3.denselayer22.norm1.weight', 'features.denseblock3.denselayer22.norm1.bias', 'features.denseblock3.denselayer22.norm1.running_mean', 'features.denseblock3.denselayer22.norm1.running_var', 'features.denseblock3.denselayer22.conv1.weight', 'features.denseblock3.denselayer22.norm2.weight', 'features.denseblock3.denselayer22.norm2.bias', 'features.denseblock3.denselayer22.norm2.running_mean', 'features.denseblock3.denselayer22.norm2.running_var', 'features.denseblock3.denselayer22.conv2.weight', 'features.denseblock3.denselayer23.norm1.weight', 'features.denseblock3.denselayer23.norm1.bias', 'features.denseblock3.denselayer23.norm1.running_mean', 'features.denseblock3.denselayer23.norm1.running_var', 'features.denseblock3.denselayer23.conv1.weight', 'features.denseblock3.denselayer23.norm2.weight', 'features.denseblock3.denselayer23.norm2.bias', 'features.denseblock3.denselayer23.norm2.running_mean', 'features.denseblock3.denselayer23.norm2.running_var', 'features.denseblock3.denselayer23.conv2.weight', 'features.denseblock3.denselayer24.norm1.weight', 'features.denseblock3.denselayer24.norm1.bias', 'features.denseblock3.denselayer24.norm1.running_mean', 'features.denseblock3.denselayer24.norm1.running_var', 'features.denseblock3.denselayer24.conv1.weight', 'features.denseblock3.denselayer24.norm2.weight', 'features.denseblock3.denselayer24.norm2.bias', 'features.denseblock3.denselayer24.norm2.running_mean', 'features.denseblock3.denselayer24.norm2.running_var', 'features.denseblock3.denselayer24.conv2.weight', 'features.transition3.norm.weight', 'features.transition3.norm.bias', 'features.transition3.norm.running_mean', 'features.transition3.norm.running_var', 'features.transition3.conv.weight', 'features.denseblock4.denselayer1.norm1.weight', 'features.denseblock4.denselayer1.norm1.bias', 'features.denseblock4.denselayer1.norm1.running_mean', 'features.denseblock4.denselayer1.norm1.running_var', 'features.denseblock4.denselayer1.conv1.weight', 'features.denseblock4.denselayer1.norm2.weight', 'features.denseblock4.denselayer1.norm2.bias', 'features.denseblock4.denselayer1.norm2.running_mean', 'features.denseblock4.denselayer1.norm2.running_var', 'features.denseblock4.denselayer1.conv2.weight', 'features.denseblock4.denselayer2.norm1.weight', 'features.denseblock4.denselayer2.norm1.bias', 'features.denseblock4.denselayer2.norm1.running_mean', 'features.denseblock4.denselayer2.norm1.running_var', 'features.denseblock4.denselayer2.conv1.weight', 'features.denseblock4.denselayer2.norm2.weight', 'features.denseblock4.denselayer2.norm2.bias', 'features.denseblock4.denselayer2.norm2.running_mean', 'features.denseblock4.denselayer2.norm2.running_var', 'features.denseblock4.denselayer2.conv2.weight', 'features.denseblock4.denselayer3.norm1.weight', 'features.denseblock4.denselayer3.norm1.bias', 'features.denseblock4.denselayer3.norm1.running_mean', 'features.denseblock4.denselayer3.norm1.running_var', 'features.denseblock4.denselayer3.conv1.weight', 'features.denseblock4.denselayer3.norm2.weight', 'features.denseblock4.denselayer3.norm2.bias', 'features.denseblock4.denselayer3.norm2.running_mean', 'features.denseblock4.denselayer3.norm2.running_var', 'features.denseblock4.denselayer3.conv2.weight', 'features.denseblock4.denselayer4.norm1.weight', 'features.denseblock4.denselayer4.norm1.bias', 'features.denseblock4.denselayer4.norm1.running_mean', 'features.denseblock4.denselayer4.norm1.running_var', 'features.denseblock4.denselayer4.conv1.weight', 'features.denseblock4.denselayer4.norm2.weight', 'features.denseblock4.denselayer4.norm2.bias', 'features.denseblock4.denselayer4.norm2.running_mean', 'features.denseblock4.denselayer4.norm2.running_var', 'features.denseblock4.denselayer4.conv2.weight', 'features.denseblock4.denselayer5.norm1.weight', 'features.denseblock4.denselayer5.norm1.bias', 'features.denseblock4.denselayer5.norm1.running_mean', 'features.denseblock4.denselayer5.norm1.running_var', 'features.denseblock4.denselayer5.conv1.weight', 'features.denseblock4.denselayer5.norm2.weight', 'features.denseblock4.denselayer5.norm2.bias', 'features.denseblock4.denselayer5.norm2.running_mean', 'features.denseblock4.denselayer5.norm2.running_var', 'features.denseblock4.denselayer5.conv2.weight', 'features.denseblock4.denselayer6.norm1.weight', 'features.denseblock4.denselayer6.norm1.bias', 'features.denseblock4.denselayer6.norm1.running_mean', 'features.denseblock4.denselayer6.norm1.running_var', 'features.denseblock4.denselayer6.conv1.weight', 'features.denseblock4.denselayer6.norm2.weight', 'features.denseblock4.denselayer6.norm2.bias', 'features.denseblock4.denselayer6.norm2.running_mean', 'features.denseblock4.denselayer6.norm2.running_var', 'features.denseblock4.denselayer6.conv2.weight', 'features.denseblock4.denselayer7.norm1.weight', 'features.denseblock4.denselayer7.norm1.bias', 'features.denseblock4.denselayer7.norm1.running_mean', 'features.denseblock4.denselayer7.norm1.running_var', 'features.denseblock4.denselayer7.conv1.weight', 'features.denseblock4.denselayer7.norm2.weight', 'features.denseblock4.denselayer7.norm2.bias', 'features.denseblock4.denselayer7.norm2.running_mean', 'features.denseblock4.denselayer7.norm2.running_var', 'features.denseblock4.denselayer7.conv2.weight', 'features.denseblock4.denselayer8.norm1.weight', 'features.denseblock4.denselayer8.norm1.bias', 'features.denseblock4.denselayer8.norm1.running_mean', 'features.denseblock4.denselayer8.norm1.running_var', 'features.denseblock4.denselayer8.conv1.weight', 'features.denseblock4.denselayer8.norm2.weight', 'features.denseblock4.denselayer8.norm2.bias', 'features.denseblock4.denselayer8.norm2.running_mean', 'features.denseblock4.denselayer8.norm2.running_var', 'features.denseblock4.denselayer8.conv2.weight', 'features.denseblock4.denselayer9.norm1.weight', 'features.denseblock4.denselayer9.norm1.bias', 'features.denseblock4.denselayer9.norm1.running_mean', 'features.denseblock4.denselayer9.norm1.running_var', 'features.denseblock4.denselayer9.conv1.weight', 'features.denseblock4.denselayer9.norm2.weight', 'features.denseblock4.denselayer9.norm2.bias', 'features.denseblock4.denselayer9.norm2.running_mean', 'features.denseblock4.denselayer9.norm2.running_var', 'features.denseblock4.denselayer9.conv2.weight', 'features.denseblock4.denselayer10.norm1.weight', 'features.denseblock4.denselayer10.norm1.bias', 'features.denseblock4.denselayer10.norm1.running_mean', 'features.denseblock4.denselayer10.norm1.running_var', 'features.denseblock4.denselayer10.conv1.weight', 'features.denseblock4.denselayer10.norm2.weight', 'features.denseblock4.denselayer10.norm2.bias', 'features.denseblock4.denselayer10.norm2.running_mean', 'features.denseblock4.denselayer10.norm2.running_var', 'features.denseblock4.denselayer10.conv2.weight', 'features.denseblock4.denselayer11.norm1.weight', 'features.denseblock4.denselayer11.norm1.bias', 'features.denseblock4.denselayer11.norm1.running_mean', 'features.denseblock4.denselayer11.norm1.running_var', 'features.denseblock4.denselayer11.conv1.weight', 'features.denseblock4.denselayer11.norm2.weight', 'features.denseblock4.denselayer11.norm2.bias', 'features.denseblock4.denselayer11.norm2.running_mean', 'features.denseblock4.denselayer11.norm2.running_var', 'features.denseblock4.denselayer11.conv2.weight', 'features.denseblock4.denselayer12.norm1.weight', 'features.denseblock4.denselayer12.norm1.bias', 'features.denseblock4.denselayer12.norm1.running_mean', 'features.denseblock4.denselayer12.norm1.running_var', 'features.denseblock4.denselayer12.conv1.weight', 'features.denseblock4.denselayer12.norm2.weight', 'features.denseblock4.denselayer12.norm2.bias', 'features.denseblock4.denselayer12.norm2.running_mean', 'features.denseblock4.denselayer12.norm2.running_var', 'features.denseblock4.denselayer12.conv2.weight', 'features.denseblock4.denselayer13.norm1.weight', 'features.denseblock4.denselayer13.norm1.bias', 'features.denseblock4.denselayer13.norm1.running_mean', 'features.denseblock4.denselayer13.norm1.running_var', 'features.denseblock4.denselayer13.conv1.weight', 'features.denseblock4.denselayer13.norm2.weight', 'features.denseblock4.denselayer13.norm2.bias', 'features.denseblock4.denselayer13.norm2.running_mean', 'features.denseblock4.denselayer13.norm2.running_var', 'features.denseblock4.denselayer13.conv2.weight', 'features.denseblock4.denselayer14.norm1.weight', 'features.denseblock4.denselayer14.norm1.bias', 'features.denseblock4.denselayer14.norm1.running_mean', 'features.denseblock4.denselayer14.norm1.running_var', 'features.denseblock4.denselayer14.conv1.weight', 'features.denseblock4.denselayer14.norm2.weight', 'features.denseblock4.denselayer14.norm2.bias', 'features.denseblock4.denselayer14.norm2.running_mean', 'features.denseblock4.denselayer14.norm2.running_var', 'features.denseblock4.denselayer14.conv2.weight', 'features.denseblock4.denselayer15.norm1.weight', 'features.denseblock4.denselayer15.norm1.bias', 'features.denseblock4.denselayer15.norm1.running_mean', 'features.denseblock4.denselayer15.norm1.running_var', 'features.denseblock4.denselayer15.conv1.weight', 'features.denseblock4.denselayer15.norm2.weight', 'features.denseblock4.denselayer15.norm2.bias', 'features.denseblock4.denselayer15.norm2.running_mean', 'features.denseblock4.denselayer15.norm2.running_var', 'features.denseblock4.denselayer15.conv2.weight', 'features.denseblock4.denselayer16.norm1.weight', 'features.denseblock4.denselayer16.norm1.bias', 'features.denseblock4.denselayer16.norm1.running_mean', 'features.denseblock4.denselayer16.norm1.running_var', 'features.denseblock4.denselayer16.conv1.weight', 'features.denseblock4.denselayer16.norm2.weight', 'features.denseblock4.denselayer16.norm2.bias', 'features.denseblock4.denselayer16.norm2.running_mean', 'features.denseblock4.denselayer16.norm2.running_var', 'features.denseblock4.denselayer16.conv2.weight', 'features.norm5.weight', 'features.norm5.bias', 'features.norm5.running_mean', 'features.norm5.running_var', 'classifier.weight', 'classifier.bias']
2025-05-03 08:50:10,750 [WARNING] - Unexpected keys when restoring best state for densenet: ['features.0.0.weight', 'features.0.1.weight', 'features.0.1.bias', 'features.0.1.running_mean', 'features.0.1.running_var', 'features.0.1.num_batches_tracked', 'features.1.0.block.0.0.weight', 'features.1.0.block.0.1.weight', 'features.1.0.block.0.1.bias', 'features.1.0.block.0.1.running_mean', 'features.1.0.block.0.1.running_var', 'features.1.0.block.0.1.num_batches_tracked', 'features.1.0.block.1.fc1.weight', 'features.1.0.block.1.fc1.bias', 'features.1.0.block.1.fc2.weight', 'features.1.0.block.1.fc2.bias', 'features.1.0.block.2.0.weight', 'features.1.0.block.2.1.weight', 'features.1.0.block.2.1.bias', 'features.1.0.block.2.1.running_mean', 'features.1.0.block.2.1.running_var', 'features.1.0.block.2.1.num_batches_tracked', 'features.2.0.block.0.0.weight', 'features.2.0.block.0.1.weight', 'features.2.0.block.0.1.bias', 'features.2.0.block.0.1.running_mean', 'features.2.0.block.0.1.running_var', 'features.2.0.block.0.1.num_batches_tracked', 'features.2.0.block.1.0.weight', 'features.2.0.block.1.1.weight', 'features.2.0.block.1.1.bias', 'features.2.0.block.1.1.running_mean', 'features.2.0.block.1.1.running_var', 'features.2.0.block.1.1.num_batches_tracked', 'features.2.0.block.2.fc1.weight', 'features.2.0.block.2.fc1.bias', 'features.2.0.block.2.fc2.weight', 'features.2.0.block.2.fc2.bias', 'features.2.0.block.3.0.weight', 'features.2.0.block.3.1.weight', 'features.2.0.block.3.1.bias', 'features.2.0.block.3.1.running_mean', 'features.2.0.block.3.1.running_var', 'features.2.0.block.3.1.num_batches_tracked', 'features.2.1.block.0.0.weight', 'features.2.1.block.0.1.weight', 'features.2.1.block.0.1.bias', 'features.2.1.block.0.1.running_mean', 'features.2.1.block.0.1.running_var', 'features.2.1.block.0.1.num_batches_tracked', 'features.2.1.block.1.0.weight', 'features.2.1.block.1.1.weight', 'features.2.1.block.1.1.bias', 'features.2.1.block.1.1.running_mean', 'features.2.1.block.1.1.running_var', 'features.2.1.block.1.1.num_batches_tracked', 'features.2.1.block.2.fc1.weight', 'features.2.1.block.2.fc1.bias', 'features.2.1.block.2.fc2.weight', 'features.2.1.block.2.fc2.bias', 'features.2.1.block.3.0.weight', 'features.2.1.block.3.1.weight', 'features.2.1.block.3.1.bias', 'features.2.1.block.3.1.running_mean', 'features.2.1.block.3.1.running_var', 'features.2.1.block.3.1.num_batches_tracked', 'features.3.0.block.0.0.weight', 'features.3.0.block.0.1.weight', 'features.3.0.block.0.1.bias', 'features.3.0.block.0.1.running_mean', 'features.3.0.block.0.1.running_var', 'features.3.0.block.0.1.num_batches_tracked', 'features.3.0.block.1.0.weight', 'features.3.0.block.1.1.weight', 'features.3.0.block.1.1.bias', 'features.3.0.block.1.1.running_mean', 'features.3.0.block.1.1.running_var', 'features.3.0.block.1.1.num_batches_tracked', 'features.3.0.block.2.fc1.weight', 'features.3.0.block.2.fc1.bias', 'features.3.0.block.2.fc2.weight', 'features.3.0.block.2.fc2.bias', 'features.3.0.block.3.0.weight', 'features.3.0.block.3.1.weight', 'features.3.0.block.3.1.bias', 'features.3.0.block.3.1.running_mean', 'features.3.0.block.3.1.running_var', 'features.3.0.block.3.1.num_batches_tracked', 'features.3.1.block.0.0.weight', 'features.3.1.block.0.1.weight', 'features.3.1.block.0.1.bias', 'features.3.1.block.0.1.running_mean', 'features.3.1.block.0.1.running_var', 'features.3.1.block.0.1.num_batches_tracked', 'features.3.1.block.1.0.weight', 'features.3.1.block.1.1.weight', 'features.3.1.block.1.1.bias', 'features.3.1.block.1.1.running_mean', 'features.3.1.block.1.1.running_var', 'features.3.1.block.1.1.num_batches_tracked', 'features.3.1.block.2.fc1.weight', 'features.3.1.block.2.fc1.bias', 'features.3.1.block.2.fc2.weight', 'features.3.1.block.2.fc2.bias', 'features.3.1.block.3.0.weight', 'features.3.1.block.3.1.weight', 'features.3.1.block.3.1.bias', 'features.3.1.block.3.1.running_mean', 'features.3.1.block.3.1.running_var', 'features.3.1.block.3.1.num_batches_tracked', 'features.4.0.block.0.0.weight', 'features.4.0.block.0.1.weight', 'features.4.0.block.0.1.bias', 'features.4.0.block.0.1.running_mean', 'features.4.0.block.0.1.running_var', 'features.4.0.block.0.1.num_batches_tracked', 'features.4.0.block.1.0.weight', 'features.4.0.block.1.1.weight', 'features.4.0.block.1.1.bias', 'features.4.0.block.1.1.running_mean', 'features.4.0.block.1.1.running_var', 'features.4.0.block.1.1.num_batches_tracked', 'features.4.0.block.2.fc1.weight', 'features.4.0.block.2.fc1.bias', 'features.4.0.block.2.fc2.weight', 'features.4.0.block.2.fc2.bias', 'features.4.0.block.3.0.weight', 'features.4.0.block.3.1.weight', 'features.4.0.block.3.1.bias', 'features.4.0.block.3.1.running_mean', 'features.4.0.block.3.1.running_var', 'features.4.0.block.3.1.num_batches_tracked', 'features.4.1.block.0.0.weight', 'features.4.1.block.0.1.weight', 'features.4.1.block.0.1.bias', 'features.4.1.block.0.1.running_mean', 'features.4.1.block.0.1.running_var', 'features.4.1.block.0.1.num_batches_tracked', 'features.4.1.block.1.0.weight', 'features.4.1.block.1.1.weight', 'features.4.1.block.1.1.bias', 'features.4.1.block.1.1.running_mean', 'features.4.1.block.1.1.running_var', 'features.4.1.block.1.1.num_batches_tracked', 'features.4.1.block.2.fc1.weight', 'features.4.1.block.2.fc1.bias', 'features.4.1.block.2.fc2.weight', 'features.4.1.block.2.fc2.bias', 'features.4.1.block.3.0.weight', 'features.4.1.block.3.1.weight', 'features.4.1.block.3.1.bias', 'features.4.1.block.3.1.running_mean', 'features.4.1.block.3.1.running_var', 'features.4.1.block.3.1.num_batches_tracked', 'features.4.2.block.0.0.weight', 'features.4.2.block.0.1.weight', 'features.4.2.block.0.1.bias', 'features.4.2.block.0.1.running_mean', 'features.4.2.block.0.1.running_var', 'features.4.2.block.0.1.num_batches_tracked', 'features.4.2.block.1.0.weight', 'features.4.2.block.1.1.weight', 'features.4.2.block.1.1.bias', 'features.4.2.block.1.1.running_mean', 'features.4.2.block.1.1.running_var', 'features.4.2.block.1.1.num_batches_tracked', 'features.4.2.block.2.fc1.weight', 'features.4.2.block.2.fc1.bias', 'features.4.2.block.2.fc2.weight', 'features.4.2.block.2.fc2.bias', 'features.4.2.block.3.0.weight', 'features.4.2.block.3.1.weight', 'features.4.2.block.3.1.bias', 'features.4.2.block.3.1.running_mean', 'features.4.2.block.3.1.running_var', 'features.4.2.block.3.1.num_batches_tracked', 'features.5.0.block.0.0.weight', 'features.5.0.block.0.1.weight', 'features.5.0.block.0.1.bias', 'features.5.0.block.0.1.running_mean', 'features.5.0.block.0.1.running_var', 'features.5.0.block.0.1.num_batches_tracked', 'features.5.0.block.1.0.weight', 'features.5.0.block.1.1.weight', 'features.5.0.block.1.1.bias', 'features.5.0.block.1.1.running_mean', 'features.5.0.block.1.1.running_var', 'features.5.0.block.1.1.num_batches_tracked', 'features.5.0.block.2.fc1.weight', 'features.5.0.block.2.fc1.bias', 'features.5.0.block.2.fc2.weight', 'features.5.0.block.2.fc2.bias', 'features.5.0.block.3.0.weight', 'features.5.0.block.3.1.weight', 'features.5.0.block.3.1.bias', 'features.5.0.block.3.1.running_mean', 'features.5.0.block.3.1.running_var', 'features.5.0.block.3.1.num_batches_tracked', 'features.5.1.block.0.0.weight', 'features.5.1.block.0.1.weight', 'features.5.1.block.0.1.bias', 'features.5.1.block.0.1.running_mean', 'features.5.1.block.0.1.running_var', 'features.5.1.block.0.1.num_batches_tracked', 'features.5.1.block.1.0.weight', 'features.5.1.block.1.1.weight', 'features.5.1.block.1.1.bias', 'features.5.1.block.1.1.running_mean', 'features.5.1.block.1.1.running_var', 'features.5.1.block.1.1.num_batches_tracked', 'features.5.1.block.2.fc1.weight', 'features.5.1.block.2.fc1.bias', 'features.5.1.block.2.fc2.weight', 'features.5.1.block.2.fc2.bias', 'features.5.1.block.3.0.weight', 'features.5.1.block.3.1.weight', 'features.5.1.block.3.1.bias', 'features.5.1.block.3.1.running_mean', 'features.5.1.block.3.1.running_var', 'features.5.1.block.3.1.num_batches_tracked', 'features.5.2.block.0.0.weight', 'features.5.2.block.0.1.weight', 'features.5.2.block.0.1.bias', 'features.5.2.block.0.1.running_mean', 'features.5.2.block.0.1.running_var', 'features.5.2.block.0.1.num_batches_tracked', 'features.5.2.block.1.0.weight', 'features.5.2.block.1.1.weight', 'features.5.2.block.1.1.bias', 'features.5.2.block.1.1.running_mean', 'features.5.2.block.1.1.running_var', 'features.5.2.block.1.1.num_batches_tracked', 'features.5.2.block.2.fc1.weight', 'features.5.2.block.2.fc1.bias', 'features.5.2.block.2.fc2.weight', 'features.5.2.block.2.fc2.bias', 'features.5.2.block.3.0.weight', 'features.5.2.block.3.1.weight', 'features.5.2.block.3.1.bias', 'features.5.2.block.3.1.running_mean', 'features.5.2.block.3.1.running_var', 'features.5.2.block.3.1.num_batches_tracked', 'features.6.0.block.0.0.weight', 'features.6.0.block.0.1.weight', 'features.6.0.block.0.1.bias', 'features.6.0.block.0.1.running_mean', 'features.6.0.block.0.1.running_var', 'features.6.0.block.0.1.num_batches_tracked', 'features.6.0.block.1.0.weight', 'features.6.0.block.1.1.weight', 'features.6.0.block.1.1.bias', 'features.6.0.block.1.1.running_mean', 'features.6.0.block.1.1.running_var', 'features.6.0.block.1.1.num_batches_tracked', 'features.6.0.block.2.fc1.weight', 'features.6.0.block.2.fc1.bias', 'features.6.0.block.2.fc2.weight', 'features.6.0.block.2.fc2.bias', 'features.6.0.block.3.0.weight', 'features.6.0.block.3.1.weight', 'features.6.0.block.3.1.bias', 'features.6.0.block.3.1.running_mean', 'features.6.0.block.3.1.running_var', 'features.6.0.block.3.1.num_batches_tracked', 'features.6.1.block.0.0.weight', 'features.6.1.block.0.1.weight', 'features.6.1.block.0.1.bias', 'features.6.1.block.0.1.running_mean', 'features.6.1.block.0.1.running_var', 'features.6.1.block.0.1.num_batches_tracked', 'features.6.1.block.1.0.weight', 'features.6.1.block.1.1.weight', 'features.6.1.block.1.1.bias', 'features.6.1.block.1.1.running_mean', 'features.6.1.block.1.1.running_var', 'features.6.1.block.1.1.num_batches_tracked', 'features.6.1.block.2.fc1.weight', 'features.6.1.block.2.fc1.bias', 'features.6.1.block.2.fc2.weight', 'features.6.1.block.2.fc2.bias', 'features.6.1.block.3.0.weight', 'features.6.1.block.3.1.weight', 'features.6.1.block.3.1.bias', 'features.6.1.block.3.1.running_mean', 'features.6.1.block.3.1.running_var', 'features.6.1.block.3.1.num_batches_tracked', 'features.6.2.block.0.0.weight', 'features.6.2.block.0.1.weight', 'features.6.2.block.0.1.bias', 'features.6.2.block.0.1.running_mean', 'features.6.2.block.0.1.running_var', 'features.6.2.block.0.1.num_batches_tracked', 'features.6.2.block.1.0.weight', 'features.6.2.block.1.1.weight', 'features.6.2.block.1.1.bias', 'features.6.2.block.1.1.running_mean', 'features.6.2.block.1.1.running_var', 'features.6.2.block.1.1.num_batches_tracked', 'features.6.2.block.2.fc1.weight', 'features.6.2.block.2.fc1.bias', 'features.6.2.block.2.fc2.weight', 'features.6.2.block.2.fc2.bias', 'features.6.2.block.3.0.weight', 'features.6.2.block.3.1.weight', 'features.6.2.block.3.1.bias', 'features.6.2.block.3.1.running_mean', 'features.6.2.block.3.1.running_var', 'features.6.2.block.3.1.num_batches_tracked', 'features.6.3.block.0.0.weight', 'features.6.3.block.0.1.weight', 'features.6.3.block.0.1.bias', 'features.6.3.block.0.1.running_mean', 'features.6.3.block.0.1.running_var', 'features.6.3.block.0.1.num_batches_tracked', 'features.6.3.block.1.0.weight', 'features.6.3.block.1.1.weight', 'features.6.3.block.1.1.bias', 'features.6.3.block.1.1.running_mean', 'features.6.3.block.1.1.running_var', 'features.6.3.block.1.1.num_batches_tracked', 'features.6.3.block.2.fc1.weight', 'features.6.3.block.2.fc1.bias', 'features.6.3.block.2.fc2.weight', 'features.6.3.block.2.fc2.bias', 'features.6.3.block.3.0.weight', 'features.6.3.block.3.1.weight', 'features.6.3.block.3.1.bias', 'features.6.3.block.3.1.running_mean', 'features.6.3.block.3.1.running_var', 'features.6.3.block.3.1.num_batches_tracked', 'features.7.0.block.0.0.weight', 'features.7.0.block.0.1.weight', 'features.7.0.block.0.1.bias', 'features.7.0.block.0.1.running_mean', 'features.7.0.block.0.1.running_var', 'features.7.0.block.0.1.num_batches_tracked', 'features.7.0.block.1.0.weight', 'features.7.0.block.1.1.weight', 'features.7.0.block.1.1.bias', 'features.7.0.block.1.1.running_mean', 'features.7.0.block.1.1.running_var', 'features.7.0.block.1.1.num_batches_tracked', 'features.7.0.block.2.fc1.weight', 'features.7.0.block.2.fc1.bias', 'features.7.0.block.2.fc2.weight', 'features.7.0.block.2.fc2.bias', 'features.7.0.block.3.0.weight', 'features.7.0.block.3.1.weight', 'features.7.0.block.3.1.bias', 'features.7.0.block.3.1.running_mean', 'features.7.0.block.3.1.running_var', 'features.7.0.block.3.1.num_batches_tracked', 'features.8.0.weight', 'features.8.1.weight', 'features.8.1.bias', 'features.8.1.running_mean', 'features.8.1.running_var', 'features.8.1.num_batches_tracked', 'classifier.1.weight', 'classifier.1.bias']
2025-05-03 08:50:10,750 [INFO] - Restored best state for densenet from initialization (Val Acc: 94.22%)
2025-05-03 08:50:10,767 [INFO] - Restored best state for student from initialization (Val Acc: 93.68%)
2025-05-03 08:50:10,767 [INFO] - Initialization phase completed
2025-05-03 08:50:10,771 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-03 08:50:10,917 [INFO] - GPU Memory: Current=1770.90MB, Peak=2687.81MB, Reserved=1880.00MB
2025-05-03 08:50:10,918 [INFO] - Mutual learning script finished.
2025-05-03 09:25:10,927 [INFO] - Using device: cuda
2025-05-03 09:25:10,927 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:25:10,927 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:25:10,927 [INFO] - CUDA Version: 11.8
2025-05-03 09:25:10,927 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:25:11,497 [INFO] - Flash Attention library not found or import failed. Standard attention will be used.
2025-05-03 09:25:11,497 [INFO] - Configuration loaded:
2025-05-03 09:25:11,497 [INFO] - Random seed set to 42
2025-05-03 09:25:11,497 [INFO] - cuDNN benchmark/autotuner enabled via config.
2025-05-03 09:25:11,497 [INFO] - Using channels_last memory format via config.
2025-05-03 09:25:11,497 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "use_checkpoint_activation": true,
    "mixed_precision_dtype": "float16",
    "optimize_transformer_attention": true,
    "optimize_memory_footprint": true,
    "cache_clearing_frequency": 25,
    "dataloader_prefetch": 2,
    "use_channels_last_memory_format": true,
    "num_workers": 2,
    "enable_cudnn_autotuner": true,
    "input_size": 32,
    "model_input_size": 224,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.0005,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "alpha": 0.35,
    "feature_loss_weight": 0.008,
    "cal_weight": 0.06,
    "use_warmup": true,
    "warmup_epochs": 8,
    "curriculum_start_epoch": 8,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 60,
    "use_loss_clipping": true,
    "loss_clip_threshold": 5.0,
    "use_gradient_skip": true,
    "gradient_skip_threshold": 10.0,
    "temperature_min": 2.0,
    "temperature_max": 5.0,
    "anneal_temperature": true,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-03 09:25:11,497 [INFO] - Random seed set to 42
2025-05-03 09:25:11,507 [INFO] - Creating models...
2025-05-03 09:25:11,507 [INFO] - Loading ViT-B16 model...
2025-05-03 09:25:12,412 [INFO] - Loading EfficientNetB0 model...
2025-05-03 09:25:12,528 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-03 09:25:12,878 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-03 09:25:12,878 [INFO] - Loading MobileNetV3-Large model...
2025-05-03 09:25:12,985 [INFO] - Loading ResNet50 model...
2025-05-03 09:25:13,330 [INFO] - Loading DenseNet121 model...
2025-05-03 09:25:13,465 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-03 09:25:13,959 [INFO] - Model vit converted to channels_last format.
2025-05-03 09:25:13,968 [INFO] - Model efficientnet converted to channels_last format.
2025-05-03 09:25:13,975 [INFO] - Model inception converted to channels_last format.
2025-05-03 09:25:13,978 [INFO] - Model mobilenet converted to channels_last format.
2025-05-03 09:25:13,981 [INFO] - Model resnet converted to channels_last format.
2025-05-03 09:25:13,989 [INFO] - Model densenet converted to channels_last format.
2025-05-03 09:25:13,993 [INFO] - Model student converted to channels_last format.
2025-05-03 09:25:13,993 [INFO] - Gradient checkpointing enabled for vit.
2025-05-03 09:25:13,993 [INFO] - Gradient checkpointing enabled for efficientnet.
2025-05-03 09:25:13,993 [INFO] - Gradient checkpointing enabled for inception.
2025-05-03 09:25:13,993 [INFO] - Gradient checkpointing enabled for mobilenet.
2025-05-03 09:25:13,993 [INFO] - Gradient checkpointing enabled for resnet.
2025-05-03 09:25:13,993 [INFO] - Gradient checkpointing enabled for densenet.
2025-05-03 09:25:13,993 [INFO] - Gradient checkpointing enabled for student.
2025-05-03 09:25:13,993 [INFO] - Models created and moved to device.
2025-05-03 09:25:13,998 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-03 09:25:13,998 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-03 09:25:15,593 [INFO] - Loaded model state for vit successfully.
2025-05-03 09:25:15,607 [INFO] - Loaded model state for efficientnet successfully.
2025-05-03 09:25:15,647 [INFO] - Loaded model state for inception successfully.
2025-05-03 09:25:15,657 [INFO] - Loaded model state for mobilenet successfully.
2025-05-03 09:25:15,688 [INFO] - Loaded model state for resnet successfully.
2025-05-03 09:25:15,718 [INFO] - Loaded model state for densenet successfully.
2025-05-03 09:25:15,738 [INFO] - Loaded model state for student successfully.
2025-05-03 09:25:15,868 [INFO] - Recreated and loaded optimizer state for vit
2025-05-03 09:25:15,891 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-03 09:25:15,947 [INFO] - Recreated and loaded optimizer state for inception
2025-05-03 09:25:15,968 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-03 09:25:16,017 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-03 09:25:16,083 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-03 09:25:16,108 [INFO] - Recreated and loaded optimizer state for student
2025-05-03 09:25:16,108 [INFO] - Recreated and loaded scheduler state for vit (Type: StepLR)
2025-05-03 09:25:16,108 [INFO] - Recreated and loaded scheduler state for efficientnet (Type: StepLR)
2025-05-03 09:25:16,108 [INFO] - Recreated and loaded scheduler state for inception (Type: StepLR)
2025-05-03 09:25:16,108 [INFO] - Recreated and loaded scheduler state for mobilenet (Type: StepLR)
2025-05-03 09:25:16,108 [INFO] - Recreated and loaded scheduler state for resnet (Type: StepLR)
2025-05-03 09:25:16,108 [INFO] - Recreated and loaded scheduler state for densenet (Type: StepLR)
2025-05-03 09:25:16,108 [INFO] - Recreated and loaded scheduler state for student (Type: StepLR)
2025-05-03 09:25:16,108 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-03 09:25:16,118 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-03 09:25:16,118 [INFO] - Preparing data loaders...
2025-05-03 09:25:24,588 [INFO] - Training samples: 45000 per model
2025-05-03 09:25:24,588 [INFO] - Validation samples: 5000 per model
2025-05-03 09:25:24,588 [INFO] - Test samples: 10000 per model
2025-05-03 09:25:24,588 [INFO] - Skipping initialization phase.
2025-05-03 09:25:24,588 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-03 09:25:24,742 [INFO] - GPU Memory: Current=1753.03MB, Peak=1753.03MB, Reserved=1784.00MB
2025-05-03 09:25:24,742 [INFO] - Mutual learning script finished.
2025-05-03 09:26:20,175 [INFO] - Using device: cuda
2025-05-03 09:26:20,178 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:26:20,178 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:26:20,178 [INFO] - CUDA Version: 11.8
2025-05-03 09:26:20,179 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:26:20,703 [INFO] - Flash Attention library not found or import failed. Standard attention will be used.
2025-05-03 09:26:20,703 [INFO] - Configuration loaded:
2025-05-03 09:26:20,705 [INFO] - Random seed set to 42
2025-05-03 09:26:20,706 [INFO] - cuDNN benchmark/autotuner enabled via config.
2025-05-03 09:26:20,706 [INFO] - Using channels_last memory format via config.
2025-05-03 09:26:20,706 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "use_checkpoint_activation": true,
    "mixed_precision_dtype": "float16",
    "optimize_transformer_attention": true,
    "optimize_memory_footprint": true,
    "cache_clearing_frequency": 25,
    "dataloader_prefetch": 2,
    "use_channels_last_memory_format": true,
    "num_workers": 2,
    "enable_cudnn_autotuner": true,
    "input_size": 32,
    "model_input_size": 224,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.0005,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "alpha": 0.35,
    "feature_loss_weight": 0.008,
    "cal_weight": 0.06,
    "use_warmup": true,
    "warmup_epochs": 8,
    "curriculum_start_epoch": 8,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 60,
    "use_loss_clipping": true,
    "loss_clip_threshold": 5.0,
    "use_gradient_skip": true,
    "gradient_skip_threshold": 10.0,
    "temperature_min": 2.0,
    "temperature_max": 5.0,
    "anneal_temperature": true,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-03 09:26:20,707 [INFO] - Random seed set to 42
2025-05-03 09:26:20,707 [INFO] - Creating models...
2025-05-03 09:26:20,707 [INFO] - Loading ViT-B16 model...
2025-05-03 09:26:21,332 [INFO] - Loading EfficientNetB0 model...
2025-05-03 09:26:21,407 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-03 09:26:21,588 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-03 09:26:21,588 [INFO] - Loading MobileNetV3-Large model...
2025-05-03 09:26:21,671 [INFO] - Loading ResNet50 model...
2025-05-03 09:26:21,926 [INFO] - Loading DenseNet121 model...
2025-05-03 09:26:22,042 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-03 09:26:22,478 [INFO] - Model vit converted to channels_last format.
2025-05-03 09:26:22,478 [INFO] - Model efficientnet converted to channels_last format.
2025-05-03 09:26:22,488 [INFO] - Model inception converted to channels_last format.
2025-05-03 09:26:22,494 [INFO] - Model mobilenet converted to channels_last format.
2025-05-03 09:26:22,497 [INFO] - Model resnet converted to channels_last format.
2025-05-03 09:26:22,502 [INFO] - Model densenet converted to channels_last format.
2025-05-03 09:26:22,510 [INFO] - Model student converted to channels_last format.
2025-05-03 09:26:22,510 [INFO] - Gradient checkpointing enabled for vit.
2025-05-03 09:26:22,510 [INFO] - Gradient checkpointing enabled for efficientnet.
2025-05-03 09:26:22,510 [INFO] - Gradient checkpointing enabled for inception.
2025-05-03 09:26:22,510 [INFO] - Gradient checkpointing enabled for mobilenet.
2025-05-03 09:26:22,510 [INFO] - Gradient checkpointing enabled for resnet.
2025-05-03 09:26:22,510 [INFO] - Gradient checkpointing enabled for densenet.
2025-05-03 09:26:22,510 [INFO] - Gradient checkpointing enabled for student.
2025-05-03 09:26:22,510 [INFO] - Models created and moved to device.
2025-05-03 09:26:22,510 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-03 09:26:22,510 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-03 09:26:23,241 [INFO] - Loaded model state for vit successfully.
2025-05-03 09:26:23,258 [INFO] - Loaded model state for efficientnet successfully.
2025-05-03 09:26:23,294 [INFO] - Loaded model state for inception successfully.
2025-05-03 09:26:23,308 [INFO] - Loaded model state for mobilenet successfully.
2025-05-03 09:26:23,334 [INFO] - Loaded model state for resnet successfully.
2025-05-03 09:26:23,359 [INFO] - Loaded model state for densenet successfully.
2025-05-03 09:26:23,379 [INFO] - Loaded model state for student successfully.
2025-05-03 09:26:23,494 [INFO] - Recreated and loaded optimizer state for vit
2025-05-03 09:26:23,515 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-03 09:26:23,570 [INFO] - Recreated and loaded optimizer state for inception
2025-05-03 09:26:23,604 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-03 09:26:23,653 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-03 09:26:23,688 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-03 09:26:23,718 [INFO] - Recreated and loaded optimizer state for student
2025-05-03 09:26:23,718 [INFO] - Recreated and loaded scheduler state for vit (Type: StepLR)
2025-05-03 09:26:23,718 [INFO] - Recreated and loaded scheduler state for efficientnet (Type: StepLR)
2025-05-03 09:26:23,718 [INFO] - Recreated and loaded scheduler state for inception (Type: StepLR)
2025-05-03 09:26:23,718 [INFO] - Recreated and loaded scheduler state for mobilenet (Type: StepLR)
2025-05-03 09:26:23,718 [INFO] - Recreated and loaded scheduler state for resnet (Type: StepLR)
2025-05-03 09:26:23,718 [INFO] - Recreated and loaded scheduler state for densenet (Type: StepLR)
2025-05-03 09:26:23,718 [INFO] - Recreated and loaded scheduler state for student (Type: StepLR)
2025-05-03 09:26:23,718 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-03 09:26:23,718 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-03 09:26:23,718 [INFO] - Preparing data loaders...
2025-05-03 09:26:31,918 [INFO] - Training samples: 45000 per model
2025-05-03 09:26:31,918 [INFO] - Validation samples: 5000 per model
2025-05-03 09:26:31,918 [INFO] - Test samples: 10000 per model
2025-05-03 09:26:31,918 [INFO] - Skipping initialization phase.
2025-05-03 09:26:31,918 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-03 09:26:32,062 [INFO] - GPU Memory: Current=1753.03MB, Peak=1753.03MB, Reserved=1784.00MB
2025-05-03 09:26:32,062 [INFO] - Mutual learning script finished.
2025-05-03 09:34:24,729 [INFO] - Using device: cuda
2025-05-03 09:34:24,734 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:34:24,734 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:34:24,734 [INFO] - CUDA Version: 11.8
2025-05-03 09:34:24,734 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:34:24,735 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.0005,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "alpha": 0.5,
    "feature_loss_weight": 0.01,
    "cal_weight": 0.1,
    "use_warmup": true,
    "warmup_epochs": 5,
    "curriculum_start_epoch": 5,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 45,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-03 09:34:24,739 [INFO] - Random seed set to 42
2025-05-03 09:34:24,740 [INFO] - Creating models...
2025-05-03 09:34:24,740 [INFO] - Loading ViT-B16 model...
2025-05-03 09:34:25,690 [INFO] - Loading EfficientNetB0 model...
2025-05-03 09:34:25,813 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-03 09:34:26,168 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-03 09:34:26,168 [INFO] - Loading MobileNetV3-Large model...
2025-05-03 09:34:26,265 [INFO] - Loading ResNet50 model...
2025-05-03 09:34:26,610 [INFO] - Loading DenseNet121 model...
2025-05-03 09:34:26,740 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-03 09:34:27,007 [INFO] - Model vit moved to cuda
2025-05-03 09:34:27,028 [INFO] - Model efficientnet moved to cuda
2025-05-03 09:34:27,078 [INFO] - Model inception moved to cuda
2025-05-03 09:34:27,094 [INFO] - Model mobilenet moved to cuda
2025-05-03 09:34:27,129 [INFO] - Model resnet moved to cuda
2025-05-03 09:34:27,201 [INFO] - Model densenet moved to cuda
2025-05-03 09:34:27,219 [INFO] - Model student moved to cuda
2025-05-03 09:34:27,221 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-03 09:34:27,221 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-03 09:34:27,225 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-03 09:34:27,225 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-03 09:34:27,225 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-03 09:34:27,225 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-03 09:34:27,225 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-03 09:34:27,231 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-03 09:34:27,231 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-03 09:34:29,027 [INFO] - Loaded model state for vit successfully.
2025-05-03 09:34:29,051 [INFO] - Loaded model state for efficientnet successfully.
2025-05-03 09:34:29,087 [INFO] - Loaded model state for inception successfully.
2025-05-03 09:34:29,112 [INFO] - Loaded model state for mobilenet successfully.
2025-05-03 09:34:29,140 [INFO] - Loaded model state for resnet successfully.
2025-05-03 09:34:29,179 [INFO] - Loaded model state for densenet successfully.
2025-05-03 09:34:29,201 [INFO] - Loaded model state for student successfully.
2025-05-03 09:34:29,342 [INFO] - Recreated and loaded optimizer state for vit
2025-05-03 09:34:29,360 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-03 09:34:29,412 [INFO] - Recreated and loaded optimizer state for inception
2025-05-03 09:34:29,432 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-03 09:34:29,483 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-03 09:34:29,527 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-03 09:34:29,544 [INFO] - Recreated and loaded optimizer state for student
2025-05-03 09:34:29,544 [INFO] - Recreated and loaded scheduler state for vit (Type: StepLR)
2025-05-03 09:34:29,544 [INFO] - Recreated and loaded scheduler state for efficientnet (Type: StepLR)
2025-05-03 09:34:29,544 [INFO] - Recreated and loaded scheduler state for inception (Type: StepLR)
2025-05-03 09:34:29,544 [INFO] - Recreated and loaded scheduler state for mobilenet (Type: StepLR)
2025-05-03 09:34:29,544 [INFO] - Recreated and loaded scheduler state for resnet (Type: StepLR)
2025-05-03 09:34:29,544 [INFO] - Recreated and loaded scheduler state for densenet (Type: StepLR)
2025-05-03 09:34:29,544 [INFO] - Recreated and loaded scheduler state for student (Type: StepLR)
2025-05-03 09:34:29,604 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-03 09:34:29,613 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-03 09:34:29,613 [INFO] - Preparing data loaders...
2025-05-03 09:34:38,166 [INFO] - Training samples: 45000 per model
2025-05-03 09:34:38,166 [INFO] - Validation samples: 5000 per model
2025-05-03 09:34:38,166 [INFO] - Test samples: 10000 per model
2025-05-03 09:34:38,166 [INFO] - Skipping initialization phase.
2025-05-03 09:34:38,166 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-03 09:34:38,282 [INFO] - GPU Memory: Current=1753.94MB, Peak=1753.94MB, Reserved=1764.00MB
2025-05-03 09:34:38,298 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-03 09:34:38,298 [INFO] - Starting mutual learning phase...
2025-05-03 09:34:38,298 [INFO] - Hook registered for encoder.ln
2025-05-03 09:34:38,298 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-03 09:34:38,848 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-03 09:34:38,848 [INFO] - Hook registered for features.8
2025-05-03 09:34:38,848 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-03 09:34:39,298 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-03 09:34:39,298 [INFO] - Hook registered for inception.Mixed_7c
2025-05-03 09:34:39,298 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-03 09:34:39,828 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-03 09:34:39,828 [INFO] - Hook registered for features
2025-05-03 09:34:39,828 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-03 09:34:39,978 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-03 09:34:39,978 [INFO] - Hook registered for layer4
2025-05-03 09:34:39,978 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-03 09:34:40,201 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-03 09:34:40,201 [INFO] - Hook registered for features
2025-05-03 09:34:40,201 [INFO] - Feature extractor registered for densenet at layer features
2025-05-03 09:34:40,500 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-03 09:34:40,506 [INFO] - Hook registered for features.8
2025-05-03 09:34:40,506 [INFO] - Feature extractor registered for student at layer features.8
2025-05-03 09:34:40,516 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-03 09:34:41,591 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-03 09:34:41,591 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-03 09:34:41,591 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-03 09:34:41,591 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-03 09:34:41,601 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-03 09:34:41,601 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-03 09:34:41,611 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-03 09:34:41,611 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-03 09:34:41,611 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-03 09:34:41,611 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-03 09:34:41,622 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-03 09:34:41,622 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-03 09:34:41,632 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-03 09:34:41,632 [INFO] - HFI module initialized with 6 teachers.
2025-05-03 09:34:41,756 [INFO] - HFI initialized.
2025-05-03 09:34:41,756 [INFO] - Added HFI params to student optimizer.
2025-05-03 09:34:43,247 [INFO] - Using 3-stage scheduler for vit: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:34:43,249 [INFO] - Using 3-stage scheduler for efficientnet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:34:43,249 [INFO] - Using 3-stage scheduler for inception: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:34:43,249 [INFO] - Using 3-stage scheduler for mobilenet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:34:43,253 [INFO] - Using 3-stage scheduler for resnet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:34:43,253 [INFO] - Using 3-stage scheduler for densenet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:34:43,256 [INFO] - Using 3-stage scheduler for student: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:34:43,257 [INFO] - Added HFI parameters to the student optimizer.
2025-05-03 09:34:43,257 [INFO] - Mutual learning phase using effective batch size: 4
2025-05-03 09:34:43,257 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-03 09:34:49,153 [INFO] - Using device: cuda
2025-05-03 09:34:49,153 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:34:49,153 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:34:49,153 [INFO] - CUDA Version: 11.8
2025-05-03 09:34:49,153 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:34:54,259 [INFO] - Using device: cuda
2025-05-03 09:34:54,259 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:34:54,259 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:34:54,259 [INFO] - CUDA Version: 11.8
2025-05-03 09:34:54,259 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:34:59,422 [INFO] - Using device: cuda
2025-05-03 09:34:59,422 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:34:59,422 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:34:59,422 [INFO] - CUDA Version: 11.8
2025-05-03 09:34:59,422 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:35:04,638 [INFO] - Using device: cuda
2025-05-03 09:35:04,638 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:35:04,638 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:35:04,638 [INFO] - CUDA Version: 11.8
2025-05-03 09:35:04,638 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:35:15,149 [INFO] - GPU Memory: Current=3026.70MB, Peak=3626.93MB, Reserved=3840.00MB
2025-05-03 09:39:17,573 [INFO] - Using device: cuda
2025-05-03 09:39:17,573 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:39:17,573 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:39:17,573 [INFO] - CUDA Version: 11.8
2025-05-03 09:39:17,573 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:39:17,573 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.0005,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "alpha": 0.5,
    "feature_loss_weight": 0.01,
    "cal_weight": 0.1,
    "use_warmup": true,
    "warmup_epochs": 5,
    "curriculum_start_epoch": 5,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 100,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-03 09:39:17,589 [INFO] - Random seed set to 42
2025-05-03 09:39:17,589 [INFO] - Creating models...
2025-05-03 09:39:17,589 [INFO] - Loading ViT-B16 model...
2025-05-03 09:39:18,432 [INFO] - Loading EfficientNetB0 model...
2025-05-03 09:39:18,555 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-03 09:39:18,874 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-03 09:39:18,874 [INFO] - Loading MobileNetV3-Large model...
2025-05-03 09:39:18,969 [INFO] - Loading ResNet50 model...
2025-05-03 09:39:19,286 [INFO] - Loading DenseNet121 model...
2025-05-03 09:39:19,412 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-03 09:39:19,626 [INFO] - Model vit moved to cuda
2025-05-03 09:39:19,652 [INFO] - Model efficientnet moved to cuda
2025-05-03 09:39:19,696 [INFO] - Model inception moved to cuda
2025-05-03 09:39:19,712 [INFO] - Model mobilenet moved to cuda
2025-05-03 09:39:19,744 [INFO] - Model resnet moved to cuda
2025-05-03 09:39:19,776 [INFO] - Model densenet moved to cuda
2025-05-03 09:39:19,808 [INFO] - Model student moved to cuda
2025-05-03 09:39:19,808 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-03 09:39:19,808 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-03 09:39:19,808 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-03 09:39:19,824 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-03 09:39:19,824 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-03 09:39:19,826 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-03 09:39:19,826 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-03 09:39:19,826 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-03 09:39:19,826 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-03 09:39:21,725 [INFO] - Loaded model state for vit successfully.
2025-05-03 09:39:21,744 [INFO] - Loaded model state for efficientnet successfully.
2025-05-03 09:39:21,793 [INFO] - Loaded model state for inception successfully.
2025-05-03 09:39:21,811 [INFO] - Loaded model state for mobilenet successfully.
2025-05-03 09:39:21,839 [INFO] - Loaded model state for resnet successfully.
2025-05-03 09:39:21,892 [INFO] - Loaded model state for densenet successfully.
2025-05-03 09:39:21,936 [INFO] - Loaded model state for student successfully.
2025-05-03 09:39:22,064 [INFO] - Recreated and loaded optimizer state for vit
2025-05-03 09:39:22,091 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-03 09:39:22,156 [INFO] - Recreated and loaded optimizer state for inception
2025-05-03 09:39:22,176 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-03 09:39:22,217 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-03 09:39:22,268 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-03 09:39:22,288 [INFO] - Recreated and loaded optimizer state for student
2025-05-03 09:39:22,288 [INFO] - Recreated and loaded scheduler state for vit (Type: StepLR)
2025-05-03 09:39:22,288 [INFO] - Recreated and loaded scheduler state for efficientnet (Type: StepLR)
2025-05-03 09:39:22,288 [INFO] - Recreated and loaded scheduler state for inception (Type: StepLR)
2025-05-03 09:39:22,288 [INFO] - Recreated and loaded scheduler state for mobilenet (Type: StepLR)
2025-05-03 09:39:22,288 [INFO] - Recreated and loaded scheduler state for resnet (Type: StepLR)
2025-05-03 09:39:22,288 [INFO] - Recreated and loaded scheduler state for densenet (Type: StepLR)
2025-05-03 09:39:22,288 [INFO] - Recreated and loaded scheduler state for student (Type: StepLR)
2025-05-03 09:39:22,308 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-03 09:39:22,319 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-03 09:39:22,319 [INFO] - Preparing data loaders...
2025-05-03 09:39:30,199 [INFO] - Training samples: 45000 per model
2025-05-03 09:39:30,199 [INFO] - Validation samples: 5000 per model
2025-05-03 09:39:30,199 [INFO] - Test samples: 10000 per model
2025-05-03 09:39:30,199 [INFO] - Skipping initialization phase.
2025-05-03 09:39:30,199 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-03 09:39:30,330 [INFO] - GPU Memory: Current=1753.94MB, Peak=1753.94MB, Reserved=1764.00MB
2025-05-03 09:39:30,330 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-03 09:39:30,330 [INFO] - Starting mutual learning phase...
2025-05-03 09:39:30,330 [INFO] - Hook registered for encoder.ln
2025-05-03 09:39:30,330 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-03 09:39:30,586 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-03 09:39:30,586 [INFO] - Hook registered for features.8
2025-05-03 09:39:30,588 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-03 09:39:30,837 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-03 09:39:30,837 [INFO] - Hook registered for inception.Mixed_7c
2025-05-03 09:39:30,841 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-03 09:39:31,247 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-03 09:39:31,247 [INFO] - Hook registered for features
2025-05-03 09:39:31,247 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-03 09:39:31,390 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-03 09:39:31,390 [INFO] - Hook registered for layer4
2025-05-03 09:39:31,390 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-03 09:39:31,538 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-03 09:39:31,538 [INFO] - Hook registered for features
2025-05-03 09:39:31,538 [INFO] - Feature extractor registered for densenet at layer features
2025-05-03 09:39:31,810 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-03 09:39:31,810 [INFO] - Hook registered for features.8
2025-05-03 09:39:31,810 [INFO] - Feature extractor registered for student at layer features.8
2025-05-03 09:39:31,841 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-03 09:39:32,838 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-03 09:39:32,838 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-03 09:39:32,843 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-03 09:39:32,843 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-03 09:39:32,852 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-03 09:39:32,852 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-03 09:39:32,858 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-03 09:39:32,858 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-03 09:39:32,867 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-03 09:39:32,867 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-03 09:39:32,877 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-03 09:39:32,877 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-03 09:39:32,879 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-03 09:39:32,879 [INFO] - HFI module initialized with 6 teachers.
2025-05-03 09:39:32,971 [INFO] - HFI initialized.
2025-05-03 09:39:32,971 [INFO] - Added HFI params to student optimizer.
2025-05-03 09:39:34,187 [INFO] - Using 3-stage scheduler for vit: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:39:34,187 [INFO] - Using 3-stage scheduler for efficientnet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:39:34,189 [INFO] - Using 3-stage scheduler for inception: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:39:34,189 [INFO] - Using 3-stage scheduler for mobilenet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:39:34,189 [INFO] - Using 3-stage scheduler for resnet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:39:34,189 [INFO] - Using 3-stage scheduler for densenet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:39:34,189 [INFO] - Using 3-stage scheduler for student: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:39:34,189 [INFO] - Added HFI parameters to the student optimizer.
2025-05-03 09:39:34,189 [INFO] - Mutual learning phase using effective batch size: 4
2025-05-03 09:39:34,189 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-03 09:39:39,305 [INFO] - Using device: cuda
2025-05-03 09:39:39,316 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:39:39,316 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:39:39,316 [INFO] - CUDA Version: 11.8
2025-05-03 09:39:39,316 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:39:44,421 [INFO] - Using device: cuda
2025-05-03 09:39:44,421 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:39:44,421 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:39:44,421 [INFO] - CUDA Version: 11.8
2025-05-03 09:39:44,421 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:39:49,542 [INFO] - Using device: cuda
2025-05-03 09:39:49,542 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:39:49,558 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:39:49,558 [INFO] - CUDA Version: 11.8
2025-05-03 09:39:49,558 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:39:54,688 [INFO] - Using device: cuda
2025-05-03 09:39:54,688 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:39:54,688 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:39:54,688 [INFO] - CUDA Version: 11.8
2025-05-03 09:39:54,688 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:40:04,303 [INFO] - GPU Memory: Current=3026.70MB, Peak=3626.93MB, Reserved=3838.00MB
2025-05-03 09:44:03,012 [INFO] - Using device: cuda
2025-05-03 09:44:03,012 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:44:03,012 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:44:03,012 [INFO] - CUDA Version: 11.8
2025-05-03 09:44:03,012 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:44:03,012 [INFO] - Configuration: {
    "seed": 42,
    "model_name": "mutual_learning",
    "dataset": "CIFAR-10",
    "use_amp": true,
    "memory_efficient_attention": true,
    "prefetch_factor": 2,
    "pin_memory": true,
    "persistent_workers": true,
    "batch_size": 4,
    "gradient_accumulation_steps": 8,
    "gpu_memory_fraction": 0.75,
    "input_size": 32,
    "model_input_size": 224,
    "num_workers": 4,
    "val_split": 0.1,
    "dataset_path": "C:\\Users\\Gading\\Downloads\\Research\\Dataset",
    "clear_cache_every_n_batches": 50,
    "pretrained": true,
    "num_classes": 10,
    "models": [
        "vit",
        "efficientnet",
        "inception",
        "mobilenet",
        "resnet",
        "densenet",
        "student"
    ],
    "model_input_sizes": {
        "vit": 224,
        "efficientnet": 224,
        "inception": 299,
        "mobilenet": 224,
        "resnet": 224,
        "densenet": 224,
        "student": 224
    },
    "model_batch_sizes": {
        "vit": 4,
        "efficientnet": 4,
        "inception": 4,
        "mobilenet": 8,
        "resnet": 4,
        "densenet": 4,
        "student": 4
    },
    "model_grad_accum": {
        "vit": 96,
        "efficientnet": 64,
        "inception": 96,
        "mobilenet": 32,
        "resnet": 64,
        "densenet": 64,
        "student": 64
    },
    "pretrained_model_paths": {
        "vit": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ViT\\checkpoints\\vit_b16_teacher_20250321_053628_best.pth",
        "efficientnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\EfficientNetB0\\checkpoints\\efficientnet_b0_teacher_20250325_132652_best.pth",
        "inception": "C:\\Users\\Gading\\Downloads\\Research\\Models\\InceptionV3\\checkpoints\\inception_v3_teacher_20250321_153825_best.pth",
        "mobilenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MobileNetV3\\checkpoints\\mobilenetv3_20250326_035725_best.pth",
        "resnet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\ResNet50\\checkpoints\\resnet50_teacher_20250322_225032_best.pth",
        "densenet": "C:\\Users\\Gading\\Downloads\\Research\\Models\\DenseNet121\\checkpoints\\densenet121_teacher_20250325_160534_best.pth"
    },
    "use_pretrained_models": false,
    "mixed_precision_dtype": "float16",
    "use_model_specific_batch_size": true,
    "use_model_specific_transforms": true,
    "enable_memory_efficient_validation": true,
    "enable_calibration_early_stopping": true,
    "inference_batch_mult": 2.0,
    "initialization_epochs": 5,
    "mutual_learning_epochs": 50,
    "soft_target_temp": 4.0,
    "learn_temperatures": true,
    "model_temperatures": {
        "densenet": 4.0,
        "efficientnet": 4.0,
        "inception": 5.0,
        "mobilenet": 4.0,
        "resnet": 4.0,
        "vit": 4.0,
        "student": 3.0
    },
    "lr": 0.0005,
    "weight_decay": 1e-05,
    "early_stop_patience": 10,
    "calibration_patience": 5,
    "max_ece_threshold": 0.05,
    "model_specific_lr": {
        "vit": 0.0003,
        "efficientnet": 0.001,
        "inception": 0.0007,
        "mobilenet": 0.0015,
        "resnet": 0.001,
        "densenet": 0.0008,
        "student": 0.002
    },
    "alpha": 0.5,
    "feature_loss_weight": 0.01,
    "cal_weight": 0.1,
    "use_warmup": true,
    "warmup_epochs": 5,
    "curriculum_start_epoch": 5,
    "use_curriculum": true,
    "curriculum_ramp_epochs": 100,
    "checkpoint_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\checkpoints",
    "results_dir": "C:\\Users\\Gading\\Downloads\\Research\\Results\\MutualLearning",
    "export_dir": "C:\\Users\\Gading\\Downloads\\Research\\Models\\MutualLearning\\exports",
    "per_model_calibration": true
}
2025-05-03 09:44:03,028 [INFO] - Random seed set to 42
2025-05-03 09:44:03,028 [INFO] - Creating models...
2025-05-03 09:44:03,028 [INFO] - Loading ViT-B16 model...
2025-05-03 09:44:03,957 [INFO] - Loading EfficientNetB0 model...
2025-05-03 09:44:04,074 [INFO] - Loading InceptionV3 model with safe wrapper for small inputs...
2025-05-03 09:44:04,455 [INFO] - Adapting InceptionV3 AuxLogits layer...
2025-05-03 09:44:04,455 [INFO] - Loading MobileNetV3-Large model...
2025-05-03 09:44:04,561 [INFO] - Loading ResNet50 model...
2025-05-03 09:44:04,932 [INFO] - Loading DenseNet121 model...
2025-05-03 09:44:05,069 [INFO] - Creating student model (EfficientNetB0-based)...
2025-05-03 09:44:05,296 [INFO] - Model vit moved to cuda
2025-05-03 09:44:05,312 [INFO] - Model efficientnet moved to cuda
2025-05-03 09:44:05,358 [INFO] - Model inception moved to cuda
2025-05-03 09:44:05,368 [INFO] - Model mobilenet moved to cuda
2025-05-03 09:44:05,406 [INFO] - Model resnet moved to cuda
2025-05-03 09:44:05,437 [INFO] - Model densenet moved to cuda
2025-05-03 09:44:05,455 [INFO] - Model student moved to cuda
2025-05-03 09:44:05,455 [INFO] - Model vit: 85.81M parameters (85.81M trainable)
2025-05-03 09:44:05,455 [INFO] - Model efficientnet: 4.02M parameters (4.02M trainable)
2025-05-03 09:44:05,455 [INFO] - Model inception: 24.37M parameters (24.37M trainable)
2025-05-03 09:44:05,455 [INFO] - Model mobilenet: 4.21M parameters (4.21M trainable)
2025-05-03 09:44:05,455 [INFO] - Model resnet: 23.53M parameters (23.53M trainable)
2025-05-03 09:44:05,463 [INFO] - Model densenet: 6.96M parameters (6.96M trainable)
2025-05-03 09:44:05,463 [INFO] - Model student: 4.02M parameters (4.02M trainable)
2025-05-03 09:44:05,463 [INFO] - Found latest checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth (Epoch 5, Phase: init)
2025-05-03 09:44:05,463 [INFO] - Attempting to load checkpoint: C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth
2025-05-03 09:44:07,378 [INFO] - Loaded model state for vit successfully.
2025-05-03 09:44:07,398 [INFO] - Loaded model state for efficientnet successfully.
2025-05-03 09:44:07,441 [INFO] - Loaded model state for inception successfully.
2025-05-03 09:44:07,455 [INFO] - Loaded model state for mobilenet successfully.
2025-05-03 09:44:07,481 [INFO] - Loaded model state for resnet successfully.
2025-05-03 09:44:07,527 [INFO] - Loaded model state for densenet successfully.
2025-05-03 09:44:07,539 [INFO] - Loaded model state for student successfully.
2025-05-03 09:44:07,668 [INFO] - Recreated and loaded optimizer state for vit
2025-05-03 09:44:07,690 [INFO] - Recreated and loaded optimizer state for efficientnet
2025-05-03 09:44:07,755 [INFO] - Recreated and loaded optimizer state for inception
2025-05-03 09:44:07,771 [INFO] - Recreated and loaded optimizer state for mobilenet
2025-05-03 09:44:07,819 [INFO] - Recreated and loaded optimizer state for resnet
2025-05-03 09:44:07,859 [INFO] - Recreated and loaded optimizer state for densenet
2025-05-03 09:44:07,885 [INFO] - Recreated and loaded optimizer state for student
2025-05-03 09:44:07,892 [INFO] - Recreated and loaded scheduler state for vit (Type: StepLR)
2025-05-03 09:44:07,892 [INFO] - Recreated and loaded scheduler state for efficientnet (Type: StepLR)
2025-05-03 09:44:07,892 [INFO] - Recreated and loaded scheduler state for inception (Type: StepLR)
2025-05-03 09:44:07,892 [INFO] - Recreated and loaded scheduler state for mobilenet (Type: StepLR)
2025-05-03 09:44:07,892 [INFO] - Recreated and loaded scheduler state for resnet (Type: StepLR)
2025-05-03 09:44:07,892 [INFO] - Recreated and loaded scheduler state for densenet (Type: StepLR)
2025-05-03 09:44:07,892 [INFO] - Recreated and loaded scheduler state for student (Type: StepLR)
2025-05-03 09:44:07,942 [INFO] - Checkpoint loaded successfully from C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\init_checkpoint_epoch_5.pth. Checkpoint epoch: 5, Phase: 'init'.
2025-05-03 09:44:07,952 [INFO] - Initialization phase completed (loaded epoch 5). Starting mutual learning from epoch 1.
2025-05-03 09:44:07,952 [INFO] - Preparing data loaders...
2025-05-03 09:44:16,112 [INFO] - Training samples: 45000 per model
2025-05-03 09:44:16,112 [INFO] - Validation samples: 5000 per model
2025-05-03 09:44:16,112 [INFO] - Test samples: 10000 per model
2025-05-03 09:44:16,112 [INFO] - Skipping initialization phase.
2025-05-03 09:44:16,112 [INFO] - Clearing GPU cache before mutual learning phase...
2025-05-03 09:44:16,254 [INFO] - GPU Memory: Current=1753.94MB, Peak=1753.94MB, Reserved=1764.00MB
2025-05-03 09:44:16,254 [INFO] - Starting mutual learning phase from epoch 1...
2025-05-03 09:44:16,254 [INFO] - Starting mutual learning phase...
2025-05-03 09:44:16,254 [INFO] - Hook registered for encoder.ln
2025-05-03 09:44:16,254 [INFO] - Feature extractor registered for vit at layer encoder.ln
2025-05-03 09:44:16,745 [INFO] - Feature shape for vit: torch.Size([1, 197, 768])
2025-05-03 09:44:16,745 [INFO] - Hook registered for features.8
2025-05-03 09:44:16,745 [INFO] - Feature extractor registered for efficientnet at layer features.8
2025-05-03 09:44:17,154 [INFO] - Feature shape for efficientnet: torch.Size([1, 1280, 7, 7])
2025-05-03 09:44:17,154 [INFO] - Hook registered for inception.Mixed_7c
2025-05-03 09:44:17,154 [INFO] - Feature extractor registered for inception at layer Mixed_7c
2025-05-03 09:44:17,638 [INFO] - Feature shape for inception: torch.Size([1, 2048, 5, 5])
2025-05-03 09:44:17,638 [INFO] - Hook registered for features
2025-05-03 09:44:17,638 [INFO] - Feature extractor registered for mobilenet at layer features
2025-05-03 09:44:17,766 [INFO] - Feature shape for mobilenet: torch.Size([1, 960, 7, 7])
2025-05-03 09:44:17,766 [INFO] - Hook registered for layer4
2025-05-03 09:44:17,766 [INFO] - Feature extractor registered for resnet at layer layer4
2025-05-03 09:44:18,022 [INFO] - Feature shape for resnet: torch.Size([1, 2048, 7, 7])
2025-05-03 09:44:18,022 [INFO] - Hook registered for features
2025-05-03 09:44:18,022 [INFO] - Feature extractor registered for densenet at layer features
2025-05-03 09:44:18,306 [INFO] - Feature shape for densenet: torch.Size([1, 1024, 7, 7])
2025-05-03 09:44:18,306 [INFO] - Hook registered for features.8
2025-05-03 09:44:18,306 [INFO] - Feature extractor registered for student at layer features.8
2025-05-03 09:44:18,337 [INFO] - Feature shape for student: torch.Size([1, 1280, 7, 7])
2025-05-03 09:44:19,398 [INFO] - HFI Initializing. Target student feature shape (excluding batch): torch.Size([1280, 7, 7])
2025-05-03 09:44:19,398 [INFO] -   Teacher vit: Original feature shape torch.Size([197, 768]) (3D)
2025-05-03 09:44:19,398 [INFO] -     vit (3D->4D): Using Linear projection 768 -> 1280
2025-05-03 09:44:19,403 [INFO] -   Teacher efficientnet: Original feature shape torch.Size([1280, 7, 7]) (4D)
2025-05-03 09:44:19,409 [INFO] -     efficientnet (4D->4D): Using Conv2d projection 1280 -> 1280
2025-05-03 09:44:19,409 [INFO] -   Teacher inception: Original feature shape torch.Size([2048, 8, 8]) (4D)
2025-05-03 09:44:19,419 [INFO] -     inception (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-03 09:44:19,419 [INFO] -   Teacher mobilenet: Original feature shape torch.Size([960, 7, 7]) (4D)
2025-05-03 09:44:19,419 [INFO] -     mobilenet (4D->4D): Using Conv2d projection 960 -> 1280
2025-05-03 09:44:19,419 [INFO] -   Teacher resnet: Original feature shape torch.Size([2048, 7, 7]) (4D)
2025-05-03 09:44:19,429 [INFO] -     resnet (4D->4D): Using Conv2d projection 2048 -> 1280
2025-05-03 09:44:19,429 [INFO] -   Teacher densenet: Original feature shape torch.Size([1024, 7, 7]) (4D)
2025-05-03 09:44:19,439 [INFO] -     densenet (4D->4D): Using Conv2d projection 1024 -> 1280
2025-05-03 09:44:19,439 [INFO] - HFI module initialized with 6 teachers.
2025-05-03 09:44:19,520 [INFO] - HFI initialized.
2025-05-03 09:44:19,520 [INFO] - Added HFI params to student optimizer.
2025-05-03 09:44:20,821 [INFO] - Using 3-stage scheduler for vit: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:44:20,821 [INFO] - Using 3-stage scheduler for efficientnet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:44:20,825 [INFO] - Using 3-stage scheduler for inception: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:44:20,827 [INFO] - Using 3-stage scheduler for mobilenet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:44:20,829 [INFO] - Using 3-stage scheduler for resnet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:44:20,831 [INFO] - Using 3-stage scheduler for densenet: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:44:20,833 [INFO] - Using 3-stage scheduler for student: Warmup (5 epochs), Hold (2 epochs), Cosine Decay (43 epochs)
2025-05-03 09:44:20,833 [INFO] - Added HFI parameters to the student optimizer.
2025-05-03 09:44:20,833 [INFO] - Mutual learning phase using effective batch size: 4
2025-05-03 09:44:20,833 [INFO] - --- Starting Mutual Learning Epoch 1/50 ---
2025-05-03 09:44:26,174 [INFO] - Using device: cuda
2025-05-03 09:44:26,174 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:44:26,174 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:44:26,174 [INFO] - CUDA Version: 11.8
2025-05-03 09:44:26,174 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:44:31,395 [INFO] - Using device: cuda
2025-05-03 09:44:31,395 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:44:31,395 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:44:31,395 [INFO] - CUDA Version: 11.8
2025-05-03 09:44:31,395 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:44:36,586 [INFO] - Using device: cuda
2025-05-03 09:44:36,586 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:44:36,586 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:44:36,586 [INFO] - CUDA Version: 11.8
2025-05-03 09:44:36,586 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:44:41,807 [INFO] - Using device: cuda
2025-05-03 09:44:41,807 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 09:44:41,807 [INFO] - GPU Memory: 6.00 GB
2025-05-03 09:44:41,807 [INFO] - CUDA Version: 11.8
2025-05-03 09:44:41,807 [INFO] - cuDNN benchmark mode enabled
2025-05-03 09:44:51,803 [INFO] - GPU Memory: Current=3026.12MB, Peak=3626.35MB, Reserved=3844.00MB
2025-05-03 09:47:17,690 [INFO] - GPU Memory: Current=3026.82MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 09:49:44,930 [INFO] - GPU Memory: Current=3026.82MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 09:52:11,327 [INFO] - GPU Memory: Current=3026.82MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 09:54:37,595 [INFO] - GPU Memory: Current=3026.82MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 09:57:03,922 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 09:59:38,226 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:02:04,315 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:04:30,501 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:06:56,929 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:09:23,397 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:11:49,965 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:14:16,509 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:16:42,889 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:19:08,791 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:21:34,622 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:23:59,745 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:26:24,289 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:28:49,667 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:31:15,259 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:33:41,541 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:36:07,476 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:38:33,362 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:40:58,406 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:43:24,515 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:45:51,132 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:48:17,446 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:50:44,385 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:53:09,930 [INFO] - GPU Memory: Current=3026.32MB, Peak=4665.07MB, Reserved=4730.00MB
2025-05-03 10:53:25,089 [INFO] - --- Mutual Epoch 1 Summary (Time: 4144.26s): Avg Loss=0.1775, Avg Acc=94.13% ---
2025-05-03 10:53:25,091 [INFO] -   vit: Loss=0.0354, Acc=98.88%, CE=0.0354, Mut=2.1829, Cal=0.0086, Feat=0.0000
2025-05-03 10:53:25,091 [INFO] -   efficientnet: Loss=0.1374, Acc=95.37%, CE=0.1374, Mut=2.3576, Cal=0.0319, Feat=0.0000
2025-05-03 10:53:25,091 [INFO] -   inception: Loss=0.1690, Acc=94.51%, CE=0.1690, Mut=4.2172, Cal=0.0367, Feat=0.0000
2025-05-03 10:53:25,091 [INFO] -   mobilenet: Loss=0.2281, Acc=92.18%, CE=0.2281, Mut=2.5003, Cal=0.0506, Feat=0.0000
2025-05-03 10:53:25,092 [INFO] -   resnet: Loss=0.2660, Acc=91.24%, CE=0.2660, Mut=2.1646, Cal=0.0567, Feat=0.0000
2025-05-03 10:53:25,092 [INFO] -   densenet: Loss=0.1925, Acc=94.00%, CE=0.1925, Mut=2.3365, Cal=0.0406, Feat=0.0000
2025-05-03 10:53:25,092 [INFO] -   student: Loss=0.2144, Acc=92.70%, CE=0.2144, Mut=2.6471, Cal=0.0485, Feat=0.8527
2025-05-03 10:53:25,092 [INFO] - --- Starting Validation for Epoch 1 ---
2025-05-03 10:53:25,092 [INFO] - Collecting validation targets...
2025-05-03 10:53:30,498 [INFO] - Using device: cuda
2025-05-03 10:53:30,502 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 10:53:30,502 [INFO] - GPU Memory: 6.00 GB
2025-05-03 10:53:30,502 [INFO] - CUDA Version: 11.8
2025-05-03 10:53:30,502 [INFO] - cuDNN benchmark mode enabled
2025-05-03 10:53:35,685 [INFO] - Using device: cuda
2025-05-03 10:53:35,685 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 10:53:35,685 [INFO] - GPU Memory: 6.00 GB
2025-05-03 10:53:35,685 [INFO] - CUDA Version: 11.8
2025-05-03 10:53:35,685 [INFO] - cuDNN benchmark mode enabled
2025-05-03 10:53:40,819 [INFO] - Using device: cuda
2025-05-03 10:53:40,819 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 10:53:40,819 [INFO] - GPU Memory: 6.00 GB
2025-05-03 10:53:40,819 [INFO] - CUDA Version: 11.8
2025-05-03 10:53:40,819 [INFO] - cuDNN benchmark mode enabled
2025-05-03 10:53:45,973 [INFO] - Using device: cuda
2025-05-03 10:53:45,973 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 10:53:45,973 [INFO] - GPU Memory: 6.00 GB
2025-05-03 10:53:45,973 [INFO] - CUDA Version: 11.8
2025-05-03 10:53:45,973 [INFO] - cuDNN benchmark mode enabled
2025-05-03 10:53:48,268 [INFO] - Collected 5000 validation targets.
2025-05-03 10:54:20,943 [INFO] -   Validation vit: Loss=0.1046, Acc=96.24%, ECE=0.0122
2025-05-03 10:54:36,091 [INFO] -   Validation efficientnet: Loss=0.1891, Acc=94.78%, ECE=0.0182
2025-05-03 10:54:55,998 [INFO] -   Validation inception: Loss=0.1686, Acc=94.40%, ECE=0.0126
2025-05-03 10:55:08,177 [INFO] -   Validation mobilenet: Loss=0.1584, Acc=94.86%, ECE=0.0167
2025-05-03 10:55:19,985 [INFO] -   Validation resnet: Loss=0.2277, Acc=92.36%, ECE=0.0094
2025-05-03 10:55:46,228 [INFO] -   Validation densenet: Loss=0.1751, Acc=94.28%, ECE=0.0046
2025-05-03 10:56:01,252 [INFO] -   Validation student: Loss=0.2179, Acc=93.28%, ECE=0.0150
2025-05-03 10:56:01,667 [INFO] - New best accuracy for vit: 96.24%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\vit_mutual_best_acc.pth
2025-05-03 10:56:01,667 [INFO] - New best ECE for vit: 0.0122.
2025-05-03 10:56:02,037 [INFO] - New best accuracy for efficientnet: 94.78%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\efficientnet_mutual_best_acc.pth
2025-05-03 10:56:02,037 [INFO] - New best ECE for efficientnet: 0.0182.
2025-05-03 10:56:02,260 [INFO] - New best accuracy for inception: 94.40%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\inception_mutual_best_acc.pth
2025-05-03 10:56:02,262 [INFO] - New best ECE for inception: 0.0126.
2025-05-03 10:56:02,446 [INFO] - New best accuracy for mobilenet: 94.86%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mobilenet_mutual_best_acc.pth
2025-05-03 10:56:02,446 [INFO] - New best ECE for mobilenet: 0.0167.
2025-05-03 10:56:02,621 [INFO] - New best accuracy for resnet: 92.36%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\resnet_mutual_best_acc.pth
2025-05-03 10:56:02,621 [INFO] - New best ECE for resnet: 0.0094.
2025-05-03 10:56:02,885 [INFO] - New best accuracy for densenet: 94.28%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\densenet_mutual_best_acc.pth
2025-05-03 10:56:02,885 [INFO] - New best ECE for densenet: 0.0046.
2025-05-03 10:56:03,060 [INFO] - New best accuracy for student: 93.28%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\student_mutual_best_acc.pth
2025-05-03 10:56:03,060 [INFO] - New best ECE for student: 0.0150.
2025-05-03 10:56:45,232 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_1.pth (Epoch 0)
2025-05-03 10:56:45,376 [INFO] - GPU Memory: Current=4211.97MB, Peak=4665.07MB, Reserved=4328.00MB
2025-05-03 10:56:45,376 [INFO] - --- Starting Mutual Learning Epoch 2/50 ---
2025-05-03 10:56:48,852 [INFO] - GPU Memory: Current=3617.74MB, Peak=5262.58MB, Reserved=5354.00MB
2025-05-03 10:59:20,246 [INFO] - GPU Memory: Current=3617.56MB, Peak=5269.66MB, Reserved=5378.00MB
2025-05-03 11:01:53,366 [INFO] - GPU Memory: Current=3617.56MB, Peak=5269.66MB, Reserved=5398.00MB
2025-05-03 11:04:26,685 [INFO] - GPU Memory: Current=3617.30MB, Peak=5269.66MB, Reserved=5346.00MB
2025-05-03 11:06:56,256 [INFO] - GPU Memory: Current=3617.36MB, Peak=5270.56MB, Reserved=5346.00MB
2025-05-03 11:09:24,978 [INFO] - GPU Memory: Current=3617.36MB, Peak=5270.56MB, Reserved=5346.00MB
2025-05-03 11:11:58,018 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 11:14:27,537 [INFO] - GPU Memory: Current=3617.55MB, Peak=5270.56MB, Reserved=5338.00MB
2025-05-03 11:17:02,559 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 11:19:34,826 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 11:22:06,405 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 11:24:37,849 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 11:27:09,610 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5356.00MB
2025-05-03 11:29:43,104 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 11:32:16,870 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 11:34:47,748 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 11:37:20,274 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 11:39:51,705 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 11:42:23,772 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 11:44:59,701 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 11:47:31,384 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 11:50:03,353 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 11:52:34,782 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 11:55:09,172 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 11:57:40,058 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:00:14,831 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:02:49,072 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:05:21,658 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:07:55,402 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:08:12,338 [INFO] - --- Mutual Epoch 2 Summary (Time: 4286.96s): Avg Loss=0.3749, Avg Acc=87.68% ---
2025-05-03 12:08:12,338 [INFO] -   vit: Loss=0.3635, Acc=88.05%, CE=0.3635, Mut=2.9394, Cal=0.0777, Feat=0.0000
2025-05-03 12:08:12,341 [INFO] -   efficientnet: Loss=0.2482, Acc=91.53%, CE=0.2482, Mut=3.2220, Cal=0.0554, Feat=0.0000
2025-05-03 12:08:12,341 [INFO] -   inception: Loss=0.4753, Acc=84.80%, CE=0.4753, Mut=5.2193, Cal=0.0948, Feat=0.0000
2025-05-03 12:08:12,341 [INFO] -   mobilenet: Loss=0.3853, Acc=87.10%, CE=0.3853, Mut=3.4053, Cal=0.0813, Feat=0.0000
2025-05-03 12:08:12,341 [INFO] -   resnet: Loss=0.5515, Acc=81.66%, CE=0.5515, Mut=2.8957, Cal=0.1088, Feat=0.0000
2025-05-03 12:08:12,341 [INFO] -   densenet: Loss=0.3969, Acc=87.42%, CE=0.3969, Mut=2.9935, Cal=0.0793, Feat=0.0000
2025-05-03 12:08:12,341 [INFO] -   student: Loss=0.2038, Acc=93.17%, CE=0.2038, Mut=3.5043, Cal=0.0460, Feat=0.8500
2025-05-03 12:08:12,341 [INFO] - --- Starting Validation for Epoch 2 ---
2025-05-03 12:08:12,347 [INFO] - Collecting validation targets...
2025-05-03 12:08:14,617 [INFO] - Collected 5000 validation targets.
2025-05-03 12:08:48,912 [INFO] -   Validation vit: Loss=0.2980, Acc=89.90%, ECE=0.0182
2025-05-03 12:09:04,250 [INFO] -   Validation efficientnet: Loss=0.2602, Acc=92.04%, ECE=0.0330
2025-05-03 12:09:24,158 [INFO] -   Validation inception: Loss=0.3391, Acc=89.58%, ECE=0.0283
2025-05-03 12:09:36,417 [INFO] -   Validation mobilenet: Loss=0.2863, Acc=91.58%, ECE=0.0368
2025-05-03 12:09:48,059 [INFO] -   Validation resnet: Loss=0.4671, Acc=84.62%, ECE=0.0311
2025-05-03 12:10:14,170 [INFO] -   Validation densenet: Loss=0.3537, Acc=88.68%, ECE=0.0308
2025-05-03 12:10:29,366 [INFO] -   Validation student: Loss=0.2205, Acc=92.92%, ECE=0.0193
2025-05-03 12:10:31,643 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_2.pth (Epoch 1)
2025-05-03 12:10:31,789 [INFO] - GPU Memory: Current=4209.88MB, Peak=5270.56MB, Reserved=4536.00MB
2025-05-03 12:10:31,789 [INFO] - --- Starting Mutual Learning Epoch 3/50 ---
2025-05-03 12:10:34,830 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5356.00MB
2025-05-03 12:13:04,228 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:15:40,832 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:18:11,810 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:20:46,655 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:23:18,597 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:25:51,372 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:28:23,568 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:30:55,922 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:33:32,173 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:36:08,123 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:38:43,022 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:41:14,615 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:43:50,509 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:46:24,065 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:48:56,953 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:51:34,035 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:54:10,022 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:56:46,092 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 12:59:21,543 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 13:01:57,154 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 13:04:31,893 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 13:07:10,907 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 13:09:44,714 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 13:12:16,469 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 13:14:57,030 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 13:17:36,676 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 13:20:10,019 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 13:22:47,742 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 13:23:03,129 [INFO] - --- Mutual Epoch 3 Summary (Time: 4351.34s): Avg Loss=0.6112, Avg Acc=80.02% ---
2025-05-03 13:23:03,129 [INFO] -   vit: Loss=0.5607, Acc=81.30%, CE=0.5607, Mut=2.9122, Cal=0.1128, Feat=0.0000
2025-05-03 13:23:03,130 [INFO] -   efficientnet: Loss=0.4811, Acc=84.18%, CE=0.4811, Mut=3.1858, Cal=0.0968, Feat=0.0000
2025-05-03 13:23:03,130 [INFO] -   inception: Loss=0.8285, Acc=73.21%, CE=0.8285, Mut=5.3287, Cal=0.1465, Feat=0.0000
2025-05-03 13:23:03,130 [INFO] -   mobilenet: Loss=0.6379, Acc=79.04%, CE=0.6379, Mut=3.2913, Cal=0.1215, Feat=0.0000
2025-05-03 13:23:03,130 [INFO] -   resnet: Loss=0.8501, Acc=72.05%, CE=0.8501, Mut=2.9980, Cal=0.1531, Feat=0.0000
2025-05-03 13:23:03,130 [INFO] -   densenet: Loss=0.7280, Acc=76.99%, CE=0.7280, Mut=3.1124, Cal=0.1311, Feat=0.0000
2025-05-03 13:23:03,130 [INFO] -   student: Loss=0.1920, Acc=93.36%, CE=0.1920, Mut=4.7660, Cal=0.0436, Feat=0.8443
2025-05-03 13:23:03,130 [INFO] - --- Starting Validation for Epoch 3 ---
2025-05-03 13:23:03,130 [INFO] - Collecting validation targets...
2025-05-03 13:23:05,360 [INFO] - Collected 5000 validation targets.
2025-05-03 13:23:40,090 [INFO] -   Validation vit: Loss=0.5478, Acc=80.96%, ECE=0.0509
2025-05-03 13:23:55,285 [INFO] -   Validation efficientnet: Loss=0.3873, Acc=89.12%, ECE=0.0398
2025-05-03 13:24:15,343 [INFO] -   Validation inception: Loss=0.5432, Acc=83.10%, ECE=0.0308
2025-05-03 13:24:27,605 [INFO] -   Validation mobilenet: Loss=0.5031, Acc=84.64%, ECE=0.0636
2025-05-03 13:24:39,009 [INFO] -   Validation resnet: Loss=0.6915, Acc=77.94%, ECE=0.0613
2025-05-03 13:25:04,821 [INFO] -   Validation densenet: Loss=0.4734, Acc=85.44%, ECE=0.0319
2025-05-03 13:25:19,930 [INFO] -   Validation student: Loss=0.2145, Acc=93.44%, ECE=0.0125
2025-05-03 13:25:20,025 [INFO] - New best accuracy for student: 93.44%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\student_mutual_best_acc.pth
2025-05-03 13:25:20,025 [INFO] - New best ECE for student: 0.0125.
2025-05-03 13:25:22,570 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_3.pth (Epoch 2)
2025-05-03 13:25:22,713 [INFO] - GPU Memory: Current=4209.50MB, Peak=5270.56MB, Reserved=4550.00MB
2025-05-03 13:25:22,713 [INFO] - --- Starting Mutual Learning Epoch 4/50 ---
2025-05-03 13:25:25,706 [INFO] - GPU Memory: Current=3617.17MB, Peak=5270.56MB, Reserved=5356.00MB
2025-05-03 13:28:01,027 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5334.00MB
2025-05-03 13:30:33,475 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5334.00MB
2025-05-03 13:33:08,306 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5334.00MB
2025-05-03 13:35:46,578 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5334.00MB
2025-05-03 13:38:17,589 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5334.00MB
2025-05-03 13:40:48,442 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5334.00MB
2025-05-03 13:43:18,577 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5334.00MB
2025-05-03 13:45:55,796 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5334.00MB
2025-05-03 13:48:29,882 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5334.00MB
2025-05-03 13:51:04,420 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5334.00MB
2025-05-03 13:53:34,420 [INFO] - GPU Memory: Current=3617.30MB, Peak=5270.56MB, Reserved=5336.00MB
2025-05-03 13:56:14,356 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 13:58:50,695 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:01:22,063 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:03:51,552 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:06:23,039 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:08:55,267 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:11:27,529 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:14:01,524 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:16:32,678 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:19:06,763 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:21:43,559 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:24:14,896 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:26:42,076 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:29:11,664 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:31:44,066 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:34:17,328 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:36:55,784 [INFO] - GPU Memory: Current=3616.92MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:37:11,709 [INFO] - --- Mutual Epoch 4 Summary (Time: 4309.00s): Avg Loss=0.7828, Avg Acc=74.37% ---
2025-05-03 14:37:11,711 [INFO] -   vit: Loss=0.7935, Acc=73.28%, CE=0.7935, Mut=3.0107, Cal=0.1502, Feat=0.0000
2025-05-03 14:37:11,711 [INFO] -   efficientnet: Loss=0.6260, Acc=79.28%, CE=0.6260, Mut=3.0244, Cal=0.1221, Feat=0.0000
2025-05-03 14:37:11,711 [INFO] -   inception: Loss=1.0322, Acc=66.29%, CE=1.0322, Mut=5.2155, Cal=0.1730, Feat=0.0000
2025-05-03 14:37:11,711 [INFO] -   mobilenet: Loss=0.8973, Acc=71.21%, CE=0.8973, Mut=3.2292, Cal=0.1599, Feat=0.0000
2025-05-03 14:37:11,711 [INFO] -   resnet: Loss=1.0246, Acc=66.01%, CE=1.0246, Mut=2.9635, Cal=0.1749, Feat=0.0000
2025-05-03 14:37:11,711 [INFO] -   densenet: Loss=0.9297, Acc=70.36%, CE=0.9297, Mut=3.0455, Cal=0.1582, Feat=0.0000
2025-05-03 14:37:11,711 [INFO] -   student: Loss=0.1765, Acc=94.12%, CE=0.1765, Mut=5.5514, Cal=0.0405, Feat=0.8389
2025-05-03 14:37:11,711 [INFO] - --- Starting Validation for Epoch 4 ---
2025-05-03 14:37:11,711 [INFO] - Collecting validation targets...
2025-05-03 14:37:13,943 [INFO] - Collected 5000 validation targets.
2025-05-03 14:37:46,519 [INFO] -   Validation vit: Loss=0.4997, Acc=83.06%, ECE=0.0122
2025-05-03 14:38:01,459 [INFO] -   Validation efficientnet: Loss=0.4590, Acc=85.76%, ECE=0.0423
2025-05-03 14:38:21,196 [INFO] -   Validation inception: Loss=0.6921, Acc=77.90%, ECE=0.0378
2025-05-03 14:38:33,192 [INFO] -   Validation mobilenet: Loss=0.7055, Acc=79.30%, ECE=0.0788
2025-05-03 14:38:44,760 [INFO] -   Validation resnet: Loss=0.8923, Acc=70.54%, ECE=0.0789
2025-05-03 14:39:10,422 [INFO] -   Validation densenet: Loss=0.6061, Acc=80.84%, ECE=0.0522
2025-05-03 14:39:25,237 [INFO] -   Validation student: Loss=0.2019, Acc=93.24%, ECE=0.0155
2025-05-03 14:39:27,609 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_4.pth (Epoch 3)
2025-05-03 14:39:27,745 [INFO] - GPU Memory: Current=4206.87MB, Peak=5270.56MB, Reserved=4586.00MB
2025-05-03 14:39:27,753 [INFO] - --- Starting Mutual Learning Epoch 5/50 ---
2025-05-03 14:39:30,714 [INFO] - GPU Memory: Current=3617.25MB, Peak=5270.56MB, Reserved=5376.00MB
2025-05-03 14:42:03,923 [INFO] - GPU Memory: Current=3617.19MB, Peak=5270.56MB, Reserved=5378.00MB
2025-05-03 14:44:37,984 [INFO] - GPU Memory: Current=3617.19MB, Peak=5270.56MB, Reserved=5378.00MB
2025-05-03 14:47:22,292 [INFO] - GPU Memory: Current=3617.93MB, Peak=5270.56MB, Reserved=5354.00MB
2025-05-03 14:50:07,634 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 14:52:45,293 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 14:55:23,238 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 14:57:57,306 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:00:35,383 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:03:16,502 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:05:51,110 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:08:26,865 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5376.00MB
2025-05-03 15:11:03,529 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:13:36,005 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:16:02,517 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:18:33,583 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:21:01,916 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:23:33,026 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:26:00,793 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:28:28,483 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:30:58,413 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:33:26,303 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:35:55,673 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:38:22,200 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:40:49,159 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:43:24,332 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:46:00,456 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:48:29,706 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:51:08,882 [INFO] - GPU Memory: Current=3617.00MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 15:51:24,257 [INFO] - --- Mutual Epoch 5 Summary (Time: 4316.50s): Avg Loss=0.8699, Avg Acc=71.23% ---
2025-05-03 15:51:24,257 [INFO] -   vit: Loss=0.9805, Acc=66.26%, CE=0.9805, Mut=3.1436, Cal=0.1736, Feat=0.0000
2025-05-03 15:51:24,257 [INFO] -   efficientnet: Loss=0.7363, Acc=75.64%, CE=0.7363, Mut=2.9292, Cal=0.1367, Feat=0.0000
2025-05-03 15:51:24,257 [INFO] -   inception: Loss=1.1093, Acc=63.68%, CE=1.1093, Mut=5.0702, Cal=0.1806, Feat=0.0000
2025-05-03 15:51:24,257 [INFO] -   mobilenet: Loss=1.0474, Acc=66.54%, CE=1.0474, Mut=3.2956, Cal=0.1729, Feat=0.0000
2025-05-03 15:51:24,257 [INFO] -   resnet: Loss=1.0533, Acc=64.40%, CE=1.0533, Mut=2.8297, Cal=0.1805, Feat=0.0000
2025-05-03 15:51:24,257 [INFO] -   densenet: Loss=0.9939, Acc=67.77%, CE=0.9939, Mut=3.0236, Cal=0.1659, Feat=0.0000
2025-05-03 15:51:24,257 [INFO] -   student: Loss=0.1687, Acc=94.34%, CE=0.1687, Mut=6.0786, Cal=0.0386, Feat=0.8377
2025-05-03 15:51:24,257 [INFO] - --- Starting Validation for Epoch 5 ---
2025-05-03 15:51:24,257 [INFO] - Collecting validation targets...
2025-05-03 15:51:26,484 [INFO] - Collected 5000 validation targets.
2025-05-03 15:51:59,084 [INFO] -   Validation vit: Loss=0.9297, Acc=67.38%, ECE=0.0237
2025-05-03 15:52:14,168 [INFO] -   Validation efficientnet: Loss=0.6089, Acc=81.82%, ECE=0.0650
2025-05-03 15:52:33,806 [INFO] -   Validation inception: Loss=0.8592, Acc=73.24%, ECE=0.0528
2025-05-03 15:52:45,889 [INFO] -   Validation mobilenet: Loss=0.6947, Acc=79.04%, ECE=0.0694
2025-05-03 15:52:57,405 [INFO] -   Validation resnet: Loss=0.8769, Acc=71.54%, ECE=0.0556
2025-05-03 15:53:22,399 [INFO] -   Validation densenet: Loss=0.6795, Acc=78.02%, ECE=0.0545
2025-05-03 15:53:36,994 [INFO] -   Validation student: Loss=0.1868, Acc=93.82%, ECE=0.0151
2025-05-03 15:53:37,088 [INFO] - New best accuracy for student: 93.82%. Checkpoint saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\student_mutual_best_acc.pth
2025-05-03 15:53:39,226 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_5.pth (Epoch 4)
2025-05-03 15:53:39,358 [INFO] - GPU Memory: Current=4209.99MB, Peak=5270.56MB, Reserved=4626.00MB
2025-05-03 15:53:39,358 [INFO] - --- Starting Mutual Learning Epoch 6/50 ---
2025-05-03 15:53:42,395 [INFO] - GPU Memory: Current=3617.59MB, Peak=5270.56MB, Reserved=5380.00MB
2025-05-03 15:56:21,245 [INFO] - GPU Memory: Current=3617.34MB, Peak=5270.56MB, Reserved=5356.00MB
2025-05-03 15:59:08,378 [INFO] - GPU Memory: Current=3617.33MB, Peak=5270.56MB, Reserved=5376.00MB
2025-05-03 16:01:58,119 [INFO] - GPU Memory: Current=3618.07MB, Peak=5270.56MB, Reserved=5376.00MB
2025-05-03 16:04:48,271 [INFO] - GPU Memory: Current=3617.58MB, Peak=5270.56MB, Reserved=5372.00MB
2025-05-03 16:07:31,124 [INFO] - GPU Memory: Current=3617.33MB, Peak=5270.56MB, Reserved=5374.00MB
2025-05-03 16:10:07,544 [INFO] - GPU Memory: Current=3618.07MB, Peak=5270.56MB, Reserved=5376.00MB
2025-05-03 16:12:44,022 [INFO] - GPU Memory: Current=3617.58MB, Peak=5270.56MB, Reserved=5372.00MB
2025-05-03 16:15:25,026 [INFO] - GPU Memory: Current=3618.33MB, Peak=5270.56MB, Reserved=5378.00MB
2025-05-03 16:18:02,257 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5370.00MB
2025-05-03 16:20:46,992 [INFO] - GPU Memory: Current=3618.33MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 16:23:24,359 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 16:26:01,000 [INFO] - GPU Memory: Current=3618.33MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 16:28:43,375 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 16:31:21,094 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 16:34:02,260 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5356.00MB
2025-05-03 16:36:41,013 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 16:39:20,484 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 16:42:06,314 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 16:44:48,420 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5356.00MB
2025-05-03 16:47:25,510 [INFO] - GPU Memory: Current=3617.45MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 16:50:04,532 [INFO] - GPU Memory: Current=3617.45MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 16:52:48,595 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5370.00MB
2025-05-03 16:55:33,708 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 16:58:12,016 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 17:00:53,086 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 17:03:26,191 [INFO] - GPU Memory: Current=3618.33MB, Peak=5271.69MB, Reserved=5378.00MB
2025-05-03 17:06:06,051 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5358.00MB
2025-05-03 17:08:49,392 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5370.00MB
2025-05-03 17:09:05,929 [INFO] - --- Mutual Epoch 6 Summary (Time: 4526.57s): Avg Loss=1.1710, Avg Acc=60.62% ---
2025-05-03 17:09:05,938 [INFO] -   vit: Loss=1.0818, Acc=62.34%, CE=1.0780, Mut=1.7840, Cal=0.1869, Feat=0.0000
2025-05-03 17:09:05,939 [INFO] -   efficientnet: Loss=0.8296, Acc=72.57%, CE=0.8232, Mut=2.0822, Cal=0.1498, Feat=0.0000
2025-05-03 17:09:05,939 [INFO] -   inception: Loss=1.1796, Acc=61.14%, CE=1.1733, Mut=2.3824, Cal=0.1870, Feat=0.0000
2025-05-03 17:09:05,939 [INFO] -   mobilenet: Loss=1.1204, Acc=63.91%, CE=1.1152, Mut=2.1277, Cal=0.1835, Feat=0.0000
2025-05-03 17:09:05,939 [INFO] -   resnet: Loss=1.0805, Acc=63.24%, CE=1.0782, Mut=1.5075, Cal=0.1814, Feat=0.0000
2025-05-03 17:09:05,939 [INFO] -   densenet: Loss=1.0397, Acc=66.69%, CE=1.0356, Mut=1.8209, Cal=0.1723, Feat=0.0000
2025-05-03 17:09:05,939 [INFO] -   student: Loss=1.8655, Acc=34.46%, CE=1.8675, Mut=1.4159, Cal=0.2055, Feat=0.2813
2025-05-03 17:09:05,939 [INFO] - --- Starting Validation for Epoch 6 ---
2025-05-03 17:09:05,939 [INFO] - Collecting validation targets...
2025-05-03 17:09:08,151 [INFO] - Collected 5000 validation targets.
2025-05-03 17:09:40,726 [INFO] -   Validation vit: Loss=1.0758, Acc=61.66%, ECE=0.0409
2025-05-03 17:09:55,318 [INFO] -   Validation efficientnet: Loss=0.8262, Acc=77.42%, ECE=0.0684
2025-05-03 17:10:14,934 [INFO] -   Validation inception: Loss=0.9872, Acc=67.38%, ECE=0.0434
2025-05-03 17:10:26,944 [INFO] -   Validation mobilenet: Loss=1.0433, Acc=68.78%, ECE=0.0761
2025-05-03 17:10:38,505 [INFO] -   Validation resnet: Loss=0.9270, Acc=69.08%, ECE=0.0398
2025-05-03 17:11:04,119 [INFO] -   Validation densenet: Loss=0.7237, Acc=76.04%, ECE=0.0478
2025-05-03 17:11:18,715 [INFO] -   Validation student: Loss=1.1357, Acc=58.48%, ECE=0.0253
2025-05-03 17:11:18,727 [INFO] - Model vit triggered early stopping based on calibration patience (5 epochs).
2025-05-03 17:11:18,729 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 17:11:18,729 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-03 17:11:18,729 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 17:11:18,731 [INFO] - Model resnet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 17:11:18,731 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 17:11:20,888 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_6.pth (Epoch 5)
2025-05-03 17:11:21,026 [INFO] - GPU Memory: Current=4210.36MB, Peak=5271.69MB, Reserved=4600.00MB
2025-05-03 17:11:21,034 [INFO] - --- Starting Mutual Learning Epoch 7/50 ---
2025-05-03 17:11:24,108 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 17:14:12,719 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 17:16:51,293 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 17:19:46,757 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 17:22:33,951 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 17:25:11,599 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 17:27:56,578 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 17:30:38,031 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 17:33:18,188 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5356.00MB
2025-05-03 17:35:53,419 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 17:38:33,017 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 17:41:10,454 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 17:43:58,243 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 17:46:34,860 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 17:49:11,475 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 17:51:49,184 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 17:54:31,037 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 17:57:09,766 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 17:59:51,099 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 18:02:32,355 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 18:05:09,422 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 18:07:45,937 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 18:10:22,934 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 18:13:00,011 [INFO] - GPU Memory: Current=3617.40MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 18:15:33,949 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5354.00MB
2025-05-03 18:18:05,619 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5354.00MB
2025-05-03 18:20:42,738 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 18:23:20,004 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5354.00MB
2025-05-03 18:25:51,517 [INFO] - GPU Memory: Current=3617.45MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 18:26:06,606 [INFO] - --- Mutual Epoch 7 Summary (Time: 4485.57s): Avg Loss=1.0723, Avg Acc=63.88% ---
2025-05-03 18:26:06,606 [INFO] -   vit: Loss=1.0689, Acc=62.99%, CE=1.0620, Mut=1.7122, Cal=0.1856, Feat=0.0000
2025-05-03 18:26:06,606 [INFO] -   efficientnet: Loss=0.8032, Acc=73.51%, CE=0.7932, Mut=1.7595, Cal=0.1450, Feat=0.0000
2025-05-03 18:26:06,606 [INFO] -   inception: Loss=1.1060, Acc=63.39%, CE=1.0945, Mut=2.2040, Cal=0.1779, Feat=0.0000
2025-05-03 18:26:06,606 [INFO] -   mobilenet: Loss=1.0766, Acc=64.70%, CE=1.0685, Mut=1.8435, Cal=0.1778, Feat=0.0000
2025-05-03 18:26:06,606 [INFO] -   resnet: Loss=1.0131, Acc=65.72%, CE=1.0091, Mut=1.3721, Cal=0.1750, Feat=0.0000
2025-05-03 18:26:06,609 [INFO] -   densenet: Loss=0.9969, Acc=67.66%, CE=0.9901, Mut=1.6353, Cal=0.1656, Feat=0.0000
2025-05-03 18:26:06,609 [INFO] -   student: Loss=1.4413, Acc=49.16%, CE=1.4449, Mut=1.0407, Cal=0.2074, Feat=0.2599
2025-05-03 18:26:06,609 [INFO] - --- Starting Validation for Epoch 7 ---
2025-05-03 18:26:06,609 [INFO] - Collecting validation targets...
2025-05-03 18:26:08,803 [INFO] - Collected 5000 validation targets.
2025-05-03 18:26:41,335 [INFO] -   Validation vit: Loss=0.9149, Acc=67.38%, ECE=0.0121
2025-05-03 18:26:56,283 [INFO] -   Validation efficientnet: Loss=0.5991, Acc=80.98%, ECE=0.0450
2025-05-03 18:27:15,934 [INFO] -   Validation inception: Loss=0.9390, Acc=68.84%, ECE=0.0559
2025-05-03 18:27:27,948 [INFO] -   Validation mobilenet: Loss=0.9187, Acc=72.50%, ECE=0.0994
2025-05-03 18:27:39,392 [INFO] -   Validation resnet: Loss=0.8732, Acc=70.70%, ECE=0.0719
2025-05-03 18:28:04,868 [INFO] -   Validation densenet: Loss=0.6885, Acc=77.60%, ECE=0.0346
2025-05-03 18:28:19,786 [INFO] -   Validation student: Loss=1.0735, Acc=63.24%, ECE=0.0421
2025-05-03 18:28:19,804 [INFO] - New best ECE for vit: 0.0121.
2025-05-03 18:28:20,070 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 18:28:20,070 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-03 18:28:20,081 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 18:28:20,081 [INFO] - Model resnet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 18:28:20,081 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 18:28:22,145 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_7.pth (Epoch 6)
2025-05-03 18:28:22,289 [INFO] - GPU Memory: Current=4211.51MB, Peak=5271.69MB, Reserved=4594.00MB
2025-05-03 18:28:22,289 [INFO] - --- Starting Mutual Learning Epoch 8/50 ---
2025-05-03 18:28:25,437 [INFO] - GPU Memory: Current=3617.40MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 18:31:05,996 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 18:33:50,220 [INFO] - GPU Memory: Current=3618.33MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 18:36:29,545 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5370.00MB
2025-05-03 18:39:05,832 [INFO] - GPU Memory: Current=3618.33MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 18:41:50,633 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 18:44:31,711 [INFO] - GPU Memory: Current=3618.33MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 18:47:17,885 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5360.00MB
2025-05-03 18:50:02,705 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 18:52:46,692 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 18:55:30,202 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5370.00MB
2025-05-03 18:58:15,541 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 19:00:56,994 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 19:03:33,990 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 19:06:16,308 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 19:08:56,012 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 19:11:36,834 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 19:14:15,564 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 19:16:54,840 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 19:19:34,391 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5356.00MB
2025-05-03 19:22:21,579 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 19:24:59,562 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5356.00MB
2025-05-03 19:27:39,653 [INFO] - GPU Memory: Current=3617.45MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 19:30:19,391 [INFO] - GPU Memory: Current=3618.33MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 19:32:55,156 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5360.00MB
2025-05-03 19:35:34,861 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 19:38:10,410 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 19:40:47,797 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 19:43:23,957 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5370.00MB
2025-05-03 19:43:39,211 [INFO] - --- Mutual Epoch 8 Summary (Time: 4516.92s): Avg Loss=0.9950, Avg Acc=66.50% ---
2025-05-03 19:43:39,211 [INFO] -   vit: Loss=1.0468, Acc=63.82%, CE=1.0370, Mut=1.6493, Cal=0.1825, Feat=0.0000
2025-05-03 19:43:39,211 [INFO] -   efficientnet: Loss=0.7706, Acc=74.74%, CE=0.7570, Mut=1.6321, Cal=0.1408, Feat=0.0000
2025-05-03 19:43:39,211 [INFO] -   inception: Loss=1.0777, Acc=64.51%, CE=1.0608, Mut=2.1508, Cal=0.1753, Feat=0.0000
2025-05-03 19:43:39,211 [INFO] -   mobilenet: Loss=0.9753, Acc=67.89%, CE=0.9648, Mut=1.6306, Cal=0.1669, Feat=0.0000
2025-05-03 19:43:39,211 [INFO] -   resnet: Loss=0.9318, Acc=68.17%, CE=0.9258, Mut=1.2931, Cal=0.1659, Feat=0.0000
2025-05-03 19:43:39,211 [INFO] -   densenet: Loss=0.9051, Acc=70.59%, CE=0.8955, Mut=1.5049, Cal=0.1539, Feat=0.0000
2025-05-03 19:43:39,211 [INFO] -   student: Loss=1.2580, Acc=55.77%, CE=1.2614, Mut=0.9921, Cal=0.1983, Feat=0.2558
2025-05-03 19:43:39,211 [INFO] - --- Starting Validation for Epoch 8 ---
2025-05-03 19:43:39,214 [INFO] - Collecting validation targets...
2025-05-03 19:43:41,428 [INFO] - Collected 5000 validation targets.
2025-05-03 19:44:13,897 [INFO] -   Validation vit: Loss=1.0352, Acc=62.80%, ECE=0.0270
2025-05-03 19:44:28,875 [INFO] -   Validation efficientnet: Loss=0.6624, Acc=79.80%, ECE=0.0649
2025-05-03 19:44:48,311 [INFO] -   Validation inception: Loss=0.7346, Acc=75.14%, ECE=0.0365
2025-05-03 19:45:00,045 [INFO] -   Validation mobilenet: Loss=0.7772, Acc=75.04%, ECE=0.0696
2025-05-03 19:45:11,362 [INFO] -   Validation resnet: Loss=0.8020, Acc=72.90%, ECE=0.0474
2025-05-03 19:45:36,869 [INFO] -   Validation densenet: Loss=0.6435, Acc=78.90%, ECE=0.0393
2025-05-03 19:45:51,381 [INFO] -   Validation student: Loss=0.9852, Acc=65.32%, ECE=0.0506
2025-05-03 19:45:51,392 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 19:45:51,392 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-03 19:45:51,392 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 19:45:51,392 [INFO] - Model resnet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 19:45:51,392 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 19:45:51,402 [INFO] - Model student triggered early stopping based on calibration patience (5 epochs).
2025-05-03 19:45:53,465 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_8.pth (Epoch 7)
2025-05-03 19:45:53,598 [INFO] - GPU Memory: Current=4210.48MB, Peak=5271.69MB, Reserved=4586.00MB
2025-05-03 19:45:53,598 [INFO] - --- Starting Mutual Learning Epoch 9/50 ---
2025-05-03 19:45:56,897 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 19:48:45,645 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 19:51:23,505 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 19:54:09,618 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5356.00MB
2025-05-03 19:56:53,486 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5356.00MB
2025-05-03 19:59:37,219 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 20:02:21,222 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 20:05:02,010 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 20:07:45,791 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 20:10:29,128 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 20:13:06,305 [INFO] - GPU Memory: Current=3618.33MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 20:15:48,823 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5360.00MB
2025-05-03 20:18:30,123 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5360.00MB
2025-05-03 20:21:11,104 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 20:23:56,194 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 20:26:35,390 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 20:29:11,416 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 20:31:52,349 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 20:34:31,269 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 20:37:14,377 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5370.00MB
2025-05-03 20:40:01,352 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 20:42:40,999 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 20:45:28,154 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 20:48:15,327 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 20:50:52,974 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 20:53:27,821 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5370.00MB
2025-05-03 20:56:04,126 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 20:58:42,770 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 21:01:18,682 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 21:01:34,017 [INFO] - --- Mutual Epoch 9 Summary (Time: 4540.42s): Avg Loss=0.9619, Avg Acc=67.85% ---
2025-05-03 21:01:34,017 [INFO] -   vit: Loss=1.0188, Acc=64.69%, CE=1.0048, Mut=1.6681, Cal=0.1796, Feat=0.0000
2025-05-03 21:01:34,019 [INFO] -   efficientnet: Loss=0.7413, Acc=75.82%, CE=0.7239, Mut=1.5651, Cal=0.1347, Feat=0.0000
2025-05-03 21:01:34,019 [INFO] -   inception: Loss=1.0271, Acc=66.59%, CE=1.0046, Mut=2.0961, Cal=0.1690, Feat=0.0000
2025-05-03 21:01:34,019 [INFO] -   mobilenet: Loss=0.9713, Acc=68.24%, CE=0.9577, Mut=1.6045, Cal=0.1646, Feat=0.0000
2025-05-03 21:01:34,019 [INFO] -   resnet: Loss=0.8693, Acc=70.48%, CE=0.8610, Mut=1.2426, Cal=0.1564, Feat=0.0000
2025-05-03 21:01:34,019 [INFO] -   densenet: Loss=0.8936, Acc=71.32%, CE=0.8804, Mut=1.5114, Cal=0.1527, Feat=0.0000
2025-05-03 21:01:34,019 [INFO] -   student: Loss=1.2122, Acc=57.78%, CE=1.2158, Mut=0.9928, Cal=0.1917, Feat=0.2475
2025-05-03 21:01:34,019 [INFO] - --- Starting Validation for Epoch 9 ---
2025-05-03 21:01:34,021 [INFO] - Collecting validation targets...
2025-05-03 21:01:36,212 [INFO] - Collected 5000 validation targets.
2025-05-03 21:02:08,652 [INFO] -   Validation vit: Loss=0.8502, Acc=70.80%, ECE=0.0223
2025-05-03 21:02:23,624 [INFO] -   Validation efficientnet: Loss=0.6025, Acc=81.04%, ECE=0.0604
2025-05-03 21:02:42,862 [INFO] -   Validation inception: Loss=0.7550, Acc=73.22%, ECE=0.0519
2025-05-03 21:02:54,604 [INFO] -   Validation mobilenet: Loss=0.7859, Acc=75.48%, ECE=0.0726
2025-05-03 21:03:06,179 [INFO] -   Validation resnet: Loss=0.8941, Acc=74.46%, ECE=0.0296
2025-05-03 21:03:31,166 [INFO] -   Validation densenet: Loss=0.6207, Acc=79.24%, ECE=0.0168
2025-05-03 21:03:46,047 [INFO] -   Validation student: Loss=0.8723, Acc=69.74%, ECE=0.0199
2025-05-03 21:03:46,059 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 21:03:46,059 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-03 21:03:46,059 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 21:03:46,059 [INFO] - Model resnet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 21:03:46,061 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 21:03:46,061 [INFO] - Model student triggered early stopping based on calibration patience (5 epochs).
2025-05-03 21:03:48,188 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_9.pth (Epoch 8)
2025-05-03 21:03:48,321 [INFO] - GPU Memory: Current=4210.48MB, Peak=5271.69MB, Reserved=4586.00MB
2025-05-03 21:03:48,321 [INFO] - --- Starting Mutual Learning Epoch 10/50 ---
2025-05-03 21:03:51,572 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 21:06:31,800 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 21:09:09,046 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5378.00MB
2025-05-03 21:11:53,917 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5356.00MB
2025-05-03 21:14:24,565 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 21:16:58,296 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5370.00MB
2025-05-03 21:19:25,617 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 21:22:03,169 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 21:24:40,943 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5356.00MB
2025-05-03 21:27:14,992 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 21:29:52,370 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 21:32:24,467 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 21:34:57,922 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 21:37:36,903 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 21:40:17,003 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 21:42:55,823 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 21:45:39,707 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 21:48:17,648 [INFO] - GPU Memory: Current=3618.33MB, Peak=5271.69MB, Reserved=5378.00MB
2025-05-03 21:50:54,067 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 21:53:31,414 [INFO] - GPU Memory: Current=3618.33MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 21:56:01,277 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 21:58:35,708 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 22:01:06,858 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 22:03:40,881 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 22:06:13,849 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 22:08:53,212 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 22:11:32,354 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 22:14:07,472 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 22:16:44,053 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 22:17:00,269 [INFO] - --- Mutual Epoch 10 Summary (Time: 4391.95s): Avg Loss=0.9111, Avg Acc=69.64% ---
2025-05-03 22:17:00,269 [INFO] -   vit: Loss=0.9949, Acc=65.90%, CE=0.9767, Mut=1.6678, Cal=0.1777, Feat=0.0000
2025-05-03 22:17:00,269 [INFO] -   efficientnet: Loss=0.7072, Acc=76.88%, CE=0.6860, Mut=1.5085, Cal=0.1301, Feat=0.0000
2025-05-03 22:17:00,269 [INFO] -   inception: Loss=0.9590, Acc=68.95%, CE=0.9302, Mut=2.0477, Cal=0.1604, Feat=0.0000
2025-05-03 22:17:00,269 [INFO] -   mobilenet: Loss=0.9350, Acc=69.66%, CE=0.9177, Mut=1.5755, Cal=0.1596, Feat=0.0000
2025-05-03 22:17:00,269 [INFO] -   resnet: Loss=0.8183, Acc=72.33%, CE=0.8079, Mut=1.1939, Cal=0.1496, Feat=0.0000
2025-05-03 22:17:00,269 [INFO] -   densenet: Loss=0.8483, Acc=72.61%, CE=0.8315, Mut=1.4742, Cal=0.1475, Feat=0.0000
2025-05-03 22:17:00,269 [INFO] -   student: Loss=1.1148, Acc=61.14%, CE=1.1172, Mut=0.9799, Cal=0.1850, Feat=0.2379
2025-05-03 22:17:00,269 [INFO] - --- Starting Validation for Epoch 10 ---
2025-05-03 22:17:00,279 [INFO] - Collecting validation targets...
2025-05-03 22:17:02,487 [INFO] - Collected 5000 validation targets.
2025-05-03 22:17:38,051 [INFO] -   Validation vit: Loss=0.9108, Acc=68.74%, ECE=0.0209
2025-05-03 22:17:52,979 [INFO] -   Validation efficientnet: Loss=0.5833, Acc=82.62%, ECE=0.0584
2025-05-03 22:18:12,257 [INFO] -   Validation inception: Loss=0.7122, Acc=77.74%, ECE=0.0535
2025-05-03 22:18:23,972 [INFO] -   Validation mobilenet: Loss=0.7574, Acc=75.82%, ECE=0.0674
2025-05-03 22:18:35,288 [INFO] -   Validation resnet: Loss=0.7352, Acc=75.90%, ECE=0.0663
2025-05-03 22:19:00,603 [INFO] -   Validation densenet: Loss=0.6194, Acc=80.04%, ECE=0.0467
2025-05-03 22:19:15,448 [INFO] -   Validation student: Loss=0.8139, Acc=72.10%, ECE=0.0444
2025-05-03 22:19:15,458 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 22:19:15,460 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-03 22:19:15,460 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 22:19:15,462 [INFO] - Model resnet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 22:19:15,462 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 22:19:15,462 [INFO] - Model student triggered early stopping based on calibration patience (5 epochs).
2025-05-03 22:19:34,984 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_10.pth (Epoch 9)
2025-05-03 22:19:35,128 [INFO] - GPU Memory: Current=4212.93MB, Peak=5271.69MB, Reserved=4592.00MB
2025-05-03 22:19:35,128 [INFO] - --- Starting Mutual Learning Epoch 11/50 ---
2025-05-03 22:19:38,390 [INFO] - GPU Memory: Current=3617.27MB, Peak=5271.69MB, Reserved=5384.00MB
2025-05-03 22:22:21,830 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 22:24:49,600 [INFO] - GPU Memory: Current=3618.33MB, Peak=5271.69MB, Reserved=5380.00MB
2025-05-03 22:27:26,569 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 22:29:58,719 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 22:32:35,129 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 22:35:06,520 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5356.00MB
2025-05-03 22:37:47,333 [INFO] - GPU Memory: Current=3617.40MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 22:40:22,829 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5370.00MB
2025-05-03 22:43:02,649 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 22:45:39,260 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 22:48:17,674 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 22:50:59,171 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 22:53:39,663 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 22:56:25,480 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5370.00MB
2025-05-03 22:59:00,942 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 23:01:39,876 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 23:04:21,811 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 23:06:59,443 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 23:09:38,664 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 23:12:13,429 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 23:14:52,583 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 23:17:36,910 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 23:20:13,698 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 23:22:54,664 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 23:25:30,652 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5374.00MB
2025-05-03 23:28:04,520 [INFO] - GPU Memory: Current=3617.58MB, Peak=5271.69MB, Reserved=5372.00MB
2025-05-03 23:30:42,196 [INFO] - GPU Memory: Current=3617.33MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 23:33:20,079 [INFO] - GPU Memory: Current=3618.07MB, Peak=5271.69MB, Reserved=5376.00MB
2025-05-03 23:33:36,526 [INFO] - --- Mutual Epoch 11 Summary (Time: 4441.40s): Avg Loss=0.8749, Avg Acc=71.00% ---
2025-05-03 23:33:36,526 [INFO] -   vit: Loss=0.9564, Acc=67.15%, CE=0.9346, Mut=1.6288, Cal=0.1702, Feat=0.0000
2025-05-03 23:33:36,526 [INFO] -   efficientnet: Loss=0.7130, Acc=76.91%, CE=0.6885, Mut=1.4791, Cal=0.1300, Feat=0.0000
2025-05-03 23:33:36,526 [INFO] -   inception: Loss=0.9188, Acc=70.58%, CE=0.8837, Mut=2.0203, Cal=0.1548, Feat=0.0000
2025-05-03 23:33:36,526 [INFO] -   mobilenet: Loss=0.9040, Acc=70.43%, CE=0.8846, Mut=1.5004, Cal=0.1564, Feat=0.0000
2025-05-03 23:33:36,526 [INFO] -   resnet: Loss=0.7903, Acc=73.36%, CE=0.7775, Mut=1.1775, Cal=0.1448, Feat=0.0000
2025-05-03 23:33:36,526 [INFO] -   densenet: Loss=0.8123, Acc=74.09%, CE=0.7922, Mut=1.4351, Cal=0.1406, Feat=0.0000
2025-05-03 23:33:36,526 [INFO] -   student: Loss=1.0292, Acc=64.46%, CE=1.0297, Mut=0.9733, Cal=0.1748, Feat=0.2294
2025-05-03 23:33:36,526 [INFO] - --- Starting Validation for Epoch 11 ---
2025-05-03 23:33:36,533 [INFO] - Collecting validation targets...
2025-05-03 23:33:38,726 [INFO] - Collected 5000 validation targets.
2025-05-03 23:34:11,179 [INFO] -   Validation vit: Loss=0.9288, Acc=67.00%, ECE=0.0443
2025-05-03 23:34:25,807 [INFO] -   Validation efficientnet: Loss=0.5796, Acc=83.16%, ECE=0.0639
2025-05-03 23:34:44,791 [INFO] -   Validation inception: Loss=0.6348, Acc=79.84%, ECE=0.0394
2025-05-03 23:34:56,451 [INFO] -   Validation mobilenet: Loss=0.6690, Acc=78.54%, ECE=0.0543
2025-05-03 23:35:07,693 [INFO] -   Validation resnet: Loss=0.8466, Acc=76.64%, ECE=0.0449
2025-05-03 23:35:32,300 [INFO] -   Validation densenet: Loss=0.5322, Acc=83.00%, ECE=0.0257
2025-05-03 23:35:46,777 [INFO] -   Validation student: Loss=0.8104, Acc=72.52%, ECE=0.0351
2025-05-03 23:35:46,787 [INFO] - Model vit triggered early stopping based on accuracy patience (10 epochs).
2025-05-03 23:35:46,791 [INFO] - Model efficientnet triggered early stopping based on accuracy patience (10 epochs).
2025-05-03 23:35:46,791 [INFO] - Model efficientnet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 23:35:46,791 [INFO] - Model inception triggered early stopping based on accuracy patience (10 epochs).
2025-05-03 23:35:46,791 [INFO] - Model inception triggered early stopping based on calibration patience (5 epochs).
2025-05-03 23:35:46,791 [INFO] - Model mobilenet triggered early stopping based on accuracy patience (10 epochs).
2025-05-03 23:35:46,791 [INFO] - Model mobilenet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 23:35:46,793 [INFO] - Model resnet triggered early stopping based on accuracy patience (10 epochs).
2025-05-03 23:35:46,793 [INFO] - Model resnet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 23:35:46,793 [INFO] - Model densenet triggered early stopping based on accuracy patience (10 epochs).
2025-05-03 23:35:46,793 [INFO] - Model densenet triggered early stopping based on calibration patience (5 epochs).
2025-05-03 23:35:46,793 [INFO] - Model student triggered early stopping based on calibration patience (5 epochs).
2025-05-03 23:35:48,839 [INFO] - Checkpoint saved successfully to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mutual_checkpoint_epoch_11.pth (Epoch 10)
2025-05-03 23:35:48,839 [INFO] - All models met early stopping criteria at epoch 11. Stopping training.
2025-05-03 23:35:48,839 [INFO] - Restoring best model states based on validation accuracy...
2025-05-03 23:35:48,849 [INFO] - Restored best state for vit from epoch 1 (Acc: 96.24%)
2025-05-03 23:35:48,860 [INFO] - Restored best state for efficientnet from epoch 1 (Acc: 94.78%)
2025-05-03 23:35:48,890 [INFO] - Restored best state for inception from epoch 1 (Acc: 94.40%)
2025-05-03 23:35:48,911 [INFO] - Restored best state for mobilenet from epoch 1 (Acc: 94.86%)
2025-05-03 23:35:48,921 [INFO] - Restored best state for resnet from epoch 1 (Acc: 92.36%)
2025-05-03 23:35:48,941 [INFO] - Restored best state for densenet from epoch 1 (Acc: 94.28%)
2025-05-03 23:35:48,951 [INFO] - Restored best state for student from epoch 5 (Acc: 93.82%)
2025-05-03 23:35:48,951 [INFO] - Saving final (best) model states...
2025-05-03 23:35:49,231 [INFO] - Final best model for vit saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\vit_mutual_final_best.pth
2025-05-03 23:35:49,276 [INFO] - Final best model for efficientnet saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\efficientnet_mutual_final_best.pth
2025-05-03 23:35:49,428 [INFO] - Final best model for inception saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\inception_mutual_final_best.pth
2025-05-03 23:35:49,469 [INFO] - Final best model for mobilenet saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\mobilenet_mutual_final_best.pth
2025-05-03 23:35:49,572 [INFO] - Final best model for resnet saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\resnet_mutual_final_best.pth
2025-05-03 23:35:49,664 [INFO] - Final best model for densenet saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\densenet_mutual_final_best.pth
2025-05-03 23:35:49,715 [INFO] - Final best model for student saved to C:\Users\Gading\Downloads\Research\Models\MutualLearning\checkpoints\student_mutual_final_best.pth
2025-05-03 23:35:49,715 [INFO] - Training history saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\mutual_learning_20250503_094420_history.json
2025-05-03 23:35:49,715 [INFO] - Mutual learning phase completed
2025-05-03 23:35:52,669 [INFO] - Training history plot saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\mutual_learning_history.png
2025-05-03 23:35:52,669 [INFO] - Starting final evaluation and export...
2025-05-03 23:35:52,669 [INFO] - Plotting calibration curves...
2025-05-03 23:36:15,275 [INFO] - Using device: cuda
2025-05-03 23:36:15,275 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 23:36:15,275 [INFO] - GPU Memory: 6.00 GB
2025-05-03 23:36:15,275 [INFO] - CUDA Version: 11.8
2025-05-03 23:36:15,275 [INFO] - cuDNN benchmark mode enabled
2025-05-03 23:36:20,068 [INFO] - Using device: cuda
2025-05-03 23:36:20,083 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 23:36:20,083 [INFO] - GPU Memory: 6.00 GB
2025-05-03 23:36:20,083 [INFO] - CUDA Version: 11.8
2025-05-03 23:36:20,083 [INFO] - cuDNN benchmark mode enabled
2025-05-03 23:36:24,872 [INFO] - Using device: cuda
2025-05-03 23:36:24,872 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 23:36:24,872 [INFO] - GPU Memory: 6.00 GB
2025-05-03 23:36:24,872 [INFO] - CUDA Version: 11.8
2025-05-03 23:36:24,872 [INFO] - cuDNN benchmark mode enabled
2025-05-03 23:36:29,624 [INFO] - Using device: cuda
2025-05-03 23:36:29,642 [INFO] - GPU: NVIDIA GeForce RTX 3060 Laptop GPU
2025-05-03 23:36:29,642 [INFO] - GPU Memory: 6.00 GB
2025-05-03 23:36:29,642 [INFO] - CUDA Version: 11.8
2025-05-03 23:36:29,642 [INFO] - cuDNN benchmark mode enabled
2025-05-03 23:41:53,370 [INFO] - Teacher calibration curves saved to C:\Users\Gading\Downloads\Research\Results\MutualLearning\plots\teacher_calibration_curves.png
2025-05-03 23:41:53,373 [INFO] - Evaluating final student model...
2025-05-03 23:41:53,373 [INFO] - Evaluating student model...
2025-05-03 23:42:30,221 [INFO] - Test Results:
2025-05-03 23:42:30,221 [INFO] - Loss: 0.2129
2025-05-03 23:42:30,221 [INFO] - Accuracy: 93.93%
2025-05-03 23:42:30,221 [INFO] - F1 Score: 0.9393
2025-05-03 23:42:30,221 [INFO] - Precision: 0.9394
2025-05-03 23:42:30,221 [INFO] - Recall: 0.9393
2025-05-03 23:42:30,221 [INFO] - ECE: 0.0161
2025-05-03 23:42:30,221 [INFO] - Exporting final student model...
2025-05-03 23:42:30,271 [INFO] - Final student model exported to C:\Users\Gading\Downloads\Research\Models\MutualLearning\exports\mutual_learning_20250503_234230_final_student.pth
2025-05-03 23:42:30,271 [INFO] - Mutual learning script finished.
